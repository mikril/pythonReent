(self.webpackChunkvk=self.webpackChunkvk||[]).push([[77433],{254632:(e,t,i)=>{"use strict";i.d(t,{useInView:()=>u});var n=i(667294);const r=new Map,a=new WeakMap;let o,s=0;function d(e){return Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>{return`${t}_${"root"===t?(i=e.root,i?(a.has(i)||(s+=1,a.set(i,s.toString())),a.get(i)):"0"):e[t]}`;var i})).toString()}function c(e,t,i={},n=o){if(void 0===window.IntersectionObserver&&void 0!==n){const r=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:"number"==typeof i.threshold?i.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),()=>{}}const{id:a,observer:s,elements:c}=function(e){let t=d(e),i=r.get(t);if(!i){const n=new Map;let a;const o=new IntersectionObserver((t=>{t.forEach((t=>{var i;const r=t.isIntersecting&&a.some((e=>t.intersectionRatio>=e));e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=r),null==(i=n.get(t.target))||i.forEach((e=>{e(r,t)}))}))}),e);a=o.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:t,observer:o,elements:n},r.set(t,i)}return i}(i);let l=c.get(e)||[];return c.has(e)||c.set(e,l),l.push(t),s.observe(e),function(){l.splice(l.indexOf(t),1),0===l.length&&(c.delete(e),s.unobserve(e)),0===c.size&&(s.disconnect(),r.delete(a))}}class l extends n.Component{constructor(e){super(e),this.node=null,this._unobserveCb=null,this.handleNode=e=>{this.node&&(this.unobserve(),e||this.props.triggerOnce||this.props.skip||this.setState({inView:!!this.props.initialInView,entry:void 0})),this.node=e||null,this.observeNode()},this.handleChange=(e,t)=>{e&&this.props.triggerOnce&&this.unobserve(),isPlainChildren(this.props)||this.setState({inView:e,entry:t}),this.props.onChange&&this.props.onChange(e,t)},this.state={inView:!!e.initialInView,entry:void 0}}componentDidUpdate(e){e.rootMargin===this.props.rootMargin&&e.root===this.props.root&&e.threshold===this.props.threshold&&e.skip===this.props.skip&&e.trackVisibility===this.props.trackVisibility&&e.delay===this.props.delay||(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve(),this.node=null}observeNode(){if(!this.node||this.props.skip)return;const{threshold:e,root:t,rootMargin:i,trackVisibility:n,delay:r,fallbackInView:a}=this.props;this._unobserveCb=c(this.node,this.handleChange,{threshold:e,root:t,rootMargin:i,trackVisibility:n,delay:r},a)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){if(!isPlainChildren(this.props)){const{inView:e,entry:t}=this.state;return this.props.children({inView:e,entry:t,ref:this.handleNode})}const e=this.props,{children:t,as:i}=e,r=function(e,t){if(null==e)return{};var i,n,r={},a=Object.keys(e);for(0;n<a.length;n++)a[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,_excluded);return n.createElement(i||"div",_extends({ref:this.handleNode},r),t)}}function u({threshold:e,delay:t,trackVisibility:i,rootMargin:r,root:a,triggerOnce:o,skip:s,initialInView:d,fallbackInView:l,onChange:u}={}){var v;const[f,p]=n.useState(null),h=n.useRef(),[m,_]=n.useState({inView:!!d,entry:void 0});h.current=u,n.useEffect((()=>{if(s||!f)return;let n=c(f,((e,t)=>{_({inView:e,entry:t}),h.current&&h.current(e,t),t.isIntersecting&&o&&n&&(n(),n=void 0)}),{root:a,rootMargin:r,threshold:e,trackVisibility:i,delay:t},l);return()=>{n&&n()}}),[Array.isArray(e)?e.toString():e,f,a,r,o,s,i,l,t]);const g=null==(v=m.entry)?void 0:v.target;n.useEffect((()=>{f||!g||o||s||_({inView:!!d,entry:void 0})}),[f,g,o,s,d]);const k=[p,m.inView,m.entry];return k.ref=k[0],k.inView=k[1],k.entry=k[2],k}},784970:(e,t,i)=>{"use strict";i.d(t,{usePrevious:()=>f,useDidUpdate:()=>p,useActualEffectCleanup:()=>h,useDebounced:()=>m,useOnline:()=>_,OnlinesProvider:()=>k,useDispatch:()=>y,DispatchProvider:()=>w,useHelpHints:()=>I,HelpHintsProvider:()=>A,useTypings:()=>P,TypingsProvider:()=>S,usePixelDensity:()=>E,matchAddEventListener:()=>R,useNow:()=>N,usePeers:()=>F,PeersProvider:()=>T,useConvos:()=>L,ConvosProvider:()=>D,useChannels:()=>B,ChannelsProvider:()=>O,useFeatureFlags:()=>K,FeatureFlagsProvider:()=>j,useOwner:()=>H,OwnerProvider:()=>z,useViewer:()=>Y,ViewerProvider:()=>X,useAppSource:()=>$,useVideoMessageShapes:()=>Z,VideoMessageShapesProvider:()=>ee,AppSourceProvider:()=>ie,useBrowserEnv:()=>ne,BrowserEnvProvider:()=>ae,useViewport:()=>oe,useRead:()=>de,useCombinedRefs:()=>ce,InsertIntoCacheProvider:()=>ue,useInsertIntoCache:()=>ve,ConvosSearchIndexProvider:()=>pe,useConvosSearchIndex:()=>he});var n=i(111965),r=i(28991),a=i(334738),o=i(678927),s=i(667294),d=i(254632),c=i(314432),l=i(233600),u=i(21705),v=i(837021);function f(e){var t=(0,s.useRef)();return(0,s.useEffect)((function(){t.current=e}),[e]),t.current}function p(e,t){var i=(0,s.useRef)(!1);(0,s.useEffect)((function(){if(i.current)return e()}),t),(0,s.useEffect)((function(){i.current=!0}),[])}function h(e,t){var i=(0,s.useRef)(t);i.current=t,(0,s.useEffect)((function(){return function(){t.some((function(e,t){return e!==i.current[t]}))&&e()}}),[].concat((0,o.default)(t),[e]));var n=(0,s.useRef)(e);n.current=e,(0,s.useEffect)((function(){return function(){n.current()}}),[])}function m(e,t){var i=(0,s.useState)({debounced:e,debouncedUpdatesCount:0}),n=(0,a.default)(i,2),o=n[0],d=n[1];return(0,s.useLayoutEffect)((function(){if(0!==t){var i=setTimeout((function(){d((function(t){var i=t.debouncedUpdatesCount;return{debounced:e,debouncedUpdatesCount:i+1}}))}),t);return function(){clearTimeout(i)}}d((function(t){return(0,r.default)((0,r.default)({},t),{},{debounced:e})}))}),[e,t]),o}function _(e){var t=(0,s.useContext)(g);return!!c.isUserPeerId(e)&&t.has(e)}var g=s.createContext(new Set),k=g.Provider;function y(){var e=(0,s.useContext)(b);if(!e)throw new Error("DispatchProvider не добавлен в дерево Реакта!");return e}var b=s.createContext(null),w=b.Provider;function I(){var e=(0,s.useContext)(C);if(void 0===e)throw new Error("HelpHintsProvider не добавлен в дерево Реакта!");return e}var C=s.createContext(new Set),A=C.Provider;function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=(0,s.useContext)(x),a=F(),o=ne(),d=o.lang,l=r.get(e);if(l){var u,f=[],p=new Set,h=(0,n.default)(v.TypingVariants);try{for(h.s();!(u=h.n()).done;){var m=u.value,_=l[m];_&&(f.push(m),_.peerIds.forEach((function(e){return p.add(e)})))}}catch(e){h.e(e)}finally{h.f()}var g=f.length>1?"text":f[0]||"text";if(0===i)return{text:d.use("me_typing_".concat(g)),type:g};var k,y,b=[],w=(0,n.default)(p);try{for(w.s();!(k=w.n()).done;){var I=k.value,C=a.get(I);if(C&&(b.push(C),b.length===i))break}}catch(e){w.e(e)}finally{w.f()}var A=", ",P=p.size-b.length;switch(!0){case 0===b.length&&P>0:y=d.use("me_typing_people",{num:P});break;case P>0:y=b.map((function(e){return c.shortName(e)})).join(A),y=d.use("me_typing_names_lots",{num:P,values:{names:y}});break;case b.length>1:var S=b.length>i-1?b.slice(0,i-1).map((function(e){return c.shortName(e)})).join(A):b[0]?c.shortName(b[0]):"",M=b[b.length-1],E=M?c.shortName(M):"";y=d.use("me_typing_names_couple",{values:{before:S,after:E}});break;case 1===b.length:y=b[0]?c.shortName(b[0]):"";break;default:y=""}var R="compact"===t?y:d.use("me_typing_".concat(g,"_named"),{num:b.length,values:{names:y}});return{text:R,type:g}}}var x=s.createContext(new Map),S=x.Provider,M=function(){return window.devicePixelRatio>1.3};function E(){var e=(0,s.useState)(M),t=(0,a.default)(e,2),i=t[0],n=t[1];return(0,s.useEffect)((function(){return R(window.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),(function(){n(M)}))}),[]),i}function R(e,t){try{return e.addEventListener("change",t),function(){e.removeEventListener("change",t)}}catch(i){return e.addListener(t),function(){e.removeListener(t)}}}function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,t=(0,s.useState)(Date.now),i=(0,a.default)(t,2),n=i[0],r=i[1];return(0,s.useLayoutEffect)((function(){var t=setInterval((function(){r(Date.now())}),e);return function(){return clearInterval(t)}}),[e]),n}function F(){return(0,s.useContext)(U)}var U=s.createContext(new Map),T=U.Provider;function L(){return(0,s.useContext)(V)}var V=s.createContext(new Map),D=V.Provider;function B(){return(0,s.useContext)(q)}var q=s.createContext(new Map),O=q.Provider;function K(){var e=(0,s.useContext)(G);if(!e)throw new Error("FeatureFlagsProvider не добавлен в дерево Реакта!");return e}var G=s.createContext(null),j=G.Provider;function H(){var e=(0,s.useContext)(W);if(!e)throw new Error("OwnerProvider не добавлен в дерево Реакта!");return e}var W=s.createContext(null),z=W.Provider;function Y(){var e=(0,s.useContext)(J);if(!e)throw new Error("ViewerProvider не добавлен в дерево Реакта!");return e}var J=s.createContext(null),X=J.Provider;function $(){var e=(0,s.useContext)(te);if(!e)throw new Error("AppSourceProvider не добавлен");return e}function Z(){return(0,s.useContext)(Q)}var Q=s.createContext(new Map),ee=Q.Provider,te=s.createContext(null),ie=te.Provider;function ne(){var e=(0,s.useContext)(re);if(!e)throw new Error("BrowserEnvProvider не добавлен в дерево Реакта!");return e}var re=s.createContext(null),ae=re.Provider;function oe(e){var t=e.debounced,i=void 0!==t&&t,n=(0,s.useState)(se),r=(0,a.default)(n,2),o=r[0],d=r[1],c=(0,s.useRef)((0,u.debounce)(d,300,!1));return(0,s.useLayoutEffect)((function(){var e=c.current,t=function(){i?e(se()):d(se())};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t),i&&e.cancel()}}),[i]),o}function se(){return"undefined"==typeof window?[0,0]:[document.documentElement.clientWidth,document.documentElement.clientHeight]}function de(e){var t=e.isUnread,i=e.isOut,n=e.onRead,r=ne().idle,o=(0,s.useState)((function(){return r.isIdle()})),c=(0,a.default)(o,2),l=c[0],u=c[1],v=(0,d.useInView)({threshold:.01}),f=v.ref,p=v.inView;return(0,s.useEffect)((function(){return r.subscribe((function(){u(r.isIdle())}))}),[r]),(0,s.useEffect)((function(){if(p&&!l&&t){var e=setTimeout(n,500);return function(){return clearTimeout(e)}}}),[p,l,n,i,t]),f}function ce(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=(0,s.useRef)(null);return s.useEffect((function(){t.forEach((function(e){e&&("function"==typeof e?e(n.current):e.current=n.current)}))}),[t]),n}var le=s.createContext(null),ue=le.Provider;function ve(){var e=(0,s.useContext)(le);if(!e)throw new Error("InsertIntoCacheProvider не добавлен в дерево Реакта!");return e}var fe=s.createContext(l.create()),pe=fe.Provider;function he(){return(0,s.useContext)(fe)}},417388:(e,t,i)=>{"use strict";i.d(t,{UIConfigProvider:()=>u,useLayoutData:()=>v,useDeviceData:()=>f});var n=i(334738),r=i(667294),a=i(86894),o=i(784970),s=i(362276),d=i(21705),c=i(552114),l=i(785893),u=function(e){var t=e.scheme,i=void 0===t?"VKCOM":t,s=e.theme,u=void 0===s?"system":s,v=e.children,f=e.locale,p=e.onThemeUpdated,m=(0,r.useState)("system"!==u?u:"light"),_=(0,n.default)(m,2),g=_[0],k=_[1],y=(0,r.useRef)(null),b=(0,r.useCallback)((function(e){k(e.matches?"dark":"light")}),[]);(0,r.useEffect)((function(){var e,t=window.matchMedia("(prefers-color-scheme: dark)");switch(u){case"light":case"dark":k(u),null===(e=y.current)||void 0===e||e.call(y);break;case"system":y.current=(0,o.matchAddEventListener)(t,b),k(t.matches?"dark":"light");break;default:(0,d.exhaustivenessCheck)(u)}}),[b,u]),(0,r.useEffect)((function(){return function(){var e;return null===(e=y.current)||void 0===e?void 0:e.call(y)}}),[]),(0,r.useLayoutEffect)((function(){null==p||p(g)}),[p,g]),(0,r.useEffect)((function(){var e=c.BounceDisabler.supported()?new c.BounceDisabler:void 0;return null==e||e.enable(),function(){null==e||e.disable()}}),[]);var w="VKCOM"===i?"light"===g?"vkcom_light":"vkcom_dark":"light"===g?a.Scheme.BRIGHT_LIGHT:a.Scheme.SPACE_GRAY,I=(0,o.useViewport)({debounced:!0}),C=(0,n.default)(I,1)[0]<640?"one-column":"two-column";return(0,l.jsx)(a.ConfigProvider,{locale:f,platform:a.Platform.IOS,scheme:w,children:(0,l.jsx)(a.ConfigProvider,{locale:f,platform:a.Platform.VKCOM,scheme:"inherit",children:(0,l.jsx)(a.AdaptivityProvider,{children:(0,l.jsx)(h,{value:{mode:C},children:v})})})})};function v(){var e=(0,r.useContext)(p);if(!e)throw new Error("LayoutDataContext не добавлен в дерево Реакта!");return e}function f(){var e=(0,r.useContext)(s.AdaptivityContext);if(!e)throw new Error("AdaptivityContext не добавлен в дерево Реакта!");return{isTouchOnly:!e.deviceHasHover}}var p=r.createContext(null),h=p.Provider},552114:(e,t,i)=>{"use strict";i.d(t,{BounceDisabler:()=>s});var n=i(306610),r=i(5991),a=i(896156),o=i(21705),s=function(){function e(){(0,n.default)(this,e),(0,a.default)(this,"startX",0),(0,a.default)(this,"startY",0)}return(0,r.default)(e,[{key:"onTouchMove",value:function(e){var t=d(e);if(e.target&&t&&!function(e){var t=window.innerWidth/window.document.documentElement.clientWidth;if(1===e.length)return!1;return 1!==t}(t)&&!function(e,t,i){var n=10,r=i[0],a=r.screenY,o=r.screenX,s=a<=t+n&&a>=t-n;return e!==o&&s}(this.startX,this.startY,t)){for(var i=e.target;i!==document.body;){if(c(i))return;var n=l(i);if(n)return void(n(this.startY,t[0].screenY)&&e.preventDefault());var r=i.parentElement;if(!r)break;i=r}e.preventDefault()}}},{key:"onTouchStart",value:function(e){var t=d(e);t&&(this.startX=t[0].screenX,this.startY=t[0].screenY)}},{key:"enable",value:function(){window.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1})}},{key:"disable",value:function(){window.removeEventListener("touchstart",this.onTouchStart,!1),window.removeEventListener("touchmove",this.onTouchMove,!1)}}],[{key:"supported",value:function(){try{var e=document.createElement("div");document.documentElement.appendChild(e),e.style.WebkitOverflowScrolling="touch";var t="getComputedStyle"in window&&"touch"===window.getComputedStyle(e).getPropertyValue("-webkit-overflow-scrolling");return document.documentElement.removeChild(e),t}catch(e){return console.error(e),!1}}}]),e}();function d(e){return(0,o.toNonEmpty)(Array.from(e.touches))}function c(e){return"INPUT"===e.nodeName&&"range"===e.getAttribute("type")}function l(e){var t=window.getComputedStyle(e),i=t.getPropertyValue("-webkit-overflow-scrolling"),n=t.getPropertyValue("overflow-y"),r=parseInt(t.getPropertyValue("height"),10),a="touch"===i&&("auto"===n||"scroll"===n),o=e.scrollHeight>e.offsetHeight;return!(!a||!o)&&function(t,i){var n=t>=i,a=t<=i&&0===e.scrollTop,o=n&&e.scrollHeight-e.scrollTop===r;return a||o}}},151225:(e,t,i)=>{"use strict";i.d(t,{resolveMiniAppId:()=>d,preview:()=>c,ids:()=>l,last:()=>u,addAttach:()=>v,removeAttach:()=>f,isChatInviteLink:()=>p,isCallJoinLink:()=>h,rearrangeAttaches:()=>m,generatePollBackgroundGradientStyle:()=>_,getPollReflowKey:()=>g});var n=i(678927),r=i(111965),a=i(334738),o=i(21705),s=i(190831),d=function(e){return e};function c(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=["o","p","q","r"];if("Story"===e.kind)if(e.photo)e=e.photo;else{if(!e.video)return null;e=e.video}if("Video"===e.kind||"Gift"===e.kind||"PollBackgroundPhoto"===e.kind||"VideoMessage"===e.kind)return e.image.find((function(e){var t=e.width,r=e.height;return t>=i&&r>=n}))||e.image.reduce((function(e,t){return!e||t.width*t.height>e.width*e.height?t:e}))||null;var s,d="Photo"===e.kind?e.sizes:e.image;return d?r?(null===(s=Array.from(d.entries()).find((function(e){var t=(0,a.default)(e,2),r=t[0],s=t[1],d=s.width,c=s.height;return o.includes(r)&&d>=i&&c>=n})))||void 0===s?void 0:s[1])||d.get("r")||d.get("q")||d.get("p")||d.get("o")||null:(null===(t=Array.from(d.entries()).find((function(e){var t=(0,a.default)(e,2),r=t[0],s=t[1],d=s.width,c=s.height;return!o.includes(r)&&d>=i&&c>=n})))||void 0===t?void 0:t[1])||d.get("w")||d.get("z")||d.get("y")||d.get("x")||d.get("m")||d.get("s")||null:null}function l(e){var t,i=[],n=(0,r.default)(e.photos||[]);try{for(n.s();!(t=n.n()).done;){var a=t.value;i.push("photo".concat(a.ownerId,"_").concat(a.id))}}catch(e){n.e(e)}finally{n.f()}var o,s=(0,r.default)(e.videos||[]);try{for(s.s();!(o=s.n()).done;){var d=o.value;i.push("video".concat(d.ownerId,"_").concat(d.id))}}catch(e){s.e(e)}finally{s.f()}var c,l=(0,r.default)(e.audios||[]);try{for(l.s();!(c=l.n()).done;){var u=c.value;i.push("audio".concat(u.ownerId,"_").concat(u.id))}}catch(e){l.e(e)}finally{l.f()}e.audioPlaylist&&i.push("audio_playlist".concat(e.audioPlaylist.ownerId,"_").concat(e.audioPlaylist.id)),e.podcast&&i.push("podcast".concat(e.podcast.ownerId,"_").concat(e.podcast.id)),e.market&&i.push("market".concat(e.market.ownerId,"_").concat(e.market.id));var v,f=(0,r.default)(e.docs||[]);try{for(f.s();!(v=f.n()).done;){var p=v.value;i.push("doc".concat(p.ownerId,"_").concat(p.id))}}catch(e){f.e(e)}finally{f.f()}return e.voice&&i.push("doc".concat(e.voice.ownerId,"_").concat(e.voice.id)),e.wall&&i.push("wall".concat(e.wall.ownerId,"_").concat(e.wall.id)),e.wallReply&&i.push("wall_reply".concat(e.wallReply.ownerId,"_").concat(e.wallReply.id)),e.poll&&i.push("poll".concat(e.poll.ownerId,"_").concat(e.poll.id)),e.story&&i.push("story".concat(e.story.ownerId,"_").concat(e.story.id)),e.donutLink&&i.push("donut_link".concat(e.donutLink.ownerId)),e.widget&&i.push("widget".concat(e.widget.id)),i}function u(e){return 0===Object.keys(e).length?null:e.widget||e.wallReply||e.wall||e.poll||e.donutLink||e.moneyTransfer||e.moneyRequest||e.miniApps&&e.miniApps.slice(-1)[0]||e.article||e.audioPlaylist||e.podcast||e.audios&&e.audios.slice(-1)[0]||e.voice||e.docs&&e.docs.slice(-1)[0]||e.geo||e.story||e.market||e.inviteLink||e.link||e.graffiti||e.videos&&e.videos.slice(-1)[0]||e.photos&&e.photos.slice(-1)[0]||e.videoMessage||e.sticker||e.finishedCall||e.activeCall||e.gift||null}function v(e,t){t.photos&&(e.photos=[].concat((0,n.default)(e.photos||[]),(0,n.default)(t.photos))),t.videos&&(e.videos=[].concat((0,n.default)(e.videos||[]),(0,n.default)(t.videos))),t.audios&&(e.audios=[].concat((0,n.default)(e.audios||[]),(0,n.default)(t.audios))),t.docs&&(e.docs=[].concat((0,n.default)(e.docs||[]),(0,n.default)(t.docs))),t.voice&&(e.voice=t.voice),t.poll&&(e.poll=t.poll)}function f(e,t){switch(t.kind){case"Audio":if(!e.audios)break;var i=(0,o.toNonEmpty)(e.audios.filter((function(e){return e.id!==t.id})));i?e.audios=i:delete e.audios;break;case"Doc":if(!e.docs)break;var n=(0,o.toNonEmpty)(e.docs.filter((function(e){return e.id!==t.id})));n?e.docs=n:delete e.docs;break;case"Photo":if(!e.photos)break;var r=(0,o.toNonEmpty)(e.photos.filter((function(e){return e.id!==t.id})));r?e.photos=r:delete e.photos;break;case"Video":if(!e.videos)break;var a=(0,o.toNonEmpty)(e.videos.filter((function(e){return e.id!==t.id})));a?e.videos=a:delete e.videos;break;case"Voice":e.voice&&delete e.voice;break;case"Poll":e.poll&&delete e.poll;break;default:(0,o.exhaustivenessCheck)(t)}}function p(e){return e.startsWith(s.CHAT_INVITE_LINK_URL_BASE)||e.startsWith(s.VKME_CHAT_INVITE_LINK_URL_BASE)}function h(e){return e.startsWith(s.CALL_JOIN_LINK_URL_BASE)}function m(e,t,i){var n=t.currentPosition,r=t.newPosition;switch(i){case"photos":var a=e[i];if(!a)return;var s=a[n];if(!s)return;a.splice(n,1),a.splice(r,0,s),e[i]=a;break;case"videos":var d=e[i];if(!d)return;var c=d[n];if(!c)return;d.splice(n,1),d.splice(r,0,c),e[i]=d;break;case"audios":var l=e[i];if(!l)return;var u=l[n];if(!u)return;l.splice(n,1),l.splice(r,0,u),e[i]=l;break;case"docs":var v=e[i];if(!v)return;var f=v[n];if(!f)return;v.splice(n,1),v.splice(r,0,f),e[i]=v;break;default:(0,o.exhaustivenessCheck)(i)}}function _(e){for(var t=e.angle-90,i=e.points,n=[],r=0;r<i.length;r++){var a=i[r],o=100*r/(i.length-1);n.push("".concat(a," ").concat(o,"%"))}return"linear-gradient(".concat(t,"deg, ").concat(n.join(", "),")")}function g(e){return e?[e.title.length,e.voted?"0":"1",e.answers.map((function(e){return e.id})).join(",")].join("-"):""}},573974:(e,t,i)=>{"use strict";function n(e,t,i){return encodeURIComponent("".concat("app"+e+(i?"_"+i:""),"#").concat(t))}function r(e){return e}i.d(t,{createAppUrl:()=>n,resolveId:()=>r})},208134:(e,t,i)=>{"use strict";function n(e){return!Number.isNaN(e)&&e||(e=0),e}i.d(t,{resolveId:()=>n})},194170:(e,t,i)=>{"use strict";function n(e){return!Number.isNaN(e)&&e||(e=0),e}i.d(t,{resolveId:()=>n})},878664:(e,t,i)=>{"use strict";function n(e){return Number.isNaN(e)&&(e=0),e}function r(e){return Number.isNaN(e)&&(e=0),e}i.d(t,{resolveStickerPackId:()=>n,resolveStickerId:()=>r})},47860:(e,t,i)=>{"use strict";i.d(t,{dictionaryLatinConvert:()=>l,toTranslit:()=>u,toLocalCase:()=>v});var n=i(111965),r=i(334738),a=i(28991),o={u1072:"a",u1073:"b",u1074:"v",u1075:"g",u1076:"d",u1077:"e",u1105:"yo",u1078:"zh",u1079:"z",u1080:"i",u1081:"y",u1082:"k",u1083:"l",u1084:"m",u1085:"n",u1086:"o",u1087:"p",u1088:"r",u1089:"s",u1090:"t",u1091:"u",u1092:"f",u1093:"kh",u1094:"ts",u1095:"ch",u1096:"sh",u1097:"shch",u1098:"'",u1099:"y",u1100:"'",u1101:"e",u1102:"yu",u1103:"ya"},s=(0,a.default)((0,a.default)({},o),{},{u1093:"h",u1097:"sh",u1098:"",u1100:"",u1105:"e"}),d={u102:"а",u44:"б",u100:"в",u117:"г",u108:"д",u116:"е",u92:"ё",u59:"ж",u112:"з",u98:"и",u113:"й",u114:"к",u107:"л",u118:"м",u121:"н",u106:"о",u103:"п",u104:"р",u99:"с",u110:"т",u101:"у",u97:"ф",u91:"х",u119:"ц",u120:"ч",u105:"ш",u111:"щ",u93:"ъ",u109:"ь",u115:"ы",u39:"э",u46:"ю",u122:"я",u60:"б",u126:"ё",u58:"ж",u123:"х",u125:"ъ",u34:"э",u62:"ю",u64:'"',u35:"№",u36:";",u37:"%",u94:":",u38:"?",u63:",",u47:"."},c={yo:"ё",YO:"Ё",zh:"ж",ZH:"Ж",kh:"х",KH:"Х",ts:"ц",TS:"Ц",ch:"ч",CH:"Ч",sch:"щ",SCH:"Щ",shch:"щ",SHCH:"Щ",sh:"ш",SH:"Ш",eh:"э",EH:"Э",yu:"ю",YU:"Ю",ya:"я",YA:"Я","'":"ь",a:"а",A:"А",b:"б",B:"Б",v:"В",g:"г",G:"Г",d:"д",D:"Д",e:"е",E:"Е",z:"з",Z:"З",i:"и",I:"И",j:"й",J:"Й",k:"к",K:"К",l:"л",L:"Л",m:"м",M:"М",n:"н",N:"Н",o:"о",O:"О",p:"п",P:"Р",r:"р",R:"Р",s:"с",S:"С",t:"т",T:"Т",u:"у",U:"У",f:"ф",F:"Ф",h:"х",H:"Х",c:"ц",C:"Ц",y:"ы",Y:"Ы"};function l(e){return function(e){var t=e.dictionary,i=e.value;return Object.entries(t).reduce((function(e,t){var i=(0,r.default)(t,2),n=i[0],a=i[1];return e.replace(new RegExp(n,"g"),a)}),i)}({value:e.value,dictionary:c})}function u(e,t){e=e.toLowerCase().trim();var i=[o,s];return t&&i.push(d),i.reduce((function(t,i){var n=f(e,i);return n===e||t.includes(n)||t.push(n),t}),[])}function v(e){return f(e=e.toLowerCase().trim(),d)}function f(e,t){var i,r="",a=(0,n.default)(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t["u"+o.codePointAt(0)];r+=void 0!==s?s:o}}catch(e){a.e(e)}finally{a.f()}return r}},233600:(e,t,i)=>{"use strict";i.d(t,{create:()=>l,add:()=>u,search:()=>v,peerWords:()=>h});var n=i(111965),r=i(678927),a=i(896156),o=i(47860),s=i(21705),d=i(540075),c=Symbol("items");function l(){return(0,a.default)({},c,new Set)}function u(e,t,i){if(Array.isArray(t))t.forEach((function(t){return u(e,t,i)}));else{var n=i(t),r=n.id,a=n.strings;(0,d.getWordsVariants)(a).forEach((function(t){var i=e;i[c].add(r),Array.from(t.trim().toLowerCase()).forEach((function(e){var t=i[e];t||(t=i[e]=l()),t[c].add(r),i=t}))}))}return e}function v(e,t){var i=f(e,m(t)),n=f(e,m(o.toLocalCase(t))),a=f(e,o.toTranslit(t));return new Set([].concat((0,r.default)(i),(0,r.default)(n),(0,r.default)(a)))}function f(e,t){var i,a=null,o=(0,n.default)(t);try{for(o.s();!(i=o.n()).done;){var s=p(e,i.value);if(a){var d,c=(0,n.default)(a);try{for(c.s();!(d=c.n()).done;){var l=d.value;s.has(l)||a.delete(l)}}catch(e){c.e(e)}finally{c.f()}}else a=new Set((0,r.default)(s))}}catch(e){o.e(e)}finally{o.f()}return a||new Set}function p(e,t){var i,r=e,a=t.trim().toLowerCase(),o=(0,n.default)(a);try{for(o.s();!(i=o.n()).done;){var s=r[i.value];if(!s)return new Set;r=s}}catch(e){o.e(e)}finally{o.f()}return r[c]}function h(e){var t=[];switch(e.kind){case"Chat":t.push.apply(t,(0,r.default)(m(e.title)));break;case"Group":e.screenName&&t.push(e.screenName),t.push.apply(t,(0,r.default)(m(e.name)));break;case"User":e.screenName&&t.push(e.screenName),t.push.apply(t,(0,r.default)(m(e.firstName))),t.push.apply(t,(0,r.default)(m(e.lastName)));break;case"Contact":t.push.apply(t,(0,r.default)(m(e.name)));break;default:(0,s.exhaustivenessCheck)(e)}return t}function m(e){return e.trim().toLowerCase().split(/\s+/g)}},540075:(e,t,i)=>{"use strict";i.d(t,{getWordsVariants:()=>a});var n=i(111965),r=i(47860);function a(e){var t,i=[],a=(0,n.default)(e);try{var o=function(){var e=t.value,n=e.replace(/ё/g,"е").replace(/Ё/g,"Е");n!==e&&i.push(n),r.toTranslit(e,!0).forEach((function(t){t!==e&&i.push(t)})),i.push(e)};for(a.s();!(t=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}return i}},303460:(e,t,i)=>{"use strict";i.d(t,{UNKNOWN_SHAPE_ID:()=>m,fromApiAttach:()=>_,fromApiConvoAttach:()=>g,fromApiWallAttach:()=>k,fromApiWallReplyAttach:()=>y,fromApiDoc:()=>w,fromApiPhoto:()=>I,fromApiVideo:()=>C,fromApiAudio:()=>M,fromApiVoice:()=>E,fromApiPoll:()=>B,fromApiPollBackgroundGradient:()=>q,apiAttachWallOwnerId:()=>K});var n=i(781253),r=i(399809),a=i(896156),o=i(28991),s=i(111965),d=i(678927),c=i(151225),l=i(314432),u=i(980662),v=i(641450),f=i(21705),p=i(378399),h=["type","src","url"],m=-1;function _(e,t){if(0===e.length)return{};var i,n,r,a,u,h,m,_,g,P,R,U,q,O,H,W,z,Y,J,X,$,Z,Q={},ee=function(e){Q.unknown=[].concat((0,d.default)(Q.unknown||[]),[{data:e,kind:"Unknown"}])},te=(0,s.default)(e);try{for(te.s();!(i=te.n()).done;){var ie=i.value;switch(ie.type){case"photo":if(!ie.photo){ee(ie);break}var ne=I(ie.photo,t);if(!ne){ee(ie);break}Q.photos=[].concat((0,d.default)(Q.photos||[]),[ne]);break;case"audio":if(!ie.audio){ee(ie);break}var re=M(ie.audio);Q.audios=[].concat((0,d.default)(Q.audios||[]),[re]);break;case"video":if(!ie.video){ee(ie);break}var ae=C(ie.video,t);if(!ae){ee(ie);break}Q.videos=[].concat((0,d.default)(Q.videos||[]),[ae]);break;case"doc":if(!ie.doc){ee(ie);break}var oe=w(ie.doc);if(!oe){ee(ie);break}Q.docs=[].concat((0,d.default)(Q.docs||[]),[oe]);break;case"link":if(!ie.link){ee(ie);break}var se=b(ie.link);if(!se){ee(ie);break}if(c.isChatInviteLink(se.url)&&se.image){Q.inviteLink=function(e){return e.image&&(0,o.default)((0,o.default)({},e),{},{image:e.image,kind:"InviteLink"})}(se);break}Q.link=se;break;case"market":if(!ie.market){ee(ie);break}Q.market={kind:"Market",id:(Z=ie.market).id,ownerId:Z.owner_id,title:Z.title,price:Z.price.text,priceOld:Z.price.old_amount_text,photo:Z.thumb_photo};break;case"market_album":if(!ie.market_market_album){ee(ie);break}Q.marketAlbum={kind:"MarketAlbum"};break;case"gift":if(!ie.gift){ee(ie);break}var de=S(ie.gift);if(!de){ee(ie);break}Q.gift=de;break;case"sticker":if(!ie.sticker){ee(ie);break}var ce=(0,p.fromApiSticker)(ie.sticker);if(!ce){ee(ie);break}Q.sticker=ce;break;case"wall":if(!ie.wall||!ie.wall.from_id||!ie.wall.id){ee(ie);break}ie.wall.geo&&(ie.wall.attachments=[].concat((0,d.default)(ie.wall.attachments||[]),[{type:"geo",geo:ie.wall.geo}]));var le=K(ie.wall);if(!le){ee(ie);break}Q.wall={kind:"Wall",authorId:l.resolveId(ie.wall.from_id),ownerId:l.resolveId(le),id:ie.wall.id,date:1e3*(ie.wall.date||0),chunks:v.fromServerText(ie.wall.text||""),attaches:k(ie.wall)};break;case"wall_reply":if(!(ie.wall_reply&&ie.wall_reply.from_id&&ie.wall_reply.id&&ie.wall_reply.post_id)){ee(ie);break}var ue=K(ie.wall_reply);if(!ue){ee(ie);break}Q.wallReply={kind:"WallReply",id:ie.wall_reply.id,postId:ie.wall_reply.post_id,authorId:l.resolveId(ie.wall_reply.from_id),ownerId:l.resolveId(ue),parentsStack:ie.wall_reply.parents_stack,date:1e3*(ie.wall_reply.date||0),chunks:v.fromServerText(ie.wall_reply.text||""),attaches:y(ie.wall_reply.attachments||[])};break;case"article":if(!ie.article){ee(ie);break}Q.article=A(ie.article);break;case"poll":if(!ie.poll){ee(ie);break}Q.poll=B(ie.poll);break;case"graffiti":if(!ie.graffiti){ee(ie);break}Q.graffiti={kind:"Graffiti",imageUrl:ie.graffiti.url,width:ie.graffiti.width,height:ie.graffiti.height};break;case"audio_message":if(!ie.audio_message){ee(ie);break}Q.voice=E(ie.audio_message);break;case"audio_playlist":if(!ie.audio_playlist){ee(ie);break}Q.audioPlaylist={kind:"AudioPlaylist",id:($=ie.audio_playlist).id,ownerId:$.owner_id,type:N[$.type],title:$.title,accessKey:$.access_key,image:x($.photo,"photo")};break;case"podcast":if(!ie.podcast){ee(ie);break}Q.podcast=(H=ie.podcast,W=void 0,z=void 0,Y=void 0,J=void 0,X=void 0,Y=null===(W=H.podcast_info)||void 0===W||null===(z=W.cover)||void 0===z?void 0:z.sizes,J=Y&&F(Y).values(),X=J&&(0,f.toNonEmpty)((0,d.default)(J))||void 0,{kind:"Podcast",id:H.id,ownerId:H.owner_id,title:H.title,image:X});break;case"money_transfer":if(!ie.money_transfer){ee(ie);break}Q.moneyTransfer=(q=ie.money_transfer,O=void 0,{kind:"MoneyTransfer",text:(null===(O=q.amount)||void 0===O?void 0:O.text)||""});break;case"money_request":if(!ie.money_request){ee(ie);break}Q.moneyRequest={kind:"MoneyRequest",id:(U=ie.money_request).id,toId:U.to_id,fromId:U.from_id,text:U.amount.text,initUrl:U.init_url,isUserOwner:!!U.user_is_owner,isProcessed:!!U.processed};break;case"story":if(!ie.story){ee(ie);break}Q.story=(_=ie.story,g=void 0,P=void 0,R=void 0,g=!!_.is_expired,P=!!_.is_restricted,R=!g&&0!==_.can_see,{kind:"Story",id:_.id,ownerId:_.owner_id,date:void 0!==_.date?1e3*_.date:void 0,restricted:P,expired:g,available:R,photo:_.photo&&I(_.photo),video:_.video&&C(_.video)});break;case"geo":if(!ie.geo||!ie.geo.coordinates){ee(ie);break}Q.geo={kind:"Geo",coordinates:ie.geo.coordinates,place:ie.geo.place};break;case"call":if(!ie.call){ee(ie);break}Q.finishedCall=(a=ie.call,u=void 0,h=void 0,m=void 0,{kind:"FinishedCall",initiatorId:a.initiator_id,duration:a.duration,state:L(a),participants:{list:null===(u=a.participants)||void 0===u||null===(h=u.list)||void 0===h?void 0:h.map(l.resolveId),count:(null===(m=a.participants)||void 0===m?void 0:m.count)||0,coverList:T(a)}});break;case"group_call_in_progress":if(!ie.group_call_in_progress){ee(ie);break}Q.activeCall=(n=ie.group_call_in_progress,r=void 0,{kind:"ActiveCall",initiatorId:n.initiator_id,joinLink:n.join_link,participants:{list:null===(r=n.participants.list)||void 0===r?void 0:r.map(l.resolveId),count:n.participants.count||0,coverList:T(n)}});break;case"mini_app":if(!ie.mini_app){ee(ie);break}var ve=V(ie.mini_app);if(!ve){ee(ie);break}Q.miniApps=[].concat((0,d.default)(Q.miniApps||[]),[ve]);break;case"donut_link":if(!ie.donut_link){ee(ie);break}var fe=D(ie.donut_link);if(!fe){ee(ie);break}Q.donutLink=fe;break;case"video_message":if(!ie.video_message){ee(ie);break}Q.videoMessage=G(ie.video_message);break;case"widget":if(!ie.widget){ee(ie);break}Q.widget=j(ie.widget);break;case"narrative":case"artist":case"event":case"curator":case"group":case"link_curator":case"video_playlist":case"app_action":ee(ie);break;default:ie.type;ee(ie)}}}catch(e){te.e(e)}finally{te.f()}return Q}function g(e){var t,i={},n=(0,s.default)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;switch(r.attachment.type){case"photo":if(!r.attachment.photo)break;var a=I(r.attachment.photo,r.attachment.photo.access_key);if(!a)break;var o={attach:a,cmid:u.resolveCmid(r.message_id),messageId:u.resolveId(r.message_id),peerId:l.resolveId(r.from_id),date:r.date};i.photos=(i.photos||[]).concat(o);break;case"audio":if(!r.attachment.audio)break;var d={attach:M(r.attachment.audio),cmid:u.resolveCmid(r.message_id),messageId:u.resolveId(r.message_id),peerId:l.resolveId(r.from_id),date:r.date};i.audios=(i.audios||[]).concat(d);break;case"video":if(!r.attachment.video)break;var c=C(r.attachment.video,r.attachment.video.access_key);if(!c)break;var v={attach:c,cmid:u.resolveCmid(r.message_id),messageId:u.resolveId(r.message_id),peerId:l.resolveId(r.from_id),date:r.date};i.videos=(i.videos||[]).concat(v);break;case"doc":if(!r.attachment.doc)break;var p=w(r.attachment.doc);if(!p)break;var h={attach:p,cmid:u.resolveCmid(r.message_id),messageId:u.resolveId(r.message_id),peerId:l.resolveId(r.from_id),date:r.date};i.docs=(i.docs||[]).concat(h);break;case"link":if(!r.attachment.link)break;var m=b(r.attachment.link);if(!m)break;var _={attach:m,cmid:u.resolveCmid(r.message_id),messageId:u.resolveId(r.message_id),peerId:l.resolveId(r.from_id),date:r.date};i.links=(i.links||[]).concat(_);break;case"audio_message":case"app_action":case"graffiti":case"market":case"share":case"wall":break;default:(0,f.exhaustivenessCheck)(r.attachment.type)}}}catch(e){n.e(e)}finally{n.f()}return i}function k(e){var t=e.geo,i=e.attachments,n=e.copy_history,r=e.access_key,d=[];t&&(null==i||i.push({type:"geo",geo:t}));var c,u=(0,s.default)(i||[]);try{for(u.s();!(c=u.n()).done;){var v=c.value;switch(v.type){case"photo":case"audio":case"video":case"doc":case"link":case"mini_app":case"sticker":case"market":case"article":case"poll":case"audio_playlist":case"podcast":case"market_album":case"donut_link":case"graffiti":d.push((0,a.default)({type:v.type},v.type,v[v.type]));break;case"geo":var f,p,h;if(!v.geo)break;var m=null===(f=v.geo.coordinates)||void 0===f?void 0:f.split(" ").map((function(e){return parseFloat(e)}));d.push({type:"geo",geo:(0,o.default)((0,o.default)({},v.geo),{},{place:{title:null===(p=v.geo.place)||void 0===p?void 0:p.title,address:null===(h=v.geo.place)||void 0===h?void 0:h.address},coordinates:m&&m[0]&&m[1]?{latitude:m[0],longitude:m[1]}:void 0})});break;case"textlive":case"textpost":case"textpost_publish":case"posted_photo":case"note":case"app":case"page":case"album":case"event":case"situational_theme":case"group":case"artist":case"curator":case"photos_list":case"pretty_cards":case"narrative":case"video_playlist":break;default:v.type}}}catch(e){u.e(e)}finally{u.f()}var g=_(d,r);if(null!=n&&n[0]){var k=K(n[0]);g.wallHistory={kind:"WallHistory",id:n[0].id||0,authorId:l.resolveId(n[0].from_id),ownerId:l.resolveId(k),date:1e3*(n[0].date||0),text:n[0].text||""}}return g}function y(e){var t,i=[],n=(0,s.default)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;switch(r.type){case"photo":case"audio":case"video":case"doc":case"link":case"sticker":case"market":case"graffiti":case"market_album":case"geo":i.push((0,a.default)({type:r.type},r.type,r[r.type]));break;case"note":case"page":case"audio_playlist":case"album":case"app":case"article":case"curator":case"donut_link":case"event":case"group":case"mini_app":case"narrative":case"photos_list":case"poll":case"posted_photo":case"pretty_cards":case"video_playlist":case"situational_theme":case"textlive":case"textpost":case"textpost_publish":case"podcast":case"artist":break;default:r.type}}}catch(e){n.e(e)}finally{n.f()}return _(i)}function b(e){if(e.title){var t=e.url,i=/^https:\/\/m\.vk\.com(.+)/;if(i.test(e.url)){var n=e.url.match(i);t=n&&n[1]?n[1]:t}return{kind:"Link",url:t,title:e.title,meta:e.caption||t,image:e.photo?F(e.photo.sizes||[]):void 0}}}function w(e){var t,i,n;if(e.url){var r=!(null===(t=e.preview)||void 0===t||null===(i=t.photo)||void 0===i||null===(n=i.sizes)||void 0===n||!n.length)&&F(e.preview.photo.sizes.map((function(e){return(0,o.default)((0,o.default)({},e),{},{url:e.src})})));return(0,o.default)({kind:"Doc",id:e.id,ownerId:e.owner_id,title:e.title,size:e.size,ext:e.ext,date:e.date,url:e.url},r&&{image:r})}}function I(e,t){var i;if(e.sizes)return{kind:"Photo",accessKey:e.access_key,albumId:e.album_id,id:e.id,ownerId:e.owner_id,hasTags:e.has_tags,sizes:F(e.sizes),originalImage:null===(i=e.orig_photo)||void 0===i?void 0:i.url,messageAccessKey:t}}function C(e,t){if(e.id&&e.owner_id){var i=U(e.image||[{url:"",height:0,width:0}]);if(i)return{kind:"Video",accessKey:e.access_key,id:e.id,ownerId:e.owner_id,duration:e.duration,width:e.width,height:e.height,image:i,title:e.title,views:e.views||0,restriction:e.restriction,files:"files"in e?e.files:void 0,messageAccessKey:t,player:e.player,platform:e.platform}}}function A(e){var t,i;switch(e.state){case"available":case"banned":case"deleted":case"paid":case"protected":t=e.state;break;case void 0:t="unknown";break;default:e.state;t="unknown"}return e.photo?i=F(e.photo.sizes||[]):e.owner_photo&&(i=F([{type:"o",width:0,height:0,url:e.owner_photo}])),{kind:"Article",state:t,url:e.url||"",title:e.title||"",author:e.owner_name||"",meta:e.subtitle||"",image:i}}var P={thumb:[48,96,256,512],photo:[34,68,135,270,300,600,1200],unknown:[]};function x(e,t){if(e){var i=P[t].reduce((function(i,n){var r=e["".concat(t,"_").concat(n)];return r?(i.push({url:r,width:n,height:n}),i):i}),[]),n=(0,r.default)(i),a=n[0],o=n.slice(1);return a?[a].concat((0,d.default)(o)):void 0}}function S(e){var t=x(e,"thumb");if(t)return{kind:"Gift",id:e.id,isStickerStyle:!!e.is_stickers_style,image:t}}function M(e){var t;return{kind:"Audio",id:e.id,ownerId:e.owner_id,artist:e.artist,title:e.title,subtitle:e.subtitle,url:e.url,duration:e.duration,albumId:e.album_id,trackCode:e.track_code,contentRestricted:e.content_restricted,albumPartNumber:e.album_part_number,thumb:null===(t=e.album)||void 0===t?void 0:t.thumb,accessKey:e.access_key}}function E(e){return{kind:"Voice",duration:e.duration,id:e.id,linkMp3:e.link_mp3,linkOgg:e.link_ogg,ownerId:e.owner_id,waveform:e.waveform,isTranscriptPossible:e.duration/60/60<1,transcription:R(e)}}function R(e){switch(e.transcript_state){case"done":var t;return{state:"done",text:null===(t=e.transcript)||void 0===t?void 0:t.trim(),updatedAt:e.transcript_update_time?1e3*e.transcript_update_time:void 0};case"error":case"in_progress":return{state:e.transcript_state};case void 0:return;default:(0,f.exhaustivenessCheck)(e.transcript_state)}}var N={0:"playlist",1:"album",2:"playlist",3:"playlist",4:"playlist",5:"playlist"};function F(e){return e.sort((function(e,t){return e.width-t.width})).reduce((function(e,t){var i=t.type,r=(t.src,t.url),a=(0,n.default)(t,h);return void 0===r||"s"!==i&&"m"!==i&&"x"!==i&&"o"!==i&&"p"!==i&&"q"!==i&&"r"!==i&&"y"!==i&&"z"!==i&&"w"!==i||(a.width&&a.height?e.set(i,(0,o.default)({url:r},a)):e.set(i,(0,o.default)((0,o.default)({},a),{},{url:r,width:200,height:200}))),e}),new Map)}function U(e){var t=e.sort((function(e,t){return e.width-t.width})).map((function(e){return{width:e.width,height:e.height,url:e.url}})),i=(0,r.default)(t),n=i[0],a=i.slice(1);if(n)return[n].concat((0,d.default)(a))}function T(e){var t,i=null===(t=e.participants)||void 0===t?void 0:t.list;return i?i.reduce((function(e,t){var i=l.resolveAnyId(t);return(l.isUserPeerId(i)||l.isGroupPeerId(i))&&e.push(i),e}),[]).slice(0,3):[]}function L(e){switch(e.state){case"reached":return"reached";case"canceled_by_initiator":return"canceledByInitiator";case"canceled_by_receiver":return"canceledByReceiver";default:(0,f.exhaustivenessCheck)(e.state)}}function V(e){if(e.app&&e.app.share_url&&e.app.webview_url){var t=(0,f.toNonEmpty)(e.images.map((function(e){var t=e.url,i=e.height;return{width:e.width,height:i,url:t}})));if(t){t.sort((function(e,t){return e.width-t.width}));var i=e.app.share_url.replace(/https:\/\/[a-z0-9_\-.]+\//,"");return{kind:"MiniApp",title:e.title,appLink:i,images:t,id:c.resolveMiniAppId(e.app.id),url:e.app.webview_url}}}}function D(e){var t,i,n=l.resolveId(e.owner_id);if(l.isGroupPeerId(n)&&null!==(t=e.action)&&void 0!==t&&t.url&&null!==(i=e.button.action)&&void 0!==i&&i.url&&e.button.title)return{kind:"DonutLink",ownerId:n,button:{action:{target:"internal",type:"open_url",url:e.button.action.url},title:e.button.title},donorsCount:e.donors.count,text:e.text,action:{target:"internal",type:"open_url",url:e.action.url}}}function B(e){var t,i;return{kind:"Poll",id:e.id,ownerId:l.resolveId(e.owner_id),authorId:void 0!==e.author_id?l.resolveId(e.author_id):l.resolveId(e.owner_id),title:e.question,anonymous:!!e.anonymous,endDate:1e3*e.end_date,answers:e.answers.map((function(t){var i;return{id:t.id,text:t.text,votes:t.votes,rate:t.rate,selected:!(null===(i=e.answer_ids)||void 0===i||!i.includes(t.id))}})),voted:!(null===(t=e.answer_ids)||void 0===t||!t.length),canVote:e.can_vote,canChangeVote:!e.disable_unvote,canEdit:e.can_edit,multiple:e.multiple,votes:e.votes,friends:(null===(i=e.friends)||void 0===i?void 0:i.map((function(e){return l.resolveId(e.id)})))||[],backgroundGradient:q(e.background),backgroundPhoto:O(e.photo)}}function q(e){if(e&&"gradient"===e.type){var t=e.points,i=e.angle;if(void 0!==t&&void 0!==i)return{id:e.id||0,points:t.map((function(e){return"#"+e.color})),angle:i}}}function O(e){if(e&&e.color&&e.images){var t=(0,f.toNonEmpty)(e.images.map((function(e){return{url:e.url,width:e.width,height:e.height}})));if(t)return{kind:"PollBackgroundPhoto",image:t,color:"#"+e.color}}}function K(e){var t,i=e.owner_id,n=e.source_id,r=e.to_id;return null!==(t=null!=i?i:n)&&void 0!==t?t:r}function G(e){if(e.id&&e.owner_id){var t=U(e.image||[{url:"",height:0,width:0}]);if(t)return{kind:"VideoMessage",id:e.id,ownerId:e.owner_id,duration:e.duration,shapeId:e.shape_id||m,image:t,files:e.files}}}function j(e){if(e.item.widget_id)return{kind:"Widget",id:e.item.widget_id,data:e}}},583906:(e,t,i)=>{"use strict";i.d(t,{fromApiKeyboard:()=>d,fromEngineKeyboard:()=>c,convertButtons:()=>u,fromApiMessageEvent:()=>f});var n=i(28991),r=i(659397),a=i(573974),o=i(314432),s=i(190831);function d(e,t){var i=l(e.buttons,e.inline),n=o.resolveId(e.author_id||t);return e.inline?{kind:"InlineKeyboard",authorId:n,buttons:i}:{kind:"InputKeyboard",authorId:n,buttons:i,oneTime:e.one_time}}function c(e,t){return e.inline?e.buttons?{kind:"InlineKeyboard",buttons:l(e.buttons,e.inline),authorId:o.resolveId(e.author_id||t)}:void 0:null!==(i=e.buttons)&&void 0!==i&&i.length?{kind:"InputKeyboardUpsertEvent",keyboard:{kind:"InputKeyboard",buttons:l(e.buttons,e.inline),authorId:o.resolveId(e.author_id||t),oneTime:e.one_time}}:{kind:"InputKeyboardDeleteEvent"};var i}function l(e,t){return e.map((function(e){return u(e,t)}))}function u(e,t){return e.map((function(e){return function(e,t){var i,n="positive"===(i=e.color)?"commerce":"negative"===i?"destructive":"primary"===i?i:"secondary";switch(e.action.type){case"text":case"callback":return{type:e.action.type,label:(0,r.unescape)(e.action.label||""),payload:e.action.payload||"",color:n};case"open_link":return{type:e.action.type,link:e.action.link,label:(0,r.unescape)(e.action.label||""),payload:e.action.payload||"",color:n};case"location":return{type:e.action.type,payload:e.action.payload||"",color:n};case"vkpay":return{type:e.action.type,payload:e.action.payload||"",hash:e.action.hash||"",url:a.createAppUrl(s.VK_PAY_APP_ID,e.action.hash||"")};case"open_app":return{type:e.action.type,payload:e.action.payload||"",label:(0,r.unescape)(e.action.label||""),hash:e.action.hash||"",appId:e.action.app_id||0,ownerId:e.action.owner_id||0,color:n,url:a.createAppUrl(e.action.app_id,e.action.hash||"",e.action.owner_id)};case"open_photo":return;default:return void e.action}}(e)})).filter(v)}function v(e){return void 0!==e}var f=function(e,t,i){var r=i.event_id,s=i.action,d=i.owner_id,c=a.resolveId(r),l=o.resolveId(d);if(!s)return{id:c,type:"null",ownerId:l,peerId:e.id};switch(s.type){case"show_snackbar":return(0,n.default)((0,n.default)({},s),{},{id:c,ownerId:l,title:o.name(e),photo:t.photo50,peerId:e.id});case"open_link":return(0,n.default)((0,n.default)({},s),{},{id:c,ownerId:l,title:o.name(e),peerId:e.id});default:return{id:c,type:s.type,ownerId:l,url:(0,a.createAppUrl)(s.app_id,s.hash,l),peerId:e.id}}}},65515:(e,t,i)=>{"use strict";i.d(t,{fromApiTemplate:()=>d});var n=i(28991),r=i(781253),a=i(583906),o=i(303460),s=["buttons","photo","action"];function d(e,t){var i;return{kind:"carousel",elements:(null===(i=e.elements)||void 0===i?void 0:i.map((function(e){return function(e,t){var i=e.buttons,d=e.photo,c=e.action,l=(0,r.default)(e,s),u=d?(0,o.fromApiPhoto)(d,t):null,v=(0,n.default)((0,n.default)({buttons:i?(0,a.convertButtons)(i,!0):[]},u&&{photo:u}),l),f=(0,n.default)((0,n.default)({},v),{},{kind:"simple"});if(!c)return f;switch(c.type){case"open_photo":return d&&u?(0,n.default)((0,n.default)({},v),{},{kind:"photo",photo:u}):f;case"open_link":return(0,n.default)((0,n.default)({},v),{},{kind:"link",link:c.link});default:return f}}(e,t)})))||[]}}},419117:(e,t,i)=>{"use strict";i.d(t,{fromApiChannel:()=>o});var n=i(716352),r=i(30966),a=i(610557),o=function(e,t){var i,o,s,d,c=e.channel,l=e.last_message,u=l&&(0,a.fromApiPost)(l).post,v=[];u&&(v=u.cmid>1?[{kind:"GapItem",fromCmid:r.resolveCmid(1),toCmid:r.resolveCmid(u.cmid-1)},{kind:"PostItem",post:u}]:[{kind:"PostItem",post:u}]);var f=!c.user_data.notification_settings.is_enabled||(c.user_data.notification_settings.disable_duration||0)>0;return{kind:"Channel",id:n.resolveId(c.channel_id),unreadCount:(null===(i=c.user_data.read_state)||void 0===i?void 0:i.unread_count)||0,isArchived:!(null===(o=c.user_data)||void 0===o||!o.is_archived),isMuted:f,notificationsDisabledUntil:c.user_data.notification_settings.disable_duration||0,inReadCmid:r.resolveCmid((null===(s=c.user_data)||void 0===s||null===(d=s.read_state)||void 0===d?void 0:d.read_up_to_cmid)||0),majorSortId:c.sort_id.major_id,minorSortId:c.sort_id.minor_id,membersCount:t.members_count||0,isMember:Boolean(t.is_member),adminLevel:t.admin_level||0,photos:{photo50:t.photo_50,photo100:t.photo_100},name:t.name||"",activity:t.activity||"",isVerified:!!t.verified,screenName:t.screen_name,history:v,canSendDonut:!!t.can_post_donut,pending:{},locks:{loading:!1,cleanUp:0}}}},581239:(e,t,i)=>{"use strict";i.d(t,{fromApiConvoBanner:()=>r});var n=i(641450);function r(e){var t,i;return{icon:null!==(t=e.icon)&&void 0!==t?t:"",name:e.name,title:null!==(i=e.title)&&void 0!==i?i:"",chunks:n.fromServerText(e.text),canHide:e.can_hide||!0,buttons:(e.buttons||[]).map((function(e){var t,i;return{callbackData:null!==(t=null==e?void 0:e.callback_data)&&void 0!==t?t:"",mode:e.layout,appearance:a(e.style),link:null!==(i=null==e?void 0:e.link)&&void 0!==i?i:"",text:e.text,hideOnAction:!!e.hide_on_action,type:e.type}}))}}function a(e){return"destructive"===e?"negative":"regular"===e?"accent":e}},975474:(e,t,i)=>{"use strict";i.d(t,{fromApiConvo:()=>v,fromLongpollPushSettings:()=>f});var n=i(678927),r=i(28991),a=i(314432),o=i(360202),s=i(980662),d=i(341570),c=i(583906),l=i(581239),u={18:"peer_deleted",900:"peer_blacklisted_by_me",901:"peer_blacklisted",902:"peer_blacklisted",915:"disabled_by_community",916:"disabled_by_peer",917:"kicked",918:"no_access",922:"no_access",925:"no_access",932:"no_access",945:"chat_unsupported",946:"chat_unsupported",203:"disabled_by_peer"};function v(e,t){var i,u,v,f=t&&(0,d.fromApiMessage)(t).message,_=e.current_keyboard&&(0,c.fromApiKeyboard)(e.current_keyboard);if("InlineKeyboard"===(null==_?void 0:_.kind))throw new Error("Не может прийти инлайн клавиатура для сообщения");var g,k,y={majorSortId:(null===(i=e.sort_id)||void 0===i?void 0:i.major_id)||0,minorSortId:(null===(u=e.sort_id)||void 0===u?void 0:u.minor_id)||0,unreadCount:e.unread_count||0,isMarkedUnread:!!e.is_marked_unread,isArchived:!!e.is_archived,inReadBy:s.resolveCmid(e.in_read_cmid),outReadBy:s.resolveCmid(e.out_read_cmid),folderIds:new Set((null===(v=e.folder_ids)||void 0===v?void 0:v.map(o.resolveId))||[]),isNew:!!e.is_new,canWrite:h(e),currentKeyboard:_,push:p(e.push_settings),persistedCmid:s.resolveCmid(null==f?void 0:f.cmid),persisted:f?new Map([[f.cmid,(0,r.default)((0,r.default)({},f),{},{olderId:s.resolveCmid(),newerId:s.resolveCmid()})]]):new Map,queuedId:s.resolveRandomId(),queued:new Map,unreadExpireables:new Set((e.expire_cmids||[]).map(s.resolveCmid)),unreadReactions:new Set((e.unread_reactions||[]).map(s.resolveCmid)),hasMore:e.last_message_id>0,convoBanner:e.conversation_bar&&(0,l.fromApiConvoBanner)(e.conversation_bar)},b=a.resolveId(e.peer.id);switch(e.peer.type){case"user":if(!a.isUserPeerId(b))return null;if(void 0!==e.message_request_data){var w=e.message_request_data.status;return"pending"===w?{convo:(0,r.default)((0,r.default)({},y),{},{kind:"MessageRequestUserConvo",peerId:b,MRStatus:w})}:null}return{convo:(0,r.default)((0,r.default)({},y),{},{kind:"UserConvo",peerId:b})};case"chat":var I,C,A,P,x,S,M,E;if(!a.isChatPeerId(b))return null;if(!e.chat_settings)throw new Error("TODO chat convo has to has chat settings");var R=e.chat_settings.owner_id&&0!==e.chat_settings.owner_id?a.resolveId(e.chat_settings.owner_id):void 0,N=R&&(a.isUserPeerId(R)||a.isGroupPeerId(R))?R:void 0,F=(0,r.default)((0,r.default)({},y),{},{peerId:b,ownerId:N,unreadMentions:new Set((e.mention_cmids||[]).map(s.resolveCmid)),membersCount:(null===(I=e.chat_settings)||void 0===I?void 0:I.members_count)||0,state:null===(C=e.chat_settings)||void 0===C?void 0:C.state,isCasper:!!e.chat_settings.is_disappearing,isCommunityChat:!!R&&a.isGroupPeerId(R),isDonut:!!e.chat_settings.is_donut,isGroupChannel:!!e.chat_settings.is_group_channel,activeCall:m(e.call_in_progress),pinnedMessage:e.chat_settings.pinned_message?(0,d.fromApiPinnedMessage)(e.chat_settings.pinned_message):void 0,acl:(k=e.chat_settings.acl,{canChangeInfo:k.can_change_info,canChangeInviteLink:k.can_change_invite_link,canChangePin:k.can_change_pin,canInvite:k.can_invite,canPromoteUsers:k.can_promote_users,canSeeInviteLink:k.can_see_invite_link,canModerate:k.can_moderate,canCopyChat:k.can_copy_chat,canCall:k.can_call,canUseMassMentions:k.can_use_mass_mentions,canChangeServiceType:Boolean(k.can_change_service_type),canChangeStyle:Boolean(k.can_change_style),canSendReactions:!0}),permissions:e.chat_settings.permissions?(g=e.chat_settings.permissions,{invite:g.invite||"all",change_info:g.change_info||"all",change_pin:g.change_pin||"all",use_mass_mentions:g.use_mass_mentions||"all",see_invite_link:g.see_invite_link||"all",call:g.call||"all",change_style:g.change_style||"all",change_admins:g.change_admins||"owner"}):void 0,description:e.chat_settings.description,isService:Boolean(e.chat_settings.is_service),adminIds:new Set([].concat((0,n.default)([R]||0),(0,n.default)(e.chat_settings.admin_ids||[])).map(a.resolveId)),memberIds:new Set([]),invitedIds:new Set([]),shouldShortPollReactions:Boolean(e.chat_settings.short_poll_reactions)}),U={kind:"Chat",id:b,title:(null===(A=e.chat_settings)||void 0===A?void 0:A.title)||"",photo50:null===(P=e.chat_settings.photo)||void 0===P?void 0:P.photo_50,photo100:null===(x=e.chat_settings.photo)||void 0===x?void 0:x.photo_100,photo200:null===(S=e.chat_settings.photo)||void 0===S?void 0:S.photo_200,hasDefaultPhoto:(null===(M=e.chat_settings.photo)||void 0===M?void 0:M.is_default_photo)||(null===(E=e.chat_settings.photo)||void 0===E?void 0:E.is_default_call_photo),canCall:e.chat_settings.acl.can_call};if(void 0!==e.message_request_data){var T=e.message_request_data,L=T.status,V=T.inviter_id;return"pending"===L&&void 0!==V?{convo:(0,r.default)((0,r.default)({},F),{},{kind:"MessageRequestChatConvo",inviterPeerId:a.resolveId(V),MRStatus:L}),peer:U}:null}return"business_notify"===e.special_service_type?{convo:(0,r.default)((0,r.default)({},F),{},{kind:"BusinessNotify"}),peer:U}:{convo:(0,r.default)((0,r.default)({},F),{},{kind:"ChatConvo"}),peer:U};case"group":return a.isGroupPeerId(b)?{convo:(0,r.default)((0,r.default)({},y),{},{peerId:b,kind:"GroupConvo"})}:null;case"email":return null;case"contact":return a.isContactPeerId(b)?{convo:(0,r.default)((0,r.default)({},y),{},{peerId:b,kind:"ContactConvo"})}:null;default:e.peer.type;return null}}function f(e){var t=Number(e[1].disabled_until);switch(t){case 0:return{mode:"everything",disabledUntil:0};case-1:return{mode:"every-mention",disabledUntil:1/0};default:return{mode:"every-mention",disabledUntil:1e3*t}}}function p(e){var t={mode:"everything",disabledUntil:0};return e?(e.disabled_forever?t={mode:"every-mention",disabledUntil:1/0}:e.disabled_until&&(t={mode:"every-mention",disabledUntil:1e3*e.disabled_until}),"everything"!==t.mode&&(e.disabled_mass_mentions&&(t=(0,r.default)((0,r.default)({},t),{},{mode:"direct-mention"})),e.disabled_mentions&&(t=(0,r.default)((0,r.default)({},t),{},{mode:"nothing"}))),t):t}function h(e){var t,i=e.can_write;return"chat"===e.peer.type&&"rejected"===(null===(t=e.message_request_data)||void 0===t?void 0:t.status)?{allowed:!1,reason:"mr_rejected"}:null!=i&&i.allowed?{allowed:!0}:{allowed:!1,reason:(null==i?void 0:i.reason)&&u[i.reason]||"unknown"}}function m(e){if(e)return{participants:{list:(e.participants.list||[]).reduce((function(e,t){var i=a.resolveAnyId(t);return(a.isUserPeerId(i)||a.isGroupPeerId(i))&&e.push(i),e}),[]),count:e.participants.count||0},joinLink:e.join_link,canFinishCall:Boolean(e.can_finish_call),hasLink:Boolean(e.has_link)}}},590917:(e,t,i)=>{"use strict";i.d(t,{fromApiFolder:()=>r});var n=i(360202);function r(e){return{id:n.resolveId(e.id),name:e.name,unreadCount:0,unreadUnmutedCount:0,all:{peerIds:new Set,boundaryMinorId:1/0,hasMore:!0},unread:{peerIds:new Set,boundaryMinorId:1/0,hasMore:!0}}}},341570:(e,t,i)=>{"use strict";i.d(t,{fromApiMessage:()=>_,fromEngineMessage:()=>g,fromApiPinnedMessage:()=>I});var n=i(678927),r=i(111965),a=i(334738),o=i(659397),s=i(281385),d=i(303460),c=i(980662),l=i(314432),u=i(641450),v=i(208134),f=i(21705),p=i(583906),h=i(65515),m=i(667361);function _(e){if(e.action)return{message:{kind:"Service",id:c.resolveId(e.id),action:b({apiAction:e.action,apiAttaches:e.attachments}),peerId:l.resolveId(e.peer_id),cmid:c.resolveCmid(e.conversation_message_id),authorId:l.resolveId(e.from_id),sentAt:1e3*e.date,isOut:1===e.out,isSilent:e.is_silent,deleteTTL:void 0!==e.ttl?1e3*e.ttl:void 0},mentions:{hasDirect:!1,hasMass:!1}};var t=l.resolveId(e.peer_id);if(e.is_expired)return{message:{kind:"Expired",id:c.resolveId(e.id),cmid:c.resolveCmid(e.conversation_message_id),peerId:l.resolveId(e.peer_id),authorId:l.resolveId(e.from_id),isOut:1===e.out,isSilent:e.is_silent,sentAt:1e3*e.date},mentions:{hasDirect:!1,hasMass:!1}};var i=e.keyboard&&(0,p.fromApiKeyboard)(e.keyboard);if("InputKeyboard"===(null==i?void 0:i.kind))throw new Error("Кажется из апи пришла не инлайн клавиатура для сообщения");var n=c.resolveCmid(e.conversation_message_id);return{message:{kind:"Normal",id:c.resolveId(e.id),randomId:c.resolveRandomId(e.random_id),cmid:n,peerId:t,authorId:l.resolveId(e.from_id),chunks:u.fromServerText(e.text),isOut:1===e.out,isSilent:e.is_silent,isImportant:!!e.important,isPlayed:!!e.was_played,sentAt:1e3*e.date,updatedAt:e.update_time&&1e3*e.update_time,attaches:(0,d.fromApiAttach)(w(e),"mail".concat(e.id)),keyboard:i,forwardedMessages:y(e.fwd_messages,t,n),replyMessage:e.reply_message?k(e.reply_message,t,n):void 0,expireTTL:e.expire_ttl?1e3*e.expire_ttl:void 0,deleteTTL:void 0!==e.ttl?1e3*e.ttl:void 0,pinnedAt:e.pinned_at&&1e3*e.pinned_at,template:e.template?(0,h.fromApiTemplate)(e.template,"mail".concat(e.id)):void 0,reactions:e.reactions?(0,m.fromApiMessageReactions)(e.reactions):new Map,reactionId:e.reaction_id?v.resolveId(e.reaction_id):void 0},mentions:{hasDirect:!1,hasMass:!1}}}function g(e,t,i){var n,v,h,m,_,g,k,y,w,I;switch(e[0]){case 4:var C=(0,a.default)(e,11);n=C[1],v=C[2],h=C[4],m=C[5],_=C[6],g=C[7],k=C[8],y=C[9],I=C[10];break;case 10004:var A=(0,a.default)(e,11);I=A[1],v=A[2],h=A[4],m=A[5],_=A[6],g=A[7],k=A[8],y=A[9],n=A[10];break;case 5:var P=(0,a.default)(e,11);n=P[1],v=P[2],h=P[3],m=P[4],_=P[5],g=P[6],k=P[7],y=P[8],I=P[9],w=P[10];break;case 10005:var x=(0,a.default)(e,11);I=x[1],v=x[2],h=x[3],m=x[4],_=x[5],g=x[6],k=x[7],y=x[8],n=x[9],w=x[10];break;case 18:var S=(0,a.default)(e,11);n=S[1],v=S[2],h=S[3],m=S[4],_=S[5],g=S[6],k=S[7],y=S[8],I=S[9],w=S[10];break;case 10018:var M=(0,a.default)(e,11);I=M[1],v=M[2],h=M[3],m=M[4],_=M[5],g=M[6],k=M[7],y=M[8],n=M[9],w=M[10];break;default:(0,f.exhaustivenessCheck)(e)}var E,R=l.resolveId(h),N=c.convertFlags(v),F=N.isOut,U=N.isImportant,T=N.noPush,L=N.isPlayed,V=F||l.isFavorites(R,t),D="1"===g.is_silent;if(E=void 0!==g.from?l.resolveId(Number(g.from)):V?t:R,g.source_act)return{message:{kind:"Service",id:c.resolveId(n),cmid:c.resolveCmid(I),peerId:R,authorId:E,action:b({apiAction:{conversation_message_id:g.source_chat_local_id?Number(g.source_chat_local_id):void 0,message:g.source_message,type:g.source_act,member_id:g.source_mid?Number(g.source_mid):void 0,text:g.source_text,old_text:g.source_old_text,style:g.source_style}}),deleteTTL:void 0!==g.ttl?1e3*Number(g.ttl):void 0,sentAt:1e3*m,isOut:V,isSilent:D},mentions:{hasDirect:!1,hasMass:!1},noPush:T};if("1"===g.is_expired)return{message:{kind:"Expired",id:c.resolveId(n),cmid:c.resolveCmid(I),isOut:V,isSilent:D,peerId:R,authorId:E,sentAt:1e3*m},mentions:{hasDirect:!1,hasMass:!1},noPush:!0};var B,q={hasDirect:!1,hasMass:!1},O=(0,r.default)(g.marked_users||[]);try{for(O.s();!(B=O.n()).done;){var K=B.value;if(K[0]===s.IEngine.MarkedType.Mention)switch(K[1]){case"all":q.hasMass=q.hasMass||E!==t;break;case"online":q.hasMass=q.hasMass||K[2].includes(t);break;default:q.hasDirect=K[1].includes(t)}}}catch(e){O.e(e)}finally{O.f()}var G,j={};if("sticker"!==k.attach1_type&&"audiomsg"!==k.attach1_kind||!k.attachments)void 0!==k.attach1_type&&(j={unknown:[{data:k,kind:"Unknown"}]});else{var H=JSON.parse(k.attachments);Array.isArray(H)&&(j=(0,d.fromApiAttach)(H,"mail".concat(n)))}if(void 0!==k.reply){var W=JSON.parse(k.reply),z=i(c.resolveCmid(W.conversation_message_id));z&&(G=c.toForeign({message:z,rootPeerId:R,rootCmid:c.resolveCmid(I)}))}var Y,J,X=g.keyboard?(0,p.fromEngineKeyboard)(g.keyboard,E):void 0;return"InlineKeyboard"===(null==X?void 0:X.kind)?Y=X:J=X,{message:{kind:"Normal",id:c.resolveId(n),cmid:c.resolveCmid(I),randomId:c.resolveRandomId(y),peerId:R,authorId:E,chunks:u.fromServerText((0,o.unescape)(_)),isOut:V,isSilent:D,isImportant:U,isPlayed:L,sentAt:1e3*m,updatedAt:w?1e3*w:void 0,pinnedAt:g.pinned_at?1e3*Number(g.pinned_at):void 0,expireTTL:g.expire_ttl?1e3*Number(g.expire_ttl):void 0,deleteTTL:void 0!==g.ttl?1e3*Number(g.ttl):void 0,attaches:j,replyMessage:G,keyboard:Y,reactions:new Map},mentions:q,noPush:T,keyboardEvent:J}}function k(e,t,i){var n,r;return e.peer_id&&(n=l.resolveId(e.peer_id)),e.id&&(r=c.resolveId(e.id)),{kind:"Foreign",id:r,peerId:n,rootPeerId:t,rootCmid:i,cmid:c.resolveCmid(e.conversation_message_id),authorId:l.resolveId(e.from_id),chunks:u.fromServerText(e.text),sentAt:1e3*e.date,updatedAt:e.update_time&&1e3*e.update_time,attaches:(0,d.fromApiAttach)(w(e),e.id?"mail".concat(e.id):void 0),forwardedMessages:y(e.fwd_messages,t,i),replyMessage:e.reply_message?k(e.reply_message,t,i):void 0}}function y(e,t,i){if(e&&0!==e.length){var n,a,o=(0,r.default)(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;n?n.push(k(s,t,i)):n=[k(s,t,i)]}}catch(e){o.e(e)}finally{o.f()}return n}}function b(e){var t=e.apiAction,i=e.apiAttaches,n={type:"unknown"};switch(t.type){case"chat_create":return t.text?{type:t.type,title:t.text}:n;case"chat_title_update":return t.text&&t.old_text?{type:t.type,title:t.text,oldTitle:t.old_text}:n;case"chat_photo_remove":case"chat_screenshot":case"chat_group_call_started":case"chat_invite_user_by_link":case"chat_invite_user_by_call_join_link":case"chat_kick_don":return{type:t.type};case"chat_pin_message":case"chat_unpin_message":return{type:t.type,cmid:c.resolveCmid(t.conversation_message_id),chunks:t.message?u.fromServerText(t.message):[]};case"chat_photo_update":var r=null==i?void 0:i.find((function(e){return"photo"===e.type})),a=null==r?void 0:r.photo;if(!a)return n;var o=(0,d.fromApiPhoto)(a);return o?{type:t.type,photo:o}:n;case"chat_invite_user":case"chat_kick_user":case"accepted_message_request":if(!t.member_id)return n;var s=l.resolveId(t.member_id);return l.isUserPeerId(s)||l.isGroupPeerId(s)?{type:t.type,peerId:s}:n;case"chat_invite_user_by_message_request":case"chat_invite_user_by_call":case"chat_kick_user_call_block":if(!t.member_id)return n;var v=l.resolveId(t.member_id);return l.isUserPeerId(v)?{type:t.type,peerId:v}:n;case"conversation_style_update":case"conversation_style_update_action":var f;switch(t.style){case"disco":case"twilight":case"sunset":case"lagoon":case"marine":case"retrowave":case"candy":case"crimson":case"emerald":case"halloween_orange":case"halloween_violet":case"unicorn":case"midnight":case"easter_egg":case"frost":case"new_year":case"valentine":case"warm_valentine":case"womens_day":case void 0:f=t.style;break;default:f="unknown"}return{type:t.type,style:f};case"custom":return t.message?{type:t.type,chunks:u.fromServerText(t.message)}:n;default:t.type;return n}}function w(e){var t=e.attachments,i=void 0===t?[]:t,r=e.geo;return r?[].concat((0,n.default)(i),[{type:"geo",geo:r}]):i}function I(e){var t,i=l.resolveId(e.peer_id),n=c.resolveCmid(e.conversation_message_id),r=l.resolveId(e.from_id);return e.id&&(t=c.resolveId(e.id)),{kind:"Pinned",id:t,cmid:n,peerId:i,authorId:r,chunks:u.fromServerText(e.text),sentAt:1e3*e.date,forwardedMessages:e.fwd_messages?y(e.fwd_messages,i,n):void 0,replyMessage:e.reply_message?k(e.reply_message,i,n):void 0,attaches:(0,d.fromApiAttach)(e.attachments||[])}}},667361:(e,t,i)=>{"use strict";i.d(t,{fromApiMessageReactions:()=>a});var n=i(208134),r=i(314432);function a(e){return e.sort((function(e,t){return t.count-e.count})).reduce((function(e,t){return e.set(n.resolveId(t.reaction_id),{reactionId:n.resolveId(t.reaction_id),count:t.count,peerIds:new Set(t.user_ids.map(r.resolveId))}),e}),new Map)}},604850:(e,t,i)=>{"use strict";i.d(t,{fromApiUser:()=>s,fromApiGroup:()=>d,fromApiContact:()=>c,fromApiAnonym:()=>l,convertPlatform:()=>u});var n=i(334738),r=i(314432),a=[6482950,6481715,6146827],o={1:"mobile",2:"mobile",3:"mobile",4:"mobile",5:"mobile",6:"other",7:"other"};function s(e){var t,i,o,s,d,c,l={0:"unfamiliar",1:"outgoingRequest",2:"incomingRequest",3:"friends"},u="other";null!==(t=e.online_info)&&void 0!==t&&t.is_mobile&&(u="mobile"),a.includes((null===(i=e.online_info)||void 0===i?void 0:i.app_id)||0)&&(u="vkme");var v=r.resolveRealId("User",e.id),f=Boolean(e.blacklisted),p=e.photo_id?e.photo_id.split("_"):[],h=(0,n.default)(p,2)[1],m=h?parseInt(h):null;return{user:{kind:"User",id:v,firstName:e.first_name,firstNameGen:e.first_name_gen||e.first_name,firstNameAcc:e.first_name_acc||e.first_name,lastName:e.last_name,lastNameGen:e.last_name_gen||e.last_name,lastNameAcc:e.last_name_acc||e.last_name,screenName:e.screen_name,sex:void 0!==e.sex?{0:"unknown",1:"female",2:"male"}[e.sex]:"unknown",photoId:m&&!isNaN(m)?m:void 0,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,lastSeen:{isVisible:!(null===(o=e.online_info)||void 0===o||!o.visible),at:(null===(s=e.online_info)||void 0===s?void 0:s.last_seen)&&1e3*e.online_info.last_seen,platform:u},isVerified:Boolean(e.verified),isBlacklisted:f,isBlacklistedByMe:Boolean(e.blacklisted_by_me),isDeactivated:Boolean(e.deactivated),deactivationReason:e.deactivated,canCall:Boolean(e.can_call),canChangeFriendship:1===e.can_send_friend_request,canInviteToChats:!!e.can_invite_to_chats,canMessage:1===e.can_write_private_message,hasDefaultPhoto:1!==e.has_photo,followersCount:e.followers_count||0,friendship:void 0!==e.friend_status?l[e.friend_status]:l[0],mutualFriends:f?{hint:[],count:0}:void 0,contactName:e.contact_name,occupation:e.occupation,bdate:e.bdate,city:e.city,phone:e.mobile_phone},isOnline:!(null===(d=e.online_info)||void 0===d||!d.visible||null===(c=e.online_info)||void 0===c||!c.is_online)}}function d(e){var t,i=r.resolveRealId("Group",e.id);if(!e.type)throw new Error("fromApiGroup содержит некорректный тип ".concat(e.type));var n={0:"notMember",1:"member",2:"unsure",3:"declined",4:"outgoingRequest",5:"incomingRequest"}[e.member_status||0];return{kind:"Group",id:i,type:e.type,name:e.name,screenName:e.screen_name,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,activity:e.activity,memberCount:e.members_count||0,membership:n,isDeactivated:Boolean(e.deactivated),isVerified:1===e.verified,isClosed:Boolean(e.is_closed),canMessage:1===e.can_message,canChangeMembership:0!==(null===(t=e.ban_info)||void 0===t?void 0:t.end_date)&&(0===e.is_closed||"member"===n||"incomingRequest"===n),mutualFriends:2===e.is_closed&&"member"!==n?{hint:[],count:0}:void 0,isBlacklistedByMe:1===e.is_messages_blocked,site:e.site}}function c(e){var t=r.resolveRealId("Contact",e.id),i=r.resolveId(e.user_id);return{kind:"Contact",id:t,name:e.name,userId:i,phone:e.phone,canWrite:e.can_write,photo50:e.photo_50,lastSeen:e.last_seen_status}}function l(e){var t=r.resolveAnyId(e.id);if(r.isAnonymPeerId(t))return{id:t,kind:"Anonym",name:e.name,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,photo400:e.photo_400}}function u(e,t){var i=o[e]||"other";return a.includes(t)&&(i="vkme"),i}},610557:(e,t,i)=>{"use strict";i.d(t,{fromApiPost:()=>f});var n=i(678927),r=i(28991),a=i(30966),o=i(641450),s=i(314432),d=i(716352),c=i(194170),l=i(303460),u=i(239325),v={id:"reactions",items:[{id:0,title:"Нравится",asset:{animation_url:"https://vk.com/reaction/3-reactions-0?c_uniq_tag=83b2081a8e4adfc36ee536f5f1b4ad470174c89678369a4b9dc5547614a3955e",images:[{url:"https://vk.com/reaction/1-reactions-0-48?c_uniq_tag=e6bee176471af6e4f7ca0f57ac099847d57b8101bf07944e47b42b097a6d8455",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-0-72?c_uniq_tag=d6f55fe94c0add8f817b447cbd804768752eb996c06ef222b39eb3fd35834780",width:72,height:72}],title:{color:{foreground:{light:"FF3347",dark:"FF5C5C"},background:{light:"FFEDED",dark:"3E2526"}}},title_color:{light:"FF3347",dark:"FF5C5C"}}},{id:1,title:"Смешно",asset:{animation_url:"https://vk.com/reaction/3-reactions-1?c_uniq_tag=a47193579880c0f53dd597a15d3bd57d4827820687c73d6128df2720647b42b9",images:[{url:"https://vk.com/reaction/1-reactions-1-48?c_uniq_tag=8f5eb3a1d6a6ec81aceff211782af3c9e9a5d1c837f0bfade6965a6844786f8b",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-1-72?c_uniq_tag=c852fcad6e67059878dcf1905e3e416fd89fbc61222ead100935a6fcc1dab4c9",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:2,title:"Ого!",asset:{animation_url:"https://vk.com/reaction/3-reactions-2?c_uniq_tag=b946fcbe262642bc920331746b6eccd9f175bb17d8ef37e54d232fa35ca2c750",images:[{url:"https://vk.com/reaction/1-reactions-2-48?c_uniq_tag=2a6544dce8827d216db7ea91eafc726cd3a823f5d465ba00216901a6de2801ad",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-2-72?c_uniq_tag=5a0663f3d38dd6fbcf3e4973610d50641420631c9df30b6cf80eee0dd5c5efee",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:3,title:"Восторг",asset:{animation_url:"https://vk.com/reaction/3-reactions-3?c_uniq_tag=c6ed3add99e841dccda5479c8e21779954e61e0fba15f94a2ae16706df492123",images:[{url:"https://vk.com/reaction/1-reactions-3-48?c_uniq_tag=eda1a2c18d733b356babdeed5f52cdcc64dd59f1f69776a133fc34a5627eecee",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-3-72?c_uniq_tag=be09c5080773a9ba78984406588c7371e48073e80b842eb7c9a817f7b435379b",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:5,title:"Печаль",asset:{animation_url:"https://vk.com/reaction/3-reactions-5?c_uniq_tag=c61122c8c334154cb10ccf0e0687057bf1f0f40c2817198b2e1150df534c22c4",images:[{url:"https://vk.com/reaction/1-reactions-5-48?c_uniq_tag=31bcb230babad96120a62589c52af22811aaba54d4ed73a36cfd499d9d94102f",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-5-72?c_uniq_tag=a840d0eb581c133d97638ff5bf34f4b33f3fb8557b932cfe3516925b88e2f151",width:72,height:72}],title:{color:{foreground:{light:"4986CC",dark:"71AAEB"},background:{light:"EDF3FA",dark:"27303C"}}},title_color:{light:"4986CC",dark:"71AAEB"}}},{id:4,title:"&$#%!",asset:{animation_url:"https://vk.com/reaction/3-reactions-4?c_uniq_tag=063e6b2dd888bb5a9716cf6153f03bf9c0c9707713b857eed8fe1e4e09aea2b3",images:[{url:"https://vk.com/reaction/1-reactions-4-48?c_uniq_tag=c80e3224c299a73384c057ff065c9458dcd533d57a1458875eb98883c3a96783",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-4-72?c_uniq_tag=a0eddba1ec31f96adbb9afa2c6c14bec055b95f8d9f113bdf759fb5a9c9054f0",width:72,height:72}],title:{color:{foreground:{light:"EF5203",dark:"FA5300"},background:{light:"FDEBE8",dark:"3C2421"}}},title_color:{light:"EF5203",dark:"FA5300"}}}]};function f(e){var t,i,f,p,h,m,_,g,k,y,b,w,I,C,A,P,x,S,M,E,R,N=(0,r.default)((0,r.default)({},null==e||null===(t=e.attachments)||void 0===t||null===(i=t[0])||void 0===i?void 0:i.wall),{},{attachments:(P=e,M=null==P||null===(x=P.attachments)||void 0===x||null===(S=x[0])||void 0===S?void 0:S.wall,E=null==M?void 0:M.geo,R=(null==M?void 0:M.attachments)||[],E?[].concat((0,n.default)(R),[{type:"geo",geo:E}]):R)}),F=null==N||null===(f=N.copy_history)||void 0===f?void 0:f[0],U={};if(F){var T=(0,l.apiAttachWallOwnerId)(F),L="reply"===F.post_type;U=(0,r.default)((0,r.default)({},U),L?{wallReply:{kind:"WallReply",id:F.id||0,postId:F.reply_post_id||0,authorId:s.resolveId(F.from_id),ownerId:s.resolveId(T),parentsStack:F.parents_stack,date:1e3*(F.date||0),chunks:o.fromServerText(F.text||""),attaches:(0,l.fromApiWallAttach)(F)}}:{wall:{kind:"Wall",id:F.id||0,authorId:s.resolveId(F.from_id),ownerId:s.resolveId(T),date:1e3*(F.date||0),chunks:o.fromServerText(F.text||""),attaches:(0,l.fromApiWallAttach)(F)}}),N.copy_history=void 0}null!=N&&N.attachments&&(U=(0,r.default)((0,r.default)({},U),(0,l.fromApiWallAttach)(N)));var V=[],D=[];return v.items.forEach((function(e){var t=(0,u.fromApiReaction)(e);t&&(V.push(t),D.push(t.id))})),{post:{kind:"Normal",cmid:a.resolveCmid(e.cmid),chunks:null!=N&&N.text?o.fromServerText(N.text):[],views:(null==N||null===(p=N.views)||void 0===p?void 0:p.count)||0,sentAt:1e3*e.time,updatedAt:e.update_time&&1e3*e.update_time,channelId:d.resolveId(e.author_id),likes:{count:(null==N||null===(h=N.likes)||void 0===h?void 0:h.count)||0,reactionId:Boolean(null==N||null===(m=N.likes)||void 0===m?void 0:m.user_likes)?c.resolveId(null==N||null===(_=N.reactions)||void 0===_?void 0:_.user_reaction):void 0,availableReactionIds:D,peerIds:new Set},reposts:{count:(null==N||null===(g=N.reposts)||void 0===g?void 0:g.count)||0,isReposted:Boolean(null==N||null===(k=N.reposts)||void 0===k?void 0:k.user_reposted)},comments:{count:(null==N||null===(y=N.comments)||void 0===y?void 0:y.count)||0,oneLevelCount:0,canView:Boolean(null==N||null===(b=N.comments)||void 0===b?void 0:b.can_view),canPost:Boolean(null==N||null===(w=N.comments)||void 0===w?void 0:w.can_post),history:[],order:"interesting"},attaches:U,rights:{canDelete:1===N.can_delete},donutPlaceholder:null!==(I=N.donut)&&void 0!==I&&I.placeholder?{text:null===(C=N.donut.placeholder)||void 0===C?void 0:C.text,button:null===(A=N.donut.placeholder)||void 0===A?void 0:A.button}:void 0},reactions:V}}},239325:(e,t,i)=>{"use strict";i.d(t,{fromApiReaction:()=>r});var n=i(194170);function r(e){var t,i,r,a,o,s;if(e.asset.animation_url&&null!==(t=e.asset.title_color)&&void 0!==t&&t.dark&&null!==(i=e.asset.title_color)&&void 0!==i&&i.light){var d=null===(r=e.asset.images.find((function(e){return 48===e.height})))||void 0===r?void 0:r.url,c=null===(a=e.asset.images.find((function(e){return 72===e.height})))||void 0===a?void 0:a.url;if(d&&c)return{id:n.resolveId(e.id),animation:e.asset.animation_url,title:e.title,image48:d,image72:c,color:{light:null===(o=e.asset.title_color)||void 0===o?void 0:o.light,dark:null===(s=e.asset.title_color)||void 0===s?void 0:s.dark}}}}},378399:(e,t,i)=>{"use strict";i.d(t,{fromApiStickerPack:()=>a,fromApiSticker:()=>o,fromApiStickersKeywords:()=>s});var n=i(111965),r=i(878664);function a(e){if("stickers"===e.type&&e.title&&e.previews&&e.stickers){var t=e.previews.find((function(e){return 22===e.height})),i=e.previews.find((function(e){return 34===e.height})),n=e.previews.find((function(e){return 44===e.height})),a=e.previews.find((function(e){return 68===e.height}));if(t&&i&&n&&a){var s=[],d=[];return e.stickers.reduce((function(e,t){var i=o(t);return i?(d.push(i),e.push(i.id),e):e}),s),{stickerPack:{id:r.resolveStickerPackId(e.id),name:e.title,icons:{icon22:t.url,icon34:i.url,icon44:n.url,icon68:a.url},stickerIds:s},stickers:d}}}}function o(e){var t,i;if("sticker_id"in e&&e.images&&e.images_with_background&&e.sticker_id){e.images.sort((function(e,t){return e.height-t.height}));var n=e.images.find((function(e){return e.height>=128})),a=e.images.find((function(e){return e.height>=256})),o=e.images_with_background.find((function(e){return e.height>=128})),s=e.images_with_background.find((function(e){return e.height>=256}));if(n&&a&&o&&s)return{id:r.resolveStickerId(e.sticker_id),kind:"Sticker",isAllowed:void 0===e.is_allowed||e.is_allowed,image128:{light:n.url,dark:o.url},image256:{light:a.url,dark:s.url},animation:e.animations&&{light:(null===(t=e.animations.find((function(e){return"light"===e.type})))||void 0===t?void 0:t.url)||"",dark:(null===(i=e.animations.find((function(e){return"dark"===e.type})))||void 0===i?void 0:i.url)||""}}}}function s(e){return e.dictionary.reduce((function(e,t){var i,a,o,s=null!==(i=null===(a=t.stickers)||void 0===a?void 0:a.map((function(e){var t=e.sticker_id;return r.resolveStickerId(t)})))&&void 0!==i?i:[],d=(0,n.default)(t.words);try{for(d.s();!(o=d.n()).done;){e[o.value]=s}}catch(e){d.e(e)}finally{d.f()}return e}),{})}},281385:(e,t,i)=>{"use strict";var n,r,a,o,s;i.d(t,{IEngine:()=>n}),r=n||(n={}),function(e){e[e.Mention=1]="Mention",e[e.ExpiringMessage=2]="ExpiringMessage"}(a||(a={})),r.MarkedType=a,function(e){e[e.CopyFlagChanged=0]="CopyFlagChanged",e[e.TitleChanged=1]="TitleChanged",e[e.AvatarChanged=2]="AvatarChanged",e[e.AdminGrated=3]="AdminGrated",e[e.FlagsChanged=4]="FlagsChanged",e[e.Pinned=5]="Pinned",e[e.UserJoined=6]="UserJoined",e[e.UserLeft=7]="UserLeft",e[e.UserKicked=8]="UserKicked",e[e.AdminKicked=9]="AdminKicked",e[e.BannerChanged=10]="BannerChanged",e[e.KeyboardChanged=11]="KeyboardChanged",e[e.MessageRequestChanged=12]="MessageRequestChanged",e[e.ContactConverted=13]="ContactConverted",e[e.BusinessNotifyDataChanged=14]="BusinessNotifyDataChanged",e[e.MessageRequestCanceled=15]="MessageRequestCanceled",e[e.MessageRequestRejected=16]="MessageRequestRejected",e[e.MessageRequestAccepted=17]="MessageRequestAccepted",e[e.ContactJoined=18]="ContactJoined",e[e.CallInProgressChanged=19]="CallInProgressChanged",e[e.DonSubscribed=20]="DonSubscribed",e[e.DonUnsubscribed=21]="DonUnsubscribed",e[e.IsNewChange=22]="IsNewChange",e[e.StyleChanged=23]="StyleChanged",e[e.DescriptionChanged=24]="DescriptionChanged",e[e.ShortPollReactionsChanged=25]="ShortPollReactionsChanged"}(o||(o={})),r.ChatUpdateType=o,function(e){e[e.Deleted=0]="Deleted",e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected",e[e.New=3]="New"}(s||(s={})),r.MRStatus=s,r.isIncompleteUpdate=function(e){switch(e[0]){case 10004:case 4:return e.length<12;case 10005:case 10018:case 5:case 18:return e.length<11;default:return!1}}},837021:(e,t,i)=>{"use strict";i.d(t,{TypingVariants:()=>p,insertConvos:()=>h,insertPeers:()=>_,insertContactItems:()=>g,insertContacts:()=>k,insertFolders:()=>y,insertChannels:()=>b,getOwnerGroupId:()=>w,removeConvosFromFolder:()=>I,addConvosToFolder:()=>C,getConvosByIds:()=>A});var n=i(111965),r=i(509727),a=i(314432),o=i(233600),s=i(716352),d=i(360202),c=i(975474),l=i(604850),u=i(590917),v=i(419117),f=i(610557),p=["text","voice","photo","video","file","videomessage"];function h(e,t){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=a.dangerouslyMerge,d=[],l=(0,n.default)(t);try{for(l.s();!(i=l.n()).done;){var u,v=i.value,f="conversation"in v?(0,c.fromApiConvo)(v.conversation,v.last_message):(0,c.fromApiConvo)(v);if(f){var p=f.convo,h=f.peer,_=e.convos.get(p.peerId);if(!_||s){var g=m(p,_);e.convos.set(p.peerId,g),h&&e.peers.set(h.id,h),d.push(p),"ChatConvo"===g.kind&&e.hiddenPinnedMessages.get(g.peerId)!==(null===(u=g.pinnedMessage)||void 0===u?void 0:u.cmid)&&e.hiddenPinnedMessages.delete(g.peerId)}else d.push(_)}}}catch(e){l.e(e)}finally{l.f()}var k=d.filter((function(e){return!r.isMR(e)&&!r.isBusinessNotify(e)}));return o.add(e.convosSearchIndex,k,(function(t){var i=e.peers.get(t.peerId);return{id:t.peerId,strings:i?o.peerWords(i):[]}})),d}function m(e,t){return t?(0===t.persisted.size&&0===t.queued.size&&(t.persisted=e.persisted,t.persistedCmid=e.persistedCmid),"ChatConvo"===t.kind&&"ChatConvo"===e.kind&&(t.unreadMentions=e.unreadMentions),t):e}function _(e,t){var i,r=t.apiUsers,o=t.apiGroups,s=t.apiContacts,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=d.dangerouslyOverwrite,u=[],v=(0,n.default)(r);try{for(v.s();!(i=v.n()).done;){var f=i.value,p=(0,l.fromApiUser)(f),h=p.user,m=p.isOnline,_=e.peers.get(h.id);e.onlines.delete(h.id),m&&e.onlines.add(h.id),"User"===(null==_?void 0:_.kind)&&a.updateLastSeen(_,h.lastSeen),"User"!==(null==_?void 0:_.kind)||c?(e.peers.set(h.id,h),u.push(h)):u.push(_)}}catch(e){v.e(e)}finally{v.f()}var g,k=[],y=(0,n.default)(o);try{for(y.s();!(g=y.n()).done;){var b=g.value,w=(0,l.fromApiGroup)(b),I=e.peers.get(w.id);!I||"Group"!==I.kind||c?(e.peers.set(w.id,w),k.push(w)):k.push(I)}}catch(e){y.e(e)}finally{y.f()}var C,A=[],P=(0,n.default)(s);try{for(P.s();!(C=P.n()).done;){var x=C.value,S=(0,l.fromApiContact)(x),M=e.peers.get(S.id);!M||"Contact"!==M.kind||c?(e.peers.set(S.id,S),A.push(S)):A.push(M)}}catch(e){P.e(e)}finally{P.f()}return{insertedUsers:u,insertedGroups:k,insertedContacts:A}}function g(e,t,i){var n=[];return _(e,{apiUsers:i,apiGroups:[],apiContacts:[]},{dangerouslyOverwrite:!0}),t.forEach((function(t){var i=a.resolveId(t);if(a.isUserPeerId(i)){var r=e.peers.get(i);if("User"!==(null==r?void 0:r.kind))return;e.contacts.items.set(i,r),n.push(i)}})),n}function k(e,t){var i=[];t.sort((function(e,t){return e.name.localeCompare(t.name)}));var r,a=(0,n.default)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=(0,l.fromApiContact)(o),d=s.userId?s.userId:s.id;e.contacts.contacts.set(d,s),i.push(s)}}catch(e){a.e(e)}finally{a.f()}return i}function y(e,t){var i,r=[],a=(0,n.default)(t);try{var o=function(){var t=i.value,n=(0,u.fromApiFolder)(t);if(e.organisers.folders.find((function(e){return e.id===n.id})))return r.push(n),"continue";e.organisers.folders.push(n),r.push(n)};for(a.s();!(i=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}return r}function b(e,t){var i,r=t.apiChannels,a=t.apiGroups,o=t.dangerouslyMerge,d=[],c=(0,n.default)(r);try{var l=function(){var t=i.value,n=a.find((function(e){return-e.id===t.channel.channel_id}));if(!n)throw new Error("С бэка не приходит нужная группа для канала");var r=(0,v.fromApiChannel)(t,n);(t.last_message&&(0,f.fromApiPost)(t.last_message).reactions||[]).forEach((function(t){e.reactions.set(t.id,t)}));var c=e.channels.get(r.id);if(c&&!o)return d.push(c),"continue";var l=c?s.merge(c,r):r;e.channels.set(l.id,l),d.push(l)};for(c.s();!(i=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}return d}function w(e){return a.isGroupPeerId(e)?a.toRealId(e):0}function I(e,t,i){var a,o,s=e.organisers.folders.find((function(e){return e.id===t}));if(s){var c,l=null!==(a=s.unreadCount)&&void 0!==a?a:0,u=null!==(o=s.unreadUnmutedCount)&&void 0!==o?o:0,v=(0,n.default)(i);try{for(v.s();!(c=v.n()).done;){var f=c.value;r.isInFolder(f,t)&&(r.removeFolder(f,t),d.refresh(e.organisers.folders,f),f.unreadCount&&(r.isMuted(f)?l--:u--))}}catch(e){v.e(e)}finally{v.f()}d.setUnreadCounters(e.organisers.folders,t,l,u)}}function C(e,t,i){var a,o,s=[],c=e.organisers.folders.find((function(e){return e.id===t}));if(c){var l,u=null!==(a=c.unreadCount)&&void 0!==a?a:0,v=null!==(o=c.unreadUnmutedCount)&&void 0!==o?o:0,f=(0,n.default)(i);try{for(f.s();!(l=f.n()).done;){var p=l.value;r.isInFolder(p,t)||(r.addFolder(p,t),s.push(p),p.unreadCount&&(r.isMuted(p)?u++:v++))}}catch(e){f.e(e)}finally{f.f()}d.push(e.organisers.folders,t,"all",s,c.all.hasMore),d.push(e.organisers.folders,t,"unread",s.filter((function(e){return r.isUnread(e)})),c.unread.hasMore),d.setUnreadCounters(e.organisers.folders,t,u,v)}}function A(e,t){return t.reduce((function(t,i){var n=e.convos.get(a.resolveId(i));return n&&t.push(n),t}),[])}}}]);try{stManager.done("dist/b5d48e03a4dc005738790e7aca8143ff.782b70182fdab1f0f5a5.js")}catch(e){}