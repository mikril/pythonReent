(()=>{"use strict";var __webpack_modules__={975803:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon16ChevronOutline","chevron_outline_16","0 0 12 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 16" id="chevron_outline_16"><path fill="currentColor" fill-rule="evenodd" d="M4.22 3.47a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06-1.06L7.69 8 4.22 4.53a.75.75 0 0 1 0-1.06z" clip-rule="evenodd" /></symbol>',12,16,!1,void 0)},488830:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon20MarketOutline","market_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="market_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M7.25 5.75a2.75 2.75 0 0 1 5.5 0V6h-5.5zm-1.5.254V5.75a4.25 4.25 0 0 1 8.5 0v.254c1.013.014 1.62.073 2.112.323a3 3 0 0 1 1.311 1.311C18 8.28 18 9.12 18 10.8v.5c0 2.52 0 3.78-.49 4.743a4.5 4.5 0 0 1-1.967 1.966c-.963.491-2.223.491-4.743.491H9.2c-2.52 0-3.78 0-4.743-.49a4.5 4.5 0 0 1-1.967-1.967C2 15.08 2 13.82 2 11.3v-.5c0-1.68 0-2.52.327-3.162a3 3 0 0 1 1.311-1.311c.492-.25 1.1-.31 2.112-.323zm-.798 1.532C5.377 7.5 5.935 7.5 6.8 7.5h6.4c.865 0 1.423.001 1.848.036.408.033.559.09.633.127a1.5 1.5 0 0 1 .655.656c.038.074.095.225.128.633.035.425.036.983.036 1.848v.5c0 1.285-.001 2.158-.056 2.833-.054.658-.151.994-.271 1.229a3 3 0 0 1-1.311 1.311c-.235.12-.57.217-1.229.27C12.958 17 12.085 17 10.8 17H9.2c-1.285 0-2.158-.001-2.833-.056-.658-.054-.994-.151-1.229-.271a3 3 0 0 1-1.311-1.311c-.12-.235-.217-.57-.27-1.229C3.5 13.458 3.5 12.585 3.5 11.3v-.5c0-.865.001-1.423.036-1.848.033-.408.09-.559.127-.633a1.5 1.5 0 0 1 .656-.656c.074-.037.225-.094.633-.127zm.798 2.339a.875.875 0 1 1 1.75 0 .875.875 0 0 1-1.75 0zM13.375 9a.875.875 0 1 0 0 1.75.875.875 0 0 0 0-1.75z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},318285:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon24MessageOutline","message_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="message_outline_24"><path fill="currentColor" d="M7.713 18.202a.9.9 0 0 1 1-.259A9.364 9.364 0 0 0 12 18.53c4.502 0 8.1-3.085 8.1-6.815S16.502 4.9 12 4.9s-8.1 3.084-8.1 6.814c0 1.283.423 2.515 1.214 3.586a.9.9 0 0 1 .176.538c-.003.893-.376 2.179-1.114 3.915 1.654-.184 2.82-.71 3.537-1.551zm-4.324 3.413c-.914.036-1.594-.943-1.209-1.795.776-1.715 1.203-2.974 1.292-3.724-.891-1.312-1.372-2.815-1.372-4.382C2.1 6.924 6.56 3.1 12 3.1s9.9 3.823 9.9 8.614-4.46 8.615-9.9 8.615c-1.157 0-2.287-.173-3.353-.506-1.21 1.116-2.975 1.703-5.258 1.792z" /></symbol>',24,24,!1,void 0)},763478:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon24NarrativeOutline","narrative_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="narrative_outline_24"><path fill="currentColor" d="M14.298 1.435c.732.17 1.377.543 1.891 1.092.521.556.825 1.145 1.151 2.298l.79 2.944a1 1 0 1 1-1.931.518l-.72-2.69-.113-.401c-.215-.729-.377-1.024-.636-1.302a1.726 1.726 0 0 0-.887-.512c-.37-.086-.707-.078-1.445.1l-.405.104L6.866 4.96c-.854.228-1.254.394-1.51.583l-.06.047-.134.119c-.26.243-.43.539-.512.886-.093.4-.076.763.148 1.638l2.723 10.17.113.401c.215.729.377 1.024.636 1.302.244.26.54.43.887.512.401.093.745.076 1.607-.14a1 1 0 1 1 .487 1.94c-1.148.288-1.805.32-2.549.147a3.726 3.726 0 0 1-1.891-1.092c-.521-.556-.825-1.145-1.151-2.298L2.922 8.963c-.355-1.324-.405-2.027-.22-2.823a3.722 3.722 0 0 1 .93-1.728l.183-.182.179-.157c.496-.412 1.077-.685 2.091-.973l.263-.072 5.128-1.374c1.323-.355 2.026-.405 2.822-.22zM18.368 11c2 0 3.632 1.592 3.632 3.567 0 1.91-.772 2.851-3.78 5.134l-1.328 1.007c-.527.4-1.257.4-1.784 0l-1.328-1.007C10.772 17.418 10 16.476 10 14.567 10 12.592 11.631 11 13.632 11c.829 0 1.595.224 2.282.66l.086.057.086-.057a4.174 4.174 0 0 1 2.036-.653zm0 2c-.63 0-1.17.228-1.67.716l-.349.34a.5.5 0 0 1-.698 0l-.35-.34c-.5-.488-1.04-.716-1.67-.716-.906 0-1.631.707-1.631 1.567 0 .993.4 1.546 2.524 3.185L16 18.875l1.012-.767c2.45-1.859 2.957-2.442 2.988-3.44l.001-.1c0-.86-.725-1.568-1.632-1.568z" /></symbol>',24,24,!1,void 0)},463989:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon24ShareOutline","share_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="share_outline_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path fill="currentColor" fill-rule="nonzero" d="M11.996 3.725A2.15 2.15 0 0 0 10 5.87l-.001 2.117-.02.005a9.904 9.904 0 0 0-7.827 10.721c.083.811 1.116 1.103 1.611.455l.187-.237a9.082 9.082 0 0 1 5.836-3.265l.213-.026.001 2.494a2.15 2.15 0 0 0 3.476 1.692l7.824-6.132a2.15 2.15 0 0 0 0-3.384l-7.824-6.132a2.15 2.15 0 0 0-1.326-.458zm.154 1.795a.35.35 0 0 1 .216.075l7.824 6.132a.35.35 0 0 1 0 .55l-7.824 6.133a.35.35 0 0 1-.566-.276l-.001-3.447a.9.9 0 0 0-.915-.9l-.233.004-.342.017a10.88 10.88 0 0 0-6.119 2.365l-.174.144.024-.135a8.103 8.103 0 0 1 6.968-6.537.9.9 0 0 0 .791-.893L11.8 5.87a.35.35 0 0 1 .35-.35z" /></g></symbol>',24,24,!1,void 0)},147650:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon24SmileOutline","smile_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="smile_outline_24"><path d="M8.438 14.297a.9.9 0 0 1 1.259.133c.013.016.196.223.53.432.383.24.97.488 1.773.488a3.3 3.3 0 0 0 1.773-.488c.191-.12.382-.26.53-.432a.9.9 0 0 1 1.4 1.132 4.045 4.045 0 0 1-.976.826A5.094 5.094 0 0 1 12 17.15a5.094 5.094 0 0 1-2.727-.762 3.987 3.987 0 0 1-.976-.826.9.9 0 0 1 .14-1.265Zm1.812-4.047a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0ZM15 11.5A1.25 1.25 0 1 0 15 9a1.25 1.25 0 0 0 0 2.5Zm-3-9.4c-5.468 0-9.9 4.432-9.9 9.9s4.432 9.9 9.9 9.9 9.9-4.432 9.9-9.9-4.432-9.9-9.9-9.9ZM3.9 12a8.1 8.1 0 1 1 16.2 0 8.1 8.1 0 0 1-16.2 0Z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},923197:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon24StoryOutline","story_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="story_outline_24"><path fill="currentColor" fill-rule="evenodd" d="M10.3 3h-.039C9.174 3 8.303 3 7.6 3.058c-.723.059-1.349.183-1.924.476a4.9 4.9 0 0 0-2.142 2.141c-.293.576-.418 1.202-.477 1.924C3 8.303 3 9.175 3 10.261v3.478c0 1.087 0 1.958.058 2.661.059.723.183 1.349.476 1.925a4.9 4.9 0 0 0 2.141 2.14c.576.294 1.202.419 1.924.478.704.057 1.575.057 2.662.057h3.478c1.087 0 1.958 0 2.661-.058.723-.059 1.349-.183 1.925-.476a4.9 4.9 0 0 0 2.14-2.141c.294-.576.419-1.202.478-1.925.057-.703.057-1.574.057-2.661v-3.478c0-1.087 0-1.958-.058-2.661-.059-.723-.183-1.349-.476-1.924a4.9 4.9 0 0 0-2.141-2.142c-.576-.293-1.202-.417-1.925-.476C15.697 3 14.826 3 13.74 3H10.3ZM6.493 5.138c.28-.143.642-.236 1.253-.286C8.368 4.8 9.166 4.8 10.3 4.8h3.4c1.135 0 1.932 0 2.554.051.611.05.974.144 1.253.287a3.1 3.1 0 0 1 1.355 1.355c.143.28.237.642.287 1.253.05.622.051 1.42.051 2.554v3.4c0 1.135 0 1.932-.051 2.554-.05.611-.144.974-.287 1.253a3.1 3.1 0 0 1-1.355 1.355c-.28.143-.642.237-1.253.287-.622.05-1.419.051-2.554.051h-3.4c-1.135 0-1.932 0-2.554-.051-.611-.05-.974-.144-1.253-.287a3.1 3.1 0 0 1-1.355-1.355c-.143-.28-.236-.642-.286-1.253C4.8 15.632 4.8 14.835 4.8 13.7v-3.4c0-1.135 0-1.932.051-2.554.05-.611.144-.974.287-1.253a3.1 3.1 0 0 1 1.355-1.355ZM9.8 12a2.199 2.199 0 1 1 4.398 0A2.199 2.199 0 0 1 9.8 12ZM12 8.001a3.999 3.999 0 1 0 0 7.998 3.999 3.999 0 0 0 0-7.998Z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},820603:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon24ViewOutline","view_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="view_outline_24"><path d="M12 4.6c5.2 0 10.4 4.237 10.4 7.4 0 3.163-5.2 7.4-10.4 7.4S1.6 15.163 1.6 12c0-3.163 5.2-7.4 10.4-7.4Zm0 1.8c-4.278 0-8.6 3.522-8.6 5.6s4.322 5.6 8.6 5.6 8.6-3.522 8.6-5.6-4.322-5.6-8.6-5.6Zm0 2.2a3.4 3.4 0 1 1 0 6.8 3.4 3.4 0 0 1 0-6.8Zm0 1.8a1.6 1.6 0 1 0 0 3.2 1.6 1.6 0 0 0 0-3.2Z" /></symbol>',24,24,!1,void 0)},587083:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon28AddOutline","add_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="add_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M14 4a1 1 0 0 1 1 1v8h8a1 1 0 0 1 0 2h-8v8a1 1 0 0 1-2 0v-8H5a1 1 0 0 1 0-2h8V5a1 1 0 0 1 1-1Z" /></g></symbol>',28,28,!1,void 0)},739124:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon28CommentOutline","comment_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="comment_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M16.06 20.354c.298-.26.68-.404 1.076-.404h4.447c1.17 0 1.867-.697 1.867-1.867V8.75c0-1.17-.697-1.867-1.867-1.867h-14c-1.17 0-1.866.697-1.866 1.867v9.333c0 1.17.696 1.867 1.866 1.867H10.5c.816.235.816.235 1.051 1.051v3.3l4.51-3.947Zm-5.752 5.934c-.551-.413-.858-1.142-.858-1.788v-2.45H7.583c-2.33 0-3.966-1.637-3.966-3.967V8.75c0-2.33 1.636-3.967 3.966-3.967h14c2.33 0 3.967 1.637 3.967 3.967v9.333c0 2.33-1.637 3.967-3.967 3.967h-4.272l-4.345 3.802c-.855.839-1.854 1.04-2.659.436Z" /></g></symbol>',28,28,!1,void 0)},763358:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon28Like","like_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="like_28"><path fill="currentColor" d="M9.026 4.88A6.526 6.526 0 0 0 2.5 11.406c0 3.613 1.445 5.421 7.493 10.126l2.78 2.16a2 2 0 0 0 2.455 0l2.779-2.16c6.048-4.705 7.493-6.513 7.493-10.126a6.526 6.526 0 0 0-6.526-6.526c-1.872 0-3.538.85-4.974 2.487C12.564 5.73 10.898 4.88 9.026 4.88z" /></symbol>',28,28,!1,void 0)},314168:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon28LikeOutline","like_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="like_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M9.026 4.88A6.526 6.526 0 0 0 2.5 11.406c0 3.613 1.445 5.421 7.493 10.126l2.78 2.16a2 2 0 0 0 2.455 0l2.779-2.16c6.048-4.705 7.493-6.513 7.493-10.126a6.526 6.526 0 0 0-6.526-6.526c-1.872 0-3.538.85-4.974 2.487C12.564 5.73 10.898 4.88 9.026 4.88Zm0 2c1.52 0 2.889.858 4.152 2.683l.205.298a.75.75 0 0 0 1.234 0l.205-.298c1.263-1.825 2.633-2.683 4.152-2.683 2.5 0 4.526 2.027 4.526 4.526 0 2.78-1.137 4.204-6.721 8.547L14 22.114l-2.779-2.161C5.637 15.61 4.5 14.187 4.5 11.406c0-2.5 2.027-4.526 4.526-4.526Z" /></g></symbol>',28,28,!1,void 0)},458819:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon28ServicesOutline","services_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="services_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M9.116 15c1.065 0 1.623.108 2.205.419.54.289.971.72 1.26 1.26.311.582.419 1.14.419 2.205v2.232c0 1.065-.108 1.623-.419 2.205-.289.54-.72.971-1.26 1.26-.582.311-1.14.419-2.205.419H6.884c-1.065 0-1.623-.108-2.205-.419-.54-.289-.971-.72-1.26-1.26C3.108 22.739 3 22.18 3 21.116v-2.232c0-1.065.108-1.623.419-2.205.289-.54.72-.971 1.26-1.26.582-.311 1.14-.419 2.205-.419h2.232Zm12 0c1.065 0 1.623.108 2.205.419.54.289.971.72 1.26 1.26.311.582.419 1.14.419 2.205v2.232c0 1.065-.108 1.623-.419 2.205-.289.54-.72.971-1.26 1.26-.582.311-1.14.419-2.205.419h-2.232c-1.065 0-1.623-.108-2.205-.419-.54-.289-.971-.72-1.26-1.26-.311-.582-.419-1.14-.419-2.205v-2.232c0-1.065.108-1.623.419-2.205.289-.54.72-.971 1.26-1.26.582-.311 1.14-.419 2.205-.419h2.232Zm-12 2H6.884c-.763 0-1.01.048-1.261.182a1.045 1.045 0 0 0-.44.44c-.135.253-.183.499-.183 1.262v2.232c0 .763.048 1.01.182 1.261.103.193.248.338.44.44.253.135.499.183 1.262.183h2.232c.763 0 1.01-.048 1.261-.182.193-.103.338-.248.44-.44.135-.253.183-.499.183-1.262v-2.232c0-.763-.048-1.01-.182-1.261a1.045 1.045 0 0 0-.44-.44c-.253-.135-.499-.183-1.262-.183Zm12 0h-2.232c-.763 0-1.01.048-1.261.182a1.045 1.045 0 0 0-.44.44c-.135.253-.183.499-.183 1.262v2.232c0 .763.048 1.01.182 1.261.103.193.248.338.44.44.253.135.499.183 1.262.183h2.232c.763 0 1.01-.048 1.261-.182.193-.103.338-.248.44-.44.135-.253.183-.499.183-1.262v-2.232c0-.763-.048-1.01-.182-1.261a1.045 1.045 0 0 0-.44-.44c-.253-.135-.499-.183-1.262-.183ZM20.89 2.413c.631.19 1.102.51 1.856 1.263l1.577 1.577c.754.754 1.072 1.225 1.263 1.856a3.044 3.044 0 0 1 0 1.782c-.19.631-.51 1.102-1.263 1.856l-1.577 1.577c-.754.754-1.225 1.072-1.856 1.263a3.044 3.044 0 0 1-1.782 0c-.631-.19-1.102-.51-1.856-1.263l-1.577-1.577c-.754-.754-1.072-1.225-1.263-1.856a3.044 3.044 0 0 1 0-1.782c.19-.631.51-1.102 1.263-1.856l1.577-1.577c.754-.754 1.225-1.072 1.856-1.263a3.044 3.044 0 0 1 1.782 0ZM9.116 3c1.065 0 1.623.108 2.205.419.54.289.971.72 1.26 1.26.311.582.419 1.14.419 2.205v2.232c0 1.065-.108 1.623-.419 2.205-.289.54-.72.971-1.26 1.26-.582.311-1.14.419-2.205.419H6.884c-1.065 0-1.623-.108-2.205-.419-.54-.289-.971-.72-1.26-1.26C3.108 10.739 3 10.18 3 9.116V6.884c0-1.065.108-1.623.419-2.205.289-.54.72-.971 1.26-1.26C5.261 3.108 5.82 3 6.884 3h2.232Zm10.573 1.327c-.274.082-.482.223-1.021.763L17.09 6.668c-.54.54-.68.747-.763 1.02a1.045 1.045 0 0 0 0 .623c.082.274.223.482.763 1.021l1.578 1.578c.54.54.747.68 1.02.763.21.064.415.064.623 0 .274-.082.482-.223 1.021-.763l1.578-1.578c.54-.54.68-.747.763-1.02a1.045 1.045 0 0 0 0-.623c-.082-.274-.223-.482-.763-1.021L21.332 5.09c-.54-.54-.747-.68-1.02-.763a1.045 1.045 0 0 0-.623 0ZM9.116 5H6.884c-.763 0-1.01.048-1.261.182a1.045 1.045 0 0 0-.44.44C5.047 5.876 5 6.122 5 6.885v2.232c0 .763.048 1.01.182 1.261.103.193.248.338.44.44.253.135.499.183 1.262.183h2.232c.763 0 1.01-.048 1.261-.182.193-.103.338-.248.44-.44.135-.253.183-.499.183-1.262V6.884c0-.763-.048-1.01-.182-1.261a1.045 1.045 0 0 0-.44-.44C10.124 5.047 9.878 5 9.115 5Z" /></g></symbol>',28,28,!1,void 0)},401755:(e,t,o)=>{o.d(t,{default:()=>i});const i=(0,o(28178).makeIcon)("Icon56CompassOutline","compass_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="compass_outline_56"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"><path d="M36.92 21.207c.406-1.307-.82-2.533-2.127-2.127l-11.036 3.425a1.9 1.9 0 0 0-1.252 1.252L19.08 34.791c-.406 1.307.82 2.534 2.128 2.128l11.036-3.425a1.9 1.9 0 0 0 1.251-1.252zM25.199 25.2l8.124-2.522-2.522 8.124-8.124 2.522z" /><path d="M52 28c0 13.255-10.745 24-24 24S4 41.255 4 28 14.745 4 28 4s24 10.745 24 24zm-3 0c0 11.598-9.402 21-21 21S7 39.598 7 28 16.402 7 28 7s21 9.402 21 21z" /></g></symbol>',56,56,!1,void 0)},727187:(e,t,o)=>{o.d(t,{BaseSexEnumNames:()=>i});var i={UNKNOWN:0,FEMALE:1,MALE:2}},903325:(e,t,o)=>{function i(){return{icon:'<svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M12 5.54C12 2.48 9.32 0 6.01 0 2.71 0 .02 2.48.02 5.54c0 1.09.34 2.1.93 2.95 0 .95-.41 1.91-.78 2.78l-.15.35c-.07.18.06.39.24.38 1.56-.07 2.74-.53 3.35-1.39.74.3 1.55.47 2.4.47 3.3 0 5.99-2.48 5.99-5.54zM6 3.25a.5.5 0 0 0-.49.39.75.75 0 0 1-1.46-.35A2 2 0 0 1 6 1.75c1.14 0 1.97.94 1.97 2.04a2 2 0 0 1-.28 1.06c-.16.27-.38.47-.52.6-.28.26-.39.36-.43.65a.75.75 0 0 1-1.48-.2c.1-.83.57-1.26.86-1.52l.04-.04c.14-.13.2-.2.24-.26a.52.52 0 0 0 .07-.29c0-.36-.24-.54-.47-.54zm.9 5.26a.9.9 0 1 1-1.8 0 .9.9 0 0 1 1.8 0z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"question_12"}}o.d(t,{getIcon12Question:()=>i})},317076:(e,t,o)=>{function i(){return{icon:'<svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 9.59 2.96 8.04a1 1 0 0 0-1.42 1.42L3.8 11.7a1 1 0 0 0 1.42 0l5.25-5.25a1 1 0 0 0-1.42-1.42z" fill="currentColor"/></svg>',name:"verified_12"}}o.d(t,{getIcon12Verified:()=>i})},634991:(e,t,o)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M12 7a.9.9 0 0 1 .9.9v3.2h3.2a.9.9 0 0 1 .9.9.9.9 0 0 1-.9.9h-3.2v3.2a.9.9 0 0 1-.9.9.9.9 0 0 1-.9-.9v-3.2H7.9A.9.9 0 0 1 7 12a.9.9 0 0 1 .9-.9h3.2V7.9A.9.9 0 0 1 12 7ZM9.46 3h5.08c.95 0 1.71 0 2.33.05.64.05 1.2.16 1.73.43a4.4 4.4 0 0 1 1.92 1.92c.27.52.38 1.09.43 1.73.05.62.05 1.38.05 2.33v5.08c0 .95 0 1.71-.05 2.33-.05.64-.16 1.2-.43 1.73a4.4 4.4 0 0 1-1.92 1.92 4.5 4.5 0 0 1-1.73.43c-.62.05-1.38.05-2.33.05H9.46c-.95 0-1.71 0-2.33-.05a4.5 4.5 0 0 1-1.73-.43 4.4 4.4 0 0 1-1.92-1.92 4.5 4.5 0 0 1-.43-1.73C3 16.25 3 15.5 3 14.54V9.46c0-.95 0-1.71.05-2.33.05-.64.16-1.2.43-1.73A4.4 4.4 0 0 1 5.4 3.48a4.51 4.51 0 0 1 1.73-.43C7.75 3 8.5 3 9.46 3ZM7.27 4.84c-.52.05-.82.13-1.05.24a2.6 2.6 0 0 0-1.14 1.14c-.11.23-.2.53-.24 1.05-.04.54-.04 1.24-.04 2.23v5c0 1 0 1.69.04 2.23.05.52.13.82.24 1.05a2.6 2.6 0 0 0 1.14 1.14c.23.11.53.2 1.05.24.54.04 1.24.04 2.23.04h5c1 0 1.69 0 2.23-.04.52-.05.82-.13 1.05-.24a2.6 2.6 0 0 0 1.14-1.14c.11-.23.2-.53.24-1.05.04-.54.04-1.24.04-2.23v-5c0-1 0-1.69-.04-2.23a2.77 2.77 0 0 0-.24-1.05 2.6 2.6 0 0 0-1.14-1.14c-.23-.11-.53-.2-1.05-.24-.54-.04-1.24-.04-2.23-.04h-5c-1 0-1.69 0-2.23.04Z" clip-rule="evenodd"/></svg>',name:"add_square_outline_24"}}o.d(t,{getIcon24AddSquareOutline:()=>i})},121096:(e,t,o)=>{function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="user_add_outline_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="user_add_outline_24__user_add_outline_24"><path id="user_add_outline_24__Bounds" d="M0 0h24v24H0z"/><path d="M18.85 7.95a2.85 2.85 0 1 0-5.7 0 2.85 2.85 0 0 0 5.7 0Zm1.8 0a4.65 4.65 0 1 1-9.3 0 4.65 4.65 0 0 1 9.3 0ZM9.9 18.43c0 .77-.1.67.34.67h11.52c.43 0 .34.1.34-.67 0-1.9-2.78-3.03-6.1-3.03s-6.1 1.14-6.1 3.03Zm-4-8.33h2.7a.9.9 0 1 1 0 1.8H5.9v2.7a.9.9 0 1 1-1.8 0v-2.7H1.4a.9.9 0 1 1 0-1.8h2.7V7.4a.9.9 0 1 1 1.8 0v2.7Zm2.2 8.33c0-3.33 3.67-4.83 7.9-4.83s7.9 1.5 7.9 4.83c0 1.73-.69 2.47-2.14 2.47H10.24c-1.45 0-2.14-.74-2.14-2.47Z" id="user_add_outline_24__Mask" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"user_add_outline_24"}}o.d(t,{getIcon24UserAddOutline:()=>i})},290634:(e,t,o)=>{function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="user_added_outline_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="user_added_outline_24__user_added_outline_24"><path id="user_added_outline_24__Bounds" d="M0 0h24v24H0z"/><path d="M18.85 7.95a2.85 2.85 0 1 0-5.7 0 2.85 2.85 0 0 0 5.7 0Zm1.8 0a4.65 4.65 0 1 1-9.3 0 4.65 4.65 0 0 1 9.3 0ZM9.9 18.43c0 .77-.1.67.34.67h11.52c.43 0 .34.1.34-.67 0-1.9-2.78-3.03-6.1-3.03s-6.1 1.14-6.1 3.03Zm-1.8 0c0-3.33 3.67-4.83 7.9-4.83s7.9 1.5 7.9 4.83c0 1.73-.69 2.47-2.14 2.47H10.24c-1.45 0-2.14-.74-2.14-2.47Zm.26-9.57a.9.9 0 1 1 1.28 1.28l-5 5a.9.9 0 0 1-1.28 0l-2.5-2.5a.9.9 0 1 1 1.28-1.28L4 13.23l4.36-4.37Z" id="user_added_outline_24__Mask" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"user_added_outline_24"}}o.d(t,{getIcon24UserAddedOutline:()=>i})},958941:(e,t,o)=>{function i(){return{icon:'<svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M16 32a1.5 1.5 0 0 1 0-3 13 13 0 1 0-12.2-8.5 1.5 1.5 0 1 1-2.81 1.04A15.97 15.97 0 0 1 0 16a16 16 0 1 1 16 16Z" fill="currentColor"/></svg>',name:"spinner_32"}}o.d(t,{getIcon32Spinner:()=>i})},117945:(e,t,o)=>{o.d(t,{getConnectionType:()=>s,saveNavigationStatEvent:()=>a,serializeNavigationStats:()=>l,saveViewerStartTime:()=>_,serializeLoadingStats:()=>c});o(821249),o(659397);var i=o(633063),r=o(979921);function s(){var e=navigator.connection;if(!e)return"";var t=e.effectiveType,o=e.downlink;switch(t){case"slow-2g":return"GPRS";case"2g":return"EDGE";case"3g":return"3G";case"4g":return o>8?"wi-fi":"LTE"}return""}var n=[];function a(e){var t=e.storyRawId,o=e.source,s=e.action,a=0,l=0;if(t){var d=(0,r.splitStoryRawId)(t);a=d[0],l=d[1]}"reply"===o&&(o="replies_list");var _={e:i.STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION,owner_id:a,story_id:l,source:o,action:s};n.push(_)}function l(){var e=n.map((e=>[e.owner_id,e.story_id,e.source,e.action].join(","))).join(";");return n=[],e}var d=[];function _(e){var t=e.storyRawId,o=e.source,n=e.time,a=(0,r.splitStoryRawId)(t),l=a[0],_=a[1],c={e:i.STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME,owner_id:l,story_id:_,source:o,time:n,internet_type:s()};d.push(c)}function c(){var e=d.map((e=>[e.owner_id,e.story_id,e.source,e.time].join(","))).join(";");return d=[],e}},878134:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var core_js_modules_es_object_entries__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(569720),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(115306),_web_legacy_ui_ui_actions_menu_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(891260),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(152278),_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(873589),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(342269),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(927766),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(769488),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(792440),uiActionsMenu={keyToggle:function(e,t){if(!(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_3__.checkKeyboardEvent)(t))return!1;var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.domClosest)("_ui_menu_wrap",e);o&&uiActionsMenu.toggle(o,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.hasClass)(o,"shown"))},keyboardToggle:function(e,t,o){if(!(0,_web_legacy_ui_ui_actions_menu_utils__WEBPACK_IMPORTED_MODULE_2__.isKeyboardActivationEvent)(t))return!1;var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.domClosest)("_ui_menu_wrap",e);i&&uiActionsMenu.toggle(i,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.hasClass)(i,"shown")),(null==o?void 0:o.preventKeyboardClickEvent)&&(null==t||null==t.preventDefault||t.preventDefault())},toggle:function toggle(el,s,options){var dummyMenu=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(el,"dummyMenu");dummyMenu&&(el=dummyMenu),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.toggleClass)(el,"shown",s);var onhide=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.attr)(el,"onHide");if(onhide&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.hasClass)(el,"shown"))try{eval(onhide)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_7__.logEvalError)(e,onhide)}if(options&&options.onToggle){var script=options.onToggle.replace("{isShow}",""+s);try{eval(script)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_7__.logEvalError)(e,script)}}},show:function(e,t,o){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidetimer");i&&(clearTimeout(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidetimer",0));var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"origMenu");if(r&&(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(r,"hidetimer"))&&(clearTimeout(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidetimer",0)),o&&o.delay){cur.uiActionsMenuShowTimeout&&clearTimeout(cur.uiActionsMenuShowTimeout);var s=o.delay;return delete o.delay,void(cur.uiActionsMenuShowTimeout=setTimeout(uiActionsMenu.show.pbind(e,t,o),s))}if(cur.uiActionsMenuShowTimeout&&(clearTimeout(cur.uiActionsMenuShowTimeout),delete cur.uiActionsMenuShowTimeout),o&&o.appendParentCls){var n,a,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.geByClass1)("_ui_menu",e);if(l){a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.domClosest)(o.appendParentCls,l),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.domClosest)("_ui_menu_wrap",e);var d=Object.entries(o.wrapAttrs||{}).reduce(((e,t)=>{var o=t[0],i=t[1];return e.push(`${o}="${i}"`),e}),[]).join(" "),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.se)(`<div class="${n.className} ui_actions_menu_dummy_wrap" onmouseover="uiActionsMenu.show(this);" onmouseout="uiActionsMenu.hide(this);" ${d}></div>`);if(_.appendChild(l),a.appendChild(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"dummyMenu",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(_,"origMenu",e),e=_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(l,"top",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getStyle)(l,"top"))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(l,"left",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getStyle)(l,"left"))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(l,"right",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getStyle)(l,"right"))),o.processHoverCls){var c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.domClosest)(o.processHoverCls,n);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_3__.addEvent)(e,"mouseover",_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.addClass.pbind(c,"hover")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_3__.addEvent)(e,"mouseout",_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.removeClass.pbind(c,"hover"))}}else e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"dummyMenu");var u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"origMenu");l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.geByClass1)("_ui_menu",e),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.domClosest)("_ui_menu_wrap",u),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.domClosest)(o.appendParentCls,l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.setStyle)(l,{display:"block"});var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getXY)(a),h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getXY)(n),v=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(l,"top"),m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(l,"left"),y=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(l,"right"),g={top:h[1]-p[1]+v};y?g.right=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getSize)(a)[0]+p[0]-h[0]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getSize)(n)[0]+y:g.left=h[0]-p[0]+m,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.setStyle)(l,g)}var f=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.geByClass1)("_ui_menu",e);if(o&&o.autopos&&f&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.hasClass)(e,"shown")){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.removeClass)(e,"ui_actions_menu_left");var w=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getXY)(e)[1],S=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getSize)(e)[1],E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getSize)(f)[1],b=o.dy||10,k=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getXY)(f)[0];(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.removeClass)(e,"ui_actions_menu_top"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.addClass)(e,"no_transition"),w+S+b+E>(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_6__.scrollGetY)()+(window.lastWindowHeight||0)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.addClass)(e,"ui_actions_menu_top"),w-b-E<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_6__.scrollGetY)()+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.getSize)("page_header_wrap")[1]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.removeClass)(e,"ui_actions_menu_top"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.toggleClass)(e,"ui_actions_menu_left",k<0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.removeClass)(e,"no_transition")}o&&o.hasOwnProperty("alwaysTop")&&f&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.hasClass)(e,"shown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.removeClass)(e,"ui_actions_menu_top"),o.alwaysTop&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.addClass)(e,"ui_actions_menu_top")),o&&o.scroll&&o.maxHeight&&(f.style.maxHeight=((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.intval)(o.maxHeight)||200)+"px",f.__uiScroll__||new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_8__.default(f)),uiActionsMenu.toggle(e,!0,o)},hide:function(e,t,o){cur.uiActionsMenuShowTimeout&&(clearTimeout(cur.uiActionsMenuShowTimeout),delete cur.uiActionsMenuShowTimeout);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidedelay");i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidedelay",!1):i=200,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidetimer")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidetimer",setTimeout((function(){uiActionsMenu.toggle(e,!1,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidetimer",0)}),i))},hideDelay:function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(e,"hidedelay",t)}};const __WEBPACK_DEFAULT_EXPORT__=uiActionsMenu},792440:(e,t,o)=>{o.r(t),o.d(t,{UiScroll:()=>_,default:()=>c});o(115306),o(323123);var i=o(840060),r=o(733164),s=o(342269),n=o(873589),a=o(152278),l=o(631351),d=o(643864);class _{constructor(e,t){if(!(e=(0,d.getScrollElement)(e)))throw new Error("uiScroll container is undefined");e.__uiScroll__&&e.__uiScroll__.destroy(),this.options=(0,s.extend)({global:!1,native:!1,theme:"default",reversed:!1,autoresize:!0,preserveEdgeBelow:!1,barMinHeight:30,preserveEdgeBelowThreshold:20,stopScrollPropagation:!0,stopScrollPropagationAlways:!1,minContentHeight:0,onmoreThreshold:null,hidden:!1,shadows:!1,scrollElements:[],onresize:null,onscroll:null,onscrollstart:null,onscrollstop:null,ondrag:null,ondragstart:null,ondragstop:null,onupdate:null,onmore:null,noForceReFlow:!1},t),this.options.native&&(this.options.shadows=!1),i.browser.mobile&&(this.options.stopScrollPropagation=!1),(0,r.isArray)(this.options.scrollElements)||(this.options.scrollElements=[]),this.removeEvents=[],this.removeElements=[],this.dragging=!1,this.dragged=!1,this.released=!0,this.noMore=!1,this.dragY=null,this.dragScroll=null,this.shadowTop=!1,this.shadowBottom=!1,this.unnecessary=!1,this.disabled=!1,this.stopped=!0,this.stoppedTimeout=null,this.fixSizeDefault=null,this.animation=null,this.barOuterHeight=null,this.barInnerHeight=null,this.currentFrame=null,this.blockerScrollTop=500,this.emitter=new EventEmitter,(0,s.isFunction)(this.options.onresize)&&this.emitter.addListener("resize",this.options.onresize),(0,s.isFunction)(this.options.onscroll)&&this.emitter.addListener("scroll",this.options.onscroll),(0,s.isFunction)(this.options.onscrollstart)&&this.emitter.addListener("scrollstart",this.options.onscrollstart),(0,s.isFunction)(this.options.onscrollstop)&&this.emitter.addListener("scrollstop",this.options.onscrollstop),(0,s.isFunction)(this.options.ondrag)&&this.emitter.addListener("drag",this.options.ondrag),(0,s.isFunction)(this.options.ondragstart)&&this.emitter.addListener("dragstart",this.options.ondragstart),(0,s.isFunction)(this.options.ondragstop)&&this.emitter.addListener("dragstop",this.options.ondragstop),(0,s.isFunction)(this.options.onupdate)&&this.emitter.addListener("update",this.options.onupdate),(0,s.isFunction)(this.options.onmore)&&this.emitter.addListener("more",this.options.onmore),this.el={container:e,overflow:(0,n.ce)("div",{className:"ui_scroll_overflow"}),outer:(0,n.ce)("div",{className:"ui_scroll_outer"},{margin:this.options.stopScrollPropagation?this.blockerScrollTop+"px 0":void 0}),inner:(0,n.ce)("div",{className:"ui_scroll_inner tt_noappend"}),shadowTop:(0,n.ce)("div",{className:"ui_scroll_shadow_top"}),shadowBottom:(0,n.ce)("div",{className:"ui_scroll_shadow_bottom"}),content:(0,n.ce)("div",{className:"ui_scroll_content clear_fix"}),barContainer:(0,n.ce)("div",{className:"ui_scroll_bar_container"}),barOuter:(0,n.ce)("div",{className:"ui_scroll_bar_outer"}),barInner:(0,n.ce)("div",{className:"ui_scroll_bar_inner"})},(0,n.data)(this.el.container,"ui-scroll",this);var o=(0,n.cf)(),l=["ui_scroll_container"];for((0,s.each)((0,r.isArray)(this.options.theme)?this.options.theme:(0,s.trim)(this.options.theme+"").split(/\s+/),(function(e,t){t&&l.push("ui_scroll_"+t+"_theme")})),(0,n.addClass)(this.el.container,l.join(" ")),this.options.hidden&&(0,n.addClass)(this.el.container,"ui_scroll_hidden");this.el.container.firstChild;)this.el.content.appendChild(this.el.container.firstChild);if(this.el.outer.appendChild(this.el.inner),this.el.inner.appendChild(this.el.content),this.options.stopScrollPropagation?(this.el.blocker=(0,n.ce)("div",{className:"ui_scroll_blocker"}),this.addEvent(this.el.blocker,"scroll",this.fixBlocker.bind(this),!0),this.el.blocker.appendChild(this.el.outer),this.el.overflow.appendChild(this.el.blocker)):this.el.overflow.appendChild(this.el.outer),o.appendChild(this.el.overflow),this.options.native?(0,n.addClass)(this.el.container,"ui_scroll_native"):(this.el.barOuter.appendChild(this.el.barInner),this.el.barContainer.appendChild(this.el.barOuter),o.appendChild(this.el.barContainer),this.options.shadows&&(this.el.overflow.appendChild(this.el.shadowTop),this.el.overflow.appendChild(this.el.shadowBottom)),i.browser.mobile||this.options.scrollElements.push(this.el.barContainer)),this.options.autoresize){var c=(0,d.addResizeSensor)(this.el.inner,this.resize.bind(this,!0)),u=(0,d.addResizeSensor)(this.el.overflow,this.resize.bind(this,!1));this.removeElements.push(c[0]),this.removeElements.push(u[0]),this.startResizeListening=function(){c[1](),u[1]()}}this.removeElements.push(this.el.overflow,this.el.barContainer),this.el.container.appendChild(o),this.options.reversed&&(this.el.outer.scrollTop=this.el.outer.scrollHeight),this.el.container.__uiScroll__=this.api={container:this.el.container,scroller:this.el.outer,content:this.el.content,emitter:this.emitter,ondragstart:this.dragstart.bind(this),ondragstop:this.dragstop.bind(this),ondrag:this.drag.bind(this),destroy:this.destroy.bind(this),disable:this.disable.bind(this,!0),enable:this.disable.bind(this,!1),scrollTop:this.scrollTop.bind(this,!0),scrollBottom:this.scrollBottom.bind(this,!0),scrollBy:this.scrollBy.bind(this),scrollIntoView:this.scrollIntoView.bind(this,!0),update:this.init.bind(this),updateAbove:this.updateAbove.bind(this),updateBelow:this.updateBelow.bind(this),data:{scrollTop:null,scrollBottom:null,scrollHeight:null,viewportHeight:null}},this.init();var p="onwheel"in this.el.outer?"wheel":void 0!==document.onmousewheel?"mousewheel":i.browser.mozilla?"MozMousePixelScroll":"DOMMouseScroll";return this.addEvent(this.el.container,p,function(e){this.animation&&this.animation.stop(),!this.disabled&&this.options.stopScrollPropagation&&(this.unnecessary?this.options.stopScrollPropagationAlways&&(0,a.cancelEvent)(e):this.isScrollEventUnused(e)?(0,a.cancelEvent)(e):(0,a.stopEvent)(e))}.bind(this),!this.options.stopScrollPropagation),this.options.native||this.addEvent(this.el.barContainer,"mousedown",this.dragstart.bind(this)),(0,s.each)(this.options.scrollElements,function(e,t){this.addEvent(t,p,function(e){this.disabled||this.unnecessary||(this.scrollBy(_.scrollEventDelta(e)),!this.options.stopScrollPropagation&&this.isScrollEventUnused(e)||(0,a.cancelEvent)(e))}.bind(this))}.bind(this)),this.options.reversed&&this.addEvent(this.el.container,"mousedown touchstart pointerdown",function(e){this.released=!1,this.noMore=!0;var t=this.addEvent(document,"mouseup contextmenu touchend pointerup",function(e){(0,a.removeEvent)(document,"mouseup contextmenu touchend pointerup",t),this.released=!0,this.noMore&&this.stopped&&!this.dragging&&(this.noMore=!1,this.more())}.bind(this))}.bind(this)),this.addEvent(this.el.outer,"scroll",function(){this.update()&&(this.stopped?(this.stopped=!1,this.emitEvent("scrollstart")):this.options.native||!1!==this.stopped||(this.stopped=0,(0,n.addClass)(this.el.container,"ui_scroll_scrolled")),this.emitEvent("scroll"),this.stoppedTimeout&&clearTimeout(this.stoppedTimeout),this.stoppedTimeout=setTimeout(function(){this.stopped||(this.stopped=!0,this.options.native||(0,n.removeClass)(this.el.container,"ui_scroll_scrolled"),this.emitEvent("scrollstop"),this.noMore&&this.released&&!this.dragging&&(this.noMore=!1,this.more()))}.bind(this),200))}.bind(this)),this.api}init(){if(this.options.stopScrollPropagation&&this.fixBlocker(),!this.inited){if(!this.el.container.scrollWidth||this.disabled)return;this.fixSize(!0),this.options.autoresize&&this.startResizeListening(),this.options.global||cur.destroy.push(this.destroy.bind(this)),this.inited=!0}return this.update(!0),this.api}addEvent(e,t,o,i){return this.removeEvents.push([e,t,o]),(0,a.addEvent)(e,t,o,void 0,void 0,i?{passive:!0}:void 0),o}destroy(){if(this.disabled=!0,this.fixSize(),this.animation&&this.animation.stop(),this.moreTimeout&&clearTimeout(this.moreTimeout),this.dragstopHandler&&(0,a.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,a.removeEvent)(document,"mousemove",this.dragHandler),(0,s.each)(this.removeEvents,(function(e,t){a.removeEvent.apply(null,t)})),this.el.overflow.parentNode==this.el.container){for(var e=(0,n.cf)();this.el.content.firstChild;)e.appendChild(this.el.content.firstChild);this.el.container.appendChild(e)}return(0,n.removeData)(this.el.container,"ui-scroll"),this.el.container.className=this.el.container.className.replace(/\bui_scroll_.+?\b/g," "),(0,s.each)(this.removeElements,(function(e,t){(0,n.re)(t)})),this.el.container.scrollTop=this.api.data.scrollTop,delete this.el.container.__uiScroll__,this.api}updateAbove(e){if((0,s.isFunction)(e)){this.animation&&this.animation.stop();var t=this.el.outer.scrollHeight-this.el.outer.scrollTop-this.el.overflow.offsetHeight;e(),this.el.outer.scrollTop=this.el.outer.scrollHeight-this.el.overflow.offsetHeight-t}return this.api}updateBelow(e){if((0,s.isFunction)(e)){this.animation&&this.animation.stop();var t=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;e(),t&&this.scrollBottom(!1)}return this.api}fixBlocker(){i.browser.chrome&&!this.options.noForceReFlow&&this.forceReFlow(),this.el.blocker.scrollTop=this.blockerScrollTop}forceReFlow(){this.el.blocker.style.display="inline-block",this.el.blocker.offsetHeight,this.el.blocker.style.display=""}fixSize(e){this.options.native||(e&&null==this.fixSizeDefault&&(this.fixSizeDefault=this.el.container.style.width),(0,n.setStyle)(this.el.container,"width",e?(0,n.getSize)(this.el.container,!0)[0]||this.fixSizeDefault||"":this.fixSizeDefault||""))}emitEvent(e){this.disabled||this.inited&&this.emitter.emitEvent(e,[this.api])}static scrollEventDelta(e){var t=0,o=void 0!==e.deltaMode?e.deltaMode:"MozMousePixelScroll"==e.type?0:1;return"wheel"==e.type?t=e.deltaY:void 0!==e.wheelDeltaX&&void 0!==e.wheelDeltaY?(t=1/40*-e.wheelDeltaY,i.browser.mac&&i.browser.opera&&(t*=.1)):void 0!==e.wheelDelta?t=1/40*-e.wheelDelta:e.detail&&2===e.axis&&(t=e.detail),t*(1==o?15:2==o?450:1)}isScrollEventUnused(e){return _.scrollEventDelta(e)>0?!this.api.data.scrollBottom:!this.api.data.scrollTop}resize(e){if(!e&&this.options.preserveEdgeBelow){var t=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;this.update(!0)&&(this.emitEvent("resize"),t&&this.scrollBottom(),this.options.stopScrollPropagation&&!e&&this.fixBlocker())}else this.update(!0)&&(this.options.stopScrollPropagation&&!e&&this.fixBlocker(),this.emitEvent("resize"))}disable(e){return this.disabled=!!e,e?(this.animation&&this.animation.stop(),this.fixSize()):(this.fixSize(!0),this.options.stopScrollPropagation&&this.fixBlocker(),this.update(!0)),(0,n.toggleClass)(this.el.container,"ui_scroll_disabled",this.disabled),this.api}dragstart(e){if(!(this.disabled||this.dragging||this.options.native))return e||(e=window.event),this.dragging=!0,this.animation&&this.animation.stop(),this.options.reversed&&(this.noMore=!0),(0,a.addEvent)(document,"mouseup contextmenu",this.dragstartHandler=this.dragstop.bind(this)),(0,a.addEvent)(document,"mousemove",this.dragHandler=this.drag.bind(this)),this.dragScroll=this.options.reversed?this.api.data.scrollBottom:this.api.data.scrollTop,this.dragY=e.screenY,(0,a.cancelEvent)(e),this.emitEvent("dragstart"),this.api}dragstop(e){if(!this.disabled&&this.dragging&&!this.options.native){if(e||(e=window.event),this.dragging=!1,this.dragstopHandler&&(0,a.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,a.removeEvent)(document,"mousemove",this.dragHandler),(0,n.setStyle)(document.body,"cursor",""),(0,n.removeClass)(this.el.container,"ui_scroll_dragging"),this.dragged)this.noMore&&(this.noMore=!1,this.more());else{this.options.reversed&&(this.noMore=!0);var t=(e.pageY-(0,n.getXY)(this.el.barOuter)[1]-this.barInnerHeight/2)*(Math.max(this.options.minContentHeight,this.api.data.scrollHeight)-this.api.data.viewportHeight)/(this.barOuterHeight-this.barInnerHeight);this.scrollTop(!1,t,0,function(){this.noMore&&(this.noMore=!1,this.more())}.bind(this))}return this.dragged=!1,e&&"contextmenu"!==e.type&&(0,a.cancelEvent)(e),this.emitEvent("dragstop"),this.api}}drag(e){if(!this.disabled&&this.dragging&&!this.options.native){e||(e=window.event);var t=(e.screenY-this.dragY)*(this.api.data.scrollHeight/this.el.barOuter.scrollHeight);return this.el.outer.scrollTop=this.options.reversed?this.el.outer.scrollHeight-this.el.overflow.offsetHeight-this.dragScroll+t:this.dragScroll+t,this.dragged||(this.dragged=!0,(0,n.setStyle)(document.body,"cursor","pointer"),(0,n.addClass)(this.el.container,"ui_scroll_dragging")),(0,a.cancelEvent)(e),this.emitEvent("drag"),this.api}}scroll(e,t,o){return this.animation&&this.animation.stop(),this.el.outer.scrollTop==e&&this.update(!0),t?(t="number"!=typeof t||!isFinite(t)||t%1?300:Math.abs(t),this.animation=new l.Fx.Base({scrollTop:this.el.outer.scrollTop},{transition:l.Fx.Transitions.easeOutCubic,onStep:function(e){this.el.outer.scrollTop=e.scrollTop}.bind(this),duration:t,onComplete:(0,s.isFunction)(o)?o.pbind(this.api):void 0}).start({scrollTop:this.el.outer.scrollTop},{scrollTop:e})):(this.el.outer.scrollTop=e,(0,s.isFunction)(o)&&o(this.api)),this.api}scrollTop(e,t,o,i){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll((0,s.intval)(t),o,i)}scrollBottom(e,t,o,i){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollHeight-this.el.overflow.offsetHeight-(0,s.intval)(t),o,i)}scrollBy(e,t,o){if(!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollTop+(0,s.intval)(e),t,o)}scrollIntoView(e,t,o,i){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),(t=(0,d.getScrollElement)(t))&&t.compareDocumentPosition&&t.compareDocumentPosition(this.el.content)&Node.DOCUMENT_POSITION_CONTAINS){var r=(0,n.getXY)(t)[1],a=(0,n.getXY)(this.el.overflow)[1],l=(0,n.getSize)(t)[1];if(r<=a&&r+l>=a+this.api.data.viewportHeight||r>=a&&r+l<=a+this.api.data.viewportHeight)(0,s.isFunction)(i)&&(o?setTimeout(i.bind(this.api),0):i(this.api));else if(l>this.api.data.viewportHeight||r<a)this.scrollTop(!1,r-a+this.api.data.scrollTop-(this.options.shadows?(0,n.getSize)(this.el.shadowTop)[1]:0),o,i);else{var _=this.options.shadows?(0,n.getSize)(this.el.shadowBottom)[1]:0;this.scrollTop(!1,r-a+this.api.data.scrollTop+l-this.api.data.viewportHeight+_,o,i)}}return this.api}update(e){var t,o;this.el.container&&!this.el.container.updateScroll&&(this.el.container.updateScroll=this.update.bind(this,!1));var i=this.el.outer.scrollTop;if(this.inited&&!this.disabled&&(e&&(t=this.el.inner.offsetHeight,this.api.data.viewportHeight!==(this.api.data.viewportHeight=this.el.overflow.offsetHeight)||this.api.data.scrollHeight!==t)||this.api.data.scrollTop!==i)){if(e&&(this.api.data.scrollHeight=t),this.api.data.scrollTop=Math.max(0,Math.min(this.api.data.scrollHeight-this.api.data.viewportHeight,Math.max(0,i))),this.api.data.scrollBottom=Math.max(0,this.api.data.scrollHeight-this.api.data.scrollTop-this.api.data.viewportHeight),!this.options.native){if(!(o=(t=Math.max(this.options.minContentHeight,this.api.data.scrollHeight))<=this.api.data.viewportHeight)){var r=this.el.barOuter.offsetHeight;(e||this.barOuterHeight!==r)&&(this.barOuterHeight=r,this.barInnerHeight=Math.max(this.options.barMinHeight,this.barOuterHeight*this.api.data.viewportHeight/t),this.el.barInner.style.height=this.barInnerHeight+"px"),(0,d.nextFrame)((()=>{var e=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(t-this.api.data.viewportHeight);this.el.barInner.style.transform=`translateY(${e}px)`}))}this.options.shadows&&(this.shadowTop!=(this.api.data.scrollTop&&!o)&&(0,n.toggleClass)(this.el.container,"ui_scroll_shadow_top_visible",this.shadowTop=this.api.data.scrollTop&&!o),this.shadowBottom!=(this.api.data.scrollBottom&&!o)&&(0,n.toggleClass)(this.el.container,"ui_scroll_shadow_bottom_visible",this.shadowBottom=this.api.data.scrollBottom&&!o)),this.unnecessary!==o&&((0,n.toggleClass)(this.el.container,"ui_scroll_unnecessary",o),this.unnecessary=o,this.options.stopScrollPropagation&&this.fixBlocker(),o&&this.barInnerHeight&&this.barOuterHeight&&(0,d.nextFrame)(function(e){this.el.barInner.style.height=100*this.barInnerHeight/this.barOuterHeight+"%";var o=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(t-this.api.data.viewportHeight)*100/this.barInnerHeight;this.el.barInner.style.transform=`translateY(${o}%)`}.bind(this)))}return this.emitEvent("update"),(!this.options.reversed||i>=0)&&this.more(),!0}return!1}more(){var e=this.options.reversed?this.api.data.scrollTop:this.api.data.scrollBottom,t=null!==this.options.onmoreThreshold?this.options.onmoreThreshold:2*this.api.data.viewportHeight;!this.noMore&&e<=t&&this.emitEvent("more")}}_.addResizeSensor=d.addResizeSensor;const c=_},643864:(e,t,o)=>{o.d(t,{nextFrame:()=>d,getScrollElement:()=>_,addResizeSensor:()=>c});var i,r=o(342269),s=o(873589),n=o(840060),a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(e=>setTimeout(e,1)),l=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;function d(e){i&&l(i),i=a(e)}function _(e){return(0,r.isString)(e)&&"_"===e[0]?(0,s.geByClass1)(e):(0,s.ge)(e)}function c(e,t){if((e=_(e))&&(0,r.isFunction)(t)){if(n.browser.msie9||n.browser.opera&&n.browser.version<13){var o=!1,i=!1,a=(0,s.ce)("object",{type:"text/html",className:"ui_scroll_resize_object",data:"about:blank",onload:function(){i=!0,o&&v()}});function v(){if(!a.contentDocument)return setTimeout(v,100);a.contentDocument.defaultView.removeEventListener("resize",t),a.contentDocument.defaultView.addEventListener("resize",t),t()}return e.appendChild(a),e.__resizeSensor__=[a,function(){o=!0,i&&v()}]}var l=(0,s.ce)("div",{className:"ui_scroll_resize_sensor"}),d=(0,s.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_expand"}),c=(0,s.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_shrink"}),u=(0,s.ce)("div"),p=(0,s.ce)("div"),h=null;return d.appendChild(u),c.appendChild(p),l.appendChild(d),l.appendChild(c),e.appendChild(l),e.__resizeSensor__=[l,d.onscroll=c.onscroll=function(){var o=(e.offsetWidth||1e4)+10,i=(e.offsetHeight||1e4)+10;u.style.width=o+"px",u.style.height=i+"px",d.scrollLeft=o,d.scrollTop=i,c.scrollLeft=o,c.scrollTop=i,h!==(h=o+" "+i)&&t()}]}}},456495:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(892222),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(682772),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(140561),core_js_modules_es_object_assign__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(319601),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(804723),_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(873589),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822560),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(342269),_web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(517920),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(152278),_web_legacy_ui_ui_tabs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(636870),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(840060),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(769488),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(927766);function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},_extends.apply(this,arguments)}var SEARCH_FOCUSED_CLASS="search_focused",uiSearch={destroy:function(e){var t=uiSearch.getFieldEl(e);uiSearch.stopEvents(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.removeData)(t)},getWrapEl:function(e){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domClosest)("_wrap",e)},getFieldEl:function(e){return e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.ge)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.hasClass)("_field",e)?e:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domByClass)(uiSearch.getWrapEl(e),"_field")},stopEvents:function(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"eventHandlers")||[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.each)(t,(function(e,t){t.stop()}))},startEvents:function(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"eventHandlers")||[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.each)(t,(function(e,t){t.stop(),t.start()}))},init:function init(el,options){if(el&&(el=uiSearch.getFieldEl(el),el)){var wrapEl=uiSearch.getWrapEl(el),delayedInitOptions=!options&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domData)(wrapEl,"init-options");if(delayedInitOptions){var evalScript="(function() { return "+delayedInitOptions+" })()";try{var _initOptions$suggeste,initOptions=eval(evalScript);(null==initOptions||null==(_initOptions$suggeste=initOptions.suggester)?void 0:_initOptions$suggeste.useCatalogSuggest)?setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domData)(wrapEl,"init-options",null)),0):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domData)(wrapEl,"init-options",null),uiSearch.init(el,initOptions)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__.logEvalError)(e,evalScript)}}else if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(el,"inited")){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(el,"inited",1);var onKeyDown=uiSearch.onKeyDown.pbind(el),onBuffer=function(e){if("input"===e.type&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_11__.browser.msie){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.val)(el);if(t===((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domData)(el,"prev-value")||""))return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domData)(el,"prev-value",t)}setTimeout(uiSearch.onChanged.pbind(el,!1,e),0)};(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_6__.placeholderInit)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(el,"opts",options);var onFocus=e=>{if(options.focusedModifierTargetSelector){var t=document.querySelector(options.focusedModifierTargetSelector);null==t||t.classList.add(SEARCH_FOCUSED_CLASS)}null==options.onFocus||options.onFocus(e)},onBlur=e=>{if(options.focusedModifierTargetSelector){var t=document.querySelector(options.focusedModifierTargetSelector);null==t||t.classList.remove(SEARCH_FOCUSED_CLASS)}null==options.onBlur||options.onBlur(e)},mainHandler;if(options.suggester){var _options$suggester;options.suggester.useCatalogSuggest=!!(null==options||null==(_options$suggester=options.suggester)?void 0:_options$suggester.useCatalogSuggest),options.suggester.useCatalogSuggest||(options.suggester.instance=new Suggester(el,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.extend)(options.suggester,{type:options.suggester.type,historyItems:!!options.suggester.history&&options.suggester.historyItems,onSearch:function(e,t,o,i,r){e||(options.allowFiltersForEmpty||uiSearch.removeAllFilters(el),uiSearch.hideProgress(el)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.toggleClass)(wrapEl,"ui_search_field_empty",!e),options.onChange&&options.onChange.call(el,e,t,o,i,r)}}))),mainHandler={start:function(){onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(el,"focus",onFocus)},stop:function(){onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(el,"focus",onFocus)}}}else{var searchBtn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.geByClass1)("_ui_search_button_search",wrapEl),onBtnClick=function(e){uiSearch.onEnter(el,e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.elfocus)(el)};mainHandler={start:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(el,"keydown",onKeyDown),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(el,"paste cut input",onBuffer),onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(el,"focus",onFocus),searchBtn&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(searchBtn,"click",onBtnClick)},stop:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(el,"keydown",onKeyDown),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(el,"paste cut input",onBuffer),onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(el,"focus",onFocus),searchBtn&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(searchBtn,"click",onBtnClick)}}}if(mainHandler.start(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(el,"eventHandlers",[mainHandler]),options.params){var _options$suggester2,_options$suggester3,content=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.trim)(options.params.html)),newOptions=(null==options||null==(_options$suggester2=options.suggester)?void 0:_options$suggester2.useCatalogSuggest)?{forceSide:"bottom",setPos:()=>({left:"auto",top:"52px"})}:{};options.paramsTooltip=new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_8__.ElementTooltip((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.geByClass1)("_ui_search_params_button",wrapEl),_extends({appendTo:wrapEl,content,autoShow:!1,customShow:!0,shift:options.params.shift?options.params.shift:0,offset:[0,-2]},newOptions)),options.paramsTooltip.build(),(null==options||null==(_options$suggester3=options.suggester)?void 0:_options$suggester3.useCatalogSuggest)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(options.paramsTooltip._ttel,{right:0}),setTimeout((function(){(function initScript(){try{eval(options.params.script)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__.logEvalError)(e,options.params.script)}}).call(el)}))}options.fixed&&uiSearch.setFixed(el),options.noAutoDestroy||cur.destroy.push(uiSearch.stopEvents.pbind(el)),uiSearch.initFilters(el,options),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.isFunction)(options.onInit)&&options.onInit(el,options)}}},getOptions:function(e){var t;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.hasClass)(e,"_field"))t=e;else{var o=uiSearch.getWrapEl(e);t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.geByClass1)("_field",o)}return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(t,"opts")||{}},toggleParameters:function(e){var t=uiSearch.getOptions(e);t.paramsTooltip&&t.paramsTooltip.toggle()},hideParameters:function(e){var t=uiSearch.getOptions(e);t&&t.paramsTooltip&&t.paramsTooltip.hide()},saveHistorySearch:function(e,t,o,i,r,s){t||(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.val)(e));var n=uiSearch.getOptions(e);n.suggester&&n.suggester.instance&&n.suggester.instance.saveHistoryItem(t,o,i,r,s)},onEnter:function(e,t){e=uiSearch.getFieldEl(e);var o=uiSearch.getOptions(e),i=e.getValue?e.getValue():e.value;return o.onEnter&&o.onEnter(e,i,t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t)},onKeyDown:function(e,t){if(cur.preventInputActions&&-1!=[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.RETURN,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.ESC,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.DOWN,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.UP].indexOf(t.keyCode))return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t);if(t.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.RETURN)return uiSearch.onEnter(e,t);if(t.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.ESC){var o=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.val)(e);return uiSearch.reset(e,!1,t),!o||(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t)}setTimeout.pbind(uiSearch.onChanged.pbind(e,!1,t),0)},onChanged:function(e,t,o){e=uiSearch.getFieldEl(e);var i=uiSearch.getOptions(e),r=uiSearch.getWrapEl(e),s=e.getValue?e.getValue():e.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.toggleClass)(r,"ui_search_field_empty",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.trim)(s)),s||i.allowFiltersForEmpty||uiSearch.removeAllFilters(e),t||i.onChange&&i.onChange.call(e,s,o)},focus:function(e){e=uiSearch.getFieldEl(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.elfocus)(e)},reset:function(e,t,o){e=uiSearch.getFieldEl(e);var i=uiSearch.getOptions(e),r=uiSearch.getWrapEl(e);(e.getValue?e.getValue():e.value)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.val)(e,""),uiSearch.onChanged(e,t,o),t||i.onEnter&&i.onEnter(e,""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.elfocus)(e)):i.in_tabs&&_web_legacy_ui_ui_tabs__WEBPACK_IMPORTED_MODULE_10__.default.hideSearch(r),window.tooltips&&tooltips.destroyAll()},showProgress:function(e){e=uiSearch.getFieldEl(e);var t=uiSearch.getWrapEl(e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.addClass)(t,"ui_search_loading");var o=e.getValue?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.trim)(e.getValue()):e.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.toggleClass)(t,"ui_search_field_empty",!o)},hideProgress:function(e){e=uiSearch.getFieldEl(e);var t=uiSearch.getWrapEl(e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.removeClass)(t,"ui_search_loading");var o=e.getValue?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.trim)(e.getValue()):e.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.toggleClass)(t,"ui_search_field_empty",!o)},scrollResize:function(e){if(!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_11__.browser.mobile){e=uiSearch.getFieldEl(e);var t,o=uiSearch.getWrapEl(e),i=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domPN)(o),r=o&&o.classList.contains("ui_search_fixed"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.ge)(cur.uiSearchPageBlock)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.gpeByClass)("page_block",e),n=vk.staticheader?Math.max(0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.ge)("page_header"))[1]-scrollNode.scrollTop):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.ge)("page_header"))[1],a=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.isAncestor)(o,boxLayerWrap);if(o&&i&&(a||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.gpeByClass)("scroll_fix",o))&&(!e.ignoreFixed||r)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.isVisible)(i))if(a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getXY)(i,!0)[1]<0:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getXY)(i,!0)[1]<n){var l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getStyle)(o.classList.contains("ui_search_new")?o:e,"width"));!r&&l&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(i,"height",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getSize)(o)[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(o,"width",l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.addClass)(o,"ui_search_fixed"));var d=Math.min(0,Math.max(-document.body.scrollLeft,document.body.clientWidth-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.ge)("page_layout"))[0]));if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(o,{marginLeft:d}),s){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getXY)(s)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.getSize)(s)[1]-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_13__.scrollGetY)()-e.offsetHeight;(t=Math.min(n,Math.max(-e.offsetHeight,_)))!==cur.lastUISearchPos&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(o,"top",t),cur.lastUISearchPos=t)}}else r&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(i,"height",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(o,{top:"",marginLeft:""}),cur.lastUISearchPos=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.removeClass)(o,"ui_search_fixed"))}},setStatic:function(e){e.ignoreFixed=!0;var t=uiSearch.getWrapEl(e),o=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domPN)(t);t&&o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(o,"height",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.setStyle)(t,{top:"",marginLeft:""}),cur.lastUISearchPos=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.removeClass)(t,"ui_search_fixed"))},setFixed:function(e){if(e.ignoreFixed=!1,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"resizeEventHandler")){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.isAncestor)(e,boxLayerWrap)?boxLayerWrap:window,o=uiSearch.scrollResize.pbind(e),i={stop:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent.pbind(t,"scroll",o),start:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent.pbind(t,"scroll",o)};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"eventHandlers",((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"eventHandlers")||[]).concat([i])),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"resizeEventHandler",!0),i.start()}uiSearch.scrollResize(e)},initFilters:function(e,t){if(e){var o=uiSearch.getWrapEl(e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.geByClass1)("ui_search_fltr_control",o),r={start:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(i,"click",(function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.hasClass)(i,"shown")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.hasClass)(e.target,"ui_search_fltr_control")||n(i)})),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(i,"mouseover",(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.hasClass)(i,"shown")){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"hidetimer");e&&(clearTimeout(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"hidetimer",0)),n(i,!0)}})),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(i,"mouseout",(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"hidetimer")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"hidetimer",setTimeout((function(){n(i,!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"hidetimer",0)}),200))}))},stop:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent.pbind(i,"click mouseover mouseout")};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"eventHandlers",((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"eventHandlers")||[]).concat([r])),r.start();var s=uiSearch._getFiltersPane(e);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(s,"click",(function(t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.hasClass)(t.target,"token_title")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.hasClass)(t.target,"token_del")){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.gpeByClass)("token",t.target),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.domData)(o,"id");uiSearch.removeFilter(e,i)}}))}function n(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.toggleClass)(e,"shown",t)}},removeAllFilters:function(e){var t=uiSearch._getFiltersPane(e),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(t,"cur_filters");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.each)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.extend)({},o),(function(t){uiSearch.removeFilter(e,t,!0)}))},toggleFilter:function(e,t,o,i){i?uiSearch.addFilter(e,t,o):uiSearch.removeFilter(e,t)},addFilter:function(e,t,o){if(t&&o){var i=uiSearch._getFiltersPane(e),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"cur_filters")||{};r[t]=o,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"cur_filters",r);var s=uiSearch.getOptions(e);s.onFiltersChanged&&s.onFiltersChanged(r),uiSearch._renderFilters(e)}},removeFilter:function(e,t,o){var i=uiSearch._getFiltersPane(e),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"cur_filters")||{};if(r[t]){delete r[t],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(i,"cur_filters",r);var s=uiSearch.getOptions(e);s.onFilterRemoved&&s.onFilterRemoved(t,e,o),s.onFiltersChanged&&s.onFiltersChanged(r),uiSearch._renderFilters(e)}},_getFiltersPane:function(e){var t=uiSearch.getWrapEl(e)||e;return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.geByClass1)("ui_search_filters_pane",t)},_renderFilters:function(e){clearTimeout((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"renderFiltersTO")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(e,"renderFiltersTO",setTimeout(uiSearch._doRenderFilters.pbind(e)))},_doRenderFilters:function(e){var t=uiSearch._getFiltersPane(e),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.data)(t,"cur_filters")||{},i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.geByClass1)("ui_search_filters",t);if(i)if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.isEmpty)(o))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.removeClass)(t,"expanded"),setTimeout((function(){i.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.hide)(t)}),200);else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.show)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.addClassDelayed)(t,"expanded");var r=[],s={},n=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.each)(o,(function(e,t){var o=!1,i=!1,a=e.match(/(.*?)_([^_]+)$/),l=a&&a[2]||!1;(a=a&&a[1]||!1)&&(void 0!==s[a]&&"from"===l?i=s[a]:void 0!==s[a]&&(o=s[a]+1),s[a]=n);var d=`<div class="token" id="token${e}" data-id="${e}">\n                         <div class="token_title">${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.replaceEntities)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.clean)(t))}</div>\n                         <div class="token_del"></div>\n                       </div>`;!1!==i?r.splice(i,0,d):!1!==o?r.splice(o,0,d):r.push(d),n++})),i.innerHTML=r.join("")}}};const __WEBPACK_DEFAULT_EXPORT__=uiSearch},636870:(e,t,o)=>{o.d(t,{default:()=>c});var i=o(873589),r=o(342269),s=o(840060),n=o(152278),a=o(368752),l=o(660080),d=o(997109),_={initTabs:function(e,t,o){if(void 0===o&&(o=!0),!(s.browser.msie&&(0,r.intval)(s.browser.version)<10||s.browser.opera&&(0,r.intval)(s.browser.version)<15||(0,i.hasClass)(e,"ui_tabs_sliding"))){var n=(0,i.getSize)(t)[0],a=t.offsetLeft,l=(0,i.geByClass1)("_ui_tabs_slider",e);if(l&&!(0,i.domData)(e,"inited")){var d={width:n+"px",marginLeft:a};(0,i.setStyle)(l,d)}o&&_.tryInitTabsScroll(e)}},tryInitTabsScroll:function(e){var t=e.querySelector(".js-tabs-scroll:not(.js-tabs-scroll-inited)");if(t){t.classList.add("js-tabs-scroll-inited");var o=new l.UIGallery(t,{scrollY:!1}),i=(0,a.debounce)((()=>{o.refresh()}),200);window.addEventListener("resize",i),(0,d.pushNavDestroy)((()=>{o.destroy(),window.removeEventListener("resize",i)}))}},tryInit:function(e,t){if(void 0===t&&(t=!0),!(0,i.domData)(e,"inited")){var o=(0,i.geByClass1)("ui_tab_group_sel",e)||(0,i.geByClass1)("ui_tab_sel",e);o&&_.initTabs(e,o,t),(0,i.domData)(e,"inited",1)}},goTab:function(e,t,o,r){if(void 0===r&&(r=!1),(0,n.checkEvent)(t))return!0;var s=(0,i.gpeByClass)("ui_tabs",e);return!(!o&&(0,i.geByClass1)("ui_tab_sel",s)==e)&&(_.switchTab(e),_.showProgress(s),nav.go(e,t,{tab:e,noframe:r}))},switchTab:function(e,t){var o=(0,i.gpeByClass)("ui_tabs",e),s=(0,i.geByClass1)("ui_tab_sel",o),n=null,a=null,l=(0,i.hasClass)(s,"ui_tab_group_item")?a=(0,i.gpeByClass)("ui_tab_group",s):s,d=(0,i.hasClass)(e,"ui_tab_group_item")?n=(0,i.gpeByClass)("ui_tab_group",e):e;if(e!=s){if(e!=d&&(_.toggleGroup(d,!1),_.resetLabel(d,e)),l){_.initTabs(o,l),t=t||{};var c=(0,i.geByClass1)("_ui_tabs_slider",o);if(c){t.noAnim||d===l||((0,i.addClass)(o,"ui_tabs_sliding"),clearTimeout(cur.tabSlidingTO),cur.tabSlidingTO=setTimeout(i.removeClass.pbind(o,"ui_tabs_sliding"),300));var u=(0,r.intval)(c.style.marginLeft),p={width:(0,i.getSize)(d)[0]+"px"};p[cssTransformProp]="translateX("+(d.offsetLeft-u)+"px)",(0,i.setStyle)(c,p)}s!=l&&d!=l&&_.resetLabel(l),l!=s&&(0,i.removeClass)(l,"ui_tab_group_sel"),(0,i.removeClass)(s,"ui_tab_sel")}if(d!=e&&(0,i.addClass)(d,"ui_tab_group_sel"),(0,i.addClass)(e,"ui_tab_sel"),a&&(0,i.removeClass)(a,"ui_tab_hide_separator"),n){o=(0,i.geByClass1)("ui_tab_group_items",n,"div").children;var h=null;(0,r.each)(o,(function(e,t){"SPAN"===t.tagName?h=t:(0,i.hasClass)((0,i.domFC)(t),"ui_tab_sel")||(0,i.hasClass)(t,"unshown")||(h=null)})),h&&(0,i.addClass)(n,"ui_tab_hide_separator")}}return!1},resetLabel:function(e,t){var o=(0,i.geByClass1)("ui_tab_group_label",e,"span");o&&(o.innerHTML=(t||o).getAttribute("data-default-label"))},toggleGroup:function(e,t){var o=(0,i.data)(e,"visibletimer");o&&clearTimeout(o),(0,i.data)(e,"visibletimer",setTimeout(i.toggleClass.pbind(e,"visible",t),t?0:100)),(0,i.toggleClass)(e,"shown",t)},showGroup:function(e){var t=(0,i.data)(e,"hidetimer");t&&(clearTimeout(t),(0,i.data)(e,"hidetimer",0)),_.toggleGroup(e,!0)},hideGroup:function(e){(0,i.data)(e,"hidetimer")||(0,i.data)(e,"hidetimer",setTimeout((function(){_.toggleGroup(e,!1),(0,i.data)(e,"hidetimer",0)}),200))},showProgress:function(e){(0,i.hasClass)(e,"ui_tabs")||(e=(0,i.gpeByClass)("ui_tabs",e)),(0,i.addClass)(e,"ui_tabs_loading")},hideProgress:function(e){(0,i.hasClass)(e,"ui_tabs")||(e=(0,i.gpeByClass)("ui_tabs",e)),(0,i.removeClass)(e,"ui_tabs_loading")},showSearch:function(e,t){if(cur.viewAsBox)return cur.viewAsBox();if((0,n.checkEvent)(t))return!0;var o=(0,i.gpeByClass)("ui_tabs",e),r=(0,i.domByClass)(o,"_field");return(0,i.addClass)(o,"ui_tabs_search_opened"),uiSearch.focus(r),!1},hideSearch:function(e,t){if((0,n.checkEvent)(t))return!0;var o=(0,i.gpeByClass)("ui_tabs",e);return(0,i.removeClass)(o,"ui_tabs_search_opened"),!1},scrollToActiveTab(e){var t=document.querySelector(`#${e}`);if(t){var o=t.querySelector(".ui_tab_sel, .ui_tab_group_sel"),i=t.querySelector(`.${l.UI_GALLERY_CONTENT_CLASSNAME}`);if(o&&i){var r=o.offsetLeft,s=r+o.offsetWidth,n=i.scrollLeft,a=i.clientWidth,d=n+a,_=r-20,c=s+20;_<n?i.scrollTo({left:_}):c>d&&i.scrollTo({left:c-a})}}}};const c=_},879622:(e,t,o)=>{o.d(t,{VISIBILITY_ACCESS_OPTIONS:()=>i,MIN_NFT_IMAGE_SIZE:()=>r,REPLY_IMAGE_DEFAULT_SIZE:()=>s,REPLY_IMAGE_SMALL_SIZE:()=>n,EVENT_REPLY_FIELD_IS_NFT_INDEX:()=>a});var i={PUBLIC:0,ONLY_FRIENDS:1,ONLY_BEST_FRIENDS:2},r=29,s=34,n=24,a=16},577438:(e,t,o)=>{o.d(t,{VideoChat:()=>h});var i=o(873589),r=o(733164),s=o(822560),n=o(152278),a=o(342269),l=o(290846),d=o(770383),_=o(186699),c=o(70162),u=o(287503),p=o(317076),h={SCROLL_EDGE_BELOW_THRESHOLD:20,MAX_COMMENTS_NUM:150,MAX_LIKES_PER_BATCH:7,MAX_STICKERS_PER_BATCH:7,init(e,t){h.block&&h.destroy(),e&&(h.block=e,h.options=(0,a.extend)({},t),h.messagesWrap=(0,i.domByClass)(e,"mv_chat_messages_wrap"),h.stickersWrap=(0,i.domByClass)(e,"mv_chat_stickers_wrap"),h.scroll=new uiScroll((0,i.domFC)(h.messagesWrap),{global:!0,hidden:t.scrollHidden,reversed:!0,preserveEdgeBelow:!0,preserveEdgeBelowThreshold:h.SCROLL_EDGE_BELOW_THRESHOLD,theme:"videoview",onupdate:h.onScrollUpdate}),this.scrollBottomBtnWrap=(0,i.domByClass)(e,"mv_chat_new_messages_btn_wrap"),h.replyForm=(0,i.domByClass)(e,"mv_chat_reply_form"),h.replyForm&&(h.replyInput=(0,i.domByClass)(e,"mv_chat_reply_input"),h.initReplyInput()),h.firstMsgIntro=(0,i.domByClass)(e,"mv_chat_first_message_intro"))},initReplyInput(){(0,s.placeholderInit)(h.replyInput,{editable:!0,global:!0}),window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){var e=Emoji.init(h.replyInput,{forceStickerPack:h.options.forceStickerPack,controlsCont:h.replyForm,noLineBreaks:1,noCtrlSend:1,noStickers:!!h.options.noStickers,ref:"video_chat",onSend:function(){h.sendMessage()},checkEditable:function(){h.checkFormHeight(),h.checkTextLen()},onStickerSend:function(e){h.sendSticker(e)}});(0,i.data)(h.replyForm,"optId",e)}))},checkFormHeight(){var e=h.replyForm,t=e.offsetHeight;if(e.lastHeight!==t){e.lastHeight=t;var o=!h.scroll.data.scrollBottom;(0,i.setStyle)(h.messagesWrap,{bottom:t+"px"}),o&&h.scroll.scrollBottom()}},checkTextLen(e){void 0===e&&(e=h.replyInput);var t=(0,a.trim)(Emoji.editableVal(e));if(e.lastLen!==t.length)if((e.lastLen=t.length)>mvcur.maxChatReplyLength){var o=cur.storyLayer?(0,c.getLang)("stories_live_chat_msg_too_long"):(0,c.getLang)("video_live_chat_msg_too_long");(0,l.showTooltip)(e,{black:1,text:o,shift:!!cur.storyLayer&&[-30,10]})}else window.tooltips&&tooltips.destroy(e)},mentionOver:e=>window.mentionOver(e,{shift:[-20,7,7]}),stickerClick:(e,t,o)=>(window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.clickSticker(e,t,o)})),!1),onScrollUpdate(e){e.data.scrollBottom<h.SCROLL_EDGE_BELOW_THRESHOLD&&h.toggleScrollBottomBtn(!1)},receiveMessage(e,t,o,i,r,s,n,l,d,_,c){if((0,a.intval)(d))h.appendSticker(d,o);else{var v=!1;window.replyAsList&&window.replyAsList.length&&(0,a.each)(window.replyAsList,(function(){if(this[0]==o)return v=!0,!1}));var m=Videoview.getMvData(),y=m.adminLevel,g=m.canDeleteComments,f="";m.canReportComments&&e!=vk.id&&o!=vk.id&&!v&&(f+=(0,a.getTemplate)("video_chat_message_action_report",{video_owner_id:e,msg_id:t})),(y>u.GroupAdminLevel.USER||g||e==vk.id||o==vk.id||v)&&(f+=(0,a.getTemplate)("video_chat_message_action_del",{video_owner_id:e,msg_id:t}));var w=i;c&&(w+='<div class="mv_page_verified">'+(0,p.getIcon12Verified)().icon+"</div>");var S=(0,a.getTemplate)("video_chat_message",{author_href:s,author_photo:r,author_name:w,message:l,video_owner_id:e,msg_id:t,actions:f,classes:o==e?"mv_chat_admin_message":""});h.appendMessage(S,t)}},receiveDelete(e,t){var o="#mv_chat_msg"+mvcur.mvData.oid+"_"+t,r=h._messagesBatch&&h._messagesBatch.querySelector(o);r?(0,i.re)(r):(r=h.messagesWrap.querySelector(o))&&!(0,i.hasClass)(r,"_deleted")&&h.scroll.updateAbove((function(){(0,i.re)(r)}))},checkStickerFlood(e,t){var o=mvcur.queueBatchId;h._stickersLimits&&h._stickersLimits.batch==o||(h._stickersLimits={batch:o,like:0,sticker:0},h._stickersDelay=0);var i="like"==e?"like":"sticker",r="like"==i?h.MAX_LIKES_PER_BATCH:h.MAX_STICKERS_PER_BATCH;return!(++h._stickersLimits[i]>r&&t!=vk.id)},appendSticker(e,t,o){if(void 0===o&&(o=!0),!h.isHidden()&&!Videoview.isFS&&"hidden"!=document.visibilityState&&"animation"in document.body.style&&"onanimationend"in window){if(t==vk.id){var s=h.recentlySentSticker;if(s&&s.stickerId==e&&s.fromQueue!=o&&Date.now()-s.time<3e3)return;h.recentlySentSticker={stickerId:e,fromQueue:o,time:Date.now()}}else if(!h.checkStickerFlood(e,t))return;if("like"==e){var l=(0,i.ce)("div",{className:"mv_chat_like"});_(l),(0,n.addEvent)(l,"animationend",u),c(l)}else{var d=(0,i.ce)("img",{className:"mv_chat_sticker",src:Stickers.getStickerUrl(e,((0,r.isRetina)()?128:64)+"b")});_(d),(0,n.addEvent)(d,"error animationend",u),(0,n.addEvent)(d,"load",c)}}function _(e){for(var o="",s=0,n=0,l=0,d=(0,a.intval)((h.getHeight()-80)/6),_=0;_<=100;_+=20){_>0&&(s+=(0,r.irand)(-4,4),n-=d,l+=(0,r.irand)(-4,4),d=(0,a.intval)(.9*d)),o+=`\n          ${_}% {\n            transform: translate(${s}px, ${n}px) rotate(${l}deg) scale(${_?1:.7});\n            opacity: ${0==_||100==_?0:1};\n          }\n        `}var c="mv_chat_sticker_animation_"+Date.now()+"_"+(0,r.irand)(0,1e9);o=`@keyframes ${c} {${o}}`,e.appendChild((0,i.ce)("style",{innerHTML:o}));var u=(0,r.irand)(1500,2500)+"ms",p=(t==vk.id?0:h._stickersDelay+=100)+"ms";(0,i.setStyle)(e,{animation:[c,u,p,"linear"].join(" ")})}function c(e){var t=e.currentTarget||e;(h._stickersBatch||(h._stickersBatch=document.createDocumentFragment())).appendChild(t),h._appendStickerTimeout||(h._appendStickerTimeout=setTimeout((function(){h.appendStickersBatch(),h._appendStickerTimeout=null}),0))}function u(e){var t=e.currentTarget||e;(0,n.removeEvent)(t),(0,i.re)(t)}},appendStickersBatch(){var e=h._stickersBatch;e&&(h._stickersBatch=null,h.isHidden()||h.stickersWrap.appendChild(e))},removeStickers(){if(h.stickersWrap)for(var e;e=(0,i.domFC)(h.stickersWrap);)(0,n.removeEvent)(e),(0,i.re)(e)},appendMessage(e,t){var o=h._messagesBatch||(h._messagesBatch=document.createDocumentFragment()),r="#mv_chat_msg"+mvcur.mvData.oid+"_"+t;if(!h.messagesWrap.querySelector(r)&&!o.querySelector(r)){o.appendChild((0,i.se)(e));for(var s=o.childNodes;o.childNodes.length>h.MAX_COMMENTS_NUM;)(0,i.re)(s[0]);h.isHidden()||h._appendMessageTimeout||(h._appendMessageTimeout=setTimeout((function(){h.appendMessagesBatch(),h._appendMessageTimeout=null}),0))}},appendMessagesBatch(){if(!h.isHidden()){var e=h._messagesBatch;if(e){h._messagesBatch=null;var t=(0,i.geByClass)("mv_chat_message_author_thumb_img",e,"img");(0,a.each)(t,(function(e,t){(0,i.attr)(t,"src")||(0,i.attr)(t,"src",(0,i.domData)(t,"src"))})),h.firstMsgIntro&&((0,i.re)(h.firstMsgIntro),h.firstMsgIntro=null);var o=h.scroll.content;h.scroll.updateBelow((function(){o.appendChild(e)})),h.scroll.updateAbove((function(){for(var e=o.childNodes;e.length>h.MAX_COMMENTS_NUM;)(0,i.re)(e[0])})),h.scroll.data.scrollBottom>100&&h.toggleScrollBottomBtn(!0)}}},toggleScrollBottomBtn(e){(0,i.toggleClass)(this.scrollBottomBtnWrap,"hidden",!e)},scrollBottom(){h.scroll.scrollBottom(0)},replyAsAnimate(e,t,o){var r=e&&(0,i.geByClass1)("mv_chat_reply_author_photo",e),s=r&&(0,i.geByClass)("mv_chat_reply_author_photo_img",r),n=(0,i.hasClass)(e,"mv_chat_author_secondary")?0:1;s&&s[n]&&(s[n].src=o),(0,i.toggleClass)(e,"mv_chat_author_secondary")},replyAsGroup(e,t){window.replyAsList?h.replyAsGroupTT(e,t):(window.replyAsList=[],window.replyAsData={},(0,i.domData)(e,"can_reply_as_any_group")?ajax.post("/al_groups.php?act=get_editor_clubs",{},{cache:1,onDone:function(o){window.replyAsList=o,(0,a.each)(o,(function(e,t){var o=t[0];t[1],t[2],t[3];window.replyAsData[o]=this})),h.replyAsGroupTT(e,t)}}):h.replyAsGroupTT(e,t))},replyAsGroupList(e,t,o){var r=[o],s=(0,i.domByClass)(e,"mv_chat_reply_group_data");if(s){var n=[(0,i.domData)(s,"group_id"),(0,i.domData)(s,"group_photo"),(0,i.domData)(s,"group_href"),(0,i.domData)(s,"group_name")];r.push(n),window.replyAsData[n[0]]=n}return(0,a.each)(window.replyAsList,(function(e,o){var i=o[0];o[1],o[2],o[3];i!=t&&r.push(this)})),r},replyAsGroupOver(e){var t=(0,i.gpeByClass)("mv_chat_reply_form",e);(0,l.showTooltip)(e,{text:function(){return(0,i.domData)(t,"from-oid")<0?(0,c.getLang)("global_on_behalf_group"):(0,c.getLang)("global_on_behalf_me")},black:1,shift:[9,8,8]})},replyAsGroupTT(e,t){var o=h.replyAsProfileData(),r=(0,i.gpeByClass)("mv_chat_reply_form",e),s=r&&(0,i.domData)(r,"from-oid"),l=(0,i.data)(e,"tt");if(!o)return!1;if(!l){var d=h.replyAsGroupList(e,t,o),_="";(0,a.each)(d,(function(e,t){var o=t[0],i=t[1],r=t[2],n=t[3];_+=(0,a.getTemplate)("video_chat_message_author_select_row",{author_id:o,author_href:r,author_photo:i,author_name:n,classes:s==o?" active":""})})),l=new ElementTooltip(e,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+_+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"top",offset:function(){return[0,-5]},onFirstTimeShow:function(t){var o=(0,i.geByClass)("post_from_tt_row",t);(0,a.each)(o,(function(t,o){(0,n.addEvent)(o,"click",h.setReplyAsGroup.pbind(e,{from:(0,i.domData)(this,"from-oid")}))})),this.rows=o,this.scroll=new uiScroll((0,i.geByClass1)("_post_scroll_wrap",t)),setTimeout((function(){l.scroll.update(),l.updatePosition()}),0)},onShow:function(e){setTimeout((function(){if(l.scroll){var t=(0,i.geByClass1)("active",e),o=t?t.offsetTop-(l.scroll.data.viewportHeight-(0,i.getSize)(t)[1])/2:0;l.scroll.scrollTop(o)}}),0)},onHide:function(e){}}),(0,i.data)(e,"tt",l)}t&&l.isShown()&&h.setReplyAsGroup(e,{from:s==vk.id?t:vk.id}),e.tt&&e.tt.hide&&e.tt.hide(),l.isShown()||l.show()},replyAsProfileData:()=>window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData,setReplyAsGroup(e,t){if(!e)return!1;var o=(0,i.domClosest)("mv_chat_reply_form",e),r=(0,i.data)(e,"tt"),s=t.from||(t.fromGroup?cur.oid:vk.id),n=s==vk.id?h.replyAsProfileData():window.replyAsData&&window.replyAsData[s];return!((0,i.domData)(o,"from-oid")==s||!n||n[0]!=s)&&((0,i.domData)(o,"from-oid",s),h.replyAsAnimate(o,n[2],n[1]),r&&r.rows&&(0,a.each)(r.rows,(function(){(0,i.toggleClass)(this,"active",(0,i.domData)(this,"from-oid")==s)})),e.setAttribute("aria-label",s<0?(0,c.getLang)("wall_reply_as_group"):(0,c.getLang)("wall_reply_as_user")),!1)},sendMessage(){if(!h.messageSending){var e={Message:(0,a.trim)(Emoji.val(h.replyInput))};if(e.Message){if(Date.now()-h.lastMsgSent<1e3)return window.tooltips&&tooltips.destroy(h.replyInput),void(0,l.showTooltip)(h.replyInput,{text:(0,c.getLang)("video_live_chat_too_fast"),black:1});var t=Videoview.getMvData(),o=(0,i.geByClass1)("mv_chat_reply_form",this.block);o&&(0,i.domData)(o,"from-oid")&&(e.from_oid=(0,i.domData)(o,"from-oid")),ajax.post("al_video.php?act=post_comment",(0,a.extend)(e,{video:t.videoRaw,hash:t.hash,videoviewer_chat:1,item_access_hash:mvcur.mvData.itemAccessHash}),{onDone:function(e,t){h.messageSending=!1,e&&t&&h.appendMessage(e,t),Emoji.val(h.replyInput,""),h.checkFormHeight(),h.scroll.data.scrollBottom&&h.scrollBottom(),h.lastMsgSent=Date.now(),mvcur.player&&mvcur.player.vars.stats_tmr&&(0,d.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onFail:function(e){if(h.messageSending=!1,h.replyInput)return window.tooltips&&tooltips.destroy(h.replyInput),(0,l.showTooltip)(h.replyInput,{text:e,showdt:200,forcetodown:0,slide:15,black:1}),(0,i.elfocus)(h.replyInput),!0}}),h.messageSending=!0}else(0,i.elfocus)(h.replyInput)}},sendSticker(e){var t=Videoview.getMvData();ajax.post("al_video.php?act=live_send_sticker",{sticker_id:e,owner_id:t.oid,video_id:t.vid,hash:t.hash,item_access_hash:mvcur.mvData.itemAccessHash},{onDone(){h.appendSticker(e,vk.id,!1)}})},deleteMessage(e,t){var o=(0,i.ge)("mv_chat_msg"+e);o&&(o.classList.add("_deleted"),ajax.post("al_video.php?act=delete_comment",{comment:e,hash:t,videoview_chat:1},{onDone(e){o&&(o.classList.add("_show_deleted_stub"),(0,i.val)((0,i.domByClass)(o,"mv_chat_message_content"),e))}}))},showReportVideoChatCommentForm(e,t){(0,_.showReportForm)("video_comment",e,t,(()=>{var o=(0,i.ge)(`mv_chat_msg${e}_${t}`);o&&(o.classList.add("_deleted"),o.classList.add("_show_deleted_stub"),(0,i.val)((0,i.domByClass)(o,"mv_chat_message_content"),(0,c.getLang)("global_report_sent")))}))},isHidden(){return!!this.hidden||Videoview.isMinimized()},setHidden(e){this.hidden=e},toggle(){var e=h.isHidden();this.setHidden(!e),h.toggleStateClasses(),e&&h.scroll&&(h.appendMessagesBatch(),h.updateScroll()),e||h.removeStickers()},toggleStateClasses(){var e=!!this.block,t=h.isHidden(),o=Videoview.isMinimized();(0,i.toggleClass)("mv_box","_has_chat",e&&!o),(0,i.toggleClass)("mv_box","_hide_chat",e&&!o&&t);var r="";e&&(h.appendMessagesBatch(),r=t?(0,c.getLang)("video_aria_expand_chat"):(0,c.getLang)("video_aria_minimize_chat")),(0,i.ge)("mv_top_pl_toggle")&&(0,i.attr)("mv_top_pl_toggle","aria-label",r)},updateScroll(){h.scroll.update(),h.scroll.scrollBottom(),h.toggleScrollBottomBtn(!1)},onResize(){h.block&&(h._chatHeight=h.block.offsetHeight)},getHeight:()=>h.block?h._chatHeight||(h._chatHeight=h.block.offsetHeight):0,destroy(){if(h.block){if(h.scroll&&(h.scroll.destroy(),h.scroll=null),h.replyForm){var e=(0,i.data)(h.replyForm,"optId");void 0!==e&&Emoji.destroy(e),(0,i.removeData)(h.replyForm),(0,i.removeData)(h.replyInput),h.replyForm=h.replyInput=null}h.removeStickers(),(0,i.removeData)(h.block),(0,i.re)(h.block),h.block=null,h.messagesWrap=null,h.stickersWrap=null,h.options=null,clearTimeout(h._appendMessageTimeout),clearTimeout(h._appendStickerTimeout),h._appendMessageTimeout=null,h._appendStickerTimeout=null,h._messagesBatch=null,h.firstMsgIntro=null,h.messageSending=!1,h.toggleStateClasses()}}}},80706:(e,t,o)=>{o.d(t,{default:()=>l});var i=o(785893),r=(o(667294),o(659397)),s=o(542443),n=o(564092),a=e=>{var t=e.children,o=e.isVerified,a=e.verifiedText,l=e.className;return(0,i.jsxs)("div",{className:(0,r.classNames)("OwnerName",l),children:[(0,i.jsx)(n.default,{children:t}),!!o&&(0,i.jsx)(s.default,{verifiedText:a,className:"OwnerName__verified"})]})};a.defaultProps={isVerified:!1,verifiedText:""};const l=a},542443:(e,t,o)=>{o.d(t,{default:()=>n});o(682772);var i=o(785893),r=(o(667294),o(659397));function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},s.apply(this,arguments)}const n=e=>{var t=e.verifiedText,o=e.className,n=function(e,t){if(null==e)return{};var o,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)o=s[i],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,["verifiedText","className"]);return(0,i.jsx)("div",s({className:(0,r.classNames)("VerifiedMarker",o)},n,{"aria-label":t,children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 12",className:"VerifiedMarker__icon","aria-hidden":"true",children:(0,i.jsx)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.25 6.75L4.5 9l5.25-5.25"})})}))}},58255:(e,t,o)=>{o.d(t,{default:()=>r});var i=o(111132);function r(e,t){e.classList?e.classList.add(t):(0,i.default)(e,t)||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}},111132:(e,t,o)=>{function i(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}o.d(t,{default:()=>i})},374277:(e,t,o)=>{function i(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function r(e,t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=i(e.className,t):e.setAttribute("class",i(e.className&&e.className.baseVal||"",t))}o.d(t,{default:()=>r})},429697:(e,t,o)=>{o.d(t,{default:()=>p});var i=o(722122),r=o(419756),s=o(841788),n=o(58255),a=o(374277),l=o(667294),d=o(696630),_=o(559391),c=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return(0,a.default)(e,t)}))},u=function(e){function t(){for(var t,o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,o){var i=t.resolveArguments(e,o),r=i[0],s=i[1];t.removeClasses(r,"exit"),t.addClass(r,s?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,o)},t.onEntering=function(e,o){var i=t.resolveArguments(e,o),r=i[0],s=i[1]?"appear":"enter";t.addClass(r,s,"active"),t.props.onEntering&&t.props.onEntering(e,o)},t.onEntered=function(e,o){var i=t.resolveArguments(e,o),r=i[0],s=i[1]?"appear":"enter";t.removeClasses(r,s),t.addClass(r,s,"done"),t.props.onEntered&&t.props.onEntered(e,o)},t.onExit=function(e){var o=t.resolveArguments(e)[0];t.removeClasses(o,"appear"),t.removeClasses(o,"enter"),t.addClass(o,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var o=t.resolveArguments(e)[0];t.addClass(o,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var o=t.resolveArguments(e)[0];t.removeClasses(o,"exit"),t.addClass(o,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,o){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,o]},t.getClassNames=function(e){var o=t.props.classNames,i="string"==typeof o,r=i?""+(i&&o?o+"-":"")+e:o[e];return{baseClassName:r,activeClassName:i?r+"-active":o[e+"Active"],doneClassName:i?r+"-done":o[e+"Done"]}},t}(0,s.default)(t,e);var o=t.prototype;return o.addClass=function(e,t,o){var i=this.getClassNames(t)[o+"ClassName"],r=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===o&&r&&(i+=" "+r),"active"===o&&e&&(0,_.forceReflow)(e),i&&(this.appliedClasses[t][o]=i,function(e,t){e&&t&&t.split(" ").forEach((function(t){return(0,n.default)(e,t)}))}(e,i))},o.removeClasses=function(e,t){var o=this.appliedClasses[t],i=o.base,r=o.active,s=o.done;this.appliedClasses[t]={},i&&c(e,i),r&&c(e,r),s&&c(e,s)},o.render=function(){var e=this.props,t=(e.classNames,(0,r.default)(e,["classNames"]));return l.createElement(d.default,(0,i.default)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(l.Component);u.defaultProps={classNames:""},u.propTypes={};const p=u},696630:(e,t,o)=>{o.d(t,{default:()=>y});var i=o(419756),r=o(841788),s=o(667294),n=o(973935),a=o(806035),l=o(500220),d=o(559391),_="unmounted",c="exited",u="entering",p="entered",h="exiting",v=function(e){function t(t,o){var i;i=e.call(this,t,o)||this;var r,s=o&&!o.isMounting?t.enter:t.appear;return i.appearStatus=null,t.in?s?(r=c,i.appearStatus=u):r=p:r=t.unmountOnExit||t.mountOnEnter?_:c,i.state={status:r},i.nextCallback=null,i}(0,r.default)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===_?{status:c}:null};var o=t.prototype;return o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(e){var t=null;if(e!==this.props){var o=this.state.status;this.props.in?o!==u&&o!==p&&(t=u):o!==u&&o!==p||(t=h)}this.updateStatus(!1,t)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var e,t,o,i=this.props.timeout;return e=t=o=i,null!=i&&"number"!=typeof i&&(e=i.exit,t=i.enter,o=void 0!==i.appear?i.appear:t),{exit:e,enter:t,appear:o}},o.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===u){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:n.findDOMNode(this);o&&(0,d.forceReflow)(o)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===c&&this.setState({status:_})},o.performEnter=function(e){var t=this,o=this.props.enter,i=this.context?this.context.isMounting:e,r=this.props.nodeRef?[i]:[n.findDOMNode(this),i],s=r[0],l=r[1],d=this.getTimeouts(),_=i?d.appear:d.enter;!e&&!o||a.default.disabled?this.safeSetState({status:p},(function(){t.props.onEntered(s)})):(this.props.onEnter(s,l),this.safeSetState({status:u},(function(){t.props.onEntering(s,l),t.onTransitionEnd(_,(function(){t.safeSetState({status:p},(function(){t.props.onEntered(s,l)}))}))})))},o.performExit=function(){var e=this,t=this.props.exit,o=this.getTimeouts(),i=this.props.nodeRef?void 0:n.findDOMNode(this);t&&!a.default.disabled?(this.props.onExit(i),this.safeSetState({status:h},(function(){e.props.onExiting(i),e.onTransitionEnd(o.exit,(function(){e.safeSetState({status:c},(function(){e.props.onExited(i)}))}))}))):this.safeSetState({status:c},(function(){e.props.onExited(i)}))},o.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},o.setNextCallback=function(e){var t=this,o=!0;return this.nextCallback=function(i){o&&(o=!1,t.nextCallback=null,e(i))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},o.onTransitionEnd=function(e,t){this.setNextCallback(t);var o=this.props.nodeRef?this.props.nodeRef.current:n.findDOMNode(this),i=null==e&&!this.props.addEndListener;if(o&&!i){if(this.props.addEndListener){var r=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],s=r[0],a=r[1];this.props.addEndListener(s,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},o.render=function(){var e=this.state.status;if(e===_)return null;var t=this.props,o=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,i.default)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return s.createElement(l.default.Provider,{value:null},"function"==typeof o?o(e,r):s.cloneElement(s.Children.only(o),r))},t}(s.Component);function m(){}v.contextType=l.default,v.propTypes={},v.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:m,onEntering:m,onEntered:m,onExit:m,onExiting:m,onExited:m},v.UNMOUNTED=_,v.EXITED=c,v.ENTERING=u,v.ENTERED=p,v.EXITING=h;const y=v},500220:(e,t,o)=>{o.d(t,{default:()=>i});const i=o(667294).createContext(null)},806035:(e,t,o)=>{o.d(t,{default:()=>i});const i={disabled:!1}},559391:(e,t,o)=>{o.d(t,{forceReflow:()=>i});var i=function(e){return e.scrollTop}},742129:(e,t,o)=>{o.d(t,{USER_INFO_MODULE:()=>i,GROUP_INFO_MODULE:()=>r,SPAMFEED_MODULE:()=>s,ABUSE_MODULE:()=>n});var i="user_personal_card",r="group_personal_card",s="sf",n="abuse"},287503:(e,t,o)=>{o.d(t,{GroupAdminLevel:()=>i,ANALYTICS_SCREEN_SETTINGS:()=>r,ANALYTICS_SCREEN_OTHER:()=>s});var i={USER:0,MODERATOR:1,EDITOR:2,ADMINISTRATOR:3,HOST:4,EVENT_CREATOR:5,CREATOR:6,PSEUDO_LEVEL_ADVERTISER:100},r="settings",s="other"},620145:(e,t,o)=>{o.d(t,{drawRoundedImage:()=>r,roundRect:()=>s,getCoverSize:()=>n,getCroppedImage:()=>a,getZeroFrameFromGif:()=>l});o(570655);var i=o(961540),r=function(e,t,o,i,r,s,n,a,l,d,_){var c=a||i,u=l||r,p=d||s||t.naturalWidth,h=_||n||t.naturalHeight;e.beginPath(),e.arc(c+o,u+o,o,Math.PI,Math.PI+Math.PI/2),e.lineTo(c+p-o,u),e.arc(c+p-o,u+o,o,Math.PI+Math.PI/2,2*Math.PI),e.lineTo(c+p,u+h-o),e.arc(c+p-o,u+h-o,o,2*Math.PI,Math.PI/2),e.lineTo(c+o,u+h),e.arc(c+o,u+h-o,o,Math.PI/2,Math.PI),e.closePath(),e.save(),e.clip(),e.drawImage(t,i,r,s,n,a,l,d,_),e.restore()},s=function(e,t,o,i,r,s){var n={};if("number"==typeof s)n={tl:s,tr:s,br:s,bl:s};else{var a={tl:0,tr:0,br:0,bl:0};for(var l in a)n[l]=n[l]||a[l]}e.save(),e.beginPath(),e.moveTo(t+n.tl,o),e.lineTo(t+i-n.tr,o),e.quadraticCurveTo(t+i,o,t+i,o+n.tr),e.lineTo(t+i,o+r-n.br),e.quadraticCurveTo(t+i,o+r,t+i-n.br,o+r),e.lineTo(t+n.bl,o+r),e.quadraticCurveTo(t,o+r,t,o+r-n.bl),e.lineTo(t,o+n.tl),e.quadraticCurveTo(t,o,t+n.tl,o),e.closePath(),e.restore()},n=function(e,t,o,i,r,s){var n,a,l=e/t;return l>o/i?(n=i,a=i*l):(a=o,n=o/l),{width:a,height:n,offsetLeft:(o-a)*(r=void 0===r?.5:r),offsetTop:(i-n)*(s=void 0===s?.5:s)}};function a(e,t,o,r,s,n){return void 0===n&&(n=0),new Promise((function(a,l){("string"==typeof e?(0,i.loadImage)(e):Promise.resolve(e)).then((function(e){var d=document.createElement("canvas");d.width=90===n||270===n?e.naturalHeight:e.naturalWidth,d.height=90===n||270===n?e.naturalWidth:e.naturalHeight;var _=d.getContext("2d");if(_){_.fillStyle="#fff",_.fillRect(0,0,_.canvas.width,_.canvas.height),n?(_.translate(d.width/2,d.height/2),_.rotate(n*Math.PI/180),_.drawImage(e,-e.naturalWidth/2,-e.naturalHeight/2)):_.drawImage(e,0,0);var c=_.getImageData(t,o,r,s),u=document.createElement("canvas");u.width=r,u.height=s;var p=u.getContext("2d");if(p)return p.putImageData(c,0,0),(0,i.loadImage)(u.toDataURL("image/jpeg",1)).then(a).catch(l);a(e)}else a(e)})).catch(l)}))}var l=function(e,t,o){return new Promise((function(r){"image/gif"!==e.type&&r({file:e,image:t,imageUrl:o});var s=document.createElement("canvas"),n=s.getContext("2d");if(!n)return r({file:e,image:t,imageUrl:o});s.width=t.width,s.height=t.height,n.drawImage(t,0,0),s.toBlob((function(s){if(null!==s){var n=URL.createObjectURL(s);(0,i.loadImage)(o).then((function(e){r({file:s,image:e,imageUrl:n})})).catch((function(i){console.log(i),r({file:e,image:t,imageUrl:o})}))}else r({file:e,image:t,imageUrl:o})}))}))}},249009:(e,t,o)=>{o.d(t,{swapObject:()=>i});var i=function(e){var t={};return Object.keys(e).forEach((function(o){t[e[o]]=o})),t}},341319:(e,t,o)=>{var i,r,s,n,a;o.d(t,{StoryType:()=>i,StoryEntryPoint:()=>r,StorySource:()=>s,StoryBlockType:()=>n,StoryListName:()=>a}),function(e){e.PHOTO="photo",e.VIDEO="video",e.LIVE="live"}(i||(i={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar"}(r||(r={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="questions"}(s||(s={})),function(e){e.stories="stories",e.communityGroupedStories="community_grouped_stories",e.appGroupedStories="app_grouped_stories",e.discover="discover"}(n||(n={})),function(e){e.feed="feed",e.groups="groups",e.apps="apps",e.discover="discover"}(a||(a={}))},508271:(e,t,o)=>{o.d(t,{HIDE_TOOLTIP_TIMEOUT:()=>i,SHOW_TOOLTIP_TIMEOUT:()=>r,REACTION_ID_DEFAULT:()=>s,REACTION_ID_MAX:()=>n,REACTION_ID_MIN:()=>a,REACTION_ID_UNSET:()=>l,REACTION_SET_ITEMS_MIN_COUNT:()=>d,OPENED_REACTED_USERS_DEFAULT_REACTION_ID:()=>_});var i=600,r=140,s=0,n=7,a=0,l=void 0,d=2,_=s},464746:(e,t,o)=>{o.d(t,{isDebugEnabled:()=>s});var i=o(15305),r=void 0,s=function(){return void 0!==r?r:r=!!i.ls.get("reactions.debug_enabled")}},714396:(e,t,o)=>{o.d(t,{reactionCountsBrandUnwrap:()=>r,reactionCountsBrandWrap:()=>s});var i=o(165594),r=function(e){return(0,i.unwrap)(e)},s=function(e){return(0,i.wrap)(e)}},82701:(e,t,o)=>{o.d(t,{reactionLogError:()=>r});var i=o(66433);function r(e){var t=e.error,o=e.reportError;void 0!==o&&o&&(0,i.logError)(t,{environment:"reactions"}),console.error(t)}},517760:(e,t,o)=>{o.d(t,{isUnknownObject:()=>l,getReaction:()=>d,getDefaultReaction:()=>_,getDefaultReactionTitle:()=>c,prepareReactionMenuSet:()=>p,isReactionIdSet:()=>h,isReactionIdUnset:()=>v,isValidReactionId:()=>m,parseReactionId:()=>y,parseReactionIdOrUnset:()=>g,validateReactionSetPayloaditems:()=>f,parseReactionMenuConfig:()=>w,calcCounters:()=>S,calcCountersSum:()=>E,calcCountersWeightedSum:()=>b,hasReactionsForCounts:()=>k,counterForReactionId:()=>T,areCountersEqual:()=>C});var i=o(570655),r=o(508271),s=o(714396),n=o(659397),a=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},l=function(e){return null!==e&&"object"==typeof e},d=function(e,t){return e.itemsById[t]},_=function(e){return d(e,r.REACTION_ID_DEFAULT)},c=function(e){var t;return null===(t=_(e))||void 0===t?void 0:t.title},u=function(e,t){return 0===e.length?"":(o=e,i=function(e){return Math.pow(t.width-e.width,2)+Math.pow(t.height-e.height,2)},r=!1,void 0===r&&(r=!0),o.reduce((function(e,t){var o=i(t),s=i(e);return s===o?r?e:t:s<o?e:t}))).url;var o,i,r},p=function(e,t,o){var i=t.map((function(e){var t=e.asset,i=e.color_sets,r=e.id,s=e.score,n=e.title;return{animationURL:t.animation_url||void 0,backgroundColor:null==i?void 0:i.background,id:r,imageMenuURL:u(t.images,o.imageMenuSize),imagePreviewURL:"imagePreviewSize"in o?u(t.images,o.imagePreviewSize):void 0,imageStoryPanelURL:"imageStoryPanelSize"in o?u(t.images,o.imageStoryPanelSize):void 0,imageStoryPreviewURL:"imageStoryPreviewSize"in o?u(t.images,o.imageStoryPreviewSize):void 0,score:s,title:n,titleColor:null==i?void 0:i.foreground}})),r={};return i.forEach((function(e){r[e.id]=e})),{id:e,items:i,itemsById:r}},h=function(e){return e!==r.REACTION_ID_UNSET},v=function(e){return e===r.REACTION_ID_UNSET},m=function(e){return a(e)&&e>=r.REACTION_ID_MIN&&e<=r.REACTION_ID_MAX},y=function(e){var t=parseInt(e,10);return m(t)?{isValid:!0,value:t}:{isValid:!1}},g=function(e){var t=y(e);return t.isValid?t.value:r.REACTION_ID_UNSET},f=function(e,t){if(e.length<r.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error("Invalid reactions items count in set '"+t+"': "+e.length)}},w=function(e){if(l(e)){var t={},o=e.animationShowStaticAfterEnd,i=e.menuShowDelay,s=e.openedDefaultReactionId,n=e.reportJsErrors;return"number"!=typeof i&&void 0!==i||(t.menuShowDelay=i),"boolean"==typeof o&&(t.animationShowStaticAfterEnd=o),"boolean"==typeof n&&(t.reportJsErrors=n),"number"==typeof s||null===s?null===s?t.openedDefaultReactionId=void 0:m(s)&&(t.openedDefaultReactionId=s):t.openedDefaultReactionId=r.OPENED_REACTED_USERS_DEFAULT_REACTION_ID,t}},S=function(e,t){var o=(0,s.reactionCountsBrandWrap)({});return Object.entries((0,s.reactionCountsBrandUnwrap)(e)).forEach((function(e){var r,s,n,a=(0,i.__read)(e,2),l=a[0],d=a[1],_=l,c=null!==(n=null===(s=null===(r=null==t?void 0:t.itemsById)||void 0===r?void 0:r[_])||void 0===s?void 0:s.score)&&void 0!==n?n:1;o[_]=c*(d||0)})),o},E=function(e){return Object.values((0,s.reactionCountsBrandUnwrap)(e)).reduce((function(e,t){return e+(t||0)}),0)},b=function(e){return E((0,s.reactionCountsBrandWrap)(e))},k=function(e){return E(e)>0},T=function(e,t){var o;return null!==(o=e[t])&&void 0!==o?o:void 0},C=function(e,t){return e&&t?(0,n.isEqual)(e,t):e===t}},165594:(e,t,o)=>{o.d(t,{unwrap:()=>i,wrap:()=>r});var i=function(e){return e},r=function(e){return e}},633063:(e,t,o)=>{o.d(t,{STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION:()=>i,STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME:()=>r});var i="stories_viewer_navigation",r="stories_viewing_start_time"},979921:(e,t,o)=>{function i(e){var t;return(null!==(t=null==e?void 0:e.split("_"))&&void 0!==t?t:[]).map(Number)}o.d(t,{splitStoryRawId:()=>i})},673023:(e,t,o)=>{o.d(t,{UploadPhoto:()=>i.UploadPhoto});var i=o(647409)},569351:(e,t,o)=>{var i,r,s;o.d(t,{UploadPhotoErrorCodes:()=>i,OwnerAvatarEditorPhotoTypes:()=>r,OwnerAvatarEditorModes:()=>s}),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.UPLOAD=1]="UPLOAD",e[e.NOT_ALLOWED_EXTENSION=2]="NOT_ALLOWED_EXTENSION",e[e.IMAGE_TOO_SMALL=3]="IMAGE_TOO_SMALL",e[e.IMAGE_TOO_BIG=4]="IMAGE_TOO_BIG",e[e.BAD_ASPECT_RATIO=5]="BAD_ASPECT_RATIO"}(i||(i={})),function(e){e.UPLOADED="uploaded",e.EXISTED="existed"}(r||(r={})),function(e){e[e.UPLOAD=1]="UPLOAD",e[e.SELECT=2]="SELECT",e[e.EDIT=3]="EDIT",e[e.NFT=4]="NFT",e[e.NFT_EDIT=5]="NFT_EDIT"}(s||(s={}))},647409:(e,t,o)=>{o.d(t,{UploadPhoto:()=>n});var i=o(570655),r=o(569351),s=o(746512),n=function(){function e(e,t){this.config=(0,i.__assign)({allowedTypes:["*"]},e),this.progressCallback=t}return e.prototype.validate=function(e){var t=this.config,o=t.constraints,n=t.allowedTypes,a=t.lang,l=!1;return n&&(l=n.some((function(t){return"*"===t||t===e.type}))),l?o?(0,s.getImageSizeByBlob)(e).then((function(e){var t=o.maxWidth,s=o.minWidth,n=o.maxHeight,l=o.minHeight,d=o.maxAspectRatio,_=o.minAspectRatio,c=(0,i.__read)(e,2),u=c[0],p=c[1],h=u/p;if(u>t||p>n){var v=(a["error_"+r.UploadPhotoErrorCodes.IMAGE_TOO_BIG]||"").replace("{width}",String(t)).replace("{height}",String(n));return Promise.reject({code:r.UploadPhotoErrorCodes.IMAGE_TOO_BIG,text:v})}if(u<s||p<l){v=(a["error_"+r.UploadPhotoErrorCodes.IMAGE_TOO_SMALL]||"").replace("{width}",String(s)).replace("{height}",String(l));return Promise.reject({code:r.UploadPhotoErrorCodes.IMAGE_TOO_SMALL,text:v})}return _&&_>h||d&&h>d?Promise.reject({code:r.UploadPhotoErrorCodes.BAD_ASPECT_RATIO,text:a["error_"+r.UploadPhotoErrorCodes.BAD_ASPECT_RATIO]}):Promise.resolve(null)})).catch((function(e){return e&&e.text&&e.code?Promise.reject(e):Promise.reject({code:r.UploadPhotoErrorCodes.UNKNOWN,text:a["error_"+r.UploadPhotoErrorCodes.UNKNOWN]})})):Promise.resolve(null):Promise.reject({code:r.UploadPhotoErrorCodes.NOT_ALLOWED_EXTENSION,text:a["error_"+r.UploadPhotoErrorCodes.NOT_ALLOWED_EXTENSION]})},e.prototype.upload=function(e,t,o){var i=this;return void 0===o&&(o="file1"),this.validate(e).then((function(){return new Promise((function(s,n){var a=new XMLHttpRequest,l=new FormData;l.append(o,e),a.open("POST",t||i.config.url,!0),a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE&&200===a.status){var e=void 0;try{a.responseText&&(e=JSON.parse(a.responseText))}catch(e){n({code:r.UploadPhotoErrorCodes.UNKNOWN,text:i.config.lang["error_"+r.UploadPhotoErrorCodes.UNKNOWN]})}s(e)}},a.onerror=function(){n({code:r.UploadPhotoErrorCodes.UPLOAD,text:i.config.lang["error_"+r.UploadPhotoErrorCodes.UPLOAD]})},a.upload.onprogress=function(e){i.progressCallback&&i.progressCallback(e.loaded,e.total)},a.send(l)}))}))},e}()},746512:(e,t,o)=>{function i(e){return t=URL.createObjectURL(e),new Promise((function(e,o){var i=new Image;i.onload=function(){var t=Number(i.height),o=Number(i.width);e([o,t])},i.onerror=function(){o()},i.onabort=function(){o()},i.src=t}));var t}o.d(t,{getImageSizeByBlob:()=>i})},224589:(e,t,o)=>{o.d(t,{logViewMarketItemInStories:()=>a});var i=o(570655),r=o(121444),s=o(473762),n=o(954932);function a(e){var t=new URL(""+document.location.origin+e).searchParams.get("w");if(t){var o=(0,i.__read)(t.slice("product-".length).split("_"),2),a=o[0],l=o[1];r.viewAnalytics.logMarketItemView({view:{start_view:"0",end_view:"0"},screen:(0,s.getStatScreen)(),ref_source:n.RefSource.STORIES,params:{item_id:Number(l),owner_id:Number(a),search_query_id:0,item_idx:0}})}}},228605:(e,t,o)=>{var i=o(523497);window.Stories=i.Stories;try{window.stManager.done(window.jsc("web/stories.js"))}catch(e){}},300851:(e,t,o)=>{o.d(t,{FRIENDS_LIST_FRIEND_OPTIONS_INDEX:()=>i,FRIENDS_STATUS_NOT_FRIENDS:()=>r,FRIENDS_STATUS_REQUEST_FROM_USER:()=>s,FRIENDS_IMAGE_STATUS_INDEX:()=>n,COMMON_FRIENDS_IMAGE_STATUS_INDEX:()=>a,FRIENDS_LIST_FRIEND_IS_NFT_INDEX:()=>l,FRIENDS_REQUESTS_FRIEND_IS_NFT_INDEX:()=>d,PHONEBOOK_SECTION_NAME:()=>_,FOLLOWERS_SECTION_NAME:()=>c,AVATAR_SIZES:()=>u,FRIENDS_LIMIT_PER_PAGE:()=>p});var i=13,r=0,s=1,n=9,a=8,l=14,d=11,_="phonebook",c="followers",u={normal:80,small:48},p=2e3},326042:(e,t,o)=>{o.d(t,{FRIENDS_LIST_LOADING_MEASURE_WITH_PARALLEL_LOADING:()=>a,FRIENDS_LIST_LOADING_MEASURE_WITH_BLOCKING_LOADING:()=>l,FRIENDS_LIST_LOADING_STATLOG:()=>d,trackStart:()=>_,trackEnd:()=>c,FriendsListLoadingType:()=>i,sendLoadingStats:()=>u});var i,r=o(315882),s="FRIENDS_LIST_LOADING_MARK_START",n="FRIENDS_LIST_LOADING_MARK_END",a="FRIENDS_LIST_LOADING_MEASURE_WITH_PARALLEL_LOADING",l="FRIENDS_LIST_LOADING_MEASURE_WITH_BLOCKING_LOADING",d="friends_list_loading";function _(){performance.mark(s)}function c(e){return performance.mark(n),performance.measure(e,{start:s,end:n})}function u(e,t,o){(0,r.statlogsValueEvent)(e,t,o)}!function(e){e.INIT_BLOCKING="init_blocking",e.INIT_PARALLEL="init_parallel"}(i||(i={}))},500445:(e,t,o)=>{o.d(t,{FriendsListLoadingMode:()=>i,removeUnseenStories:()=>h,isFriendsLoadingBugfixEnabled:()=>v,fillFriendsListWithDataFromServer:()=>y});var i,r=o(570655),s=o(563414),n=o(917258),a=o(830104),l=o(958941),d=o(506770),_=o(300851),c=o(342269),u=o(514191),p=o(326042);function h(e){var t,o,i;window.cur&&window.cur.hasUnseenStories&&delete window.cur.hasUnseenStories[e];var a=document.querySelectorAll(".friends_photo_stories_unseen"+e);try{for(var l=(0,r.__values)(a),d=l.next();!d.done;d=l.next()){var _=d.value;_.classList.remove("friends_photo_stories_unseen","friends_photo_stories_unseen"+e),null===(i=_.closest(".friends_photo"))||void 0===i||i.removeAttribute("onclick")}}catch(e){t={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(t)throw t.error}}window.Friends&&window.Friends.addSeenStories(e),(0,s.removeAvatarRichOutlineAtNode)(document.body,String(e),n.AvatarRichOutlineType.STORIES_UNSEEN)}function v(e){return void 0===e&&(e=!1),(0,d.partConfigEnabled)("friends_list_loading_bugfix")&&e}function m(e){return(t=0,o=e,Array.from(Array(o).keys()).map((function(e){return e+t}))).map((function(e){var t,o,i;return i={queryParams:{id:null!==(t=window.cur.oid)&&void 0!==t?t:0,gid:null!==(o=window.cur.gid)&&void 0!==o?o:0,sort:window.nav.objLoc.sort,platform_id:window.nav.objLoc.platform_id,section:window.cur.section,chunk_index:e,chunk_size:_.FRIENDS_LIMIT_PER_PAGE}},new Promise((function(e,t){u.ajax.post("al_friends.php",(0,r.__assign)({act:"load_friends_silent"},i.queryParams),{onDone:function(t,o,i){e({friendsData:t,occupations:o,filters:i})},onFail:function(e,o){t({error:e,status:o})},local:1})}))}));var t,o}function y(e){var t,o,s=e.friendsMethods,n=s.showMore,d=s.filter,u=s.indexAll,h=function(e){var t=(0,l.getIcon32Spinner)().icon,o=document.createElement("div");o.classList.add("friends_wide_loading");var i=(0,a.createElementFromHTML)(t);return i&&(o.append(i),null==e||e.append(o)),function(){o.remove()}}(document.querySelector("#list_content")),v=m((t=[window.cur.allFriendsCount,window.cur.allRequestsCount,window.cur.requestsCount,window.cur.followersCount],o=_.FRIENDS_LIMIT_PER_PAGE,Math.ceil(Math.max.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(t),!1))/o)));!function(){for(var e in window.cur.friendsList)window.cur.friendsList.hasOwnProperty(e)&&(window.cur.friendsList[e]=[])}(),Promise.allSettled(v).then((function(e){var t,o,s,a,l,_,v;h(),window.cur.silent=!1;var m=[],y=200,g="",f="false";try{for(var w=(0,r.__values)(e),S=w.next();!S.done;S=w.next()){var E=S.value;if("rejected"!==E.status){var b=E.value,k=b.friendsData,T=b.occupations,C=b.filters;if(k){for(var L in window.cur.occupations=(0,c.extend)(window.cur.occupations||{},T),k)k.hasOwnProperty(L)&&(window.cur.friendsList[L]=Array.isArray(window.cur.friendsList[L])?window.cur.friendsList[L].concat(k[L]):k[L]);u((function(){"list"==window.cur.section.substr(0,4)&&(window.cur.friendsList[window.cur.section]=Array.isArray(window.cur.friendsList[window.cur.section])?window.cur.friendsList[window.cur.section].concat(d(window.cur.friendsList.all,window.cur.section)):d(window.cur.friendsList.all,window.cur.section)),(window.cur.onSilentLoad||n)()})),C.cities&&m.push(C.cities)}}else y=null!==(a=null===(s=E.reason)||void 0===s?void 0:s.status)&&void 0!==a?a:"unknown",g=null!==(v=null===(_=null===(l=E.reason)||void 0===l?void 0:l.error)||void 0===_?void 0:_.message)&&void 0!==v?v:"",f="true"}}catch(e){t={error:e}}finally{try{S&&!S.done&&(o=w.return)&&o.call(w)}finally{if(t)throw t.error}}var M=m.flat().reduce((function(e,t){var o=function(e){if("string"==typeof e)return e;return e[0]+"_"+e[1]}(t);return e[o]||(e[o]=t),e}),{});!function(e){window.stManager.add(["ui_controls.js","ui_controls.css"],(function(){if(window.cur.cityFilter.setData(e),window.cur.cityFilterOpened){var t=document.getElementById("friends_fltr_progress");t&&(t.style.display="none"),window.cur.cityFilter.showDefaultList()}}))}(Object.values(M));var P=(0,p.trackEnd)(p.FRIENDS_LIST_LOADING_MEASURE_WITH_PARALLEL_LOADING);(0,p.sendLoadingStats)(p.FRIENDS_LIST_LOADING_STATLOG,P.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,mode:i.SILENT,httpStatus:y,section:window.cur.curList,errorMessage:g,loadingType:p.FriendsListLoadingType.INIT_PARALLEL,userId:window.vk.id,hasError:f})}))}!function(e){e.SILENT="silent",e.DEFAULT="default"}(i||(i={}))},891260:(e,t,o)=>{o.d(t,{isKeyboardActivationEvent:()=>r});var i=o(152278),r=function(e){return!!(window.KeyboardEvent&&e instanceof window.KeyboardEvent)&&(!(e.ctrlKey||e.altKey||e.metaKey)&&!![i.KEY.ENTER,i.KEY.SPACE].includes(e.keyCode))}},689840:(e,t,o)=>{o.d(t,{removeUnseenStories:()=>p,checkPostLen:()=>v,getPostAvatarString:()=>m});var i=o(570655),r=o(873589),s=o(342269),n=o(124041),a=o(70162),l=o(44610),d=o(563414),_=o(917258),c=o(761717),u=o(879622);function p(e){var t,o,r;if(h(document,e),null===(r=window.wkcur)||void 0===r?void 0:r.pageReplaced)try{for(var s=(0,i.__values)(window.wkcur.pageReplaced),n=s.next();!n.done;n=s.next()){h(n.value[0],e)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}}function h(e,t){var o,r,s,n,a,c,u=e.querySelectorAll(".reply_image_stories_unseen"+t);try{for(var p=(0,i.__values)(u),h=p.next();!h.done;h=p.next()){(g=h.value).classList.remove("reply_image_stories_unseen","reply_image_stories_unseen"+t),null===(a=(0,l.replyUserImageLinkClosest)(g))||void 0===a||a.removeAttribute("onclick")}}catch(e){o={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(o)throw o.error}}(0,d.removeAvatarRichOutlineAtNode)(e,String(t),_.AvatarRichOutlineType.STORIES_UNSEEN);var v=e.querySelectorAll(".post_image_stories_unseen"+t);try{for(var m=(0,i.__values)(v),y=m.next();!y.done;y=m.next()){var g;(g=y.value).classList.remove("post_image_stories_unseen","post_image_stories_unseen"+t),null===(c=g.closest(".post_image, ._post_image"))||void 0===c||c.removeAttribute("onclick")}}catch(e){s={error:e}}finally{try{y&&!y.done&&(n=m.return)&&n.call(m)}finally{if(s)throw s.error}}}function v(e,t,o,i){var l;if(e){var d=null===(l=window.cur.options)||void 0===l?void 0:l.max_post_full_length;if(!d)return!0;var _=(0,r.ge)(e);if(_){var c=(0,s.trim)(window.Emoji.val(_)).replace(/\n\n\n+/g,"\n\n");if(_.lastLen===c.length&&!i)return _.lastLen<=d;var u=_.lastLen=c.length;if(t=(0,r.ge)(t),u>d-100){var p=u>d;if(t&&(p?(o&&(n.FlatButton.isFlatButton(o)?n.FlatButton.setDisabled(o,!0):(0,r.toggleClass)(o,"button_disabled",!0)),t.innerHTML=(0,a.getLang)("text_exceeds_symbol_limit",u-d),(0,r.toggleClass)(t,"post_field_warning_red",!0)):t.innerHTML=(0,a.getLang)("text_N_symbols_remain",d-u),(0,r.show)(t)),p)return!1}else t&&(0,r.hide)(t);return t&&(0,r.toggleClass)(t,"post_field_warning_red",!1),o&&(n.FlatButton.isFlatButton(o)?n.FlatButton.setDisabled(o,!1):(0,r.toggleClass)(o,"button_disabled",!1)),!0}}}var m=function(e,t,o,i,r){void 0===o&&(o=u.REPLY_IMAGE_DEFAULT_SIZE),void 0===i&&(i=!1);var s=[t,"_post_field_image"];return r&&s.push(r),(0,c.renderAvatarToString)(e,o,null,s,null,void 0,!1,void 0,"",!(o<u.MIN_NFT_IMAGE_SIZE)&&i)}},485207:(e,t,o)=>{o.d(t,{isDebugEnabled:()=>i.isDebugEnabled,ENABLED_IN_POST_REPLY:()=>r});var i=o(464746),r=!1},582982:(e,t,o)=>{o.d(t,{reactionLogError:()=>s});var i=o(82701),r=o(385667),s=function(e){var t,o=e.error,s=(0,r.getReactionConfig)(),n=null!==(t=null==s?void 0:s.reportJsErrors)&&void 0!==t&&t;(0,i.reactionLogError)({error:o,reportError:n})}},385667:(e,t,o)=>{o.d(t,{storageAddSets:()=>u,getReactionSet:()=>p,storageSetConfig:()=>h,getReactionConfig:()=>v});var i=o(570655),r=o(659397),s=o(517760),n=o(419223),a=o(582982),l=o(95146),d=o(485207),_=(0,n.makeSharedState)("reactions-storage",(function(){return new Map}),{version:0}),c=(0,n.makeSharedState)("reactions-config",(function(){return{config:void 0}}),{version:0}),u=function(e){(0,d.isDebugEnabled)()&&console.log(e),Object.entries(e).forEach((function(e){var t=(0,i.__read)(e,2),o=t[0],n=t[1],d=(0,s.validateReactionSetPayloaditems)(n,o);if(d)(0,a.reactionLogError)({error:d.error});else{var c=n.map((function(e){return(0,i.__assign)((0,i.__assign)({},e),{title:(0,r.decodeHTMLEntities)(e.title)})}));_().set(o,(0,s.prepareReactionMenuSet)(o,c,{imageMenuSize:l.SIZE_96,imagePreviewSize:l.SIZE_32,imageStoryPanelSize:l.SIZE_128,imageStoryPreviewSize:l.SIZE_40}))}}))},p=function(e){var t=_().get(e);if(t)return t;var o=new Error("Reaction set not found: "+e);(0,a.reactionLogError)({error:o})},h=function(e){(0,d.isDebugEnabled)()&&console.log(e);var t=(0,s.parseReactionMenuConfig)(e);t?c().config=t:console.warn("Reactions: invalid menu config passed",e)},v=function(){var e;return null===(e=c())||void 0===e?void 0:e.config}},186699:(e,t,o)=>{o.d(t,{ReportReasonIds:()=>h,showReportForm:()=>m,afterCommentReportSubmit:()=>y});var i,r,s=o(570655),n=o(785893),a=o(769488),l=o(70162),d=o(196022),_=o(189798),c=o(448632),u=o(548838),p=o(856330);(0,d.makeAuthAndApiGlobal)();var h,v=window.vk;function m(e,t,i,r,a){var l=(0,u.asyncComponent)((function(){return Promise.all([o.e(24509),o.e(98066),o.e(68592),o.e(29019)]).then(o.bind(o,71018))}),(function(e){return e.ReportForm}));(0,p.showMessageBoxModalSuspense)((function(o){return(0,n.jsx)(l,(0,s.__assign)({},o,{reportSource:e,reportSourceOwnerId:t,reportSourceId:i,onSubmit:r}),void 0)}),{onDestroy:a})}function y(e,t,o){var i=function(e,t,o){switch(e){case"photo":return"#post"+t+"photo_"+o;case"video":return"#post"+t+"video_"+o+"mv";case"market":return"#post"+t+"market_"+o}}(e,t,o);if("photo"===e){var r=document.querySelector(i+" .dld");null!==r&&(r.outerHTML="")}var s=document.querySelector(i+" .reply_wrap");null!==s?(s.style.display="none",s.outerHTML+='<div class="dld">'+(0,l.getLang)("global_report_sent")+"</div>"):(0,a.debugLog)("Unable to hide report button for "+e+" comment")}(0,_.setLoginConfig)({onCaptcha:c.handleCaptcha,domain:null===(i=null==v?void 0:v.apiConfigDomains)||void 0===i?void 0:i.loginDomain}),(0,_.setApiConfig)({onCaptcha:c.handleCaptcha,domain:null===(r=null==v?void 0:v.apiConfigDomains)||void 0===r?void 0:r.apiDomain}),function(e){e[e.NotOriginalContent=28]="NotOriginalContent"}(h||(h={}))},77308:(e,t,o)=>{o.d(t,{removeUnseenStories:()=>a});var i=o(570655),r=o(563414),s=o(917258),n=o(506770);function a(e){var t,o,a,l=document.querySelectorAll(".search_item_img_stories_unseen"+e);try{for(var d=(0,i.__values)(l),_=d.next();!_.done;_=d.next()){var c=_.value;c.classList.remove("search_item_img_stories_unseen","search_item_img_stories_unseen"+e),null===(a=c.closest(".search_item_img_link"))||void 0===a||a.removeAttribute("onclick")}}catch(e){t={error:e}}finally{try{_&&!_.done&&(o=d.return)&&o.call(d)}finally{if(t)throw t.error}}(0,n.partConfigEnabled)("avatar_component_refactor_web")&&(0,r.removeAvatarRichOutlineAtNode)(document.body,String(e),s.AvatarRichOutlineType.STORIES_UNSEEN)}},632574:(e,t,o)=>{o.d(t,{AppsMetaStory:()=>c});var i=o(570655),r=o(785893),s=o(973935),n=o(239124),a=o(341319),l=o(70162),d=o(168373),_=o(10002),c=function(e){function t(t,o){var i=e.call(this,t,o)||this;if(!i.block.app)throw new Error("There is not an app info");return i.app=i.block.app,i}return(0,i.__extends)(t,e),t.prototype.update=function(){s.render((0,r.jsx)(d.MetaStory,{metaStoryInfo:(0,r.jsx)(_.MetaStoryInfo,{url:this.app.url,icon:this.app.photoUrl,header:this.app.name,urlText:(0,l.getLang)("stories_go_to_app")},void 0),list:this.block.grouped,listName:a.StoryListName.apps,isPaused:this.isPaused.bind(this),onLongTap:this.options.onLongTap,onScroll:this.onScroll,pause:this.options.pause,play:this.options.play,playNextStory:this.options.playNextStory,playPrevStory:this.options.playPrevStory},void 0),this.wrapper)},t}(n.MetaStory)},636442:(e,t,o)=>{o.d(t,{BaseStory:()=>i});var i=function(){function e(e){this.paused=!0,this.loaded=!1,this.startTs=0,this.failed=!1,this.options=e}return e.prototype.play=function(){this.paused=!1,this.isLoaded()&&this.options.onPlay()},e.prototype.pause=function(){this.paused=!0,this.options.onPause()},e.prototype.isPaused=function(){return this.paused},e.prototype.isLoaded=function(){return this.loaded},e.prototype.onStartLoading=function(){var e,t;null===(t=(e=this.options).onLoadingStart)||void 0===t||t.call(e)},e.prototype.canPlay=function(){var e,t;if(null===(t=(e=this.options).onLoadingEnd)||void 0===t||t.call(e),this.loaded=!0,this.startTs=Date.now(),!this.isPaused()){if("visible"!==document.visibilityState)return;this.play()}},e}()},936646:(e,t,o)=>{o.d(t,{ActionsButton:()=>v});var i=o(570655),r=o(785893),s=o(667294),n=o(70162),a=o(878134),l=o(342269),d=o(10141),_=o(501389),c=o(281536),u=o(341319),p=o(659397),h=o(533228),v=function(e){var t=e.story;if(!t.getCurStoryData())return null;var o,v=function(e){var t=e.getCurStoryData(),o=e.getCurrentNarrative(),r=e.layer.listName,s=[];if(!t)return s;var a=t.raw_id,c=t.can_hide_reply,p=t.report_hash,h=t.can_remove,v=t.isAds,m=t.canMarkNotInterested,y=e.data.can_blacklist,g=(0,i.__read)(a.split("_").map((function(e){return(0,l.intval)(e)})),2),f=g[0],w=g[1];(null==o?void 0:o.canEdit)&&s.push({label:(0,n.getLang)("stories_narrative_edit_button"),onClick:function(){return e.sendNarrativeEditButtonDidPress()}});f===window.vk.id||!y||o||v||s.push({label:(0,n.getLang)("stories_add_blacklist_button"),onClick:function(){return e.addToBlacklist()}});m&&s.push({label:(0,n.getLang)("stories_mark_not_interested"),onClick:function(t){var o,i=new MouseEvent("mouseout",{bubbles:!0});null===(o=t.nativeEvent.target)||void 0===o||o.dispatchEvent(i),e.markNotInterested()}});c&&s.push({label:(0,n.getLang)("stories_hide_reply_button"),onClick:function(){return e.hideReply()}});o&&(s.push({label:o.isBookmarked?(0,n.getLang)("stories_narrative_remove_bookmark_button"):(0,n.getLang)("stories_narrative_add_bookmark_button"),onClick:function(){return e.sendNarrativeBookmarkButtonDidPress()}}),s.push({label:(0,n.getLang)("stories_narrative_copy_link"),onClick:function(){var e=location.protocol+"//"+location.host+"/narrative"+f+"_"+o.id+"_"+w;(0,d.copyToClipboard)(e),(0,_.showDoneBox)((0,n.getLang)("stories_narrative_copy_link_done"))}}));p&&s.push({label:(0,n.getLang)("stories_report"),onClick:function(){return e.report()}});f===window.vk.id||o||s.push({label:(0,n.getLang)("stories_settings"),onClick:function(){return window.Stories.showBlackList()}});h&&o&&s.push({red:!0,label:(0,n.getLang)("stories_remove_from_narrative"),onClick:function(){return e.removeStoryFromNarrative()}});h&&s.push({red:!0,label:o?(0,n.getLang)("global_narrative_delete"):(0,n.getLang)("global_delete"),onClick:function(){return o?e.removeNarrativeBox():e.removeStoryBox()}});r===u.StoryListName.discover&&s.push({red:!0,label:(0,n.getLang)("stories_hide_discover"),onClick:function(){return e.hideDiscover()}});return s}(t);if(0===v.length)return null;var m=(0,s.createRef)(),y=(0,h.isNewDesignEnabled)();return(0,r.jsxs)("div",(0,i.__assign)({className:(0,p.classNames)("ui_actions_menu_wrap _ui_menu_wrap",{"StoryButton StoryButton--more StoryBottomControl ui_actions_menu_top":!y,ui_actions_menu_bottom:y}),onMouseEnter:function(e){clearTimeout(o),t.pauseStory(),a.default.show(m.current,e)},onMouseLeave:function(){a.default.hide(m.current),clearTimeout(o),o=setTimeout((function(){return t.autoResumeStory()}),300)},ref:m},{children:[(0,r.jsx)("div",(0,i.__assign)({className:"ui_actions_menu _ui_menu"},{children:v.map((function(e){var t=e.label,o=e.onClick,s=e.red,n=e.disable;return(0,r.jsx)("div",(0,i.__assign)({className:(0,p.classNames)("StoryMenuItem ui_actions_menu_item",{"StoryMenuItem--red":s,"StoryMenuItem--disable":n}),onClick:o},{children:t}),t)}))}),void 0),(0,r.jsx)(c.default,{},void 0)]}),void 0)}},408767:(e,t,o)=>{o.d(t,{default:()=>a});var i=o(570655),r=o(785893),s=o(497951),n=o(483295);const a=function(e){var t=e.title,o=e.additionalTitle,a=e.needSeparator,l=void 0===a||a,d=e.className,_=e.children;return(0,r.jsxs)("div",(0,i.__assign)({className:(0,n.classNames)("FeedbackBaseBlock",d,{"FeedbackSeparator FeedbackSeparator--top":l})},{children:[(0,r.jsx)(s.default,{title:t,additionalTitle:o},void 0),_]}),void 0)}},160637:(e,t,o)=>{o.d(t,{default:()=>a});var i=o(570655),r=o(785893),s=o(397784),n=o(408767);const a=function(e){var t=e.poll;return(0,r.jsx)(n.default,(0,i.__assign)({className:"FeedbackPollBlock",title:t.title},{children:(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackPollBlock__poll"},{children:(0,r.jsx)(s.default,{poll:t.data},void 0)}),void 0)}),void 0)}},547675:(e,t,o)=>{o.d(t,{default:()=>d});var i=o(570655),r=o(785893),s=o(667294),n=o(245415),a=o(408767),l=o(873589);const d=function(e){function t(t){var o=e.call(this,t)||this;return o.componentDidMount=function(){var e=o.scrollElement.current;e&&e.addEventListener("wheel",o.questionsMouseWheel)},o.componentWillUnmount=function(){var e=o.positionElement.current;e&&e.removeEventListener("wheel",o.questionsMouseWheel)},o.questionsMouseWheel=function(e){e.preventDefault(),o.props.questions.items.length<=1||o.setPosition(Math.abs(e.deltaY)>Math.abs(e.deltaX)?e.deltaY:e.deltaX)},o.setPosition=function(e){var t=o.positionElement.current;if(t){var r=o.state.scrollBlockPosition,s=(0,i.__read)((0,l.getSize)(t),1)[0],n=Math.max(0,Math.min(r+e,t.scrollWidth-s));o.setState({scrollBlockPosition:n})}},o.removeQuestion=function(e){var t=e.storyOwnerId,i=e.storyId,r=e.id,s=e.removeHash;window.ajax.post("al_stories.php",{act:"remove_question",story_owner_id:t,story_id:i,question_id:r,remove_hash:s},{onDone:function(){o.props.sendNavigationStatEvents("question_delete",!0,{question_id:r}),o.props.questions.items.length?o.setPosition(0):o.props.onQuestionRemove(r)}})},o.getReportReasons=function(){return new Promise((function(e,t){o.reportReasons.length?e(o.reportReasons):window.ajax.post("al_stories.php",{act:"question_report_box"},{onDone:function(t){return o.reportReasons=t,e(o.reportReasons),!0},onFail:function(e){return t(e),!0}})}))},o.state={scrollBlockPosition:0},o.reportReasons=[],o.scrollElement=(0,s.createRef)(),o.positionElement=(0,s.createRef)(),o}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.questions,o=this.state.scrollBlockPosition,s=t.items;return(0,r.jsx)(a.default,(0,i.__assign)({className:"FeedbackQuestionsBlock",title:t.title},{children:(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackQuestionsBlock__questions"},{children:(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackQuestionsBlock__wrapper",ref:this.scrollElement},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackQuestionsBlock__items",style:{transform:"translateX(-"+o+"px)"},ref:this.positionElement},{children:[(0,r.jsx)("div",{className:"FeedbackQuestionsBlock__gap"},void 0),s.map((function(t,o){return(0,r.jsx)(n.default,{question:t,storyUrl:e.props.storyUrl,showMessage:e.props.showMessage,removeQuestion:e.removeQuestion,getReportReasons:e.getReportReasons},o)})),(0,r.jsx)("div",{className:"FeedbackQuestionsBlock__gap"},void 0)]}),void 0)}),void 0)}),void 0)}),void 0)},t}(s.Component)},702632:(e,t,o)=>{o.d(t,{default:()=>d});var i=o(570655),r=o(785893),s=o(408767),n=o(896599),a=o(288420),l=o(70162);const d=function(e){var t=e.replies,o=e.showMore,d=t.list,_=Boolean(t.moreRepliesCount);return(0,r.jsxs)(s.default,(0,i.__assign)({className:"FeedbackRepliesBlock",title:t.title,additionalTitle:t.additionalTitle},{children:[(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackRepliesBlock__replies"},{children:null==d?void 0:d.map((function(e){var o;return(0,r.jsx)(n.default,{storyPack:e,listName:t.listName,source:t.source},null===(o=e.author)||void 0===o?void 0:o.id)}))}),void 0),_&&(0,r.jsx)(a.default,(0,i.__assign)({className:"FeedbackRepliesBlock__showMore",appearance:"tertiary",onClick:o},{children:(0,l.langNumeric)(t.moreRepliesCount||0,(0,l.getLang)("stories_replies_more_button","raw"))}),void 0)]}),void 0)}},164921:(e,t,o)=>{o.d(t,{default:()=>_});var i=o(570655),r=o(785893),s=o(550046),n=o(408767),a=o(70162),l=o(91574),d=o(719282);const _=function(e){var t=e.stats,o=e.extendedStats,_=e.onExtendedStatsPreviewClick,c=e.onSettingsBtnClick,u=e.onPrivacyHintHide;return(0,r.jsxs)(n.default,(0,i.__assign)({className:"FeedbackStatsBlock",title:t.title},{children:[o&&(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackStatsBlock__extendedStatsPreview FeedbackSeparator FeedbackSeparator--top",onClick:_,role:"button"},{children:[(0,r.jsx)(s.default,{appearance:"preview",title:(0,a.getLang)("stories_detailed_stats"),subtitle:o.preview},void 0),(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackStatsBlock__chevron"},{children:(0,r.jsx)(d.default,{},void 0)}),void 0)]}),void 0),t.showPrivacyHint&&(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackStatsBlock__privacyHint FeedbackSeparator FeedbackSeparator--top"},{children:[(0,a.getLang)("stories_privacy_feedback_hint"),(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackStatsBlock__links"},{children:[(0,r.jsx)(l.default,(0,i.__assign)({href:"/settings?act=privacy",onClick:c},{children:(0,a.getLang)("stories_go_to_settings")}),void 0),(0,r.jsx)("span",{className:"dvd"},void 0),(0,r.jsx)(l.default,(0,i.__assign)({onClick:u},{children:(0,a.getLang)("global_hide_notify")}),void 0)]}),void 0)]}),void 0),t.showEmptyStatsPrivacyHint&&(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackStatsBlock__emptyStatsPrivacyHint"},{children:[(0,r.jsx)("div",{className:"FeedbackStatsBlock__emptyStatsPrivacyIcon"},void 0),(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackStatsBlock__emptyStatsPrivacyText"},{children:(0,a.getLang)("stories_privacy_empty_views_hint")}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackStatsBlock__emptyStatsPrivacyLink"},{children:(0,r.jsx)(l.default,(0,i.__assign)({href:"/settings?act=privacy",onClick:c},{children:(0,a.getLang)("stories_go_to_settings")}),void 0)}),void 0)]}),void 0)]}),void 0)}},497951:(e,t,o)=>{o.d(t,{default:()=>n});var i=o(570655),r=o(785893),s=o(213984);const n=function(e){var t=e.title,o=e.additionalTitle;return(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackTitle"},{children:[(0,r.jsx)(s.default,{children:t},void 0),o&&(0,r.jsx)(s.default,(0,i.__assign)({className:"FeedbackTitle__additional"},{children:o}),void 0)]}),void 0)}},584282:(e,t,o)=>{o.d(t,{default:()=>S});var i=o(570655),r=o(785893),s=o(667294),n=o(740733),a=o(550046),l=o(547675),d=o(408767),_=o(164921),c=o(702632),u=o(160637),p=o(480757),h=o(483295),v=o(368752),m=o(146143),y=o(70162),g=o(659397),f=o(733024),w=o(23515);const S=function(e){function t(t){var o=e.call(this,t)||this;return o.onQuestionRemove=function(e){o.props.onQuestionRemove(e)},o.close=function(){o.props.toggleFeedbackTooltip(!1)},o.onSettingsBtnClick=function(){o.props.sendNavigationStatEvents("go_to_settings")},o.onPrivacyHintHide=function(){o.props.onPrivacyHintHide()},o.onExtendedStatsPreviewClick=function(){var e=o.props.sendNavigationStatEvents;o.unObserveViewerScroll(),o.unObserveTitleChanges(),o.setState({extendedStatsActive:!0}),e("open_advanced_statistic")},o.onBackBtnClick=function(){o.unObserveTitleChanges(),o.setState({extendedStatsActive:!1})},o.state={isViewersLoading:!1,extendedStatsActive:!1},o.mounted=!1,o.scrollContainerRef=(0,s.createRef)(),o.viewsSentinelRef=(0,s.createRef)(),o.titles=[],o.viewsObserver=null,o.activeHeader=null,o.onScrollHandler=null,o}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.feedback,o=e.showMessage,v=e.sendNavigationStatEvents,m=e.storyImageUrl,S=e.showMoreReplies,E=e.needShowEmptyStats,b=e.className,k=e.reactionSet,T=this.state,C=T.isViewersLoading,L=T.extendedStatsActive,M=null==t?void 0:t.stats,P=null==M?void 0:M.extendedStats,B=null==t?void 0:t.replies,A=null==t?void 0:t.poll,I=null==t?void 0:t.questions,D=null==t?void 0:t.viewers;return(0,r.jsx)("div",(0,i.__assign)({className:(0,h.classNames)("FeedbackTooltip",b,{"FeedbackTooltip--empty":E}),onClick:function(e){return e.stopPropagation()}},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackTooltip__wrapper"},{children:[(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackTooltip__close",onClick:this.close},{children:(0,r.jsx)(f.default,{},void 0)}),void 0),!t&&(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackTooltip__spinner"},{children:(0,r.jsx)(n.default,{size:36,color:"#6590c7",strokeWidth:3},void 0)}),void 0),t&&(0,r.jsxs)(s.Fragment,{children:[!L&&(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackTooltip__inner",ref:this.scrollContainerRef},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackTooltip__content"},{children:[M&&(0,r.jsx)(_.default,{stats:M,extendedStats:P,onExtendedStatsPreviewClick:this.onExtendedStatsPreviewClick,onSettingsBtnClick:this.onSettingsBtnClick,onPrivacyHintHide:this.onPrivacyHintHide},void 0),B&&(0,r.jsx)(c.default,{replies:B,showMore:S},void 0),A&&(0,r.jsx)(u.default,{poll:A},void 0),I&&(0,r.jsx)(l.default,{showMessage:o,storyUrl:m,questions:I,sendNavigationStatEvents:v,onQuestionRemove:this.onQuestionRemove},void 0),D&&(0,r.jsx)(p.default,{viewers:D,reactionSet:k,isLoading:C,needSeparator:!t.questions},void 0),Boolean(null==D?void 0:D.nextFrom)&&(0,r.jsx)("div",{className:"FeedbackTooltip__sentinel",ref:this.viewsSentinelRef},void 0)]}),void 0)}),void 0),P&&L&&(0,r.jsxs)(s.Fragment,{children:[(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackTooltip__header FeedbackSeparator FeedbackSeparator--bottom"},{children:[(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackTooltip__back",onClick:this.onBackBtnClick},{children:[(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackTooltip__backIcon"},{children:(0,r.jsx)(w.default,{},void 0)}),void 0),(0,y.getLang)("global_back")]}),void 0),(0,y.getLang)("stories_detailed_stats")]}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackTooltip__inner",ref:this.scrollContainerRef},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackTooltip__content"},{children:[P.achievement&&(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackTooltip__achievement"},{children:(0,r.jsx)(a.default,{appearance:"achievement",title:P.achievement,subtitle:P.achievementSubtitle},void 0)}),void 0),P.categories.map((function(e,t){return(0,r.jsx)(d.default,(0,i.__assign)({title:e.title},{children:(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackTooltip__lines"},{children:e.lines.map((function(e,t){return(0,r.jsxs)("div",(0,i.__assign)({className:"FeedbackTooltip__line"},{children:[(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackStatName"},{children:(0,g.decodeHTMLEntities)(e.name)}),void 0),(0,r.jsx)("div",{className:"FeedbackStatCounter",dangerouslySetInnerHTML:{__html:e.counter}},void 0)]}),t)}))}),void 0)}),t)}))]}),void 0)}),void 0)]},void 0)]},void 0)]}),void 0)}),void 0)},t.prototype.componentDidMount=function(){var e=this,t=this.props,o=t.feedback,i=t.storyRawId,r=t.onFetchFeedbackData;if(this.mounted=!0,o)return this.observeTitleChanges(),void this.observeViewerScrollIfNeeded();window.ajax.post("al_stories.php",{act:"get_feedback",story_raw:i},{onDone:function(t){e.mounted&&r(t)},onFail:function(){return(0,m.showFastBox)((0,y.getLang)("global_error"),(0,y.getLang)("global_unknown_error")),e.close(),!0}})},t.prototype.componentDidUpdate=function(e,t){!e.feedback&&this.props.feedback&&(this.observeTitleChanges(),this.observeViewerScrollIfNeeded()),!t.extendedStatsActive&&this.state.extendedStatsActive?this.observeTitleChanges():t.extendedStatsActive&&!this.state.extendedStatsActive&&(this.observeTitleChanges(),this.observeViewerScrollIfNeeded())},t.prototype.componentWillUnmount=function(){this.unObserveTitleChanges(),this.unObserveViewerScroll(),this.mounted=!1},t.prototype.loadViewers=function(){var e,t=this,o=this.props,i=o.storyRawId,r=o.feedback,s=o.onFetchViewers;this.state.isViewersLoading||(null===(e=null==r?void 0:r.viewers)||void 0===e?void 0:e.nextFrom)&&(this.setState({isViewersLoading:!0}),window.ajax.post("al_stories.php",{act:"get_viewers",story_raw:i,offset:r.viewers.nextFrom},{onDone:function(e){s(e),t.setState({isViewersLoading:!1})},onFail:function(){return(0,m.showFastBox)((0,y.getLang)("global_error"),(0,y.getLang)("global_unknown_error")),t.setState({isViewersLoading:!1}),!0}}))},t.prototype.observeViewerScrollIfNeeded=function(){var e,t=this,o=this.props.feedback;if(null===(e=null==o?void 0:o.viewers)||void 0===e?void 0:e.nextFrom){var i=this.scrollContainerRef.current,r=this.viewsSentinelRef.current;if(!r)return;this.viewsObserver=new IntersectionObserver((function(e){e.forEach((function(e){e.intersectionRatio>0&&t.loadViewers()}))}),{threshold:[0,1],root:i,rootMargin:"0px 0px 336px 0px"}),this.viewsObserver.observe(r)}},t.prototype.unObserveViewerScroll=function(){this.viewsObserver&&this.viewsObserver.disconnect()},t.prototype.observeTitleChanges=function(){var e=this,t=this.scrollContainerRef.current;t&&(this.updateTitles(),this.onScrollHandler=(0,v.debounce)((function(){!e.titles.some((function(t,o){if(t.offsetTop)return t===e.activeHeader||e.setActiveHeader(t),!0;if(e.titles[o+1]){var i=e.titles[o+1],r=e.titles[o+1].parentElement,s=r&&r.offsetHeight;return!!s&&(i.offsetTop+i.offsetHeight===s&&(t===e.activeHeader||e.setActiveHeader(t),!0))}return!1}))&&e.activeHeader&&(e.activeHeader.classList.remove("FeedbackTitle--active"),e.activeHeader=null)}),5),t.addEventListener("scroll",this.onScrollHandler))},t.prototype.updateTitles=function(){var e=this.scrollContainerRef.current;e&&(this.titles=Array.from(e.querySelectorAll(".FeedbackTitle")),this.titles.reverse())},t.prototype.unObserveTitleChanges=function(){this.scrollContainerRef.current&&this.onScrollHandler&&this.scrollContainerRef.current.removeEventListener("scroll",this.onScrollHandler),this.onScrollHandler=null,this.titles=[]},t.prototype.setActiveHeader=function(e){this.activeHeader&&this.activeHeader.classList.remove("FeedbackTitle--active"),this.activeHeader=e,e.classList.add("FeedbackTitle--active")},t}(s.Component)},480757:(e,t,o)=>{o.d(t,{default:()=>l});var i=o(570655),r=o(785893),s=o(659569),n=o(740733),a=o(408767);const l=function(e){var t=e.viewers,o=e.isLoading,l=void 0!==o&&o,d=e.needSeparator,_=void 0===d||d,c=e.reactionSet;return(0,r.jsxs)(a.default,(0,i.__assign)({className:"FeedbackViewersBlock",title:t.title,needSeparator:_},{children:[t.hiddenReason&&(0,r.jsx)("span",(0,i.__assign)({className:"FeedbackViewersBlock__hiddenReason"},{children:t.hiddenReason}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackViewersBlock__items"},{children:t.items.map((function(e,t){return(0,r.jsx)(s.default,{user:e,reactionSet:c},t)}))}),void 0),l&&(0,r.jsx)("div",(0,i.__assign)({className:"FeedbackViewersBlock__spinner"},{children:(0,r.jsx)(n.default,{size:18,color:"#6590c7",strokeWidth:2},void 0)}),void 0)]}),void 0)}},550046:(e,t,o)=>{o.d(t,{default:()=>n});var i=o(570655),r=o(785893),s=o(659397);const n=function(e){var t=e.title,o=e.subtitle,n=e.appearance,a=void 0===n?"preview":n;return(0,r.jsxs)("div",(0,i.__assign)({className:"InfoAside InfoAside--"+a},{children:[(0,r.jsx)("div",{className:"InfoAside__image"},void 0),(0,r.jsxs)("div",(0,i.__assign)({className:"InfoAside__description"},{children:[(0,r.jsx)("span",(0,i.__assign)({className:"InfoAside__title"},{children:(0,s.decodeHTMLEntities)(t)}),void 0),(0,r.jsx)("span",(0,i.__assign)({className:"InfoAside__subtitle"},{children:(0,s.decodeHTMLEntities)(o)}),void 0)]}),void 0)]}),void 0)}},397784:(e,t,o)=>{o.d(t,{default:()=>p});var i=o(570655),r=o(785893),s=o(483295),n=o(70162),a=o(583285),l=o(274642),d=o(613104),_=o(659397);function c(e){var t="";if(e.type===d.PollBackgroundType.photo)t="#"+e.backgroundColor;else if(e.type===d.PollBackgroundType.gradient){t="linear-gradient("+(e.angle-90)+"deg, "+e.points.map((function(e){return"#"+e.color+" "+Math.round(100*e.position)+"%"})).join(", ")+")"}return t}function u(e){var t=e.ownerId,o=e.pollId;e.needShowResults?(0,l.showWiki)({w:"poll"+t+"_"+o},!1,void 0,{customRef:"story"}):(0,a.showPollBox)(o,{ref:"story",className:"story_poll"})}const p=function(e){var t=e.poll,o=function(e){var t=e.background;return(0,r.jsx)("div",(0,i.__assign)({className:"PollSnippet__background",style:{background:c(t)}},{children:t.type===d.PollBackgroundType.photo&&(0,r.jsx)("div",{className:"PollSnippet__photo",style:{backgroundImage:"url("+t.photoUrl+")"}},void 0)}),void 0)}(t);return(0,r.jsxs)("div",(0,i.__assign)({className:(0,s.classNames)("PollSnippet",{"PollSnippet--default":t.background.type===d.PollBackgroundType.default})},{children:[o,(0,r.jsx)("div",(0,i.__assign)({className:"PollSnippet__question"},{children:(0,_.decodeHTMLEntities)(t.question)}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"PollSnippet__countVoters"},{children:(0,_.decodeHTMLEntities)(t.votersCountText)}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"PollSnippet__showResult",onClick:u.bind(null,t)},{children:(0,n.getLang)("stories_voting_show_result")}),void 0)]}),void 0)}},245415:(e,t,o)=>{o.d(t,{default:()=>y});var i=o(570655),r=o(785893),s=o(667294),n=o(781402),a=o(288420),l=o(118690),d=o(258668),_=o(483295),c=o(70162),u=o(659397),p=o(342269),h=o(152278),v=o(186699),m=o(536741);const y=function(e){function t(t){var o=e.call(this,t)||this;return o.componentDidMount=function(){var e=o.questionTextEl.current;e&&o.adjustQuestionTextSize(e)},o.componentDidUpdate=function(){o.replyTextareaEl.current&&o.replyTextareaEl.current.focus()},o.render=function(){var e=o.state,t=e.isOpenReplyModal,s=e.replyText,l=o.props,d=l.question,p=l.storyUrl,h=d.author,v=d.canAnswer,m=d.text,y=(0,u.decodeHTMLEntities)(m),g=(0,_.classNames)("StoryQuestion__title",{"StoryQuestion__title--free":!v});return(0,r.jsxs)("div",(0,i.__assign)({className:"StoryQuestion"},{children:[(0,r.jsxs)("div",(0,i.__assign)({className:"StoryQuestion__content"},{children:[o.renderAuthor(),(0,r.jsx)("span",(0,i.__assign)({className:g,title:y,ref:o.questionTextEl},{children:y}),void 0)]}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"StoryQuestion__controls"},{children:v&&(0,r.jsx)(a.default,(0,i.__assign)({className:"StoryQuestion__reply",appearance:d.isPublished?"secondary":"primary",size:"s",wide:!0,onClick:o.openReplyModal},{children:(0,c.getLang)("stories_question_reply")}),void 0)}),void 0),t&&(0,r.jsx)(n.default,(0,i.__assign)({title:(0,c.getLang)("stories_question_reply_box_title").replace("{name}",(0,u.decodeHTMLEntities)(h.nameDat)),actionButtons:o.getReplyModalActions(),className:"StoryQuestion__replyModal",onClose:o.closeReplyModal,appearance:"blue"},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"StoryQuestion__inner"},{children:[(0,r.jsx)("textarea",{ref:o.replyTextareaEl,className:"StoryQuestion__textarea",placeholder:(0,c.getLang)("stories_question_reply_placeholder"),onChange:o.handleChange,onKeyDown:o.handleKeyDown,value:s},void 0),(0,r.jsx)("img",{srcSet:p,className:"StoryQuestion__image"},void 0)]}),void 0)}),void 0)]}),void 0)},o.renderAuthor=function(){var e=o.props.question,t=e.id,s=e.isAnonymous,n=e.author,a="StoryQuestion__author",l=(0,u.decodeHTMLEntities)(n.name);return(0,r.jsxs)("div",(0,i.__assign)({className:"StoryQuestion__header"},{children:[s&&(0,r.jsx)("span",(0,i.__assign)({className:a},{children:l}),void 0),!s&&(0,r.jsx)("a",(0,i.__assign)({href:n.link,className:a,onClick:function(){return window.cur.storyLayer.sendNavigationStatEvents("question_go_to_author",!0,{questionId:t})}},{children:l}),void 0),(0,r.jsx)(d.default,(0,i.__assign)({position:"b",align:"right",trigger:"hover",data:o.getActions()},{children:(0,r.jsx)("span",(0,i.__assign)({className:"StoryQuestion__actions"},{children:(0,r.jsx)(m.default,{},void 0)}),void 0)}),void 0)]}),void 0)},o.getActions=function(){var e=o.props.question,t=o.state.isAuthorBan,i=[{text:(0,c.getLang)("stories_question_delete"),onClick:function(){return o.props.removeQuestion(e)}}];return e.canBlocked&&(t?i.push({text:(0,c.getLang)("stories_question_author_unban"),onClick:o.unbanAuthor}):i.push({text:(0,c.getLang)("stories_question_author_ban"),onClick:o.banAuthor}),i.push({text:(0,c.getLang)("stories_question_author_report"),onClick:o.showReportForm})),i},o.adjustQuestionTextSize=function(e){if(e.scrollHeight>e.offsetHeight){var t=getComputedStyle(e),i=parseInt(t.fontSize)-.5,r=i+2.5,s=Math.floor(parseInt(t.height)/r);i>10&&(e.setAttribute("style","font-size: "+i+"px; line-height: "+r+"px; -webkit-line-clamp: "+s+";"),setTimeout((function(){o.adjustQuestionTextSize(e)}),0))}},o.getReplyModalActions=function(){var e=o.state,t=e.isReplyButtonLoading,s=e.replyText;return[(0,r.jsx)(a.default,(0,i.__assign)({appearance:"tertiary",onClick:o.closeReplyModal},{children:(0,c.getLang)("global_cancel")}),"closeReplyModal"),(0,r.jsx)(l.default,(0,i.__assign)({loading:t,disabled:!(0,p.trim)(s),onClick:o.sendReply},{children:(0,c.getLang)("stories_question_reply_send")}),"replySend")]},o.openReplyModal=function(){o.setState({isOpenReplyModal:!0})},o.closeReplyModal=function(){o.setState({isOpenReplyModal:!1})},o.handleChange=function(e){o.setState({replyText:e.target.value})},o.handleKeyDown=function(e){var t=o.state.replyText;(0,p.trim)(t)&&"keydown"===e.type&&(e.ctrlKey||e.metaKey)&&e.keyCode==h.KEY.RETURN&&o.sendReply()},o.resetReplyText=function(){o.setState({replyText:""})},o.sendReply=function(){var e=o.state.replyText,t=o.props,i=t.question,r=t.showMessage,s=i.text,n=i.id,a=i.ownerId,l=i.storyOwnerId,d=i.storyId,_=i.sendHash,u=e+"\n\n🗣 "+(0,p.unclean)(s),h="story:"+l+"_"+d;window.ajax.post("al_im.php",{act:"a_send",msg:u,hash:_,media:h,to:a,entrypoint:"stories_comment"},{onDone:function(){o.closeReplyModal(),o.resetReplyText(),r((0,c.getLang)("stories_answer_sent")),window.cur.storyLayer.sendNavigationStatEvents("question_send_message",!0,{questionId:n})},onFail:function(e){return o.closeReplyModal(),o.resetReplyText(),r(e),!0},showProgress:function(){return o.setState({isReplyButtonLoading:!0})},hideProgress:function(){return o.setState({isReplyButtonLoading:!1})}})},o.banAuthor=function(){var e=o.props,t=e.question,i=e.showMessage,r=t.storyOwnerId,s=t.storyId,n=t.id,a=t.banHash,l=t.isAnonymous;window.ajax.post("al_stories.php",{act:"ban_author_question",story_owner_id:r,story_id:s,question_id:n,ban_hash:a},{onDone:function(){o.setState({isAuthorBan:!0}),i((0,c.getLang)("stories_question_author_blocked"));var e="question_ban_author";l&&(e="question_ban_anonymous_author"),window.cur.storyLayer.sendNavigationStatEvents(e,!0,{questionId:n})},onFail:function(e){return i(e),!0}})},o.unbanAuthor=function(){var e=o.props,t=e.question,i=e.showMessage,r=t.storyOwnerId,s=t.storyId,n=t.id,a=t.banHash;window.ajax.post("al_stories.php",{act:"unban_author_question",story_owner_id:r,story_id:s,question_id:n,ban_hash:a},{onDone:function(){o.setState({isAuthorBan:!1}),i((0,c.getLang)("stories_question_author_unblocked"))},onFail:function(e){return i(e),!0}})},o.showReportForm=function(){(0,v.showReportForm)("story_question",o.props.question.ownerId,o.props.question.id,(function(){return o.props.showMessage((0,c.getLang)("stories_report_sent"))}))},o.state={isAuthorBan:t.question.isOwnerBlocked,replyText:"",isOpenReplyModal:!1,isReplyButtonLoading:!1,isReportButtonLoading:!1,selectReasons:0},o.replyTextareaEl=(0,s.createRef)(),o.questionTextEl=(0,s.createRef)(),o}return(0,i.__extends)(t,e),t}(s.Component)},896599:(e,t,o)=>{o.d(t,{default:()=>d});var i=o(570655),r=o(785893),s=o(483295),n=o(173471),a=o(659397);function l(e){return e.items.some((function(e){return e.unread}))}const d=function(e){var t=e.storyPack,o=e.listName,d=e.source;return(0,r.jsxs)("a",(0,i.__assign)({href:t.author.href,className:(0,s.classNames)("StoryReply",{"StoryReply--new":l(t)}),onClick:function(e){e.metaKey||e.ctrlKey||((0,n.showStory)(t.author.id+"/"+o,{fromEl:e.target,source:d}),e.preventDefault())},role:"button"},{children:[(0,r.jsx)("div",(0,i.__assign)({className:"StoryReply__avatar"},{children:(0,r.jsx)("div",{className:"StoryReply__image",style:{backgroundImage:"url("+t.author.photo+")"}},void 0)}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"StoryReply__caption"},{children:(0,a.decodeHTMLEntities)(t.author.firstName)}),void 0)]}),void 0)}},659569:(e,t,o)=>{o.d(t,{default:()=>c});var i=o(570655),r=o(785893),s=o(80706),n=o(483295),a=o(659397),l=o(517760),d=o(506770),_=o(917258);const c=function(e){var t,o,c=e.user,u=e.reactionSet,p=(0,a.decodeHTMLEntities)(c.name),h=(0,d.partConfigEnabled)("avatar_component_refactor_web");return u&&null!=c.reaction_id&&(o=null===(t=(0,l.getReaction)(u,c.reaction_id))||void 0===t?void 0:t.imageStoryPreviewURL),(0,r.jsxs)("a",(0,i.__assign)({href:c.url,className:"Viewer",role:"button"},{children:[h&&(0,r.jsx)(_.AvatarRich,{src:c.photoUrl,isNFT:Boolean(c.nft),size:40,wrapperClassName:(0,n.classNames)("Viewer__avatar",{"Viewer__avatar--isLiked":c.isLiked&&!o}),badge:o?(0,r.jsx)("div",{className:"Viewer__reaction Viewer__reaction--nft",style:{backgroundImage:"url("+o+")"}},void 0):void 0},void 0),!h&&(0,r.jsxs)("div",(0,i.__assign)({className:(0,n.classNames)("Viewer__avatar",{"Viewer__avatar--isLiked":c.isLiked&&!o}),title:p},{children:[(0,r.jsx)("img",{className:"Viewer__img",src:c.photoUrl,alt:p},void 0),Boolean(o)&&(0,r.jsx)("div",{className:"Viewer__reaction",style:{backgroundImage:"url("+o+")"}},void 0)]}),void 0),(0,r.jsx)(s.default,(0,i.__assign)({className:"Viewer__name",isVerified:c.isVerified},{children:p}),void 0)]}),void 0)}},613104:(e,t,o)=>{var i;o.d(t,{PollBackgroundType:()=>i}),function(e){e.photo="photo",e.gradient="gradient",e.default="default"}(i||(i={}))},168373:(e,t,o)=>{o.d(t,{MetaStory:()=>u});var i=o(570655),r=o(785893),s=o(667294),n=o(733164),a=o(117173),l=o(659397),d=o(154109),_=o(302225),c=o(468916),u=function(e){function t(t){var o=e.call(this,t)||this;return o.infoRef=(0,s.createRef)(),o.onScroll=function(e){var t,i;if(o.infoRef.current){var r=e.currentTarget,s=Boolean(r.scrollTop),n=s?Math.min(r.scrollTop/286,1):0;null===(i=(t=o.props).onTopScrolled)||void 0===i||i.call(t,n>=1),o.props.onScroll(s),o.setState({isScrolling:s}),s?o.props.pause():o.props.play();var a=s?Math.max(.6-n,0):1;o.infoRef.current.style.opacity=""+a}},o.onClickableAreaMouseDown=function(){o.downTs=(0,n.vkNow)(),o.longTapTimer=setTimeout(o.props.onLongTap,a.LONG_PRESS_DELAY_MS)},o.onClickableAreaMouseUp=function(e){clearTimeout(o.longTapTimer);var t=e.target,i=!((0,n.vkNow)()-o.downTs<a.LONG_PRESS_DELAY_MS);if(t.classList.contains("MetaStory__navigationArea--back")&&!i)return o.props.playPrevStory();i?o.props.isPaused()&&o.props.play(!1,!!o.downTs):o.props.playNextStory()},o.loadMore=function(){return o.props.loadMore?o.props.loadMore():Promise.resolve()},o.state={isScrolling:!1},o}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.metaStoryInfo,o=e.list,s=e.listName,n=e.source,a=this.state.isScrolling,u=!o||!o.length;return(0,r.jsxs)("div",(0,i.__assign)({className:"MetaStory"},{children:[(0,r.jsx)("div",(0,i.__assign)({className:"MetaStory__infoWrapper",style:{paddingBottom:"286px"},ref:this.infoRef},{children:(0,r.jsx)("div",(0,i.__assign)({className:"MetaStory__info"},{children:t}),void 0)}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:(0,l.classNames)("MetaStory__pane",{"MetaStory__pane--scrolling":a})},{children:(0,r.jsxs)(c.default,(0,i.__assign)({className:(0,l.classNames)("MetaStory__container",{"MetaStory__container--isEmpty":u}),hasMore:this.hasMore(),loadMore:this.loadMore,onScroll:this.onScroll,threshold:500,spinnerColor:"#fff"},{children:[(0,r.jsxs)("div",(0,i.__assign)({className:"MetaStory__navigation",onMouseDown:this.onClickableAreaMouseDown,onMouseUp:this.onClickableAreaMouseUp},{children:[(0,r.jsx)("div",{className:"MetaStory__navigationArea MetaStory__navigationArea--back"},void 0),(0,r.jsx)("div",{className:"MetaStory__navigationArea MetaStory__navigationArea--next"},void 0)]}),void 0),(0,r.jsxs)("div",(0,i.__assign)({className:"MetaStory__grid",style:{minHeight:"calc(100% - 286px"}},{children:[o&&o.map((function(e){return(0,r.jsx)(d.MetaStoryItemPreview,{block:e,list:o,listName:s,source:n},e.id)})),u&&(0,i.__spreadArray)([],(0,i.__read)(Array(9)),!1).map((function(e,t){return(0,r.jsx)(_.MetaStoryItemPreviewSkeleton,{},t)}))]}),void 0)]}),void 0)}),void 0)]}),void 0)},t.prototype.componentWillUnmount=function(){clearTimeout(this.longTapTimer)},t.prototype.hasMore=function(){return!!this.props.hasMore&&this.props.hasMore()},t}(s.Component)},10002:(e,t,o)=>{o.d(t,{MetaStoryInfo:()=>n});var i=o(570655),r=o(785893),s=o(659397),n=function(e){var t=e.header,o=e.subheader,n=e.url,a=e.urlText,l=e.icon,d=(0,r.jsxs)(r.Fragment,{children:[l&&"string"==typeof l&&(0,r.jsx)("div",{className:"MetaStoryInfo__icon",style:{backgroundImage:"url("+l+")"}},void 0),l&&"object"==typeof l&&(0,r.jsx)("div",(0,i.__assign)({className:"MetaStoryInfo__icon MetaStoryInfo__icon--inline"},{children:l}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"MetaStoryInfo__header"},{children:(0,s.decodeHTMLEntities)(t)}),void 0),o&&(0,r.jsx)("div",(0,i.__assign)({className:"MetaStoryInfo__subheader"},{children:(0,s.decodeHTMLEntities)(o)}),void 0),n&&a&&(0,r.jsx)("div",(0,i.__assign)({className:"MetaStoryInfo__pseudoLink"},{children:a}),void 0)]},void 0);return n?(0,r.jsx)("a",(0,i.__assign)({href:n,className:"MetaStoryInfo",target:"_blank"},{children:d}),void 0):(0,r.jsx)("div",(0,i.__assign)({className:"MetaStoryInfo"},{children:d}),void 0)}},154109:(e,t,o)=>{o.d(t,{MetaStoryItemPreview:()=>c});var i=o(570655),r=o(785893),s=o(667294),n=o(659397),a=o(533228),l=o(341319),d=o(506770),_=o(917258),c=function(e){function t(t){var o=e.call(this,t)||this;return o.isMount=!1,o.currentStoryRawId="",o.onClick=function(e){var t=o.props.source;window.Stories.show((0,a.getStoryBlockKey)(o.props.block)+"/"+o.props.listName,{fromEl:e.target,source:t},o.props.list)},o.onImageLoad=function(e){var t,r=o.state.isFullImageLoadedMap;o.isMount&&(r[e]||o.setState({isFullImageLoadedMap:(0,i.__assign)((0,i.__assign)({},r),(t={},t[e]=!0,t))}))},o.state={isFullImageLoadedMap:{}},o}return(0,i.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,o=t.block,s=t.className,a=this.state.isFullImageLoadedMap,c=this.getCurrentStory(),u=c.unread,p="",h=Boolean(null===(e=o.author)||void 0===e?void 0:e.nft),v=c.type===l.StoryType.LIVE,m=(0,d.partConfigEnabled)("avatar_component_refactor_web"),y=void 0;return v?y=_.AvatarRichOutlineType.LIVE:u&&(y=_.AvatarRichOutlineType.STORIES_UNSEEN),p=a[c.raw_id]||!c.preview_url?c.small_preview:c.preview_url,(0,r.jsx)("span",(0,i.__assign)({className:(0,n.classNames)("MetaStoryItemPreview",{"MetaStoryItemPreview--live":v},"MetaStoryItemPreviewLayout",s),onClick:this.onClick},{children:o.author&&(0,r.jsxs)("div",(0,i.__assign)({className:"MetaStoryItemPreview__inner"},{children:[(0,r.jsx)("img",{src:p,className:"MetaStoryItemPreview__image",alt:"",loading:"lazy"},void 0),m&&(0,r.jsx)(_.AvatarRich,{src:o.author.photo,href:o.author.href,isNFT:h,size:28,outlineType:y,wrapperClassName:"MetaStoryItemPreview__avatar"},void 0),!m&&(0,r.jsx)("a",{href:o.author.href,className:(0,n.classNames)("MetaStoryItemPreview__author",{"MetaStoryItemPreview__author--unread":u}),style:{backgroundImage:"url('"+o.author.photo+"')"}},void 0),(0,r.jsx)("span",(0,i.__assign)({className:"MetaStoryItemPreview__title"},{children:(0,n.decodeHTMLEntities)(o.author.name)}),void 0)]}),void 0)}),void 0)},t.prototype.componentDidMount=function(){this.isMount=!0,this.loadCurrentStoryPreviewIfNeeded()},t.prototype.componentDidUpdate=function(){this.loadCurrentStoryPreviewIfNeeded()},t.prototype.loadCurrentStoryPreviewIfNeeded=function(){var e=this,t=this.getCurrentStory();if(t.raw_id!==this.currentStoryRawId&&(this.currentStoryRawId=t.raw_id,!this.state.isFullImageLoadedMap[t.raw_id])){var o=new Image;o.src=t.small_preview,o.onload=function(){return e.onImageLoad(t.raw_id)}}},t.prototype.getCurrentStory=function(){var e=this.props.block,t=e.items.find((function(e){return e.unread}));return t||(t=e.items[0]),t},t}(s.Component)},302225:(e,t,o)=>{o.d(t,{MetaStoryItemPreviewSkeleton:()=>s});var i=o(570655),r=o(785893),s=function(){return(0,r.jsx)("div",(0,i.__assign)({className:"MetaStoryItemPreviewSkeleton MetaStoryItemPreviewLayout"},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"MetaStoryItemPreviewSkeleton__inner"},{children:[(0,r.jsx)("div",{className:"MetaStoryItemPreviewSkeleton__author"},void 0),(0,r.jsx)("div",{className:"MetaStoryItemPreviewSkeleton__title"},void 0)]}),void 0)}),void 0)}},965430:(e,t,o)=>{o.d(t,{ReactionsPanel:()=>a});var i=o(570655),r=o(785893),s=o(66295),n=o(483295),a=function(e){var t=e.className,o=e.stickers,a=e.onStickerClick,l=e.title,d=function(e){s.StickersAnimation.loadAndPlaySticker(e.currentTarget)};return(0,r.jsx)("div",(0,i.__assign)({className:(0,n.classNames)("ReactionsPanel",t)},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"ReactionsPanel__container"},{children:[Boolean(l)&&(0,r.jsx)("div",(0,i.__assign)({className:"ReactionsPanel__title"},{children:l}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"ReactionsPanel__items"},{children:o.map((function(e,t){return function(e,t){var o=e.animationUrl?"sticker_img":"";return(0,r.jsx)("div",(0,i.__assign)({className:"ReactionsPanel__item","data-pack-id":e.packId,"data-sticker-id":e.id,"data-uniq-id":e.uniqId,"data-animation-path":e.animationUrl,"data-animation-class":"ReactionsPanel__itemAnimation",onMouseDown:function(){return a(e.id,t)},onMouseEnter:d},{children:(0,r.jsx)("div",{className:(0,n.classNames)("ReactionsPanel__itemImage",o),style:{backgroundImage:"url("+e.imageUrl+")"}},void 0)}),e.id)}(e,t)}))}),void 0)]}),void 0)}),void 0)}},914714:(e,t,o)=>{o.d(t,{StickerItem:()=>E});var i=o(570655),r=o(785893),s=o(667294),n=o(488830),a=o(117173),l=o(659397),d=o(483295),_=o(70162),c=o(173471),u=o(274642),p=o(819086),h=o(937884),v=o(146143),m=o(249009),y=o(15305),g=o(224589),f=o(517920),w=o(506770),S=o(844142),E=function(e){function t(t){var o=e.call(this,t)||this;return o.componentDidMount=function(){var e=o.props,t=e.sticker,i=e.story;if(t.audioRestriction&&i.data.needMute&&i.video&&(i.video.muted=!0),o.playlist.on(o,h.events.ADDED,(function(){o.props.showMessage((0,_.getLang)("stories_audio_added")),o.props.playStory()})),o.playlist.on(o,h.events.REMOVED,(function(){o.props.showMessage((0,_.getLang)("stories_audio_deleted")),o.props.playStory()})),t.type===a.StickerTypes.marketItem&&(0,g.logViewMarketItemInStories)(t.link),(0,w.partConfigEnabled)("stories_share_playlist")){var r=t.audioHint||t.playlistHint,s=o.stickerRef.current;r&&s&&o.props.showHelpHint(r,s,{width:t.audioHint?156:191,type:f.default.TYPE_VERTICAL,forceSide:"bottom",align:"center",offset:[0,16],appendToParent:!0,withCloseButton:!1,autoAdjustToViewport:!0,noAutoHideOnWindowClick:!1,cls:"feature_intro_tt feature_intro_blue_tt"})}},o.componentWillUnmount=function(){o.playlist.off(o),o.props.hideHelpHint()},o.render=function(){var e=o.props,t=e.story,i=e.sticker,n=t.data.needMute,l=i.audioRestriction,_=(0,m.swapObject)(a.StickerTypes),c=y.ls.get("story_show_clickable_zones"),u=(0,d.classNames)("StorySticker",{"StorySticker--clickableZones":c});return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)("div",{ref:o.stickerRef,"data-type":_[i.type],className:u,style:o.getStickerStyle(),onMouseDown:function(e){return o.props.onMouseDownHandle(e)},onMouseUp:function(e){return o.props.onMouseUpHandle(e,(function(){return o.handleClick(e)}))}},void 0),l&&n&&o.renderRestriction()]},void 0)},o.renderRestriction=function(){var e=o.props.sticker.audioRestriction;return e?(0,r.jsx)("div",(0,i.__assign)({className:"StoryRestriction"},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"StoryRestriction__inner"},{children:[(0,r.jsx)("span",(0,i.__assign)({className:"StoryRestriction__title"},{children:e.title}),void 0),e.buttonUrl&&(0,r.jsx)("a",(0,i.__assign)({className:"StoryRestriction__link",href:e.buttonUrl},{children:e.buttonText}),void 0)]}),void 0)}),void 0):null},o.getStickerStyle=function(){var e=o.props,t=e.sticker,i=e.originalWidth,r=e.originalHeight,s=e.widthViewBox,n=e.heightViewBox,a=s,l=n;return n/s>1.77?a=i*n/r:l=r*s/i,{top:t.top*l-(l-n)/2,left:t.left*a-(a-s)/2,width:t.width*a,height:t.height*l,transform:"rotate("+t.rotate+"deg)"}},o.handleClick=function(e){switch(o.props.sticker.type){case a.StickerTypes.hashtag:o.handleClickHashtag(e);break;case a.StickerTypes.mention:o.handleClickMention(e);break;case a.StickerTypes.question:o.handleClickQuestion();break;case a.StickerTypes.place:o.handleClickPlace(e);break;case a.StickerTypes.music:o.handleClickMusic(e);break;case a.StickerTypes.marketItem:o.handleClickMarketItem(e);break;case a.StickerTypes.storyReply:o.handleClickStoryReply(e);break;case a.StickerTypes.owner:o.handleClickOwner(e);break;case a.StickerTypes.link:o.handleClickLink(e);break;case a.StickerTypes.post:o.handleClickPost(e);break;case a.StickerTypes.poll:o.handleClickPoll();break;case a.StickerTypes.app:o.handleClickApp();break;case a.StickerTypes.sticker:o.handleClickSticker(e);break;case a.StickerTypes.situationalTheme:o.handleClickStickerSituationalTheme();break;case a.StickerTypes.playlist:o.handleClickPlaylist(e)}},o.handleClickHashtag=function(e){var t=o.props.sticker.hashtag.replace("#","%23"),s=(0,_.getLang)("stories_show_hashtag_link"),n="hashtag",a=(0,r.jsx)("a",(0,i.__assign)({href:"/feed?q="+t+"&section=search",onClick:function(){return o.onClickToTooltip(n)},target:"_blank",className:"StoriesTooltip__link"},{children:s}),void 0);o.props.toggleTooltip(e,a),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:n}})},o.handleClickMention=function(e){var t=o.props.sticker,s=t.mentionedOwnerHref,n=t.mentionedText,a=t.mentionedPhotoUrl,d="mention",_=(0,r.jsx)("a",(0,i.__assign)({href:s,onClick:function(){return o.onClickToTooltip(d)},target:"_blank",className:"StoriesTooltip__link StoriesTooltip__link--mention"},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"StoriesTooltipMention"},{children:[(0,r.jsx)("div",{className:"StoriesTooltipMention__avatar",style:{backgroundImage:"url("+a+")"}},void 0),(0,r.jsx)("span",(0,i.__assign)({className:"StoriesTooltipMention__text"},{children:(0,l.decodeHTMLEntities)(n)}),void 0)]}),void 0)}),void 0);o.props.toggleTooltip(e,_),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:d}})},o.handleClickQuestion=function(){o.props.showQuestionModal(),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:"question"}})},o.handleClickPlace=function(e){var t=o.props,s=t.sticker,n=t.list,a=s.placeId,l=(0,_.getLang)("stories_go_to_place"),d="place";if(window.layerQueue.count()||n.includes("archive")){var c="/feed?section=search&w=place"+a,p=(0,r.jsx)("a",(0,i.__assign)({href:""+c,onClick:function(){return o.onClickToTooltip(d)},target:"_blank",className:"StoriesTooltip__link"},{children:l}),void 0);o.props.toggleTooltip(e,p)}else{p=(0,r.jsx)("div",(0,i.__assign)({className:"StoriesTooltip__link",onClick:function(){o.onClickToTooltip(d),window.layerQueue.count()?window.layerQueue.pop():window.layerQueue.push(),(0,u.showWiki)({w:"place"+a})}},{children:l}),void 0);o.props.toggleTooltip(e,p)}o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:s.id,type:d}})},o.handleClickMusic=function(e){var t=o.props,s=t.story,n=t.sticker,a=s.data.needMute,l=n.audioId,d=n.audioData;if(n.audioRestriction)a||p.AudioUtils.showAudioRestriction(JSON.parse(d),{onShow:function(){o.props.pauseStory()},onHide:function(){o.props.playStory()}});else{var c="added"===(p.AudioUtils.getAddRestoreInfo()[l]||{}).state?(0,_.getLang)("stories_audio_delete"):(0,_.getLang)("stories_audio_add"),u=(0,r.jsxs)("ul",(0,i.__assign)({className:"StoriesTooltipActions _audio_row","data-audio":d},{children:[(0,r.jsx)("li",(0,i.__assign)({className:"StoriesTooltipActions__item",onClick:o.addAudio},{children:c}),void 0),(0,r.jsx)("li",(0,i.__assign)({className:"StoriesTooltipActions__item",onClick:o.setNext},{children:(0,_.getLang)("stories_audio_next_audio")}),void 0)]}),void 0);o.props.toggleTooltip(e,u,"b"),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:n.id,type:"music"}})}},o.handleClickPlaylist=function(e){var t=o.props.sticker,s=t.playlistOwnerId,n=t.playlistId,a=t.playlistCreatorId,l=t.playlistFollowed,d=window.vk.id===a,c=s+"_"+n,u=p.AudioUtils.getPlaylistAddRestoreInfo()[c]||{},h=u.state?"followed"===u.state:l,v=h?(0,_.getLang)("stories_playlist_unfollow"):(0,_.getLang)("stories_playlist_follow"),m=h?o.unfollowPlaylist:o.followPlaylist,y=(0,r.jsxs)("ul",(0,i.__assign)({className:"StoriesTooltipActions"},{children:[!d&&(0,r.jsx)("li",(0,i.__assign)({className:"StoriesTooltipActions__item",onClick:m},{children:v}),void 0),(0,r.jsx)("li",(0,i.__assign)({className:"StoriesTooltipActions__item",onClick:o.setNextPlaylist},{children:(0,_.getLang)("stories_playlist_next")}),void 0)]}),void 0);o.props.toggleTooltip(e,y,"b"),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:"playlist"}})},o.handleClickMarketItem=function(e){var t=o.props.sticker,s=t.photoUrl,a=t.link,l=t.isRestricted,d="market_item",c=new URL(""+document.location.origin+a).searchParams.get("w")?"&ref=stories":"",u=l?{onClick:function(){(0,v.showFastBox)((0,_.getLang)("stories_market_access_error_title"),(0,_.getLang)("stories_market_access_error_text")),o.onClickToTooltip(d)}}:{onClick:function(){return o.onClickToTooltip(d)},href:""+a+c},p=(0,r.jsxs)("a",(0,i.__assign)({},u,{target:"_blank",className:"StoriesTooltip__link"},{children:[s&&!l?(0,r.jsx)("img",{className:"StoriesTooltip__marketItemThumb",src:s,alt:""},void 0):(0,r.jsx)("div",(0,i.__assign)({className:"StoriesTooltip__marketItemThumb StoriesTooltip__marketItemThumb--stub"},{children:(0,r.jsx)(n.default,{},void 0)}),void 0),(0,r.jsx)("span",(0,i.__assign)({className:"StoriesTooltip__marketItemText"},{children:(0,_.getLang)("stories_go_to_market_item")}),void 0)]}),void 0);o.props.toggleTooltip(e,p),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:d}})},o.handleClickStoryReply=function(e){var t=o.props.sticker,s=t.ownerId,n=t.storyId,a=t.isExpired,l="story_reply";if(a)o.handleClickOwner(e);else{var d=(0,r.jsx)("a",(0,i.__assign)({className:"StoriesTooltip__link",onClick:function(){var e=s+"_"+n;(0,c.showStory)("story"+e+"/"+e+"/context:owner"),o.onClickToTooltip(l)}},{children:(0,_.getLang)("stories_go_to_story")}),void 0);o.props.toggleTooltip(e,d),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:t.id,type:l}})}},o.handleClickOwner=function(e){var t=o.props.sticker,s=t.ownerId,n=t.link,a=S.Ranges.isUserIdTransitional(s)?(0,_.getLang)("stories_go_to_profile"):(0,_.getLang)("stories_go_to_group"),l=(0,r.jsx)("a",(0,i.__assign)({href:n,target:"_blank",className:"StoriesTooltip__link"},{children:a}),void 0);o.props.toggleTooltip(e,l)},o.handleClickLink=function(e){var t=o.props.sticker,s=t.link,n=t.tooltipText,a="link",l=(0,r.jsx)("a",(0,i.__assign)({href:s,onClick:function(){return o.onClickToTooltip(a)},target:"_blank",className:"StoriesTooltip__link"},{children:n}),void 0);o.props.toggleTooltip(e,l),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:a}})},o.handleClickPost=function(e){var t=o.props.sticker,s=t.postOwnerId,n=t.postId,a=(0,_.getLang)("stories_go_to_post"),l="post",d=(0,r.jsx)("a",(0,i.__assign)({href:"/wall"+s+"_"+n,onClick:function(){return o.onClickToTooltip(l)},target:"_blank",className:"StoriesTooltip__link"},{children:a}),void 0);o.props.toggleTooltip(e,d),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:l}})},o.handleClickPoll=function(){var e=o.props.sticker.pollId;o.props.pauseStory();var t={act:"get_layout",voting_id:e,ref:"story",for_box:!0},i={containerClass:"story_poll",params:{hideButtons:!0,width:510,onDestroy:function(){o.props.playStory()}}};(0,v.showBox)("al_voting.php",t,i),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:"poll"}})},o.handleClickApp=function(){o.props.markAppNotificationsSeen(o.props.sticker),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:"app"}})},o.handleClickStickerSituationalTheme=function(){var e=o.props.sticker,t=e.situationalAppId,i=e.situationalThemeId;window.layerQueue.count()?window.layerQueue.pop():window.layerQueue.push(),o.props.pauseStory(),(0,u.showWiki)({w:"app"+t+"#"+i}),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:"situational_theme"}})},o.addAudio=function(e){p.AudioUtils.addAudio(e.target,void 0,(function(){o.props.sendNavigationStatEvents("music_added",!0,{clickable_sticker:{id:o.props.sticker.id,type:"music"}})})),o.props.hideTooltip()},o.followPlaylist=function(e){var t=o.props.sticker,i=t.playlistOwnerId,r=t.playlistId,s=t.playlistFollowHash;p.AudioUtils.followPlaylist(e.target,i,r,s);var n=i+"_"+r;p.AudioUtils.getPlaylistAddRestoreInfo()[n]={state:"followed"},o.props.playStory(),o.props.hideTooltip(),o.props.sendNavigationStatEvents("music_added",!0,{clickable_sticker:{id:o.props.sticker.id,type:"playlist"}})},o.unfollowPlaylist=function(e){var t=o.props.sticker,i=t.playlistOwnerId,r=t.playlistId,s=t.playlistFollowHash;p.AudioUtils.followPlaylist(e.target,i,r,s);var n=i+"_"+r;p.AudioUtils.getPlaylistAddRestoreInfo()[n]={state:"unfollowed"},o.props.playStory(),o.props.hideTooltip()},o.handleClickSticker=function(e){var t=o.props.sticker,s=t.stickerPackId,n=t.tooltipText,a=(0,r.jsx)("span",(0,i.__assign)({onClick:o.onClickToStickerTooltip.bind(o,s),className:"StoriesTooltip__link"},{children:n}),void 0);o.props.toggleTooltip(e,a),o.props.sendNavigationStatEvents("click_on_clickable_sticker",!0,{clickable_sticker:{id:o.props.sticker.id,type:"sticker"}})},o.onClickToStickerTooltip=function(e,t){window.Emoji.previewSticker(e,o,!1,t),o.onClickToTooltip("sticker")},o.setNext=function(e){var t=JSON.parse(o.props.sticker.audioData||"{}"),i=p.AudioUtils.audioTupleToAudioObject(t);o.playlist.setNext(e.currentTarget.parentNode,i,t),o.props.story.data.isMusicCover||o.playlist.pause(),o.props.hideTooltip(),o.props.playStory(),o.props.sendNavigationStatEvents("play_next",!0,{clickable_sticker:{id:o.props.sticker.id,type:"music"}})},o.setNextPlaylist=function(){var e=o.props.sticker,t=e.playlistOwnerId,i=e.playlistId,r=e.playlistAccessHash;o.playlist.setNextPlaylist(t,i,r),o.props.story.data.isMusicCover||o.playlist.pause(),o.props.hideTooltip(),o.props.playStory(),o.props.sendNavigationStatEvents("play_next",!0,{clickable_sticker:{id:o.props.sticker.id,type:"playlist"}})},o.onClickToTooltip=function(e){o.props.sendNavigationStatEvents("click_to_tooltip",!0,{clickable_sticker:{id:o.props.sticker.id,type:e}})},o.stickerRef=(0,s.createRef)(),o.playlist=(0,u.getAudioPlayer)(),o}return(0,i.__extends)(t,e),t}(s.Component)},925704:(e,t,o)=>{o.d(t,{StickerTooltip:()=>l});var i=o(570655),r=o(785893),s=o(667294),n=o(973935),a=o(483295),l=function(e){var t=e.clientX,o=void 0===t?0:t,l=e.clientY,d=void 0===l?0:l,_=e.position,c=void 0===_?"t":_,u=e.layerEl,p=e.children,h=(0,a.classNames)("StoriesTooltip","StoriesTooltip--"+c);return(0,r.jsx)(s.Fragment,{children:n.createPortal((0,r.jsx)("div",(0,i.__assign)({className:h,style:{top:d,left:o}},{children:p}),void 0),u)},void 0)}},474425:(e,t,o)=>{o.d(t,{StoryBottom:()=>U});var i,r=o(570655),s=o(785893),n=o(274642),a=o(667294),l=o(936646),d=o(309786),_=o(965430),c=o(117173),u=o(239914),p=o(577438),h=o(822560),v=o(173471),m=o(873589),y=o(152278),g=o(70162),f=o(290846),w=o(342269),S=o(66433),E=o(659397),b=o(739124),k=o(458819),T=o(975803),C=o(463989),L=o(521114),M=o(763478),P=o(763358),B=o(314168),A=o(318285),I=o(147650),D=o(254589),x=o(897404),O=o(429697),N=o(533228),R=o(385667),F=o(584282);!function(e){e[e.STEP_LEFT=0]="STEP_LEFT",e[e.STEP_RIGHT=1]="STEP_RIGHT",e[e.STEP_PAUSE=2]="STEP_PAUSE"}(i||(i={}));var U=function(e){function t(t){var o=e.call(this,t)||this;return o.isMount=!1,o.onOverlayTransitionEnd=function(e){e.target===e.currentTarget&&o.state.isNewMessageFormActiveAnimating&&o.setState({isNewMessageFormActiveAnimating:!1})},o.onNewMessageButtonClick=function(){o.toggleMessageForm(!0)},o.onSendFormButtonsMouseDown=function(e){o.needShowSendFormSeparately()&&!o.getMessageText()&&e.preventDefault()},o.onPanelStickerClick=function(e,t){o._sendMessage([["sticker",e,""]],{sticker_referrer:"story_reaction"},{reactionName:c.EMOJI_REACTIONS_ARR[t].name})},o.emojiInit=function(){var e;if(!o.emojiId&&o.refs.messageInput){var t=o.isStickerPanelAvailable();if(o.emojiId=window.Emoji.init(o.refs.messageInput,{ttDiff:29,ref:"stories",ttWrap:o.refs.smileWrapper,checkEditable:function(){o.props.story.isActiveLive()&&p.VideoChat.checkTextLen(o.refs.messageInput)},noStickers:!t,noStickersStore:!t,onSend:function(){return o._sendMessage()},onStickerSend:function(e,t,i){o._sendMessage([["sticker",e,i]],{sticker_referrer:t}),o.needShowSendFormSeparately()&&o.state.isMessageFormExpanded&&o.toggleMessageForm(!1)},forceUp:!0,controlsCont:o.refs.sendForm,onKeyAction:function(){return o._emojiDidKeyAction()},onEmojiAdded:function(){return o._emojiDidKeyAction()},onStoreHide:function(){o.updatePanelStickers(),o.props.story.autoResumeStory()}}),(0,y.addEvent)(o.refs.smileButton,"click",y.cancelEvent),(0,h.placeholderInit)(o.refs.messageInput,{editable:!0}),o._checkLoadedStickers())o.preloadStickerImages();else{var i=(0,w.isRetina)()?"256b":"128b";window.Emoji.emojiLoadMore(o.emojiId,{sizes:(e={},e[i]=!0,e)},(function(){o.updatePanelStickers()}))}}else o.emojiId&&!o.refs.messageInput&&o.destroyEmoji();o._canMessage()&&(0,N.isNewDesignEnabled)()&&!o._checkLoadedStickers()&&o.preloadStickers((function(){o.updatePanelStickers()}))},o.onSendFormEntered=function(){o.setState({isSendFormAnimating:!1})},o.onSendFormExited=function(){o.setState({isSendFormAnimating:!1}),o.destroyEmoji()},o.destroyEmoji=function(){(0,y.removeEvent)(o.refs.smileButton,"click",y.cancelEvent),o.emojiId&&(window.Emoji.destroy(o.emojiId),delete o.emojiId)},o.toggleMessageForm=function(e){void 0===e&&(e=!0),o.state.isMessageFormExpanded!==e&&o.setState({isMessageFormExpanded:e,isSendFormAnimating:!0})},o.addToNarrativePress=function(){o.props.story.onAddToNarrativeBtnClick()},o.onLikeAnimationEnd=function(){o.setState({needAnimateLikeButton:!1})},o.linkDidPress=function(e,t){if(t){var i=o.props.story,s=t.object_type,a=t.object,l=t.url.match(/\/narrative(-?\d+)_(\d+)/);if(l){e.preventDefault();var d=(0,r.__read)(l,3),_=d[1],c=d[2];_&&c&&(i.pauseStory(),(0,v.showNarrative)(_,c,0,"",{fromEl:i.wrapEl,source:"narrative_story"}))}else i.layer.sendNavigationStatEvents("link_click"),i.sendStatEvent("url_view");if("audio"===s)o.state.linkObjectAudioPlaying?((0,n.getAudioPlayer)().pause(),o.setState({story:(0,r.__assign)((0,r.__assign)({},o.state.story),{audioPlaying:!1})}),window.cur.storyLayer.resumeLayer()):((0,n.getAudioPlayer)().playAudio(a),o.setState({story:(0,r.__assign)((0,r.__assign)({},o.state.story),{audioPlaying:!0})}),window.cur.storyLayer.pauseLayer()),o.setState({linkObjectAudioPlaying:!o.state.linkObjectAudioPlaying}),e.preventDefault()}},o.startLinkArrowAnimation=function(){o.isMount&&o.setState({linkArrowAnimationStep:i.STEP_RIGHT})},o.pauseLinkArrowAnimation=function(){o.setState({linkArrowAnimationStep:i.STEP_PAUSE})},o.onLinkArrowTransitionEnd=function(){var e=o.state.linkArrowAnimationStep;e!==i.STEP_RIGHT?e!==i.STEP_LEFT||o.setState({linkArrowAnimationStep:i.STEP_RIGHT}):o.setState({linkArrowAnimationStep:i.STEP_LEFT})},o.onLinkArrowMouseLeave=function(){o.state.isMessageFormExpanded||o.startLinkArrowAnimation()},o.emojiId=!1,o.state={story:t.story,sendFormHasText:!1,sendFormFocused:!1,linkObjectAudioPlaying:!1,isStickerPanelShow:!1,panelStickers:o.getPanelStickers(),isMessageFormExpanded:!o.hasLink()&&!(0,N.isNewDesignEnabled)(),needAnimateLikeButton:!1,isSendFormAnimating:!1,linkArrowAnimationStep:i.STEP_LEFT},o.addToNarrativeRef=(0,a.createRef)(),o}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.emojiInit(),this.isMount=!0,requestAnimationFrame((function(){e.startLinkArrowAnimation()}))},t.prototype.componentWillUnmount=function(){this.isMount=!1,this.emojiId&&(window.Emoji.destroy(this.emojiId),delete this.emojiId)},t.prototype.componentDidUpdate=function(e,t){var o=this.state,i=o.isMessageFormExpanded,r=o.sendFormFocused;this.emojiInit(),!t.isMessageFormExpanded&&i?(window.Emoji.focus(this.refs.messageInput),this.pauseLinkArrowAnimation()):t.isMessageFormExpanded&&!i&&this.startLinkArrowAnimation(),(0,N.isNewDesignEnabled)()&&t.sendFormFocused!==r&&this.setState({isNewMessageFormActiveAnimating:!0})},t.prototype.render=function(){if((0,N.isNewDesignEnabled)())return this.renderByNewDesign();var e=this.props.story,t=this.props.story.getCurStoryData();if(!e.story||!t)return"";var o,i={left_side_empty:this.leftSideIsEmpty()},n=t.canLike,_=t.canAddToNarrative,u=t.reaction_set_id,p=e.getSticker(c.StickerTypes.app),h=this.needShowSendFormSeparately();return null!=u&&(o=(0,R.getReactionSet)(u)),(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",(0,r.__assign)({className:(0,E.classNames)("stories_story_bottom",i)},{children:(0,s.jsxs)("div",(0,r.__assign)({className:"stories_story_bottom_controls StoryBottomControls"},{children:[(n||p||h)&&(0,s.jsxs)("div",(0,r.__assign)({className:"StoryBottom__line StoryBottom__line--2"},{children:[h&&(0,s.jsxs)(s.Fragment,{children:[this.renderMessageButton(),this.renderMessageForm()]},void 0),n&&this.renderLike(),!n&&p&&this.renderAppButton()]}),void 0),p&&n&&(0,s.jsx)("div",(0,r.__assign)({className:"StoryBottom__line StoryBottom__line--3"},{children:this.renderAppButton()}),void 0),(0,s.jsx)(d.ViewsButton,{className:"StoryBottomControl",story:e,reactionSet:o},void 0),!h&&this.renderMessageForm(),this.renderLink(),_&&this.renderAddToNarrativeBtn(),this.renderShare(),(0,s.jsx)(l.ActionsButton,{story:e},void 0)]}),void 0)}),void 0)},void 0)},t.prototype.renderByNewDesign=function(){var e=this.props.story,t=this.props.story.getCurStoryData(),o=this.state.isMessageFormExpanded;if(!e.story||!t)return"";var i,n=e.isFeedbackTooltipShow,a=e.toggleFeedbackTooltip,l=e.onFetchFeedbackData,_=e.onFetchViewers,c=e.onQuestionRemove,u=e.feedback,p=e.showMoreReplies,h=e.onPrivacyHintHide,v=t.needShowEmptyStats,m=t.small_preview,y=t.canLike,g=t.canAddToNarrative,f=t.reaction_set_id,w=e.getRawId(),S=e.showMessage.bind(e),b=e.layer.sendNavigationStatEvents.bind(e.layer);return null!=f&&(i=(0,R.getReactionSet)(f)),(0,s.jsxs)("div",(0,r.__assign)({className:"StoryBottom"},{children:[(0,s.jsx)(O.default,(0,r.__assign)({in:!o,classNames:{enter:"StoryBottom__panels--enter",enterActive:"StoryBottom__panels--enterActive",exitActive:"StoryBottom__panels--exitActive",exit:"StoryBottom__panels--exit"},addEndListener:function(e,t){e.addEventListener("transitionend",(function(e){e.target===e.currentTarget&&t()}),!1)},unmountOnExit:!0},{children:(0,s.jsxs)("div",(0,r.__assign)({className:"StoryBottom__panels"},{children:[y&&(0,s.jsx)("div",(0,r.__assign)({className:"StoryBottom__floor StoryBottom__floor--2"},{children:this.renderLike()}),void 0),(0,s.jsxs)("div",(0,r.__assign)({className:"StoryBottom__floor StoryBottom__floor--1"},{children:[(0,s.jsx)(d.ViewsButton,{className:"StoryViewerBottomControl StoryViewerBottomControl--feedback",story:e,reactionSet:i},void 0),this.renderLink(),this.renderNewMessageButton(),g&&this.renderAddToNarrativeBtn(),this.renderShare()]}),void 0)]}),void 0)}),void 0),this.renderMessageForm(),(0,s.jsx)(O.default,(0,r.__assign)({in:n,timeout:200,classNames:{enter:"FeedbackTooltipTransitionWrapper--enter",enterActive:"FeedbackTooltipTransitionWrapper--enterActive",exit:"FeedbackTooltipTransitionWrapper--exit",exitActive:"FeedbackTooltipTransitionWrapper--exitActive"},unmountOnExit:!0},{children:(0,s.jsx)(F.default,{className:"StoryBottom__feedback",feedback:u,reactionSet:i,storyRawId:w,storyImageUrl:m,toggleFeedbackTooltip:a,onFetchFeedbackData:l,onFetchViewers:_,showMessage:S,sendNavigationStatEvents:b,onQuestionRemove:c,showMoreReplies:p,onPrivacyHintHide:h,needShowEmptyStats:v},void 0)}),void 0),!this.isActiveLive()&&(0,s.jsx)("div",{className:(0,E.classNames)("StoryBottom__overlay",{"StoryBottom__overlay--shown":this.needShowOverlay()}),onTransitionEnd:this.onOverlayTransitionEnd},void 0)]}),void 0)},t.prototype.needRenderNewMessageFormAsActive=function(){return this.state.sendFormFocused||(0,N.isNewDesignEnabled)()&&this.state.isNewMessageFormActiveAnimating},t.prototype.needShowOverlay=function(){return this.state.sendFormFocused},t.prototype.renderMessageButton=function(){var e=this,t=this.props.story;if(!t.getCurStoryData())return t.isActiveMetaStory()||(0,S.logError)(new Error("Fail: renderMessageButton"),{environment:"stories"}),!1;if(this.needShowSendFormSeparately()){var o=this.state,i=o.isMessageFormExpanded,n=o.isSendFormAnimating;if(!(i||n||(0,N.isNewDesignEnabled)()))return(0,s.jsx)(x.default,(0,r.__assign)({className:"StoryViewerTooltip",text:(0,g.getLang)("stories_write_message"),position:"t",marginTop:-8},{children:(0,s.jsx)("div",(0,r.__assign)({className:"StoryButton StoryBottomControl StoryButtonMessage StoryButton--round",onClick:function(){return e.toggleMessageForm()}},{children:(0,s.jsx)(b.default,{className:"StoryButton__icon"},void 0)}),void 0)}),void 0)}},t.prototype.needShowSendFormSeparately=function(){return this._canMessage()&&(this.hasLink()||(0,N.isNewDesignEnabled)())},t.prototype.renderAppButton=function(){var e=this,t=this.props.story;if(!(0,N.isNewDesignEnabled)()){var o=t.getSticker(c.StickerTypes.app);if(o){var i=this.state,n=i.isMessageFormExpanded,a=!(i.isStickerPanelShow||this.needShowSendFormSeparately()&&n);return(0,s.jsx)(O.default,(0,r.__assign)({in:a,timeout:200,classNames:{enter:"StoryButtonApp--enter",enterActive:"StoryButtonApp--enterActive",exitActive:"StoryButtonApp--exitActive",exit:"StoryButtonApp--exit"},unmountOnExit:!0},{children:(0,s.jsx)(x.default,(0,r.__assign)({className:"StoryViewerTooltip",text:(0,g.getLang)("stories_app"),position:"t",marginTop:-8},{children:(0,s.jsxs)("div",(0,r.__assign)({className:"StoryButtonApp StoryButton StoryBottomControl StoryButton--round",onClick:function(){return e.props.markAppNotificationsSeen(o)}},{children:[(0,s.jsx)(k.default,{},void 0),o.hasNewInteractions&&(0,s.jsx)("span",{className:"StoryButtonBadge StoryButtonBadge--orange StoryButton__badge"},void 0)]}),void 0)}),void 0)}),void 0)}}},t.prototype.renderLink=function(){var e=this,t=this.props.story,o=this.props.story.getCurStoryData();if(o){var n=this.state.linkArrowAnimationStep,a=o.link;if((0,w.isObject)(a)){var l=(0,E.decodeHTMLEntities)(a.url),d="stories_link";if(a.object_type&&(d+=" story_link_object_"+a.object_type),this.state.linkObjectAudioPlaying&&(d+=" story_link_object_audio_playing"),o.isProfileQuestion){var _=new URL(l);_.searchParams.set("ref","story"),l=_.toString()}var c=(0,N.isNewDesignEnabled)();return(0,s.jsx)("div",(0,r.__assign)({className:(0,E.classNames)("StoryLinkButton stories_link_wrap",{StoryBottomControl:!c,"StoryViewerBottomControl StoryViewerButton StoryViewerButton--wide StoryViewerButton--dark StoryViewerButton--link":c}),onMouseEnter:this.pauseLinkArrowAnimation,onMouseLeave:this.onLinkArrowMouseLeave},{children:(0,s.jsxs)("a",(0,r.__assign)({target:"_blank",rel:"noopener noreferrer",className:d,href:l,title:a.text,onClick:function(t){e.linkDidPress(t,a)},onTransitionEnd:this.onLinkArrowTransitionEnd},{children:[(0,s.jsx)("span",{className:"stories_link__inner",dangerouslySetInnerHTML:{__html:a.text}},void 0),!this.state.linkObjectAudioPlaying&&(0,s.jsx)(T.default,{className:(0,E.classNames)("StoryLinkButton__icon",{"StoryLinkButton__icon--right":n===i.STEP_RIGHT})},void 0)]}),void 0)}),void 0)}}else{t.isActiveMetaStory()||(0,S.logError)(new Error("Fail: _renderLink"),{environment:"stories"})}},t.prototype.renderShare=function(){var e=this.props.story,t=e.getCurStoryData();if(!t)return e.isActiveMetaStory()||(0,S.logError)(new Error("Fail: _renderShare"),{environment:"stories"}),"";if(!t.can_share)return"";var o=(0,N.isNewDesignEnabled)();return(0,s.jsx)("div",(0,r.__assign)({className:(0,E.classNames)({"StoryButton StoryButton--share StoryBottomControl":!o,"StoryViewerButton StoryViewerButton--dark StoryViewerButton--round StoryViewerBottomControl":o}),onMouseEnter:function(e){return(0,f.showTooltip)(e.target,{black:1,center:1,shift:[1,13,0],text:(0,g.getLang)("stories_share")})},onClick:this._shareButtonDidPress.bind(this)},{children:(0,s.jsx)(C.default,{className:(0,E.classNames)({StoryButton__icon:!o,StoryViewerButton__icon:o})},void 0)}),void 0)},t.prototype.renderAddToNarrativeBtn=function(){var e=this.props.story,t=this.props.story.getCurStoryData(),o=this.props.story.getCurrentNarrative();if(!t)return e.isActiveMetaStory()||(0,S.logError)(new Error("Fail: renderAddToNarrativeBtn"),{environment:"stories"}),null;if(o)return null;var i=(0,N.isNewDesignEnabled)();return(0,s.jsxs)("div",(0,r.__assign)({className:(0,E.classNames)({"StoryButton StoryBottomControl":!i,"StoryViewerButton StoryViewerButton--dark StoryViewerButton--round StoryViewerBottomControl":i}),onMouseEnter:function(e){return(0,f.showTooltip)(e.target,{black:1,center:1,shift:[1,13,0],text:(0,g.getLang)("stories_add_to_narrative")})},onClick:this.addToNarrativePress,ref:this.addToNarrativeRef},{children:[t.isPartOfNarrative&&(0,s.jsx)(L.default,{className:(0,E.classNames)({StoryButton__icon:!i,StoryViewerButton__icon:i})},void 0),!t.isPartOfNarrative&&(0,s.jsx)(M.default,{className:(0,E.classNames)({StoryButton__icon:!i,StoryViewerButton__icon:i})},void 0)]}),void 0)},t.prototype.renderLike=function(){var e=this.props.story,t=this.props.story.getCurStoryData();if(!t)return e.isActiveMetaStory()||(0,S.logError)(new Error("Fail: _renderLike"),{environment:"stories"}),"";var o=t.isLiked,i=this.state,n=i.isMessageFormExpanded,a=i.needAnimateLikeButton,l=i.isStickerPanelShow,d=(0,N.isNewDesignEnabled)(),_=!(l||this.needShowSendFormSeparately()&&n);return(0,s.jsx)(O.default,(0,r.__assign)({in:_,timeout:200,classNames:{enter:"StoryButtonLike--enter",enterActive:"StoryButtonLike--enterActive",exitActive:"StoryButtonLike--exitActive",exit:"StoryButtonLike--exit"},unmountOnExit:!0},{children:(0,s.jsx)(x.default,(0,r.__assign)({className:"StoryViewerTooltip",text:(0,g.getLang)("stories_like"),position:"t",delay:180,marginTop:-8},{children:(0,s.jsxs)("div",(0,r.__assign)({className:(0,E.classNames)("StoryButtonLike",{"StoryButton StoryButton--like StoryButton--round StoryBottomControl":!d,"StoryViewerButton StoryViewerButton--dark StoryViewerButton--round StoryViewerBottomControl":d,"StoryButtonLike--liked":o,"StoryButtonLike--animation":a,"StoryViewerButton--big":!0}),onClick:this._likeButtonDidPress.bind(this),onAnimationEnd:this.onLikeAnimationEnd},{children:[o&&(0,s.jsx)(P.default,{className:"StoryButton__icon"},void 0),!o&&(0,s.jsx)(B.default,{className:"StoryButton__icon"},void 0)]}),void 0)}),void 0)}),void 0)},t.prototype._canMessage=function(){var e=this.props.story,t=e.getCurStoryData();return t?t.can_comment&&!e.isLiveEnded():(e.isActiveMetaStory()||(0,S.logError)(new Error("Fail: _canMessage"),{environment:"stories"}),!1)},t.prototype.hasLink=function(){var e=this.props.story,t=e.getCurStoryData();return t?(0,w.isObject)(t.link):(e.isActiveMetaStory()||(0,S.logError)(new Error("Fail: hasLink"),{environment:"stories"}),!1)},t.prototype.renderNewMessageButton=function(){if(this._canMessage())return this.hasLink()?(0,s.jsx)(x.default,(0,r.__assign)({className:"StoryViewerTooltip",text:(0,g.getLang)("stories_write_message"),position:"t",marginTop:-8},{children:(0,s.jsx)("button",(0,r.__assign)({className:"StoryViewerBottomControl StoryViewerButton StoryViewerButton--dark StoryViewerButton--round",onClick:this.onNewMessageButtonClick},{children:(0,s.jsx)("div",(0,r.__assign)({className:"StoryViewerButton__icon"},{children:(0,s.jsx)(A.default,{},void 0)}),void 0)}),void 0)}),void 0):(0,s.jsx)("button",(0,r.__assign)({className:"StoryViewerBottomControl StoryViewerButton StoryViewerButton--message StoryViewerButton--wide StoryViewerButton--dark",onClick:this.onNewMessageButtonClick},{children:(0,s.jsx)("span",(0,r.__assign)({className:"StoryViewerButton__text"},{children:(0,g.getLang)("stories_answer_placeholder")}),void 0)}),void 0)},t.prototype.renderMessageForm=function(){var e=this,t=this.state,o=t.sendFormFocused,i=t.isMessageFormExpanded,n=t.panelStickers,a=this.needShowSendFormSeparately(),l=this.needRenderNewMessageFormAsActive();if(this._canMessage()){var d=(0,N.isNewDesignEnabled)(),c=(0,s.jsx)("div",(0,r.__assign)({className:(0,E.classNames)("StorySendForm stories_send_form _emoji_field_wrap emoji_rpointer",{"StorySendForm--focus":o,"StorySendForm--separately":a,"StorySendForm--expanded":i,"StorySendForm--isNewDesign":d}),ref:"sendForm"},{children:(0,s.jsxs)("div",(0,r.__assign)({className:"StorySendForm__wrapper"},{children:[(0,s.jsx)("div",{className:"StorySendForm__background"},void 0),(0,s.jsxs)("div",(0,r.__assign)({className:"StorySendForm__in"},{children:[(0,s.jsx)("div",(0,r.__assign)({className:"stories_send_form_text_wrap"},{children:(0,s.jsx)("div",{contentEditable:!0,ref:"messageInput",className:"stories_send_form_text",placeholder:(0,g.getLang)("stories_answer_placeholder"),onFocus:this._sendFormDidFocus.bind(this),onBlur:this._sendFormDidBlur.bind(this),onInput:this._checkReactionsPanel.bind(this)},void 0)}),void 0),(0,s.jsx)("div",(0,r.__assign)({className:"stories_send_form_helper",ref:"smileWrapper",onMouseDown:this.onSendFormButtonsMouseDown},{children:(0,s.jsxs)("div",(0,r.__assign)({className:(0,E.classNames)("stories_send_form_buttons _emoji_wrap",{shown:this.state.sendFormFocused||this.state.sendFormHasText})},{children:[(0,s.jsx)("div",(0,r.__assign)({ref:"smileButton",className:"stories_send_form_button smile _emoji_btn emoji_smile",onMouseEnter:function(t){window.Emoji.clearSizeCached(e.refs.smileButton),window.Emoji.show(e.refs.smileButton,t.nativeEvent)},onMouseLeave:function(t){return window.Emoji.hide(e.refs.smileButton,t.nativeEvent)},onMouseDown:function(e){return(0,y.cancelEvent)(e.nativeEvent)}},{children:(0,s.jsx)(I.default,{},void 0)}),void 0),(0,s.jsx)("div",(0,r.__assign)({className:(0,E.classNames)("stories_send_form_button send",{active:this.state.sendFormHasText}),onClick:this._onSendMessageButtonCLick.bind(this)},{children:(0,s.jsx)(D.default,{},void 0)}),void 0)]}),void 0)}),void 0)]}),void 0),this.renderDummyMessageIfNeeded()]}),void 0)}),void 0),u=d?(0,g.getLang)("stories_fast_answer"):(0,g.getLang)("stories_reactions_title"),p=(0,s.jsx)(O.default,(0,r.__assign)({in:this.state.isStickerPanelShow&&n.length>0,timeout:200,classNames:{enter:"StoryBottom__stickerPanel--enter",enterActive:"StoryBottom__stickerPanel--enterActive",exitActive:"StoryBottom__stickerPanel--exitActive",exit:"StoryBottom__stickerPanel--exit"},unmountOnExit:!0},{children:(0,s.jsx)(_.ReactionsPanel,{className:"StoryBottom__stickerPanel",stickers:n,title:u,onStickerClick:this.onPanelStickerClick},void 0)}),void 0);return d?(0,s.jsx)(O.default,(0,r.__assign)({in:i,classNames:{enter:"StoryBottom__messageForm--enter",enterActive:"StoryBottom__messageForm--enterActive",exitActive:"StoryBottom__messageForm--exitActive",exit:"StoryBottom__messageForm--exit"},onEntered:this.onSendFormEntered,onExited:this.onSendFormExited,addEndListener:function(e,t){e.addEventListener("transitionend",(function(e){e.target===e.currentTarget&&t()}),!1)},unmountOnExit:!0},{children:(0,s.jsxs)("div",(0,r.__assign)({className:(0,E.classNames)("StoryBottom__messageForm",{"StoryBottom__messageForm--active":l})},{children:[p,c]}),void 0)}),void 0):(a&&(c=(0,s.jsx)(O.default,(0,r.__assign)({in:i,classNames:{enter:"StorySendForm--enter",enterActive:"StorySendForm--enterActive",exitActive:"StorySendForm--exitActive",exit:"StorySendForm--exit"},onEntered:this.onSendFormEntered,onExited:this.onSendFormExited,addEndListener:function(e,t){e.addEventListener("transitionend",t,!1)},unmountOnExit:!0},{children:c}),void 0)),(0,s.jsxs)("div",(0,r.__assign)({className:"StoryBottom__sendFormWrapper StoryBottomControl"},{children:[p,c]}),void 0))}},t.prototype.renderDummyMessageIfNeeded=function(){var e=this.state.isSendFormAnimating;if(this.needShowSendFormSeparately()&&e&&!(0,N.isNewDesignEnabled)())return(0,s.jsx)("div",(0,r.__assign)({className:"DummyRoundButton DummyRoundButton--message"},{children:(0,s.jsx)(b.default,{},void 0)}),void 0)},t.prototype.isActiveLive=function(){return this.props.story.isActiveLive()},t.prototype.isStickerPanelAvailable=function(){return!this.isActiveLive()},t.prototype.onChangeStickerPanelVisibility=function(e){void 0===e&&(e=!1),this.isStickerPanelAvailable()&&this.setState({isStickerPanelShow:e})},t.prototype._checkLoadedStickers=function(){return this.getPanelStickers().length>=c.EMOJI_REACTIONS_ARR.length},t.prototype.leftSideIsEmpty=function(){var e=this.props.story,t=e.getCurStoryData();if(!t)return e.isActiveMetaStory()||(0,S.logError)(new Error("Fail: _leftSideIsEmpty"),{environment:"stories"}),!1;var o=t.can_manage,i=t.link,r=t.can_comment,s=e.getReplies(),n=e.getViews();return!(n&&0!==parseInt(n))&&(!s||!o)&&!(0,w.isObject)(i)&&!r||e.isLiveEnded()},t.prototype._sendFormDidFocus=function(){var e=this.props.story;this.setState({sendFormFocused:!0}),this.isStickerPanelAvailable()&&this._checkReactionsPanel(),e.onSendFormFocus(),e.layer.sendNavigationStatEvents("comment_tap")},t.prototype._sendFormDidBlur=function(){this.props.story.onSendFormBlur(),this.setState({sendFormFocused:!1}),this.isStickerPanelAvailable()&&this._hideReactionPanel(),!this.getMessageText()&&this.needShowSendFormSeparately()&&this.toggleMessageForm(!1),this._emojiDidKeyAction()},t.prototype._emojiDidKeyAction=function(){var e,t=this.getMessageText();this.setState({sendFormHasText:t.length>0}),null===(e=this.refs.messageInput)||void 0===e||e.check()},t.prototype.getMessageText=function(){return(0,w.trim)(window.Emoji.editableVal(this.refs.messageInput))},t.prototype._hideReactionPanel=function(){this.onChangeStickerPanelVisibility(!1)},t.prototype._showReactionPanel=function(){this.onChangeStickerPanelVisibility(!0)},t.prototype._checkReactionsPanel=function(){this.isStickerPanelAvailable()&&(this.props.story.getSendText().length?this._hideReactionPanel():this._showReactionPanel())},t.prototype._shareButtonDidPress=function(){this.props.story.shareBox()},t.prototype._likeButtonDidPress=function(){this.setState({needAnimateLikeButton:!0}),this.props.story.toggleLikeStory()},t.prototype.updatePanelStickers=function(){this.isMount&&(this.setState({panelStickers:this.getPanelStickers()}),this.preloadStickerImages())},t.prototype.preloadStickers=function(e){var t,o=(0,w.isRetina)()?"256b":"128b";window.Emoji.emojiPreloadMore({sizes:(t={},t[o]=!0,t)},e)},t.prototype.preloadStickerImages=function(){this.state.panelStickers.forEach((function(e){(new Image).src=e.imageUrl}))},t.prototype.getPanelStickers=function(){var e=[];if(window.stickersKeywords&&window.Emoji.stickersById){var t=window.Emoji.stickersById,o=(0,w.isRetina)()?"256b":"128b",i={};c.EMOJI_REACTIONS_ARR.forEach((function(r){var s=window.stickersKeywords[(0,u.emojiRemoveSkinToneModifiers)(window.Emoji.codeToChr(r.code))],n=s&&window.Emoji.sortStickersHints(s),a={};n&&n.every((function(e){return!(e>0&&t[e]&&t[e].sticker&&!i[e])||(a=t[e].sticker,!1)})),a[6]&&a[6][o]&&(e.push({id:a[0],packId:0,uniqId:(0,w.irand)(0,1e5),imageUrl:a[6][o],animationUrl:a[3]}),i[a[0]]=!0)}))}return e},t.prototype._hideStickerHints=function(){var e=(0,m.geByClass1)("_sticker_hints",(0,m.domPN)(this.refs.messageInput));e&&"number"==typeof this.emojiId&&window.Emoji.stickersHintsHide(e,window.Emoji.opts[this.emojiId],100)},t.prototype._onSendMessageButtonCLick=function(){this._sendMessage()},t.prototype._sendMessage=function(e,t,o){var i=this;void 0===e&&(e=[]),void 0===t&&(t={}),void 0===o&&(o={});var r=e.length;this._hideStickerHints(),this.props.story.onAnswerSend((function(){i._emojiDidKeyAction(),r&&i.updatePanelStickers(),i.needShowSendFormSeparately()&&i.state.isMessageFormExpanded&&i.toggleMessageForm(!1)}),e,t,o)},t}(a.Component)},478700:(e,t,o)=>{o.d(t,{StoryStickers:()=>w});var i=o(570655),r=o(785893),s=o(667294),n=o(914714),a=o(925704),l=o(118690),d=o(781402),_=o(288420),c=o(156589),u=o(117173),p=o(873589),h=o(70162),v=o(342269),m=o(659397),y=o(290846),g=o(152278),f=o(844142),w=function(e){function t(t){var o=e.call(this,t)||this;o.componentDidMount=function(){window.addEventListener("resize",o.handleResize)},o.componentWillUnmount=function(){window.removeEventListener("resize",o.handleResize)},o.componentDidUpdate=function(){o.askTextarea.current&&o.askTextarea.current.focus()},o.onDisableAreaMouseDown=function(e){o.props.onMouseDownHandle(e.target)},o.onDisableAreaMouseUp=function(e,t){void 0===t&&(t=function(){}),o.props.onMouseUpHandle(e.target,t)},o.render=function(){var e=o.props,t=e.story,s=e.storyData,l=e.author,_=e.layerEl,c=e.showMessage,u=e.playStory,p=e.pauseStory,v=e.list,y=e.sendNavigationStatEvents,g=e.markAppNotificationsSeen,f=e.showHelpHint,w=e.hideHelpHint,S=s.clickable_stickers,E=S.stickers,b=S.original_width,k=S.original_height,T=o.state,C=T.widthViewBox,L=T.heightViewBox,M=T.showTooltip,P=T.position,B=T.tooltipContent,A=T.showQuestionModal,I=T.clientX,D=T.clientY;return(0,r.jsxs)("div",(0,i.__assign)({className:"StoryStickers"},{children:[(0,r.jsx)("div",{className:"StoryStickers__disableArea StoryStickers__disableArea--left",onMouseDown:o.onDisableAreaMouseDown,onMouseUp:o.onDisableAreaMouseUp},void 0),(0,r.jsx)("div",{className:"StoryStickers__disableArea StoryStickers__disableArea--right",onMouseDown:o.onDisableAreaMouseDown,onMouseUp:o.onDisableAreaMouseUp},void 0),E.map((function(e,i){return(0,r.jsx)(n.StickerItem,{story:t,sticker:e,originalWidth:b,originalHeight:k,widthViewBox:C,heightViewBox:L,toggleTooltip:o.toggleTooltip,sendNavigationStatEvents:y,hideTooltip:o.hideTooltip,showQuestionModal:o.showQuestionModal,markAppNotificationsSeen:g,showMessage:c,playStory:u,pauseStory:p,list:v,onMouseDownHandle:o.onDisableAreaMouseDown,onMouseUpHandle:o.onDisableAreaMouseUp,showHelpHint:f,hideHelpHint:w},i)})),M&&(0,r.jsx)(a.StickerTooltip,(0,i.__assign)({clientX:I,clientY:D,layerEl:_,position:P},{children:B}),void 0),A&&(0,r.jsx)(d.default,(0,i.__assign)({title:(0,h.getLang)("stories_question_ask_box_title").replace("{name}",(0,m.decodeHTMLEntities)(l.name_get)),actionButtons:o.getQuestionModalActions(),className:"StoryQuestionAskForm",onClose:o.closeQuestionModal,appearance:"blue"},{children:(0,r.jsx)("div",(0,i.__assign)({className:"StoryQuestionAskForm__inner"},{children:(0,r.jsx)("textarea",{ref:o.askTextarea,className:"StoryQuestionAskForm__textarea",maxLength:80,placeholder:(0,h.getLang)("stories_question_ask_placeholder"),onChange:o.handleChange,onKeyDown:o.handleKeyDown},void 0)}),void 0)}),void 0)]}),void 0)},o.handleResize=function(){var e=(0,i.__read)((0,p.getSize)(o.props.el),2),t=e[0],r=e[1];o.setState({widthViewBox:t,heightViewBox:r,showTooltip:!1})},o.toggleTooltip=function(e,t,i){void 0===i&&(i="t"),e.preventDefault(),e.stopPropagation();var r=e.clientX,s=e.clientY,n=o.props,a=n.pauseStory,l=n.playStory,d=n.hideFeedbackTooltip,_=n.sendNavigationStatEvents;d(),o.setState({showTooltip:!o.state.showTooltip,tooltipContent:t,clientX:r,clientY:s,position:i}),setTimeout((function(){o.state.showTooltip?(_("click_on_clickable_sticker"),a()):l()}),0)},o.hideTooltip=function(){o.setState({showTooltip:!1})},o.isShownTooltip=function(){return o.state.showTooltip||o.state.showQuestionModal},o.showQuestionModal=function(){var e=o.props,t=e.storyData,i=e.showMessage,r=e.pauseStory,s=e.onModalShownChange;if(!t.can_ask)return i((0,h.getLang)("stories_question_forbidden"));o.setState({showQuestionModal:!0}),o.hideTooltip(),s(!0),r()},o.closeQuestionModal=function(){var e=o.props,t=e.playStory,i=e.onModalShownChange;o.setState({showQuestionModal:!1}),i(!1),t()},o.handleChange=function(e){o.setState({questionText:e.target.value})},o.handleKeyDown=function(e){var t=o.state.questionText;(0,v.trim)(t)&&"keydown"===e.type&&(e.ctrlKey||e.metaKey)&&e.keyCode==g.KEY.RETURN&&o.sendQuestion()},o.resetAskText=function(){o.setState({questionText:""})},o.getQuestionModalActions=function(){var e=o.props.storyData.can_ask_anonymous,t=o.state,s=t.isQuestionButtonLoading,n=t.questionText,a=[{value:u.QUESTION_SELECT_MODE.AUTHOR_ONLY,label:(0,h.getLang)("stories_question_select_author_only")},{value:u.QUESTION_SELECT_MODE.PUBLIC,label:(0,h.getLang)("stories_question_select_public")}];return e&&a.splice(1,0,{value:u.QUESTION_SELECT_MODE.ANONYMOUS,label:(0,h.getLang)("stories_question_select_anonymous")}),(0,r.jsxs)("div",(0,i.__assign)({className:"StoryQuestionAskForm__footer"},{children:[(0,r.jsx)("div",(0,i.__assign)({className:"StoryQuestionAskForm__cell StoryQuestionAskForm__cell--select"},{children:(0,r.jsx)(c.default,{value:o.state.selected,options:a,onChange:o.onSelectChange,onShow:o.onSelectShow,onHide:o.onSelectHide},void 0)}),void 0),(0,r.jsxs)("div",(0,i.__assign)({className:"StoryQuestionAskForm__cell"},{children:[(0,r.jsx)(_.default,(0,i.__assign)({appearance:"tertiary",onClick:o.closeQuestionModal},{children:(0,h.getLang)("global_cancel")}),"b"),(0,r.jsx)(l.default,(0,i.__assign)({loading:s,disabled:!(0,v.trim)(n),onClick:o.sendQuestion},{children:(0,h.getLang)("stories_question_reply_send")}),"s")]}),void 0)]}),void 0)},o.onSelectChange=function(e){o.setState({selected:Number(e.selected.value)})},o.onSelectShow=function(){var e=o.props,t=e.storyData,i=e.author,r=t.can_ask_anonymous,s=document.querySelector(".StoryQuestionAskForm__cell--select");if(s){var n=r?(0,h.getLang)("stories_question_about_user_tooltip"):(0,h.getLang)("stories_question_about_user_tooltip_without_anon"),a=r?(0,h.getLang)("stories_question_about_group_tooltip"):(0,h.getLang)("stories_question_about_group_tooltip_without_anon"),l="";l=f.Ranges.isUserId(i.id)?n.replace(/{name}/g,(0,m.decodeHTMLEntities)(i.firstName)):a,(0,y.showTooltip)(s,{text:l,width:350,slideX:15,className:"",nohide:!0,asrtl:!0,shift:[350,-15],dir:"left",showdt:1e3})}},o.onSelectHide=function(){var e=document.querySelector(".StoryQuestionAskForm__cell--select");e&&e.tt&&e.tt.destroy()},o.sendQuestion=function(){var e=o.state.questionText,t=o.props,r=t.showMessage,s=t.storyData,n=t.author,a=t.sendNavigationStatEvents,l=s.raw_id,d=s.askQuestionHash,_=(0,i.__read)(l.split("_"),2),c=_[0],p=_[1],v=!1,m=!1;o.state.selected===u.QUESTION_SELECT_MODE.PUBLIC?v=!0:o.state.selected===u.QUESTION_SELECT_MODE.ANONYMOUS&&(m=!0),window.ajax.post("al_stories.php",{act:"ask_question",story_owner_id:c,story_id:p,question_text:e,is_anonymous:+m,with_mention:+v,hash:d},{onDone:function(){switch(o.closeQuestionModal(),o.resetAskText(),r((0,h.getLang)("stories_question_sent").replace("{name}",n.first_name_ins)),o.state.selected){case u.QUESTION_SELECT_MODE.PUBLIC:a("question_reply_publish");break;case u.QUESTION_SELECT_MODE.AUTHOR_ONLY:a("question_reply");break;case u.QUESTION_SELECT_MODE.ANONYMOUS:a("question_reply_anonymous")}},onFail:function(e){return o.closeQuestionModal(),o.resetAskText(),r(e),!0},showProgress:function(){return o.setState({isQuestionButtonLoading:!0})},hideProgress:function(){return o.setState({isQuestionButtonLoading:!1})}})};var w=(0,i.__read)((0,p.getSize)(o.props.el),2),S=w[0],E=w[1];return o.askTextarea=(0,s.createRef)(),o.state={widthViewBox:S,heightViewBox:E,clientX:0,clientY:0,showTooltip:!1,tooltipContent:"",position:"t",showQuestionModal:!1,isQuestionButtonLoading:!1,selected:u.QUESTION_SELECT_MODE.AUTHOR_ONLY,questionText:""},o}return(0,i.__extends)(t,e),t}(s.Component)},309786:(e,t,o)=>{o.d(t,{ViewsButton:()=>c});var i=o(570655),r=o(785893),s=o(584282),n=o(429697),a=o(923197),l=o(820603),d=o(659397),_=o(533228),c=function(e){var t=e.story,o=e.reactionSet,c=e.className,u=void 0===c?"":c,p=t.getReplies(),h=t.getViews()||"",v=t.getCurStoryData();if(!v)return null;var m=v.can_manage,y=v.isNewQuestions,g=v.needShowEmptyStats,f=v.replies_new_counter,w=v.small_preview,S=(0,_.isNewDesignEnabled)(),E=Boolean(m&&(h||g)),b=S?Boolean(!m&&p):Boolean(p),k=g||y||Boolean(S&&m&&f),T=t.isActiveLive(),C=t.getRawId(),L=t.isFeedbackTooltipShow,M=t.toggleFeedbackTooltip,P=t.onFetchFeedbackData,B=t.onFetchViewers,A=t.onQuestionRemove,I=t.feedback,D=t.showMoreReplies,x=t.onPrivacyHintHide;if(T||!h&&!p&&!g)return null;var O=t.showMessage.bind(t),N=t.layer.sendNavigationStatEvents.bind(t.layer),R="",F="";return S?(F="StoryViewerButtonWrapper",R="StoryViewerButton StoryViewerButton--feedback StoryViewerButton--dark",L&&(R+=" StoryViewerButton--hover")):(F="StoryButtonWrapper StoryButtonWrapper--feedback",R="StoryButton StoryButton--feedback",L&&(R+=" StoryButton--hover")),(0,r.jsxs)("div",(0,i.__assign)({className:(0,d.classNames)(F,u)},{children:[(0,r.jsxs)("div",(0,i.__assign)({className:R,onClick:function(e){M(),g&&N("open_empty_feedback"),e.stopPropagation()}},{children:[b&&(0,r.jsxs)("div",(0,i.__assign)({className:"StoryButtonFeedbackLabel StoryButtonFeedbackLabel--replies"},{children:[(0,r.jsx)(a.default,{},void 0),(0,r.jsx)("span",(0,i.__assign)({className:"StoryButtonFeedbackLabel__text"},{children:p}),void 0)]}),void 0),E&&(0,r.jsxs)("div",(0,i.__assign)({className:"StoryButtonFeedbackLabel StoryButtonFeedbackLabel--views"},{children:[(0,r.jsx)(l.default,{},void 0),Boolean(h)&&(0,r.jsx)("span",(0,i.__assign)({className:"StoryButtonFeedbackLabel__text"},{children:h}),void 0)]}),void 0),k&&(0,r.jsx)("span",{className:(0,d.classNames)("StoryButtonBadge StoryButton__badge",{"StoryButton__badge--isNewDesign":S,"StoryButtonBadge--orange":y&&!S,"StoryButtonBadge--blue":!y&&g||S})},void 0)]}),void 0),!S&&(0,r.jsx)(n.default,(0,i.__assign)({in:L,timeout:200,classNames:{enter:"FeedbackTooltipTransitionWrapper--enter",enterActive:"FeedbackTooltipTransitionWrapper--enterActive",exit:"FeedbackTooltipTransitionWrapper--exit",exitActive:"FeedbackTooltipTransitionWrapper--exitActive"},unmountOnExit:!0},{children:(0,r.jsx)(s.default,{className:"StoryButtonWrapper__feedback",reactionSet:o,feedback:I,storyRawId:C,storyImageUrl:w,toggleFeedbackTooltip:M,onFetchFeedbackData:P,onFetchViewers:B,showMessage:O,sendNavigationStatEvents:N,onQuestionRemove:A,showMoreReplies:D,onPrivacyHintHide:x,needShowEmptyStats:g},void 0)}),void 0)]}),void 0)}},237298:(e,t,o)=>{o.d(t,{DiscoverMetaStory:()=>h});var i=o(570655),r=o(785893),s=o(973935),n=o(168373),a=o(10002),l=o(70162),d=o(341319),_=o(239124),c=o(401755),u=o(533228),p=o(66433),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewEventType="discover_feed_view",t.hasMore=function(){return Boolean(t.block.next_from)},t.loadMore=function(){return t.hasMore()?(0,u.fetchDiscover)(t.block.next_from,t.block.track_code,!1).then((function(e){var o=(0,i.__read)(e,2),r=o[0],s=o[1];t.block.grouped=(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__read)(t.block.grouped||[]),!1),(0,i.__read)(r),!1),t.block.next_from=s,t.update()})):Promise.resolve()},t}return(0,i.__extends)(t,e),t.prototype.update=function(){var e,t=this;this.isDestroyed||(Boolean(null===(e=this.block.grouped)||void 0===e?void 0:e.length)||(0,u.preloadDiscoverList)().then((function(){t.update()})).catch((function(e){console.error(e),(0,p.logError)(new Error("Error with getDiscoverList in DiscoverMetaStory"+(e?": "+e:"")))})),s.render((0,r.jsx)(n.MetaStory,{metaStoryInfo:(0,r.jsx)(a.MetaStoryInfo,{icon:(0,r.jsx)("div",(0,i.__assign)({className:"MetaStoryInfo__discoverIcon"},{children:(0,r.jsx)(c.default,{},void 0)}),void 0),header:(0,l.getLang)("stories_interesting_stories"),subheader:(0,l.getLang)("stories_interesting_stories_description")},void 0),list:this.block.grouped,listName:d.StoryListName.discover,source:d.StorySource.DISCOVER,isPaused:this.isPaused.bind(this),onLongTap:this.options.onLongTap,onScroll:this.onScroll,hasMore:this.hasMore,loadMore:this.loadMore,pause:this.options.pause,play:this.options.play,playNextStory:this.options.playNextStory,playPrevStory:this.options.playPrevStory,onTopScrolled:this.options.toggleMetaStoryTitle},void 0),this.wrapper))},t}(_.MetaStory)},101103:(e,t,o)=>{o.d(t,{GroupsMetaStory:()=>c});var i=o(570655),r=o(785893),s=o(973935),n=o(239124),a=o(341319),l=o(70162),d=o(168373),_=o(10002),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.update=function(){s.render((0,r.jsx)(d.MetaStory,{metaStoryInfo:(0,r.jsx)(_.MetaStoryInfo,{header:(0,l.getLang)("stories_groups_grid_title"),subheader:(0,l.getLang)("stories_groups_grid_text")},void 0),list:this.block.grouped,listName:a.StoryListName.groups,isPaused:this.isPaused.bind(this),onLongTap:this.options.onLongTap,onScroll:this.onScroll,pause:this.options.pause,play:this.options.play,playNextStory:this.options.playNextStory,playPrevStory:this.options.playPrevStory,onTopScrolled:this.options.toggleMetaStoryTitle},void 0),this.wrapper)},t}(n.MetaStory)},614706:(e,t,o)=>{o.d(t,{StoryLayer:()=>I});var i=o(570655),r=o(501389),s=o(679740),n=o(341319),a=o(784329),l=o(125696),d=o(8383),_=o(533228),c=o(862110),u=o(506770),p=o(742129),h=o(117173),v=o(810890),m=o(117945),y=o(798262),g=o(10769),f=o(274642),w=o(342269),S=o(70162),E=o(152278),b=o(927766),k=o(769488),T=o(873589),C=o(66433),L=o(689840),M=o(500445),P=o(77308),B=o(239124),A=o(579449),I=function(){function e(e,t,o,i,r,s,n,a){void 0===e&&(e=0),void 0===t&&(t=0),void 0===o&&(o=""),void 0===i&&(i=""),this.hasUnloadedDiscover=!1,this.options={},this.options=a;try{window.Videoview&&window.Videoview.togglePlay(!1)}catch(e){}this.initDOM(),this.show(),this._init(e,t,o,i,r,s,n),(0,T.addClass)(this.layerEl,"shown"),this._source=a.source,this._initViewerSource(),this._sendOpeningEvents()}return e.prototype._init=function(t,o,i,r,s,a,l){var d,_;if(r||(r=t?i?""+t+i:(null===(d=a.find((function(e){var o;return(null===(o=null==e?void 0:e.author)||void 0===o?void 0:o.id)===t})))||void 0===d?void 0:d.id)||"":(null===(_=a[0])||void 0===_?void 0:_.id)||""),!r)throw this.destroy(),new Error("blockKey is undefined");this.blockKey=r,t&&o&&(this.startStoryRaw=t+"_"+o),this.listName=s,this.renderedStoryList=a,this.storyList=a,this.extra=e.parseExtra(l),this.extraRaw=l||"",this.hasUnloadedDiscover=Boolean(a.find((function(e){var t;return e.type===n.StoryBlockType.discover&&!(null===(t=e.grouped)||void 0===t?void 0:t.length)}))),this.initStories().catch((function(e){(0,k.debugLog)(e)}))},e.prototype.initStories=function(){var e=this;return new Promise((function(t){e.renderedStoryBlockKeys=e.renderedStoryList.map((function(t){return e.getBlockKey(t)}));var o=!1,i=e.renderedStoryBlockKeys.indexOf(e.blockKey);if(i>-1){var r=e.renderedStoryList[i];o=e.isBlockUnread(r)}if(e.extra)switch(e.extra.context){case"new":o=!0;break;case"all":o=!1}if(o&&"replies"===e.listName.substr(0,7)&&(o=!1),o){for(var s=[],n=0;n<e.renderedStoryList.length;n++){var a=e.renderedStoryList[n];(a&&e.isBlockUnread(a)||0===n&&e._hasContext("new"))&&s.push(a)}s.length&&(e.renderedStoryList=s,e.renderedStoryBlockKeys=e.renderedStoryList.map((function(t){return e.getBlockKey(t)})))}e.renderedStories={};var l=e._renderStories().activeStory;e.scrollToStory(l,!0),1===e.renderedStoryList.length&&(0,T.addClass)(e.stories,"one_story"),e._startFirstStory(l,e.extra.story_id),(0,T.addClass)(e.stories,"inited"),t()}))},e.prototype.getBlockKey=function(e){var t,o,i;return(null===(t=null==e?void 0:e.author)||void 0===t?void 0:t.id)&&(null===(o=null==e?void 0:e.narrative)||void 0===o?void 0:o.id)?e.author.id+"narrative"+(null===(i=e.narrative)||void 0===i?void 0:i.id):""+e.id},e.prototype.isBlockUnread=function(e){var t,o,i=!1;return e.items[e.items.length-1]&&(i=null===(t=e.items[e.items.length-1])||void 0===t?void 0:t.unread),(null===(o=e.grouped)||void 0===o?void 0:o.length)?i||(i=e.grouped.some((function(e){var t;return null===(t=e.items[e.items.length-1])||void 0===t?void 0:t.unread}))):e.type===n.StoryBlockType.discover&&(i=!0),i},e.prototype._renderStories=function(){for(var e=this,t=[],o=0;o<this.renderedStoryList.length;o++)this.renderedStoryList[o]&&t.push(this.renderedStoryList[o]);var i=this._getScreenStoriesCount(),r=this._getCurStoryPos(t.map((function(t){return e.getBlockKey(t)}))),s=Math.floor(i/2),n=t.slice(Math.max(0,r-s)).slice(0,i),l=n.map((function(t){return e.getBlockKey(t)}));for(var d in this.renderedStories)if(this.renderedStories.hasOwnProperty(d)){var _=this.renderedStories[d];l.includes(d)||(_.story.destroy(),delete this.renderedStories[d])}var c=null;if(n.map((function(t,o){var i,r,n=e.getBlockKey(t);if(!e.renderedStories[n]){var l=e.renderedStoryBlockKeys.indexOf(n),d=new a.Story(t,{id:o,layer:e,onSelect:e._onSelectStory.bind(e),onStoriesEnd:e._onStoriesEnd.bind(e,l),playPrevOwner:e._playPrevOwner.bind(e,l),onPlayStory:e._onPlayStory.bind(e,l),onSeen:e._readStories.bind(e),onVideoPlay:e._onVideoPlay.bind(e),restoreAudioPlay:e._restoreAudioPlay.bind(e),onStartStory:e._onStartStory.bind(e),removeCurrentList:function(){return window.Stories.removeList(e.listName)},onStoryBlockRemoved:function(t,o){return e.onStoryBlockRemoved(l,t,o)},afterNarrativeRemoved:null===(i=e.options)||void 0===i?void 0:i.afterNarrativeRemoved,afterNarrativeEdited:null===(r=e.options)||void 0===r?void 0:r.afterNarrativeEdited});o<=s&&e.stories.children[o]?e.stories.insertBefore(d.render(),e.stories.children[o]):e.stories.appendChild(d.render()),e.renderedStories[n]={story:d,index:l},n===e.blockKey&&(c=d)}})),!c){var u=l[0];c=this.renderedStories[u].story}return{activeStory:c}},e.prototype._sendOpeningEvents=function(){if(this._source){var e;switch(this._source){case"narrative_story":e="narrative_open_stories";break;case"narrative_snippet":case"narrative_link":e="narrative_open";break;case"narrative_recommendations":e="narrative_other"}if(e&&this.sendNavigationStatEvents(e,!1),"narrative_fave"===this._source){var t=this.activeStory.getCurrentNarrative();if(t){var o=t.ownerId,i=t.id;(0,y.statlogsValueEvent)("bookmarks_product_analytics",{item_type:"narrative",item_owner_id:o,item_id:i,time:(0,s.getServerTime)()})}}}},e.prototype._destroyStories=function(){for(var e in this.renderedStories){if(this.renderedStories.hasOwnProperty(e))this.renderedStories[e].story.destroy()}},e.prototype.destroy=function(){clearTimeout(this.timer),clearTimeout(this.animationTimer),this._destroyStories(),this._onVideoEnd(),(0,E.removeEvent)(this.volumeControl),(0,E.removeEvent)(this.layerEl),delete this.activeStory,delete this.volumeControl,delete this.renderedStories;try{this.layerEl&&document.body.removeChild(this.layerEl)}catch(e){}delete window.cur.storyLayer},e.prototype.getList=function(){return"story"+this.activeStory.getRawId()+"/"+this.listName+(this.extraRaw?"/"+this.extraRaw:"")},e.prototype.getStoryRaw=function(){return!!this.activeStory&&this.activeStory.getRawId()},e.prototype.initDOM=function(){this.layerEl=(0,T.ce)("div",{className:"stories_layer"});var e=(0,T.ce)("div",{className:"stories_layer_cont"});this.layerEl.appendChild(e),e.appendChild(this._renderBackButton()),e.appendChild(this._renderVolumeControl()),this._updateVolumeButton(),this.stories=(0,T.ce)("div",{id:"stories_list",className:"stories_list"}),e.appendChild(this.stories),e.appendChild((0,T.ce)("div",{className:"stories_layer_close"})),(0,E.addEvent)(this.layerEl,"click",this._onLayerClick.bind(this)),document.body.appendChild(this.layerEl)},e.prototype.show=function(){window.onBodyResize()},e.prototype.hide=function(e){var t=this;(0,T.addClass)(this.layerEl,"stories_layer_hiding"),this.hideAllLayers||l.layerHide(),this._source&&this._source.startsWith("narrative")&&this.sendNavigationStatEvents("narrative_close",!1),this.activeStory&&(this.activeStory.pauseStory(),this.activeStory.hideTooltip(),this.activeStory.isActiveLive()&&this.sendNavigationStatEvents("live_player_close",!1),this._readStoriesIfNeeded(this.activeStory),this.activeStory.isActiveStoryOneTime()&&window.Stories.removeList(this.listName)),!0!==e&&this.activeStory?this.animateStory("minimize").then((function(){return t.doHide()})).catch((function(){(0,k.debugLog)("error animate story")})):this.doHide(e),(0,T.removeClass)(this.layerEl,"shown")},e.prototype.doHide=function(e){this.destroy(),e||l.removeLayer(),window.wkcur&&window.wkcur.shown&&window.WkView.restoreLayer({}),"group_stories"===this.listName&&window.Stories.groupStoriesBlockUpdate(),this.listName.startsWith("archive")&&window.updateStoriesArchiveBoxPosition&&window.updateStoriesArchiveBoxPosition&&window.updateStoriesArchiveBoxPosition(),(0,g.clear)()},e.prototype.back=function(){this.hideAllLayers=!1;var e=(0,v.getCancelStack)(),t=e[e.length-1];t&&"stories_form_focus"===t.name&&(0,v.cancelStackPop)(),this.hide(!1)},e.prototype._getScreenStoriesCount=function(){return 2*Math.floor(window.innerWidth/(window.innerHeight*d.STORY_HORIZONTAL_RATIO))+1},e.prototype._getCurStoryPos=function(e){return(e||this.renderedStoryBlockKeys).indexOf(this.blockKey)},e.prototype._startFirstStory=function(e,t){var o=this;this.activeStory=e,(0,T.addClass)(e.getWrap(),"active"),this.scrollToStory(),t||(t=this._hasContext("new")?t:this.startStoryRaw),e.indexToStoryById(t),this._startActiveStory(),setTimeout((function(){(0,T.addClass)(o.stories,"animated"),o.inited=!0,"open"===o.extra.replies&&o.activeStory.showFeedbackTooltip()}))},e.prototype._markReadRestStories=function(e){e.hasMetaStory()?this.onMetaStoryViewEnd(e):(this._markReadStoriesInRange(e,e.index,e.getFullItemsLength()),this._updateBadge(e))},e.prototype.onMetaStoryViewEnd=function(e){var t,o,r,s,a,l;if(e.data.grouped){try{for(var d=(0,i.__values)(e.data.items),_=d.next();!_.done;_=d.next()){_.value.unread=!1}}catch(e){t={error:e}}finally{try{_&&!_.done&&(o=d.return)&&o.call(d)}finally{if(t)throw t.error}}var c=(0,T.ge)("feed_story_"+this.getBlockKey(e.data)),u=[];try{for(var p=(0,i.__values)(e.data.grouped),h=p.next();!h.done;h=p.next()){var v=h.value;if(v){try{for(var m=(a=void 0,(0,i.__values)(v.items)),y=m.next();!y.done;y=m.next()){var g=y.value;g.unread=!1,u.push(g.raw_id)}}catch(e){a={error:e}}finally{try{y&&!y.done&&(l=m.return)&&l.call(m)}finally{if(a)throw a.error}}v.author&&((0,A.markSeenStoriesInProfile)(v.author.id),(0,L.removeUnseenStories)(v.author.id),(0,M.removeUnseenStories)(v.author.id),(0,P.removeUnseenStories)(v.author.id))}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(s=p.return)&&s.call(p)}finally{if(r)throw r.error}}this.markStoriesSkipped(u),e.data.has_unseen=!1,e.data.type===n.StoryBlockType.communityGroupedStories&&this._resetGroupsBlockPreview(e.data,c),this.updateMetaStoryItems(),(0,T.removeClass)(c,"story_feed_new_item")}},e.prototype.markStoriesSkipped=function(e){window.ajax.post("al_stories.php",{act:"mark_skipped",stories:e.join(","),hash:this.storiesReadHash})},e.prototype._resetGroupsBlockPreview=function(e,t){var o;if(t&&t.classList.contains("stories_feed_preview_item")&&(null===(o=e.grouped)||void 0===o?void 0:o.length)){var i=e.grouped[0].items[0];i&&i.small_preview&&(0,T.setStyle)(t,"background-image","url("+i.small_preview+")")}},e.prototype._onSelectStory=function(e){var t,o=this;this.activeStory&&(t=this.activeStory.getWrap(),this.activeStory.stop()),e.id-this.activeStory.id>0&&this._markReadRestStories(this.activeStory),this.activeStory=e,e.indexToUnread(),e.isActiveLive()||e.fillTimeLine(),this.blockKey=this.getBlockKey(e.data),clearTimeout(this.timer),(0,T.addClass)(this.stories,"animated"),this.timer=setTimeout((function(){(0,T.removeClass)(t,"active"),(0,T.addClass)(e.getWrap(),"active"),o.scrollToStory(),o.timer=setTimeout((function(){o.activeStory&&e.id!==o.activeStory.id||!o.activeStory||(e.indexToUnread(),o._startActiveStory(),o._renderStories(),o.scrollToStory(e,!0))}),200)}),0)},e.prototype._startActiveStory=function(){var e=this.activeStory;e.markAsActive(),e.playStory(!0)},e.prototype._onStartStory=function(){this.updateLocation()},e.prototype.updateLocation=function(){var e=this.activeStory,t=this.listName;if(e){var o=this.activeStory.getCurStoryData(),r=this.activeStory.getCurrentNarrative(),s=this.activeStory.isActiveMetaStory();if(o||s){var n=window.nav.objLoc;if(o){if(n.w="story"+e.getRawId(),t.match(/^-?(\d+)_(\d+)$/)||(n.w+="/"+t),t.match(/^narrative[s]?-?\d+(_\d+)?/)){var a=o.raw_id,l=(0,i.__read)(a.split("_"),2)[1];n.w="narrative"+(null==r?void 0:r.rawId)+"_"+l}}else delete n.w;window.nav.setLoc(window.nav.toStr(n))}else(0,C.logError)(new Error("Fail: _onStartStory"),{environment:"stories"})}},e.prototype.scrollToStory=function(e,t){var o=this,i=this._getScrollLeft(e);t?((0,T.removeClass)(this.stories,"animated"),this._setScrollLeft(i)):this.inited&&(0,T.addClass)(this.stories,"animated"),setTimeout((function(){o._setScrollLeft(i)}))},e.prototype._setScrollLeft=function(e){(0,T.setStyle)(this.stories,"transform","translateX("+Math.round(e)+"px) translateZ(0)")},e.prototype._getScrollLeft=function(e){return e=e||this.activeStory,window.innerWidth/2-e.getOffsetLeft()},e.prototype._onStoriesEnd=function(e,t){for(var o=-1,i=e+1;i<this.renderedStoryList.length;i++){if(this.renderedStoryList[i]){o=i;break}}var r=this._getStoryBlockByIndex(o);if(this.activeStory.isActiveMetaStory()&&this.onMetaStoryViewEnd(this.activeStory),this.activeStory.isActiveStoryOneTime()&&window.Stories.removeList(this.listName),o>-1&&r)t&&this.sendNavigationStatEvents("go_to_next_story_auto_by_time"),this._onSelectStory(r);else{var s=(0,v.getCancelStack)(),n=s[s.length-1];n&&"stories_form_focus"===n.name&&(0,v.cancelStackPop)(),(0,v.cancelStackPop)({byTimer:t})}},e.prototype.preloadDiscoverIfNeeded=function(){var e,t,o=this;if(this.hasUnloadedDiscover&&!_.isDiscoverLoading()&&this.activeStory){var i=this.getBlockKey(this.activeStory.data);if(this.renderedStories[i])for(var r=this.renderedStories[i].index,s=Math.min(r+3,this.renderedStoryBlockKeys.length-1),a=r+1;a<=s;a++)if((null===(e=this.renderedStoryList[a])||void 0===e?void 0:e.type)===n.StoryBlockType.discover)return(null===(t=this.renderedStoryList[a].grouped)||void 0===t?void 0:t.length)?void(this.hasUnloadedDiscover=!1):void _.preloadDiscoverList().then((function(){o.hasUnloadedDiscover=!1})).catch((function(e){console.error(e),(0,C.logError)(new Error("Error with getDiscoverList in preloadDiscoverIfNeeded"+(e?": "+e:"")))}))}},e.prototype._playPrevOwner=function(e){for(var t=-1,o=e-1;o>=0;o--){if(this.renderedStoryList[o]){t=o;break}}var i=this._getStoryBlockByIndex(t);t>-1&&i?this._onSelectStory(i):(0,v.cancelStackPop)()},e.prototype._markReadStoriesInRange=function(e,t,o){for(var i,r=e.data.items,s=t;s<o;s++){var n=r[s];n.unread&&(n.unread=!1)}(null===(i=e.data.grouped)||void 0===i?void 0:i.length)&&o>=e.getFullItemsLength()&&(e.data.grouped.forEach((function(e){return e.items.forEach((function(e){return e.unread=!1}))})),e.data.has_unseen=!1)},e.prototype._markReadPrevStories=function(e){this._markReadStoriesInRange(e,0,e.index)},e.prototype._updateBadge=function(e){var t,o=(0,T.ge)("feed_story_"+this.getBlockKey(e.data)),i=(0,T.geByClass1)("_stories_feed_item_replies",o);if(!e.hasUnloadedMetaStory()){var r=e.data.items||[];(r[e.index]||{}).unread=!1;var s=!0;r.forEach((function(e){e.unread&&(s=!1)})),s&&(null===(t=e.data.grouped)||void 0===t?void 0:t.length)&&(s=e.data.grouped.every((function(e){return e&&e.items.every((function(e){return!(null==e?void 0:e.unread)}))}))),(0,T.val)(i,""),s&&((0,T.removeClass)(o,"story_feed_new_item"),(0,T.removeClass)(o,"story_feed_new_item_promo"),e.data.author&&((0,A.markSeenStoriesInProfile)(e.data.author.id),(0,L.removeUnseenStories)(e.data.author.id),(0,M.removeUnseenStories)(e.data.author.id),(0,P.removeUnseenStories)(e.data.author.id)))}},e.prototype._onPlayStory=function(e){var t=this._getStoryBlockByIndex(e);t&&(this.storiesReadHash=t.getReadHash(),t.isActiveMetaStory()||t.isActiveStoryOneTime()||(this._readStories(t),this._markReadPrevStories(t)),this._updateBadge(t));var o=this._getStoryBlockByIndex(e+1);o&&(t&&0===t.getIndex()&&this.preloadDiscoverIfNeeded(),o.preloadNextStory(o.getIndex()))},e.prototype._getStoryBlockByIndex=function(e){var t=this.renderedStoryList[e];if(!t)return!1;var o=this.getBlockKey(t);return this.renderedStories[o].story},e.prototype.onStoryBlockRemoved=function(e,t,o){var i=this,r=this.renderedStoryList[e],s=this.getBlockKey(r),n=this.storyList.findIndex((function(e){return e&&s===i.getBlockKey(e)}));delete this.renderedStoryList[e],delete this.storyList[n],!t&&this._onStoriesEnd(e),window.Stories.updateFeedStories(void 0,{cb:o})},e.prototype.onVisibilityChange=function(){"visible"===document.visibilityState?window.cur.storyLayer&&window.cur.storyLayer.playStory():window.cur.storyLayer&&window.cur.storyLayer.pauseStory()},e.prototype.onResize=function(){this.activeStory&&window.cur.storyLayer.scrollToStory(this.activeStory,!0)},e.prototype.pauseStory=function(e){this.activeStory&&this.activeStory.pauseStory(e)},e.prototype.playStory=function(e){void 0===e&&(e=!1),this.activeStory&&this.activeStory.autoResumeStory(e)},e.prototype._onLayerClick=function(e){var t,o,r=(0,T.hasClass)(e.target,"stories_layer_close");if((0,T.hasClass)(e.target,"stories_layer_cont")||r){if(this.renderedStoryBlockKeys.length-1===this._getCurStoryPos()&&!r){var s=[];try{for(var n=(0,i.__values)(this.activeStory.data.items),a=n.next();!a.done;a=n.next()){var l=a.value;s.push(l.raw_id),l.unread=!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}this.markStoriesSkipped(s),this._markReadRestStories(this.activeStory)}(0,v.cancelStackPop)({isCloseBtnClick:r})}},e.prototype._checkKeyEvents=function(e){return!((0,T.attr)(e.target,"contenteditable")||(0,w.inArray)(e.target.tagName,["INPUT","TEXTAREA"])||(0,r.curBox)())},e.prototype.onKeyDown=function(e){if(window.cur.storiesKeyDown)window.cur.storyLayer&&window.cur.storyLayer._checkKeyEvents(e)&&(0,E.cancelEvent)(e);else if(window.cur.storiesKeyDown=e.keyCode!==E.KEY.ESC,[E.KEY.PAGEDOWN,E.KEY.PAGEUP].includes(e.keyCode))(0,E.cancelEvent)(e);else if(window.cur.storyLayer&&window.cur.storyLayer.inited&&window.cur.storyLayer._checkKeyEvents(e)){switch(e.keyCode){case E.KEY.LEFT:this._readStoriesIfNeeded(this.activeStory),window.cur.storyLayer.prevStory();break;case E.KEY.RIGHT:this._readStoriesIfNeeded(this.activeStory),window.cur.storyLayer.nextStory();break;case E.KEY.SPACE:(0,E.cancelEvent)(e);var t=window.cur.storyLayer.activeStory;t.isSpaceLongTabAvailable()&&(window.cur.storiesKeyDownLong=setTimeout(t.longTapHandle.bind(t),h.LONG_PRESS_DELAY_MS))}window.cur.storiesKeyDownTs=(0,w.vkNow)()}},e.prototype.onKeyUp=function(e){window.cur.storiesKeyDown=!1,clearTimeout(window.cur.storiesKeyDownLong),window.cur.storyLayer&&window.cur.storyLayer.inited&&window.cur.storyLayer._checkKeyEvents(e)&&e.keyCode===E.KEY.SPACE&&((0,E.cancelEvent)(e),(0,w.vkNow)()-window.cur.storiesKeyDownTs>h.LONG_PRESS_DELAY_MS?window.cur.storyLayer.playStory(!0):(this._readStoriesIfNeeded(this.activeStory),window.cur.storyLayer.nextStory()))},e.prototype.nextStory=function(){this.activeStory&&this.activeStory.nextStory()},e.prototype.prevStory=function(){this.activeStory&&this.activeStory.prevStory()},e.prototype.changeStory=function(e){this.activeStory&&this.activeStory.changeStory(e)},e.prototype._readStoriesIfNeeded=function(e){e.isActiveStoryOneTime()&&this._readStories(e)},e.prototype._readStories=function(e){if(e){var t=e.getRawId(),o=e.getCurrentNarrative();if(t&&e.isLoaded()){var i=e.getTrackCode(),r=0;e.isActiveStoryOneTime()&&(r=Math.max(Math.round(e.getStoryProgressPercent()),1)),i||(i=""),window.ajax.post("al_stories.php",{act:"read_stories",story_id:t,track_code:i,progress:r,source:this._getSource(),navigation_stats:(0,m.serializeNavigationStats)(),loading_stats:(0,m.serializeLoadingStats)(),connection_type:(0,m.getConnectionType)(),hash:e.getReadHash(),narrative_id:null==o?void 0:o.id})}}},e.prototype._getSource=function(){return[p.USER_INFO_MODULE,p.GROUP_INFO_MODULE,h.STORIES_MANAGE_MODULE,p.SPAMFEED_MODULE,p.ABUSE_MODULE,h.ADMIN_STORY_VIEW_MODULE].includes(window.cur.module)?window.cur.module:this._source?this._source:"list"},e.prototype.sendNavigationStatEvents=function(e,t,o){var i;void 0===t&&(t=!0),void 0===o&&(o={});var r=this.activeStory;if(r){var s=this.getStoryRaw()||(null===(i=r.getCurStoryData())||void 0===i?void 0:i.raw_id),n=this._getSource();t&&this._sendProductAnalyticEvents(e,o),this._updateLastStoryOpenAction(e),(0,m.saveNavigationStatEvent)({storyRawId:s,source:n,action:e})}},e.prototype._sendProductAnalyticEvents=function(e,t){var o;void 0===t&&(t={});var i=this.activeStory;if(i){var r=i.isActiveMetaStory(),s=this.getStoryRaw()||(null===(o=i.getCurStoryData())||void 0===o?void 0:o.raw_id);if(s||r){var a=0,l=0,d=0;if(s){var p=s.split("_");a=Number(p[0]),l=Number(p[1])}var h=i.getIndex(),v=i.getFullItemsLength()-h,m=i.story,g=this._getSource(),f=i.getCurrentNarrative();if(e&&i&&(r||m&&a&&l)){this.listName!==n.StoryListName.groups&&this.listName!==n.StoryListName.apps||(d=1);var w={event_type:e,story_owner_id:a,story_id:l,time:window.vk.ts+Math.floor(((new Date).getTime()-window.vk.started)/1e3),volume:100*_.getVolume(),view_entry_point:g,stories_author_before:h,stories_author_after:v,nav_screen:window.cur.module,view_event_timeline_position:m.getCurrentTime(),story_type:r?"group_feed":"",is_grouped:d,track_code:i.getTrackCode()};f&&Object.assign(w,{narrative_id:f.id,narrative_owner_id:f.ownerId}),Object.assign(w,t),(0,u.partConfigEnabled)("web_stats_transport_story_view")?(0,c.saveStoryViewStats)(w):(0,y.statlogsValueEvent)("story_product_analytics",w)}}else(0,C.logError)(new Error("_sendProductAnalyticEvents: storyRawId is undefined"),{environment:"stories"})}},e.prototype._updateLastStoryOpenAction=function(e){switch(e){case"go_to_next_story_tap":case"go_to_next_story_click":case"go_to_next_story_auto_by_time":this.viewerSource="next_story";break;case"go_to_previous_story":this.viewerSource="previous_story";break;case"go_to_next_author":this.viewerSource="next_author";break;case"go_to_previous_author":this.viewerSource="previous_author"}},e.prototype._initViewerSource=function(){var e=this._getSource();switch(e){case"reply":this.viewerSource="replies_list";break;case"feed":this.viewerSource=window.cur.section;break;default:this.viewerSource=e}},e.prototype.sendViewerStartTime=function(e,t){var o=this.viewerSource;(0,m.saveViewerStartTime)({storyRawId:e,source:o,time:t})},e.prototype._onVideoPlay=function(){var e=this.activeStory.getCurStoryData();e?e.noSound||(window.Notifier.lcSend("stories_video_start"),window.getAudioPlayer().isPlaying()&&((0,f.getAudioPlayer)().pause(),this.needAudioReset=!0)):(0,C.logError)(new Error("Fail: _onVideoPlay"),{environment:"stories"})},e.prototype._onVideoEnd=function(){this._restoreAudioPlay()},e.prototype._restoreAudioPlay=function(){window.Notifier.lcSend("stories_video_end"),this.needAudioReset&&(window.getAudioPlayer().play(),delete this.needAudioReset)},e.prototype._renderBackButton=function(){return this.backButton=(0,T.se)('<div class="stories_back_button_wrap">\n  <div class="stories_back_button">\n    <div class="stories_back_button_icon"></div>\n    <div class="stories_back_button_text">'+(0,S.getLang)("global_back")+"</div>\n  </div>\n</div>"),(0,E.addEvent)(this.backButton,"click",(function(){(0,v.cancelStackPop)()})),this.backButton},e.prototype.showBackButton=function(){(0,T.show)(this.backButton),this.hideAllLayers=!0,(0,T.addClass)(this.layerEl,"with_back_button")},e.parseExtra=function(e){var t,o,r={},s=String(e).split(";");try{for(var n=(0,i.__values)(s),a=n.next();!a.done;a=n.next()){var l=a.value,d=(0,i.__read)(l.split(":"),2),_=d[0],c=d[1];_&&c&&(r[_]=c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}return r},e.prototype.getAnimateFromElem=function(){if(!this.hideAllLayers){var e=this.getBlockKey(this.activeStory.data);if((0,T.hasClass)(this.animateFromEl,"stories_feed_reply_item")){var t=(0,T.domQuery)("#feed_story_"+e,(0,T.domPN)(this.animateFromEl))[0];if(t)return t}else if("feed"===window.cur.module&&!(0,T.isVisible)(this.backButton)){var o=(0,T.ge)("feed_story_"+e);if(o)return window.Stories.feedScrollToOwner(e),o}}return this.animateFromEl},e.prototype.animateStory=function(e,t){var o=this;return new Promise((function(r){if("expand"===e&&!t||"minimize"===e&&(!o.animateFromEl||!document.body.contains(o.animateFromEl)))return(0,T.setStyle)("stories_layers_background","opacity",1),r();o.pauseStory(),(0,T.addClass)(o.layerEl,"animation"),(0,T.removeClass)(o.stories,"animated");var s="expand"===e?t:o.getAnimateFromElem();if(o.hideAllLayers&&"minimize"===e){var n=l.getFirstLayer();s=n.getAnimateFromElem(),l.slicePrevLayers(),l.layerHide()}(0,T.removeClass)(s,"stories_feed_item_ava_animate");var a=(0,i.__read)((0,T.getXY)(s),2),_=a[0],c=a[1],u=(0,T.getSize)(s),p=window.innerHeight,h=Math.min(d.STORY_MAX_WIDTH,Math.max(d.STORY_MAX_HEIGHT,p*d.STORY_HORIZONTAL_RATIO)),v=h*d.STORY_VERTICAL_RATIO,m=Math.max(0,(p-v)/2),y=Math.max(0,(window.innerWidth-h)/2);_=y-_+h/2-u[0]/2+Number((0,b.scrollGetX)()),c=m-c+v/2-u[1]/2+Number((0,b.scrollGetY)()),_=-_,c=-c;var g={};"expand"===e&&(g.transform="translate("+_+"px, "+c+"px) scale(0)",o.animateFromEl=t),(0,T.setStyle)(o.activeStory.wrapEl,g),"minimize"===e&&(0,T.setStyle)(s,"transform","scale(0)"),o.animationTimer=setTimeout((function(){(0,T.addClass)(o.stories,"animated"),(0,T.addClass)(s,"stories_feed_item_ava_animate"),o.animationTimer=setTimeout((function(){"expand"===e?((0,T.setStyle)("stories_layers_background","opacity",1),(0,T.setStyle)(o.activeStory.wrapEl,"transform","translate(0, 0) scale(1)")):((0,T.setStyle)(o.activeStory.wrapEl,"transform","translate("+_+"px, "+c+"px) scale(0.01)"),(0,T.setStyle)(s,"transform","scale(1)")),o.animationTimer=setTimeout((function(){r(),"expand"===e?((0,T.setStyle)(o.activeStory.wrapEl,"transform",""),(0,T.removeClass)(o.layerEl,"animation"),(0,T.removeClass)(o.stories,"animated"),o.playStory(),l.layerShown()):((0,T.removeClass)(s,"stories_feed_item_ava_animate"),(0,T.setStyle)(s,"transform",""))}),330)}),30)}),30)}))},e.prototype.pauseLayer=function(){this.pauseStory(),(0,T.addClass)(this.layerEl,"paused")},e.prototype.resumeLayer=function(){this._updateVolumeButton(),this.activeStory.volumeUpdate(),this.activeStory&&(this.updateLocation(),window.cur.storyLayer.activeStory.isActiveMetaStory()&&this.updateMetaStoryItems(),this.activeStory.isFeedbackTooltipShow&&this.activeStory.updateBottom(),this.playStory(),(0,T.removeClass)(this.layerEl,"paused"))},e.prototype.updateMetaStoryItems=function(){var e,t;if((null===(t=null===(e=window.cur.storyLayer)||void 0===e?void 0:e.activeStory)||void 0===t?void 0:t.isActiveMetaStory())&&this.activeStory.story instanceof B.MetaStory){var o=this.activeStory.story.getList();if(!o||!o.length||o.every((function(e){return!e})))return window.cur.storyLayer.activeStory.remove(),this.hideAllLayers=!0,void this.hide();this.activeStory.updateMetaStory()}},e.prototype.setLayerVisibility=function(e){(0,T.toggle)(this.layerEl,e)},e.prototype._renderVolumeControl=function(){return this.volumeControl=(0,T.se)('<div class="stories_volume_control">\n  <div class="stories_volume_control_slide_wrap">\n    <div class="stories_volume_control_slide">\n      <div class="stories_volume_control_slide_indicator"></div>\n    </div>\n  </div>\n</div>'),(0,E.addEvent)((0,T.geByClass1)("stories_volume_control_slide_wrap",this.volumeControl),"mousedown",this._volumeControlOnMouseDown.bind(this)),(0,E.addEvent)(this.volumeControl,"mousedown",this._volumeControlOnClick.bind(this)),this.volumeControlContainer=(0,T.ce)("div",{className:"stories_volume_control_container"}),this.volumeControlContainer.appendChild(this.volumeControl),this.volumeControlContainer},e.prototype._volumeControlOnMouseDown=function(e){var t=this;(0,T.addClass)(this.volumeControlContainer,"changing");var o=(0,T.geByClass1)("stories_volume_control_slide",this.volumeControl),r=(0,T.geByClass1)("stories_volume_control_slide_indicator",o),s=(0,i.__read)((0,T.getXY)(o),1)[0],n=(0,i.__read)((0,T.getSize)(o),1)[0],a=function(e){var o=Math.max(0,Math.min(e.pageX-s,n))/n*100;(0,T.setStyle)(r,"width",o+"%"),_.setVolume(o/100),t.activeStory.volumeUpdate()},l=function(){(0,E.removeEvent)(window,"mousemove",a),(0,E.removeEvent)(window,"mouseup",l),t._updateVolumeButton(),(0,T.removeClass)(t.volumeControlContainer,"changing")};(0,E.addEvent)(window,"mousemove",a),(0,E.addEvent)(window,"mouseup",l),a(e)},e.prototype._updateVolumeButton=function(){var e=100*_.getVolume();(0,T.toggleClass)(this.volumeControl,"low",e>0&&e<50),(0,T.toggleClass)(this.volumeControl,"high",e>=50);var t=(0,T.geByClass1)("stories_volume_control_slide_indicator",this.volumeControl);(0,T.setStyle)(t,"width",e+"%")},e.prototype._volumeControlOnClick=function(e){if(!(0,T.hasClass)(e.target,"stories_volume_control_slide_wrap")&&!(0,T.hasClass)(this.volumeControlContainer,"changing")){var t=_.getVolume();t=t?0:1,_.setVolume(t),this._updateVolumeButton(),this.activeStory.volumeUpdate()}},e.prototype.onReplyDeleted=function(e){this.activeStory&&this.activeStory.onReplyDeleted(e)},e.prototype._hasContext=function(e){return this.extra&&this.extra.context&&this.extra.context===e},e}()},902535:(e,t,o)=>{o.d(t,{default:()=>u});var i=o(570655),r=o(540211),s=o(533228),n=o(343474),a=o(577438),l=o(70162),d=o(873589),_=o(579449),c=o(844142);const u=function(e){function t(t,o,i){var r=e.call(this,t,o)||this;return r.wrapEl=i,r.videoRaw=r.data.video.owner_id+"_"+r.data.video.video_id,r}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this;this.onStartLoading(),this.el=(0,d.ce)("div",{className:"stories_live"});var t=(0,d.ce)("div",{className:"stories_live_player"},{height:"100%",width:"100%"});return this.el.appendChild(t),this.chatEl=(0,d.se)('\n      <div class="stories_live_chat">\n        <div class="mv_chat_messages_wrap">\n          <div class="mv_chat_messages"></div>\n        </div>\n        <div class="mv_chat_stickers_wrap"></div>\n      </div>\n    '),this.el.appendChild(this.chatEl),window.mvcur&&window.mvcur.player&&window.Videoview.hide(!1,!0),setTimeout((function(){(0,n.showInlineVideo)(e.videoRaw,"",{autoplay:1,module:"story",onLoaded:function(){e._onPlayerInited()}},!1,t)})),this.el},t.prototype.destroy=function(){e.prototype.destroy.call(this),this._resetTimer(),window.mvcur={},this.player&&(this.player.destroy(),a.VideoChat.destroy()),window.cur.storyLayer.sendNavigationStatEvents("live_player_close",!1),delete this.el},t.prototype.getContainer=function(){return this.el||this.render()},t.prototype.onLiveEnded=function(){var e=this;this.liveEnded=!0,(0,d.hide)((0,d.geByClass1)("_error_msg",(0,d.geByClass1)("videoplayer_error")));var t=c.Ranges.isGroupId(this.mvData.oid)?(0,l.getLang)("stories_live_ended_desc_club"):(0,l.langSex)(this.mvData.author_sex,(0,l.getLang)("stories_live_ended_desc_user","raw"));t=t.replace("{name}",this.mvData.md_author);var o=c.Ranges.isGroupId(this.mvData.oid)?(0,l.getLang)("stories_live_ended_open_club"):(0,l.getLang)("stories_live_ended_open_user");(0,d.hide)(this.chatEl),(0,d.hide)((0,d.domByClass)(this.player.ui.thumb,"videoplayer_big_play_btn"));var i=window.cur.storyLayer.renderedStoryBlockKeys.length>1;this.el.appendChild((0,d.se)('\n    <div class="stories_live_end">\n      <div class="stories_live_end_author_photo" style="background-image: url('+this.mvData.author_photo+')"></div>\n      <div class="stories_live_end_title">'+(0,l.getLang)("stories_live_ended_title")+'</div>\n      <div class="stories_live_end_desc">'+t+'</div>\n      <a href="'+this.mvData.author_href+'" class="stories_live_end_open_owner">'+o+'</a>\n      <div class="stories_live_end_timer" onclick="cur.storyLayer.nextStory()" style="'+(i?"":"display: none;")+'">\n        <canvas class="_timer_canvas" width="100" height="100"></canvas>\n        <div class="stories_live_end_timer_text">'+(0,l.getLang)("stories_live_ended_watch_next")+"</div>\n      </div>\n    </div>\n    ")),i&&setTimeout((function(){e._startTimer()})),(0,_.markLiveInStoriesFinished)(this.data.owner_id)},t.prototype.pause=function(){},t.prototype.play=function(){this.player&&!this.liveEnded&&(e.prototype.play.call(this),this.player&&this.player.play())},t.prototype.sendMessage=function(e,t){e.length>window.mvcur.maxChatReplyLength||(window.ajax.post("al_video.php?act=post_comment",{comment:e,video:this.videoRaw,hash:this.mvData.hash,videoviewer_chat:1}),window.cur.storyLayer.activeStory.onAnswerSent(t))},t.prototype.volumeUpdate=function(){this.player.setVolume(s.getVolume())},t.prototype.canPlay=function(){e.prototype.canPlay.call(this),(0,d.setStyle)(this.el,"opacity",1)},t.prototype._onPlayerInited=function(){this.canPlay(),this.player=window.cur.videoInlinePlayer,this.play(),window.cur.storyLayer.sendNavigationStatEvents("live_player_show",!1),window.browser.safari&&this.player.toggleMute(!0,!1),this.mvData=window.Videoview.getMvData(),window.mvcur={chatMode:!0,maxChatReplyLength:this.mvData.maxChatReplyLength,mvData:this.mvData,mvShown:!0,queueKey:this.mvData.queue_params.key,qversion:this.mvData.qversion},a.VideoChat.init(this.chatEl,{scrollHidden:!0}),window.Videoview.queueCheckUpdates(this.mvData.queue_params)},t.prototype._startTimer=function(){var e=this;if(window.CanvasRenderingContext2D){var t=(0,d.domByClass)(this.el,"_timer_canvas"),o=t.getContext("2d");o.lineWidth=6,o.lineCap="round",o.strokeStyle="#fff";var i=Date.now(),r=function(){var t=(Date.now()-i)/5e3;t<1?(o.clearRect(0,0,100,100),o.beginPath(),o.arc(50,50,47,-Math.PI/2,-Math.PI/2+2*Math.PI*t),o.stroke(),e._nextTO=setTimeout(r,16)):window.cur.storyLayer.nextStory()};(0,d.show)(t),this.timerInProgress=!0,r()}},t.prototype._resetTimer=function(){window.CanvasRenderingContext2D&&(clearTimeout(this._nextTO),this.timerInProgress=!1,(0,d.hide)((0,d.domByClass)(this.el,"_timer_canvas")))},t.prototype.setCurrentTime=function(){},t.prototype.getCurrentTime=function(){return 0},t.prototype.getDuration=function(){return 0},t}(r.MediaStory)},247437:(e,t,o)=>{o.d(t,{loadMedia:()=>u,default:()=>p});var i,r=o(873589),s={},n={},a=[],l=!1,d=!1;function _(e,t,o){var i=n[e];if(i)for(var r=0;r<i.length;r++){var s=i[r];t?s.resolve(o):s.reject(),i.splice(r,1),r--}}function c(e){l&&l.postMessage({cmd:"load",url:e})}function u(e){return l||((l=new Worker("/dist/workers/stories_loader_worker.js")).onmessage=function(e){var t=e.data;switch(t.type){case"loaded":s[t.url]=t.data,_(t.url,!0,t.data);break;case"error":_(t.url,!1);break;case"inited":d=!0;for(var o=0;o<a.length;o++)c(a[o])}}),new Promise((function(t,o){if(e||t(""),s[e])return t(s[e]);var i=function(e){return e.match(/\.mp4/)?"video":e.match(/\.(png|jpg|jpeg|gif)/)||e.match(/\.mycdn\.me\/getVideoPreview/)?"image":void 0}(e);switch(i){case"video":case"image":n[e]||(n[e]=[]);var r=0===n[e].length;if(n[e].push({resolve:t,reject:o}),!r)return;d?c(e):a.push(e);break;default:window.vk.dev&&console.error("wrong media url")}}))}function p(e){var t;return i||(t=function(e){try{if(e.contentDocument)return e.contentDocument;if(e.contentWindow&&e.contentWindow.document)return e.contentWindow.document}catch(e){}return!1}(window.utilsNode.appendChild(document.createElement("iframe"))),i=t&&t.body?t.body:window.utilsNode.appendChild((0,r.ce)("div",{},{display:"none"}))),e.match(/\.mp4/)?function(e){return new Promise((function(t,o){var s=(0,r.ce)("video",{});s.oncanplay=function(){t(),(0,r.re)(s)},s.onerror=function(){o(),(0,r.re)(s)},i.appendChild(s),s.src=e}))}(e):function(e){return new Promise((function(t,o){var s=new Image;s.onload=function(){t(),(0,r.re)(s)},s.onerror=function(){o(),(0,r.re)(s)},i.appendChild(s),s.src=e}))}(e)}},540211:(e,t,o)=>{o.d(t,{MediaStory:()=>r});var i=o(570655),r=function(e){function t(t,o,i){var r=e.call(this,o)||this;r.longTapInfoWrapper=function(){window.cur.storyLayer.activeStory&&window.cur.storyLayer.activeStory.longTapHandle()},r.data=t;var s=t.is_expired,n=t.is_deleted,a=t.is_private,l=t.isOneTimeSeen;return s?r._error("expired"):n?i?r._error("deleted-narrative"):r._error("deleted"):l?r._error("isOneTimeSeen"):a&&(i?r._error("private-narrative"):r._error("private")),(s||n||a||l)&&(r.failed=!0),r}return(0,i.__extends)(t,e),t.prototype.destroy=function(){clearTimeout(this.longLoadingTimer)},t.prototype.getId=function(){return this.data.raw_id},t.prototype.getTrackCode=function(){return this.data.track_code},t.prototype.getDate=function(){return this.data.date},t.prototype.getViews=function(){return this.data.views},t.prototype.getReplies=function(){return this.data.replies},t.prototype.setViews=function(e){this.data.views=e},t.prototype.setReplies=function(e){this.data.repliesCountText=e},t.prototype.isOneTime=function(){return this.data.isOneTime&&this.data.authorId!==window.vk.id},t.prototype.onStartLoading=function(){var t=this;this.longLoadingTimer=setTimeout((function(){var e,o;t.isLoaded()||null===(o=(e=t.options).onLongLoading)||void 0===o||o.call(e)}),1e3),e.prototype.onStartLoading.call(this)},t.prototype.canPlay=function(){clearTimeout(this.longLoadingTimer),this.data.seenProgress&&this.isOneTime()&&this.setCurrentTime(+(this.data.seenProgress*this.getDuration()/100).toFixed(1)),e.prototype.canPlay.call(this)},t.prototype._loadingError=function(){this._error("load")},t.prototype._isFailed=function(){return this.failed},t.prototype._error=function(e){var t,o;clearTimeout(this.longLoadingTimer),null===(o=(t=this.options).onError)||void 0===o||o.call(t,e)},t}(o(636442).BaseStory)},239124:(e,t,o)=>{o.d(t,{MetaStory:()=>a});var i=o(570655),r=o(269373),s=o(636442),n=o(973935),a=function(e){function t(t,o){var i=e.call(this,o)||this;return i.pauseTime=0,i.isDestroyed=!1,i.viewEventType="group_feed_view",i.isPausedByMetaScroll=!1,i.onScroll=function(e){i.isPausedByMetaScroll=e},i.block=t,i}return(0,i.__extends)(t,e),t.prototype.getCurrentTime=function(){return Date.now()-this.startTs||0},t.prototype.getDuration=function(){return r.STORY_DURATION},t.prototype.play=function(){(0===this.startTs||this.pauseTime>0)&&(this.startTs=Date.now()-this.pauseTime,this.pauseTime=0),e.prototype.play.call(this)},t.prototype.pause=function(){this.isPaused()||(e.prototype.pause.call(this),this.pauseTime=this.getCurrentTime())},t.prototype.setCurrentTime=function(e){void 0===e&&(e=0),this.startTs=Date.now()-e,this.isPaused()&&(this.pauseTime=e)},t.prototype.render=function(){return this.canPlay(),this.wrapper=document.createElement("div"),this.wrapper.classList.add("MetaStoryWrapper"),this.update(),this.wrapper},t.prototype.canPlay=function(){var t=this;setTimeout((function(){e.prototype.canPlay.call(t),window.cur.storyLayer.sendNavigationStatEvents(t.viewEventType,!0)}))},t.prototype.getList=function(){return this.block.grouped},t.prototype.destroy=function(){n.unmountComponentAtNode(this.wrapper),this.isDestroyed=!0,this.wrapper.remove()},t}(s.BaseStory)},882846:(e,t,o)=>{o.d(t,{default:()=>l});var i=o(570655),r=o(269373),s=o(247437),n=o(540211),a=o(873589);const l=function(e){function t(t,o,i){var r=e.call(this,t,o,i)||this;return r.pauseTime=0,r}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this;if(this.onStartLoading(),this.photo)return this.photo;var t=this.data.photo_url;return this.photo=document.createElement("div"),this.photo.setAttribute("class","stories_photo"),this._isFailed()||(0,s.loadMedia)(t).then((function(t){e.photo&&((0,a.setStyle)(e.photo,"backgroundImage","url('"+t+"')"),e.canPlay())})).catch((function(){e._loadingError()})),this.photo},t.prototype.getContainer=function(){return this.photo||this.render()},t.prototype.destroy=function(){e.prototype.destroy.call(this),delete this.photo},t.prototype.play=function(){(0===this.startTs||this.pauseTime>0)&&(this.startTs=Date.now()-this.pauseTime,this.pauseTime=0),e.prototype.play.call(this)},t.prototype.pause=function(){this.isPaused()||(e.prototype.pause.call(this),this.pauseTime=this.getCurrentTime())},t.prototype.setCurrentTime=function(e){void 0===e&&(e=0),this.startTs=Date.now()-e,this.isPaused()&&(this.pauseTime=e)},t.prototype.getCurrentTime=function(){return Date.now()-this.startTs||0},t.prototype.getDuration=function(){return r.STORY_DURATION},t.prototype.canPlay=function(){e.prototype.canPlay.call(this),window.cur.storyLayer.sendNavigationStatEvents("view_story",!0,{preloading_duration:window.cur.storyLayer.activeStory&&window.cur.storyLayer.activeStory.loadingTime||0}),(0,a.setStyle)(this.photo,"opacity",1)},t}(n.MediaStory)},523497:(e,t,o)=>{o.d(t,{Stories:()=>E});var i=o(570655),r=o(341319),s=o(614706),n=o(247437),a=o(125696),l=o(873589),d=o(456495),_=o(792440),c=o(152278),u=o(315720),p=o(70162),h=o(342269),v=o(501389),m=o(146143),y=o(897449),g=o(66433),f=o(533228),w=o(997109),S={},E={show:function(e,t,o){void 0===t&&(t={}),E.getPreparedList(e,o,t).then((function(e){var o=e.ownerId,i=e.storyId,r=e.uniqKey,n=e.blockKey,l=e.listName,d=e.list,_=e.extra;a.isOpeningLocked()||(a.checkAndPrepareBoxQueue(t),a.addLayer(new s.StoryLayer(o,i,r,n,l,d,_,t),t))})).catch((function(e){console.error(e),(0,g.logError)(e),(0,m.showFastBox)((0,p.getLang)("global_error"),(0,p.getLang)("global_unknown_error"))}))},_getUnreadStory:function(e,t){e=(0,h.intval)(e);for(var o=!1,i=0;i<t.length;i++)if(t[i].author.id===e){for(var r=t[i].items,s=0;s<r.length;s++)if(r[s].unread){o=r[s];break}o||(o=r[0]);break}return o},getPreparedList:function(e,t,o){var s=this;return new Promise((function(n,a){var l=(0,i.__read)(s.parseList(e),6),d=l[0],_=l[1],c=l[2],u=l[3],p=l[4],v=l[5];if(d||u||p){var m={ownerId:(0,h.intval)(d),storyId:(0,h.intval)(_),uniqKey:c||"",blockKey:u||"",listName:p,extra:v,list:[]};if(!t)switch(p){case r.StoryListName.discover:if(!(t=(0,f.getStoryList)(p))){var y=void 0;if((g=(0,f.getStoryList)(r.StoryListName.feed))&&(null==(y=g.find((function(e){return e.type===r.StoryBlockType.discover})))?void 0:y.grouped)&&(t=y.grouped),!t)return void(0,f.preloadDiscoverList)(!0).then((function(e){m.list=e,n(m)})).catch(a)}break;case r.StoryListName.groups:case r.StoryListName.apps:var g,w=function(e){var t=e.find((function(e){return p===r.StoryListName.groups?e.type===r.StoryBlockType.communityGroupedStories:e.type===r.StoryBlockType.appGroupedStories}));(null==t?void 0:t.grouped)?(m.list=null==t?void 0:t.grouped,n(m)):a()};return void((g=(0,f.getStoryList)(r.StoryListName.feed))?w(g):E.fetchList(r.StoryListName.feed,d,v,null==o?void 0:o.trackCode).then(w).catch(a));default:t=(0,f.getStoryList)(p)}t?(m.list=t,n(m)):E.fetchList(p,d,v,null==o?void 0:o.trackCode).then((function(e){e&&(m.list=e,n(m))})).catch(a)}else a("Can not find a correct block key or list name in: "+e)}))},setList:function(e,t){window.cur["stories_list_"+e]=t},fetchList:function(e,t,o,i){return new Promise((function(r,s){window.ajax.post("al_stories.php",{act:"get_list",list:e,owner_id:t,extra:o,track_code:i},{loader:!0,onDone:function(t){E.setList(e,t),r(t)},onFail:function(e){return s(e),!0}})}))},removeList:function(e){delete window.cur["stories_list_"+e]},parseList:function(e){e.match(/story/)&&(e=decodeURIComponent(e));var t=e.match(/^(?:story)?(?:(-?\d+)(?:_(\d+))?(?:&([a-z0-9]+))?|([a-z0-9]+))?(?:\/([a-z0-9_\-]+))?(?:\/([a-z0-9_:;\-]+))?$/i);if(!t)return[];var o=(0,i.__read)(t,7);return[o[1],o[2],o[3],o[4],o[5],o[6]]},initFeed:function(e){var t=this;void 0===e&&(e="stories_feed_items_container"),"string"==typeof e&&(e=(0,l.ge)(e));var o=(0,l.geByClass1)("stories_feed_items",e),i=(0,l.attr)(o,"id");E.updateFeedArrows(i);var r=function(){(0,c.addEvent)(e,"wheel",t.feedMouseWheel)},s=function(){(0,c.removeEvent)(e,"wheel",t.feedMouseWheel)};(0,c.addEvent)(e,"mouseenter",r),(0,c.addEvent)(e,"mouseleave",s),(0,w.pushNavDestroy)((function(){(0,c.removeEvent)(e,"wheel",t.feedMouseWheel),(0,c.removeEvent)(e,"mouseenter",r),(0,c.removeEvent)(e,"mouseleave",s)}))},feedNext:function(e){var t=(0,l.ge)("stories_feed_wrap");return e&&(t=(0,l.domClosest)("stories_feed_wrap",e.target)),this.feedPaging("next",null,t)},feedPrev:function(e){var t=(0,l.ge)("stories_feed_wrap");return e&&(t=(0,l.domClosest)("stories_feed_wrap",e.target)),this.feedPaging("prev",null,t)},feedPaging:function(e,t,o){o||(o=(0,l.ge)("stories_feed_wrap"));var i=(0,l.geByClass1)("stories_feed_items",o),r=(0,l.attr)(i,"id"),s=r+"_position",n=S[s]||0,a=(0,l.getSize)(o)[0];if((0,h.isNumeric)(e))n+=Number(e);else{var d=a-100;"next"===e?n+=d:n-=d}S[s]=Math.max(0,Math.min(n,i.scrollWidth-a)),t?(0,l.removeClass)(i,"animated"):(0,l.addClass)(i,"animated"),(0,l.setStyle)(i,"transform","translateX(-"+S[s]+"px)"),E.updateFeedArrows(r)},feedScrollToOwner:function(e){var t=(0,l.ge)("feed_story_"+e);if(t){var o=(0,l.domClosest)("stories_feed_items",t),i=o.offsetWidth,r=(0,l.attr)(o,"id")+"_position",s=t.offsetWidth,n=t.offsetLeft,a=(0,l.domClosest)("stories_feed_wrap",o);S[r]=n-i+i/2+s/2,E.feedPaging(0,!0,a)}},updateFeedStories:function(e,t,o){var i=this;void 0===o&&(o="stories_feed_items");var r=(0,l.ge)(o),s=(0,l.domClosest)("stories_feed_wrap",r);if(e=e||"news",r)if((0,h.inArray)(e,["news","search"])){var n=function(e,r){t&&t.cb&&t.cb(),i.setList("feed",r),window.cur.storyLayer&&window.cur.storyLayer.updateMetaStoryItems();var n=(0,l.ge)(o);n&&(e?((0,l.setStyle)(n,"transform","translateX(0px)"),(0,l.val)(n,e),n.children.length<6?(0,l.addClass)(s,"stories_feed_not_nav_buttons"):(0,l.removeClass)(s,"stories_feed_not_nav_buttons"),S[o+"_position"]=0,E.updateFeedArrows(o),(0,l.show)(s)):(0,l.hide)(s))};if(t&&t.stories){var a=t.section,d=t.q,_=t.stories,c=_.html,u=_.js,p=u.feed?u.feed:[];return"search"!==a||d&&p.length?void n(c,u):void(0,l.hide)(s)}window.ajax.post("al_stories.php",{act:"feed_stories"},{onDone:n})}else(0,l.hide)(s)},feedMouseWheel:function(e){var t=(0,l.domClosest)("stories_feed_wrap",e.target);if(!(0,l.hasClass)(t,"stories_feed_not_nav_buttons")){(0,c.cancelEvent)(e);var o=Math.abs(e.deltaY)>Math.abs(e.deltaX)?e.deltaY:e.deltaX;E.feedPaging(o,!0,t)}},updateFeedArrows:function(e){void 0===e&&(e="stories_feed_items");var t=(0,l.ge)(e),o=e+"_position";if(t){S[o]||(S[o]=0);var i=(0,l.geByClass1)("stories_feed_wrap").offsetWidth,r=t.scrollWidth-i,s=(0,l.geByClass1)("stories_feed_arrow_left",(0,l.domPN)(t)),n=(0,l.geByClass1)("stories_feed_arrow_right",(0,l.domPN)(t));0===S[o]?(0,l.addClass)(s,"disabled"):(0,l.removeClass)(s,"disabled"),S[o]===r||r<=0?(0,l.addClass)(n,"disabled"):(0,l.removeClass)(n,"disabled")}},showBlackList:function(){window.cur.storyLayer&&window.cur.storyLayer.pauseStory(),(0,m.showBox)("al_stories.php",{act:"black_list"},{onDone:function(){window.cur.storiesBlackListScroll=new _.default("stories_black_list_result")},params:{onHide:function(){window.cur.storyLayer&&window.cur.storyLayer.playStory()}}})},blackListItemClick:function(e,t){(0,c.cancelEvent)(t);var o=(0,h.intval)((0,l.attr)(e,"data-id"));window.cur.storiesBlackListShown[o]?(delete window.cur.storiesBlackListShown[o],(0,l.removeClass)(e,"olist_item_wrap_on")):(window.cur.storiesBlackListShown[o]=1,(0,l.addClass)(e,"olist_item_wrap_on"))},saveBlackList:function(e){var t=Object.keys(window.cur.storiesBlackListShown);0!==t.length?window.ajax.post("al_stories.php",{act:"save_blacklist",hash:window.cur.storiesBlackList.hash,list:t.join(",")},{onDone:function(){E.updateFeedStories(),(0,v.curBox)().hide()},showProgress:function(){return(0,y.lockButton)(e)},hideProgress:function(){return(0,y.unlockButton)(e)}}):(0,v.curBox)().hide()},blacklistUpdateUsers:function(e){var t=e;if(e=(0,h.trim)(e).toLowerCase(),window.cur.storiesBlacklistLastQ!==e){window.cur.storiesBlacklistLastQ=e;var o=e?window.cur.storiesIndexer.search(e):window.cur.storiesBlackList.users,i=[];if(e)for(var r=0;r<e.length;r++)i.push(e.substr(r,1));var s=new RegExp(i.join(".*?"),"i"),n="";for(r=0;r<o.length;r++){var a=o[r],d=e?a.name.replace(s,(function(e){return"<em>"+e+"</em>"})):a.name;n+=window.cur.storiesBlackList.tpl.replace(/\{id\}/g,a.id).replace("{photo}",a.photo).replace("{name}",d).replace("{href}",a.href).replace("{class_name}",window.cur.storiesBlackListShown[a.id]?" olist_item_wrap_on":"")}n||(n='<div class="no_rows">'+(0,p.getLang)("global_search_not_found").replace("{search}",(0,h.clean)(t))+"</div>"),(0,l.val)((0,l.geByClass1)("olist","stories_black_list_result"),n)}},blackListInit:function(e){window.cur.storiesBlackListShown={},window.cur.storiesBlackList=e,(0,v.curBox)().setOptions({width:450,bodyStyle:"padding: 0px",onClean:function(){this.storyLayer&&this.storyLayer.playStory(),window.cur.storiesBlackListScroll&&window.cur.storiesBlackListScroll.destroy()}}).removeButtons(),window.cur.storiesBlackList.users.length?(window.cur.storiesBlacklistLastQ=!1,window.cur.storiesIndexer=new u.vkIndexer(window.cur.storiesBlackList.users,(function(e){return e.name}),(function(){E.blacklistUpdateUsers("")})),d.default.init("stories_blacklist"),d.default.focus("stories_blacklist"),(0,v.curBox)().addButton((0,p.getLang)("global_save"),this.saveBlackList).addButton((0,p.getLang)("global_cancel"),void 0,"no")):(0,v.curBox)().addButton((0,p.getLang)("global_close"))},preloadUrl:function(e){(0,n.loadMedia)(e).catch((function(e){(0,g.logError)(e)}))},groupStoriesBlockUpdate:function(){var e=(0,f.getStoryList)("group_stories"),t=e&&e[0]&&e[0].items;if(t){for(var o=0,i=0;i<t.length;i++){t[i].unread&&o++}var r=(0,l.geByClass1)("stories_groups_block_stories_wrap"),s=(0,l.geByClass1)("stories_groups_block_stories_button",r);(0,l.toggleClass)(r,"has_unread",o>0),(0,l.toggleClass)(r,"has_stories",t.length>0),(0,l.toggleClass)(s,"has_stories",t.length>0);var n=(0,h.clone)(window.cur.storiesPreviews),a=n.splice(n.length-o,3);a.length<3&&(a=a.concat(n.slice(0,3-a.length))),a.reverse();var d="";for(i=a.length-1;i>=0;i--)d+=window.cur.storiesPreviewsRowHtml.replace("{url}",a[i]);(0,l.val)((0,l.geByClass1)("stories_groups_block_stories_rows",r),d)}},isLiveShown:function(e){return!!(window.cur.storyLayer&&window.cur.storyLayer.activeStory&&window.cur.storyLayer.activeStory.isActiveLive())&&window.cur.storyLayer.activeStory.story.videoRaw===e},activeLiveEnded:function(e){window.cur.storyLayer.activeStory.onLiveEnded(e)},updateLiveViewersCount:function(e){var t=e?(0,p.getLang)("stories_live_N_watching",e,!0):"";window.cur.storyLayer.activeStory.updateLiveViewersCount(t)},updatePagePhotosModule:function(){return new Promise((function(e,t){window.ajax.post("al_profile.php",{act:"get_page_photos_module"},{onDone:function(t){var o=window.Stories;(0,l.val)("page_photos_module",t),t||(0,l.hide)("profile_photos_module"),null==o||o.removeList("profile"),e()},onFail:function(){return t(),!0}})}))}}},8383:(e,t,o)=>{o.d(t,{STORY_HORIZONTAL_RATIO:()=>i,STORY_VERTICAL_RATIO:()=>r,STORY_MAX_WIDTH:()=>s,STORY_MAX_HEIGHT:()=>n});var i=.563,r=1.78,s=540,n=320},125696:(e,t,o)=>{o.d(t,{addLayer:()=>p,removeLayer:()=>h,layerShown:()=>v,layerHide:()=>m,hideAllLayers:()=>y,getFirstLayer:()=>g,getPrevLayer:()=>f,slicePrevLayers:()=>w,onReplyDeleted:()=>S,checkAndPrepareBoxQueue:()=>b,isOpeningLocked:()=>k});var i=o(810890),r=o(152278),s=o(873589),n=o(501389),a=[],l=!1,d=function(){window.cur.storyLayer&&window.cur.storyLayer.onVisibilityChange()},_=function(){window.cur.storyLayer&&window.cur.storyLayer.onResize()},c=function(e){window.cur.storyLayer&&window.cur.storyLayer.onKeyDown(e)},u=function(e){window.cur.storyLayer&&window.cur.storyLayer.onKeyUp(e)};function p(e,t){window.cur.storyLayer&&window.cur.storyLayer.pauseLayer(),(0,s.ge)("stories_layers_background")||(document.body.appendChild((0,s.ce)("div",{id:"stories_layers_background",className:"stories_layers_background"})),window.layerQueue.hide(),window.layerQueue.push(),window.layers.fullhide=y,(0,r.addEvent)(window,"visibilitychange",d,void 0,void 0,!0),(0,r.addEvent)(window,"resize",_),(0,r.addEvent)(document,"keydown",c),(0,r.addEvent)(document,"keyup",u)),window.cur.storyLayer=e,l=!0,e.animateStory("expand",t.fromEl).catch((function(){})).finally((function(){l=!1})),a.push(e),(0,s.addClass)(document.body,"stories_layer_shown"),(0,i.cancelStackPush)("stories_layer_close"+a.length,(function(t){void 0===t&&(t={}),t.byTimer?e.sendNavigationStatEvents("close_auto_by_time"):e.sendNavigationStatEvents("close_tap"),a.length>1&&!t.isCloseBtnClick?e.back():(e.hideAllLayers=t.isCloseBtnClick,e.hide(!1))}))}function h(){var e;a.pop(),window.cur.storyLayer=a[a.length-1],window.cur.storyLayer?window.cur.storyLayer.resumeLayer():(y(!0),window.layerQueue.pop(),window.cur.storiesCashedBoxQueueData&&((0,n.restoreBoxQueue)(window.cur.storiesCashedBoxQueueData),(e=E())&&(e.forceHide=!1,e._show(!0,!1,!0)),delete window.cur.storiesCashedBoxQueueData))}function v(){a.length>1&&(a[a.length-2].setLayerVisibility(!1),a[a.length-1].showBackButton())}function m(){a.length>1?a[a.length-2].setLayerVisibility(!0):(0,s.setStyle)("stories_layers_background","opacity",0)}function y(e){void 0===e&&(e=!1);for(var t=0;t<a.length;t++)a[t].hide(!0);if(window.layers.fullhide=!1,(0,s.removeClass)(document.body,"stories_layer_shown"),(0,s.re)("stories_layers_background"),(0,r.removeEvent)(window,"visibilitychange",d),(0,r.removeEvent)(window,"resize",_),(0,r.removeEvent)(document,"keydown",c),(0,r.removeEvent)(document,"keyup",u),e){var o=window.nav.objLoc;delete o.w,window.nav.setLoc(o)}window.cur.needUpdateFeedStories&&window.Stories.updateFeedStories(),a=[]}function g(){return a[0]}function f(){return a[a.length-2]}function w(){for(var e=a.length-2;e>=0;e--)a[e].doHide(!0);a.splice(0,a.length-1)}function S(e){for(var t=0;t<a.length;t++)a[t].onReplyDeleted(e)}function E(){var e;if(!(null===(e=window._message_boxes)||void 0===e?void 0:e.length))return null;var t=window._message_boxes.filter(Boolean);return t.length?t[t.length-1]:null}function b(e){(0,n.curBox)()&&(e.fromEl=null,function(){var e=E();e&&(e._hide(!1,!0,!0),e.forceHide=!0)}(),window.cur.storiesCashedBoxQueueData=(0,n.getAndCleanBoxQueueData)())}function k(){return l}window.LayersX=a},533228:(e,t,o)=>{o.d(t,{getVolume:()=>l,setVolume:()=>d,getStoryList:()=>_,removeStoryList:()=>c,preloadDiscoverList:()=>u,fetchDiscover:()=>p,isDiscoverLoading:()=>h,getStoryBlockKey:()=>v,createUserStackMaskIfNeeded:()=>m,isNewDesignEnabled:()=>y});var i=o(570655),r=o(341319),s=o(873589),n=o(506770),a=o(997109);function l(){var e=window.ls.get("video_volume");return"number"==typeof e?Math.min(1,Math.max(0,e)):1}function d(e){window.ls.set("video_volume",e)}function _(e){return window.cur["stories_list_"+e]}function c(e){delete window.cur["stories_list_"+e]}function u(e){if(void 0===e&&(e=!1),window.cur.storiesDiscoverFetchingPromise)return window.cur.storiesDiscoverFetchingPromise;var t,o,s=_(r.StoryListName.feed);return s&&(o=s.find((function(e){return e.type===r.StoryBlockType.discover})))&&(t=o.track_code),window.cur.storiesDiscoverFetchingPromise=p("",t,e).then((function(e){var t=(0,i.__read)(e,2),r=t[0],s=t[1];return o&&(o.grouped=r,o.next_from=s),r})).finally((function(){delete window.cur.storiesDiscoverFetchingPromise})),window.cur.storiesDiscoverFetchingPromise}function p(e,t,o,i){return void 0===e&&(e=""),void 0===t&&(t=""),void 0===o&&(o=!1),void 0===i&&(i=15),new Promise((function(r,s){window.ajax.post("al_stories.php",{act:"get_discover",start_from:e,count:i,track_code:t},{loader:o,onDone:function(e,t){r([e,t])},onFail:function(e){return s(e),!0}})}))}function h(){return Boolean(window.cur.storiesDiscoverFetchingPromise)}function v(e){var t,o,i;return(null===(t=null==e?void 0:e.author)||void 0===t?void 0:t.id)&&(null===(o=null==e?void 0:e.narrative)||void 0===o?void 0:o.id)?e.author.id+"narrative"+(null===(i=e.narrative)||void 0===i?void 0:i.id):""+e.id}function m(){var e="users_stack_stories_mask",t=document.getElementById(e);t||(t=(0,s.se)('\n        <svg width="0" height="0">\n          <defs>\n            <clipPath id="'+e+'">\n              <path transform="translate(1.5 0)" d="M1.20772 8C1.20772 6.32671 0.768742 4.75626 0 3.39821C1.44342 1.34278 3.8277 0 6.52463 0C10.9293 0 14.5 3.58172 14.5 8C14.5 12.4183 10.9293 16 6.52463 16C3.8277 16 1.44342 14.6572 0 12.6018C0.768742 11.2437 1.20772 9.6733 1.20772 8Z"></path>\n            </clipPath>\n          </defs>  \n        </svg>  \n      '))&&(document.body.appendChild(t),(0,a.pushNavDestroy)((function(){null==t||t.remove()})))}function y(){return(0,n.partConfigEnabled)("story_reactions_sending_feature_web")}},784329:(e,t,o)=>{o.d(t,{Story:()=>ie});var i=o(570655),r=o(785893),s=o(341319),n=o(667294),a=o(973935),l=o(247437),d=o(125696),_=o(478700),c=o(474425),u=o(902535),p=o(488158),h=o(882846),v=o(10769),m=o(304755),y=o(117173),g=o(873589),f=o(353799),w=o(517920),S=o(810890),E=o(897449),b=o(152278),k=o(342269),T=o(608021),C=o(146143),L=o(501389),M=o(290846),P=o(826338),B=o(67328),A=o(549357),I=o(274642),D=o(66433),x=o(241926),O=o(506770),N=o(652745),R=o(849464),F=o(186699),U=o(540211),j=o(239124),H=o(101103),W=o(632574),K=o(237298),V=o(903325),q=o(121096),z=o(634991),Q=o(290634),G=o(936646),Y=o(533228),X=o(189798),Z=o(727187),$=o(917258),J=o(579449),ee=o(997109),te=o(506404),oe=o(844142),ie=function(){function e(e,t){var o=this;this.storyBottomRef=(0,n.createRef)(),this.updateBottom=function(e){var t=(0,g.geByClass1)("stories_bottom_wrap",o.wrapEl);o.isActive&&!e&&o.story&&!o.isActiveMetaStory()?(o.resetNewRepliesCounterIfNeeded(),a.render((0,r.jsx)(c.StoryBottom,{story:o,markAppNotificationsSeen:o.markAppNotificationsSeen,ref:o.storyBottomRef},void 0),t)):(a.unmountComponentAtNode(t),(0,g.val)(t,""))},this.longTapHandle=function(){o.isActiveStoryOneTime()||(o.story&&o.story.pause(),(0,g.addClass)(o.wrapEl,"paused"),o.isTooltipOpened()||o.layer.sendNavigationStatEvents("pause_long_tap"))},this.playStory=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),o.isLocked()||((0,g.removeClass)(o.wrapEl,"paused"),o.story&&!e||o._initStory(),o.story&&o.story.play(),t&&o.layer.sendNavigationStatEvents("resume_release"),delete o.downTs)},this.pauseStory=function(e){o.story&&(o.isPaused()||(e&&(0,g.addClass)(o.wrapEl,"paused"),o.story.pause()))},this.toggleMetaStoryTitle=function(e){o.metaStoryTitle&&o.metaStoryTitle.classList.toggle("MetaStoryTitle--hide",!e)},this.nextStory=function(e){if(void 0===e&&(e=!1),!o.isLocked()){e||o.layer.sendNavigationStatEvents("go_to_next_story_tap");var t=o.index+1;t<o.getFullItemsLength()?(e&&o.layer.sendNavigationStatEvents("go_to_next_story_auto_by_time"),o.changeStory(t)):(o.opts.onStoriesEnd(e),o._destroyStory())}},this.prevStory=function(){if(o.isFeedbackTooltipShow&&o.hideFeedbackTooltip(),!o.isLocked()){o.layer.sendNavigationStatEvents("go_to_previous_story");var e=o.index-1;e>=0?o.changeStory(e):(o.opts.playPrevOwner(),o._destroyStory())}},this.showMyProfileQuestionsTooltip=function(){var e;null===(e=o.profileQuestionTooltip)||void 0===e||e.show()},this.markAppNotificationsSeen=function(e){var t=o.getCurStoryData();if(t){var r=t.raw_id,s=void 0===r?"":r;if(e.appId&&e.appRef){var n=(0,i.__read)(s.split("_"),2),a=n[0],l=n[1];e.hasNewInteractions&&window.ajax.post("al_stories.php",{act:"mark_app_notifications_seen",owner_id:a,story_id:l,sticker_id:e.id,hash:e.hash},{onDone:function(){t.clickable_stickers&&t.clickable_stickers.stickers&&t.clickable_stickers.stickers.forEach((function(t){t.id===e.id&&t.type===y.StickerTypes.app&&(t.hasNewInteractions=!1)})),o.updateBottom();var i=document.querySelector("#feed_story_"+a+" .stories_feed_preview_app");i&&i.classList.contains("has_new")&&i.classList.remove("has_new")}}),window.layerQueue.count()?window.layerQueue.pop():window.layerQueue.push(),o.pauseStory(),(0,I.showWiki)({w:"app"+e.appId,app_ref:e.appRef,app_hash:e.appHash}),o.layer.sendNavigationStatEvents("click_to_app",!0,{clickable_sticker:{id:e.id,type:"app"}})}}else(0,D.logError)(new Error("Fail: markAppNotificationsSeen"),{environment:"stories"})},this.toggleFeedbackTooltip=function(e){void 0===e&&(e=!o.isFeedbackTooltipShow),e?o.showFeedbackTooltip():o.hideFeedbackTooltip()},this.onFetchFeedbackData=function(e){var t,i,r;o.feedback=e;var s=null===(i=null==e?void 0:e.replies)||void 0===i?void 0:i.repliesTotalCountText,n=null===(r=null==e?void 0:e.viewers)||void 0===r?void 0:r.viewsTotalCountText,a=null==e?void 0:e.replies,l=null==a?void 0:a.listName,d=null==a?void 0:a.list;s&&o.setReplies(s),n&&o.setViews(n),a&&d&&(window.cur=(0,k.extend)(window.cur,((t={})["stories_list_"+l]=d,t)),a.list=d.length>y.INIT_MAX_FEEDBACK_STORIES_COUNT?d.slice(0,y.INIT_MAX_FEEDBACK_STORIES_COUNT):d,a.moreRepliesCount=d.length-a.list.length),o.updateBottom()},this.showMoreReplies=function(){var e,t=null===(e=o.feedback)||void 0===e?void 0:e.replies,i=null==t?void 0:t.listName,r=null==t?void 0:t.list;if(i&&t&&r){var s=(0,Y.getStoryList)(i);if(!s)return;t.list=s.slice(0,t.list.length+y.MAX_FEEDBACK_STORIES_SLICE_COUNT),t.moreRepliesCount=s.length-t.list.length,o.updateBottom()}},this.onFetchViewers=function(e){var t,i;(null===(i=null===(t=o.feedback)||void 0===t?void 0:t.viewers)||void 0===i?void 0:i.items)&&(o.feedback.viewers.items=o.feedback.viewers.items.concat(e.viewers),o.feedback.viewers.nextFrom=e.nextFrom,o.updateBottom())},this.onQuestionRemove=function(e){var t,i;(null===(i=null===(t=o.feedback)||void 0===t?void 0:t.questions)||void 0===i?void 0:i.items)&&(o.feedback.questions.items=o.feedback.questions.items.filter((function(t){return t.id!==e})),o.feedback.questions.items.length||delete o.feedback.questions,o.updateBottom())},this.onPrivacyHintHide=function(){var e,t;(null===(t=null===(e=o.feedback)||void 0===e?void 0:e.stats)||void 0===t?void 0:t.showPrivacyHint)&&(window.ajax.post("al_stories.php",{act:"hide_privacy_hint",privacy_hint_hash:o.feedback.stats.privacyHintHash}),o.feedback.stats.extendedStats?o.feedback.stats.showPrivacyHint=!1:delete o.feedback.stats,o.updateBottom())},this.onAddToNarrativeBtnClick=function(){var e=o.getCurStoryData();if(e){o.pauseStory(),o.isModalShown=!0;var t=o.getOwnerId(),i=o.buildStoryArchiveByActive();if(i&&t){var r={ownerId:t,story:i,onClose:function(e){o.isModalShown=!1,o.updateBottom(),o.playStory(),e&&o.updateNarrativeBlockIfNeeded()},onSave:function(t){e.isPartOfNarrative=t},navScreen:R.NarrativeAnalyticNavScreen.storyViewer};(0,x.showNarrativeChooseBox)(r),(0,R.sendNarrativeAnalytic)(R.NarrativeAnalyticEventType.clickToAddToNarrative,{ownerId:t},R.NarrativeAnalyticNavScreen.storyViewer)}}},this.data=e,this.opts=t,this.id=t.id,this.isActive=!1,this.isSendFormFocused=!1,this.isModalShown=!1,this.isFeedbackTooltipShow=!1,this.pressedStory=null,this.index=0,this._currentTimeLineAdditionalEl=null,this._currentTimeLineEl=null,this.preloadedStories={},this.layer=t.layer}return e.prototype.destroy=function(){if(this._destroyStory(),(0,O.partConfigEnabled)("avatar_component_refactor_web")){var e=this.wrapEl.querySelector(".stories_author_avatar");e&&a.unmountComponentAtNode(e)}(0,b.removeEvent)((0,g.geByClass1)("stories_item_cont",this.contWrap)),(0,b.removeEvent)(this.shareButton),delete this.shareButton,(0,b.removeEvent)(this.followBtn),delete this.followBtn,(0,b.removeEvent)(this.answersEl),delete this.answersEl,clearTimeout(this.showMessageTimer);for(var t=(0,g.geByClass)("stories_time_line",this.timeLineEl),o=0;o<t.length;o++)(0,b.removeEvent)(t[o]);(0,b.removeEvent)(this.viewsButton),(0,b.removeEvent)((0,g.geByClass1)("stories_link",this.wrapEl)),delete this.contWrap,delete this.backButton,delete this.descEl,delete this.timeLineEl,delete this.authorButtons,delete this.inlineLoader,this.wrapEl&&this.wrapEl.parentNode&&this.wrapEl.parentNode.removeChild(this.wrapEl),delete this.wrapEl,(0,v.clear)()},e.prototype._destroyTimeLine=function(){for(var e=(0,g.geByClass)("stories_time_line",this.timeLineEl),t=0;t<e.length;t++)(0,b.removeEvent)(e[t])},e.prototype.getOwnerId=function(){var e,t;return null===(t=null===(e=this.data)||void 0===e?void 0:e.author)||void 0===t?void 0:t.id},e.prototype.getIndex=function(){return this.index},e.prototype.getRawId=function(){return this.story instanceof U.MediaStory&&this.story?this.story.getId():""},e.prototype.getTrackCode=function(){if(this.story instanceof U.MediaStory)return this.story?this.story.getTrackCode():""},e.prototype.getReadHash=function(){return this.data.read_hash},e.prototype.getItems=function(){return this.data.items},e.prototype.getItemsLength=function(){return this.getItems().length},e.prototype.getFullItemsLength=function(){return this.getItems().length+(this.hasMetaStory()?1:0)},e.prototype.render=function(){var e=this;this.wrapEl=(0,g.ce)("div",{className:"stories_item"}),this.contWrap=(0,g.ce)("div",{className:"stories_item_cont_wrap"}),this.contStickers=(0,g.ce)("div",{className:"stories_item_cont_sticker"}),this.contWrap.appendChild(this.contStickers),this.wrapEl.appendChild(this.contWrap);var t=(0,g.ce)("div",{className:"stories_item_cont"});return(0,b.addEvent)(t,"mousedown",(function(t){e._onMouseDownHandle(t.target)})),(0,b.addEvent)(t,"mouseup",(function(t){e._onMouseUpHandle(t.target)})),this.contWrap.appendChild(t),this.contWrap.appendChild(this.renderHeader()),this.storySendFormOverlay=(0,g.ce)("div",{className:"stories_bottom_overlay"}),this.storySendFormOverlay.appendChild((0,g.ce)("div",{className:"stories_bottom_wrap"})),this.contWrap.appendChild(this.storySendFormOverlay),this.contWrap.appendChild(this._renderPreview()),this.indexToUnread(),window.cur.noStoriesBack||(this.backButton=(0,g.ce)("div",{className:"stories_item_back"}),t.appendChild(this.backButton)),this.inlineLoader=t.appendChild((0,g.ce)("div",{className:"stories_inline_loader",innerHTML:(0,A.getProgressHtml)()})),this.contWrap.appendChild((0,g.ce)("div",{className:"stories_play_button video_thumb_play",onclick:function(){e.story&&e.story.play()}})),this.isActiveLive()?(0,g.addClass)(this.wrapEl,"live"):this.data.type!==s.StoryBlockType.discover&&this._initTimeLine(),(0,g.toggleClass)(this.wrapEl,"multi_stories",this.data.items.length>1),this.wrapEl},e.prototype.updateMetaStory=function(){this.isActiveMetaStory()&&this.story instanceof j.MetaStory&&this.story.update()},e.prototype.resetNewRepliesCounterIfNeeded=function(){var e,t;if(null===(t=null===(e=this.feedback)||void 0===e?void 0:e.replies)||void 0===t?void 0:t.listName){var o=this.getCurStoryData();if(null==o?void 0:o.replies_new_counter){var i=(0,Y.getStoryList)(this.feedback.replies.listName);if(i)Boolean(i.find((function(e){return e.items.find((function(e){return e.unread}))})))||(o.replies_new_counter=0)}}},e.prototype._canForceDeleteStories=function(){return this.data.moder_remove_hash&&!this.data.items[0].is_deleted},e.prototype._initTimeLine=function(){this.timeLineEl&&(this._destroyTimeLine(),(0,g.re)(this.timeLineEl)),this.storiesHeader.appendChild(this._renderTimeLine())},e.prototype._isActionsShown=function(){var e=(0,g.domClosest)("_ui_menu_wrap",this.wrapEl);return(0,g.hasClass)(e,"shown")},e.prototype._renderPreview=function(){return(0,g.se)('<div class="stories_preview"></div>')},e.prototype._renderMessage=function(e){return(0,g.se)('<div class="stories_message">\n  <div class="stories_message_text">'+e+"</div>\n</div>")},e.prototype.showMessage=function(e){var t=this;(0,g.re)((0,g.geByClass1)("stories_message",this.contWrap));var o=this._renderMessage(e);return this.contWrap.appendChild(o),clearTimeout(this.showMessageTimer),new Promise((function(e){t.showMessageTimer=setTimeout((function(){t.contWrap.removeChild(o),e()}),3e3)}))},e.prototype._setPreview=function(e,t){var o=this,i=this.index,r=this.data.items[i];if(r){var s=r.preview_url;s!==this.curPreviewUrl&&s&&(e=e||(0,g.geByClass1)("stories_preview",this.contWrap),(0,l.loadMedia)(s).then((function(r){i===o.index&&s!==o.curPreviewUrl&&(o.curPreviewUrl=s,(0,g.setStyle)(e,"backgroundImage","url("+r+")")),(0,g.setStyle)(e,"opacity",1),t&&setTimeout(t,0)})).catch((function(e){(0,D.logError)(e)})))}},e.prototype.renderHeader=function(){var e=this;if(this.storiesHeader=document.createElement("div"),this.storiesHeader.classList.add("stories_header"),this.storiesHeaderContent=document.createElement("div"),this.storiesHeaderContent.classList.add("stories_header_content"),this.storiesHeader.appendChild(this.storiesHeaderContent),this.data.type===s.StoryBlockType.communityGroupedStories){var t=(0,g.se)('<span class="MetaStoryBlockTitle">'+(0,T.getLang)("stories_groups_feed_block")+"</span>");this.storiesHeaderContent.appendChild(t)}else if(this.data.type===s.StoryBlockType.discover){var o=(0,g.se)('<span class="MetaStoryBlockTitle">'+(0,T.getLang)("stories_block_discover")+"</span>");this.storiesHeaderContent.appendChild(o)}if(!this.data.author)return this.storiesHeader;var i,n=this.data.author,l=n.href,d=n.name,_=n.verify,c=this.getCurStoryData(),u=this.getCurrentNarrative(),p="_self";this.layer.listName.includes("place")&&(p="_blank"),i=this.data.is_narrative?null==u?void 0:u.coverUrl:this.data.author.photo;var h="",v="",m=(0,O.partConfigEnabled)("avatar_component_refactor_web");m?(h="stories_author_avatar",v='<a href="'+l+'" target="'+p+'" class="stories_author_avatar"></a>'):v='<a href="'+l+'" target="'+p+'" class="stories_author_photo_wrap"><img src="'+i+'" class="'+(h="stories_author_photo")+'" /></a>';var y='\n      <div class="stories_author_cont">\n        '+v+'\n        <div class="StoryInfo">\n          <div class="StoryInfo__top">\n            '+(u&&c?'<div class="StoryInfo__title"><span>'+u.title+"</span></div>":'<a class="StoryInfo__title StoryInfo__title--author" href="'+l+'" target="'+p+'">'+d+(_||"")+"</a>")+'\n          </div>\n          <div class="StoryInfo__subtitle">'+this.getHeaderBottomHtml()+"</div>\n        </div>\n      </div>",f=(0,g.se)('\n      <div class="stories_author_cont_wrap">\n        <div class="stories_author_inner">'+y+'</div>\n        <div class="stories_author_buttons"></div>\n       </div>\n    ');if(m){var w=f.querySelector(".stories_author_avatar");a.render((0,r.jsx)($.AvatarRich,{src:i,isNFT:Boolean(this.data.author.nft),size:36,outlineType:this.isActiveLive()?$.AvatarRichOutlineType.LIVE:void 0},void 0),w)}return(0,b.addEvent)(f,"click",(function(t){(0,g.domClosestByTag)("a",t.target)&&e.layer.sendNavigationStatEvents("go_to_author")})),this.descEl=(0,g.geByClass1)("StoryInfo__subtitle",f),this.authorButtons=(0,g.geByClass1)("stories_author_buttons",f),this.storiesHeaderContent.appendChild(f),this.authorImg=f.querySelector("."+h),this.storiesHeader},e.prototype.showFeatureTooltipIfNeed=function(e){var t=this;window.cur.showStoriesFeatureTooltip&&!window.cur.storiesFeatureTooltip&&e&&(window.cur.storiesFeatureTooltipTimeoutId=setTimeout((function(){var o=(0,g.se)('\n        <div>\n          <div class="stories_feature_tt_close" onclick="window.cur.storiesFeatureTooltip.hide(); cancelEvent(event);"></div>\n          <div>'+(0,T.getLang)("intro_hint_title_stories_subscribe_hint_2")+"</div>\n        </div>\n     ");(0,b.addEvent)(o,"click",(function(){window.cur.storiesFeatureTooltip.hide()})),window.cur.storiesFeatureTooltip=new w.ElementTooltip(e,{appendToParent:!0,autoShow:!1,forceSide:"bottom",cls:"eltt_fancy stories_feature_tt",offset:[1,-2],content:o,align:"right",onHide:t.closeFeatureTooltip.bind(t)}),window.cur.storiesFeatureTooltip.show(),clearTimeout(window.cur.storiesFeatureTooltipTimeoutId)}),2e3),(0,ee.pushNavDestroy)((function(){clearTimeout(window.cur.storiesFeatureTooltipTimeoutId)})))},e.prototype.showHelpHint=function(e,t,o){var i,r;if(null!==(i=(r=window.cur).storiesHelpHintsInactive)&&void 0!==i||(r.storiesHelpHintsInactive={}),!window.cur.storiesHelpHintsInactive[e.id]&&!window.cur.storiesHelpHintTooltip){var s=(0,te.helpHintTooltip)(t,{helpHintId:e.id,helpHintHash:e.hash,content:'<div class="ta_c">'+e.content+"</div>"},o).tooltip;s.show(),window.cur.storiesHelpHintsInactive[e.id]=!0,window.cur.storiesHelpHintTooltip=s}},e.prototype.hideHelpHint=function(){var e;null===(e=window.cur.storiesHelpHintTooltip)||void 0===e||e.hide(!1),window.cur.storiesHelpHintTooltip=null},e.prototype.getHeaderBottomHtml=function(){if(this.data.author){var e=this.data.author,t=e.href,o=e.also_subscribed,i=this.getCurStoryData(),r=this.getCurrentNarrative(),s="",n="_self";this.layer.listName.includes("place")&&(n="_blank");var a="";if(i){if(s=i.date,i.maskOwnerDomain){var l=i.maskOwnerDomain,d="<a href='/"+l+"' target='"+n+"' class=\"StoryInfo__maskLink "+'StoryInfoLink">@'+l+"</a>";a='<span class="StoryInfo__maskInfo">'+(0,T.langSex)(i.maskOwnerSex||Z.BaseSexEnumNames.UNKNOWN,(0,T.getLang)("stories_mask_from","raw")).replace("{domain}",d)+"</span><span class='dvd'></span>"}if(i.isPromo)s=i.promoCaption;else if(r)s="<span class='dvd'></span><span>"+s+"</span>",s=a+"<a href='"+t+"' target='"+n+"' class='StoryInfo__narrativeOwnerName "+"StoryInfoLink'>"+r.ownerName+"</a>"+s;else if(i.isAds)s=(0,T.getLang)("stories_is_ad");else if(o){(0,Y.createUserStackMaskIfNeeded)();var _,c="";o.owners.forEach((function(e){c+='\n            <a href="'+e.href+'" class="StorySubscribedUsersStack__photo '+'StoryInfoLink" title="'+e.name+'">\n              <img src="'+e.photo_url+'" class="StorySubscribedUsersStack__img" alt="">  \n            </a>\n          '})),_='<div class="StorySubscribedUsersStack__photos">'+c+"</div>";var u=o.owners[0],p='<a href="'+u.href+'" class="StorySubscribedUsersStack__link '+'StoryInfoLink">'+u.name+"</a>",h=o.total_count;s='<div class="StorySubscribedUsersStack">'+_+('<div class="StorySubscribedUsersStack__label">'+(1===h?(0,T.langStr)((0,T.langSex)(u.sex,(0,T.getLang)("stories_also_subscribed_one_person","raw")),"name",p):(0,T.langStr)((0,T.getLang)("stories_also_subscribed_multiple_persons"),"name",p,"total_count",h-1))+"</div>")+"</div>"}else a&&(s=a+"<span>"+s+"</span>");if((0,O.partConfigEnabled)("profile_questions_enabled")&&i.isProfileQuestion)s='<a href="/question?ref=story" class="StoryProfileQuestionLink StoryInfoLink" target="_blank">'+('<span class="StoryInfo__icon">'+(0,V.getIcon12Question)().icon+"</span>"+(0,T.getLang)("stories_profile_question_label"))+"</a>"+"<span class='dvd'></span>"+s}return s}},e.prototype.closeFeatureTooltip=function(e){void 0===e&&(e=!1),window.cur.storiesFeatureTooltip&&(window.cur.showStoriesFeatureTooltip=!1,window.cur.storiesFeatureTooltip.destroy(),window.cur.storiesFeatureTooltip=null,e&&this.playStory(),window.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:window.cur.storiesFeatureTooltipKey,hash:window.cur.storiesFeatureTooltipHash},{onDone:function(){}}))},e.prototype._renderFollowButton=function(){var e=this,t=this.data.author;if(t){var o;o=oe.Ranges.isUserId(t.id)?(0,q.getIcon24UserAddOutline)():(0,z.getIcon24AddSquareOutline)();var i=(0,Y.isNewDesignEnabled)();return this.followBtn=(0,g.ce)("div",{className:i?"StoryViewerHeaderButton":"StoryButton StoryButton--follow"}),this.followBtn.innerHTML=o.icon,(0,b.addEvent)(this.followBtn,"click",this._onFollowBtnClick.bind(this)),(0,b.addEvent)(this.followBtn,"mouseover",(function(){if(t){e.closeFeatureTooltip();var o=t.can_follow?(0,T.getLang)("stories_follow"):(0,T.getLang)("stories_unfollow");(0,M.showTooltip)(e.followBtn,{black:1,center:1,forcetodown:!0,shift:i?[0,13,6]:[0,13,13],text:o,appendEl:e.contWrap})}})),this.showFeatureTooltipIfNeed(this.followBtn),this.followBtn}},e.prototype.renderActionButtons=function(){return this.actionButtons=document.createElement("div"),this.actionButtons.classList.add("StoryViewerHeaderButton"),a.render((0,r.jsx)(G.ActionsButton,{story:this},void 0),this.actionButtons),this.actionButtons},e.prototype.destroyActionButton=function(){this.actionButtons&&(a.unmountComponentAtNode(this.actionButtons),delete this.actionButtons)},e.prototype._renderTimeLine=function(){var e,t,o,i=this;this.timeLineEl=(0,g.ce)("div",{className:"stories_time_line"+(this.data.items.length>50?" stories_time_line_many_items":"")});var r=null===(t=null===(e=this.data)||void 0===e?void 0:e.author)||void 0===t?void 0:t.id,s=null===(o=this.data.items[0])||void 0===o?void 0:o.isOneTime,n=function(e){var t=(0,g.ce)("div",{className:"stories_time_line_item"});(0,b.addEvent)(t,"click",(function(){i.layer.sendNavigationStatEvents("go_to_story_click"),i.changeStory(e)}));var o=(0,g.ce)("div",{className:"stories_time_line_item_cont"});o.appendChild((0,g.ce)("div",{className:"stories_time_line_item_cont_active"})),t.appendChild(o),s&&window.vk.id!==r&&(t.appendChild((0,g.ce)("div",{className:"stories_time_line_item_wick"})),(0,g.addClass)(t,"stories_time_line_item_is_one_time")),i.timeLineEl.appendChild(t)};return this.data.items.forEach((function(e,t){return n(t)})),this.hasMetaStory()&&n(this.data.items.length),this.timeLineEl},e.prototype.isPaused=function(){return!this.story||this.story.isPaused()},e.prototype.isLoaded=function(){return!this.story||this.story.isLoaded()},e.prototype._onMouseDownHandle=function(e){this.pressedStory=e,this.isActive&&(this.isLocked()||((0,g.hasClass)(e,"stories_item_cont")||(0,g.hasClass)(e,"stories_item_back")||(0,g.hasClass)(e,"StoryStickers__disableArea")||(0,g.hasClass)(e,"StorySticker"))&&!this.downTs&&(this.downTs=(0,k.vkNow)(),this.longTapTimer=setTimeout(this.longTapHandle.bind(this),y.LONG_PRESS_DELAY_MS)))},e.prototype._onMouseUpHandle=function(e,t){var o,r;void 0===t&&(t=function(){}),clearTimeout(this.longTapTimer);var s=this.downTs;if(delete this.downTs,e===this.pressedStory){this.pressedStory=null;var n=(0,k.vkNow)()-s>=y.LONG_PRESS_DELAY_MS,a=n||this.isSendFormFocused||(0,g.hasClass)(this.wrapEl,"autoplay_failed");if(this.isActive&&((0,g.hasClass)(e,"stories_item_back")||(0,g.hasClass)(e,"StoryStickers__disableArea--left"))&&!a&&!this.isTooltipOpened())return this.prevStory();if(n||!(0,g.hasClass)(e,"StorySticker")){if((0,g.hasClass)(e,"stories_item_cont")||(0,g.hasClass)(e,"stories_item_back")||(0,g.hasClass)(e,"StoryStickers__disableArea")||(0,g.hasClass)(e,"StorySticker"))if(this.isFeedbackTooltipShow)this.hideFeedbackTooltip();else if((0,g.removeClass)(this.wrapEl,"paused"),this.isTooltipOpened())this.hideTooltip();else{if(!this.isActive){if(this.id>=this.layer.activeStory.id){var l=[];try{for(var d=(0,i.__values)(this.layer.activeStory.data.items),_=d.next();!_.done;_=d.next()){var c=_.value;l.push(c.raw_id),c.unread=!1}}catch(e){o={error:e}}finally{try{_&&!_.done&&(r=d.return)&&r.call(d)}finally{if(o)throw o.error}}this.layer.markStoriesSkipped(l)}var u=this.layer.renderedStoryBlockKeys;return u.indexOf(this.layer.getBlockKey(this.data))>u.indexOf(this.layer.blockKey)?this.layer.sendNavigationStatEvents("go_to_next_author"):this.layer.sendNavigationStatEvents("go_to_previous_author"),void this.opts.onSelect(this)}a?this.isPaused()&&this.playStory(!1,!!s):this._onPlayEnd()}}else t()}},e.prototype._markSeenIfNeeded=function(){this.isActiveStoryOneTime()&&this._markSeenCurrentStory()},e.prototype._markSeenCurrentStory=function(){this.opts.onSeen(this.layer.activeStory)},e.prototype.isLocked=function(){return!!(this.getSendText()||!this.isActive||this.isSendFormFocused||this.isModalShown||this.isFeedbackTooltipShow||this.isFooterPanelsActive||document.hidden||this._isActionsShown()||(0,g.isVisible)(this.inlineLoader)||(0,g.hasClass)(this.wrapEl,"hiding_reply")||(0,L.curBox)()||this.isPausedByMetaScroll())},e.prototype.isSpaceLongTabAvailable=function(){return!this.isPaused()},e.prototype.isPausedByMetaScroll=function(){if(this.story instanceof j.MetaStory)return this.story.isPausedByMetaScroll},e.prototype.isPausedByFooterScroll=function(){if(this.story instanceof j.MetaStory)return this.story.isPausedByMetaScroll},e.prototype.autoResumeStory=function(e){void 0===e&&(e=!1),this.audioPlaying||this.isTooltipOpened()||this.playStory(!1,e)},e.prototype.changeStory=function(e){this.index===e||this.isSendFormFocused||(this._destroyStory(),this.index=e,this.hideTooltip(),this._setPreview(),this.playStory())},e.prototype.getWrap=function(){return this.wrapEl},e.prototype.stop=function(){this._destroyFeedBackTT(),this.isActive=!1,this._destroyStory(),this._stopLoader(),(0,g.val)((0,g.geByClass1)("stories_send_form_text",this.wrapEl),""),this._unlockSendForm(),(0,g.removeClass)(this.wrapEl,"autoplay_failed")},e.prototype.getCurStoryData=function(){var e=this.data.items[this.index],t=this.isActiveMetaStory();return e||t||(0,D.logError)(new Error("getCurStoryData: data is undefined"),{environment:"stories"}),e},e.prototype.isActiveMetaStory=function(){var e;return!!this.hasMetaStory()&&(!(!this.hasUnloadedMetaStory()||this.data.items.length)||(null===(e=this.data.grouped)||void 0===e?void 0:e.length)&&this.getFullItemsLength()-1===this.index)},e.prototype.hasMetaStory=function(){return this.data.type===s.StoryBlockType.communityGroupedStories||this.data.type===s.StoryBlockType.discover||this.data.type===s.StoryBlockType.appGroupedStories},e.prototype.hasUnloadedMetaStory=function(){var e;return this.hasMetaStory()&&!(null===(e=this.data.grouped)||void 0===e?void 0:e.length)},e.prototype.getCurrentNarrative=function(){return this.data.narrative},e.prototype.isActiveLive=function(){var e;return"live"===(null===(e=this.getCurStoryData())||void 0===e?void 0:e.type)},e.prototype.isLiveEnded=function(){return!!this.story&&(this.isActiveLive()&&this.story.liveEnded)},e.prototype._initStory=function(){var e,t,o,i,n=this,l=this.getCurStoryData(),d=this.getCurrentNarrative(),c=this.isActiveMetaStory();if(l||c){var v={onLoadingStart:this._onLoadingStart.bind(this),onLoadingEnd:this._onLoadingEnd.bind(this),onPlay:this._onPlay.bind(this),onPause:this._onPause.bind(this),onError:this._showError.bind(this),toggleMetaStoryTitle:this.toggleMetaStoryTitle,onLongLoading:this._showLoader.bind(this),onAutoPlayFail:this._onAutoPlayFail.bind(this),play:this.playStory,pause:this.pauseStory,playPrevStory:this.prevStory,playNextStory:this.nextStory,onLongTap:this.longTapHandle};if(l){var y=l.type,f=l.noSound;this.story&&this._destroyStory(),(0,m.onPlayerChange)(this),Object.assign(l,{authorId:this.getOwnerId()});var w=void 0;if("live"===y?w=new u.default(l,v,this.wrapEl):("video"===y?(w=new p.default(l,v,d),f&&this.opts.restoreAudioPlay(),(0,g.addClass)(this.wrapEl,"video")):(w=new h.default(l,v,d),this.opts.restoreAudioPlay(),(0,g.removeClass)(this.wrapEl,"video")),this.descEl&&(this.descEl.innerHTML=this.getHeaderBottomHtml()||"",this.initProfileQuestionTooltipIfNeeded()),this.fillTimeLine()),this.story=w,"live"===y||"video"===y)(0,Y.getVolume)()>0&&this.opts.onVideoPlay();if((0,g.toggleClass)(this.wrapEl,"stories_can_comment",l.can_comment),(null===(t=null===(e=this.data)||void 0===e?void 0:e.author)||void 0===t?void 0:t.can_follow)&&!this.data.is_promo&&!this.isActiveLive()){var S=this._renderFollowButton();S&&(null===(o=this.authorButtons)||void 0===o||o.appendChild(S))}if((0,Y.isNewDesignEnabled)()){var E=this.renderActionButtons();null===(i=this.authorButtons)||void 0===i||i.appendChild(E)}this._destroyFeedBackTT(),this.updateBottom(),l.clickable_stickers&&this.data.author&&a.render((0,r.jsx)(_.StoryStickers,{ref:function(e){e&&(n.stickerLayers=e)},story:w,storyData:l,author:this.data.author,showMessage:this.showMessage.bind(this),playStory:this.playStory.bind(this),pauseStory:this.pauseStory.bind(this),hideFeedbackTooltip:this.hideFeedbackTooltip.bind(this),onModalShownChange:this._onModalsShownChange.bind(this),onMouseUpHandle:this._onMouseUpHandle.bind(this),onMouseDownHandle:this._onMouseDownHandle.bind(this),sendNavigationStatEvents:this.layer.sendNavigationStatEvents.bind(this.layer),markAppNotificationsSeen:this.markAppNotificationsSeen,showHelpHint:this.showHelpHint,hideHelpHint:this.hideHelpHint,list:this.layer.listName,layerEl:this.layer.layerEl,el:this.contWrap},void 0),this.contStickers)}else if(this.hasMetaStory()){this._destroyFeedBackTT();var b="";this.data.type===s.StoryBlockType.communityGroupedStories?(this.story=new H.GroupsMetaStory(this.data,v),b=(0,T.getLang)("stories_groups_grid_title")):this.data.type===s.StoryBlockType.discover?(this.story=new K.DiscoverMetaStory(this.data,v),b=(0,T.getLang)("stories_interesting_stories")):(this.story=new W.AppsMetaStory(this.data,v),(0,g.setStyle)((0,g.geByClass1)("stories_preview",this.contWrap),{backgroundImage:""})),b&&(this.metaStoryTitle=(0,g.ce)("div",{className:"MetaStoryTitle MetaStoryTitle--hide",innerHTML:b}),this.storiesHeaderContent.appendChild(this.metaStoryTitle)),(0,g.re)((0,g.geByClass1)("stories_photo",this.contWrap)),(0,g.re)((0,g.geByClass1)("stories_video",this.contWrap)),this.fillTimeLine()}this.opts.onStartStory(),this.contWrap.appendChild(this.story.render())}else(0,D.logError)(new Error("Fail: _initStory"),{environment:"stories"})},e.prototype.hasSticker=function(e){var t=this.getCurStoryData();if(!t||!t.clickable_stickers)return!1;var o=t.clickable_stickers.stickers;return!!Array.isArray(o)&&o.some((function(t){return t.type===e}))},e.prototype.getSticker=function(e){var t=this.getCurStoryData();if(t&&t.clickable_stickers){var o=t.clickable_stickers.stickers;if(Array.isArray(o))return o.find((function(t){return t.type===e}))}},e.prototype.isTooltipOpened=function(){return this.stickerLayers&&this.stickerLayers.isShownTooltip()},e.prototype.hideTooltip=function(e){void 0===e&&(e=!1),this.isTooltipOpened()&&(this.stickerLayers&&this.stickerLayers.hideTooltip(),e||this.playStory())},e.prototype.getReplies=function(){if(this.story instanceof U.MediaStory)return this.story&&this.story.getReplies()},e.prototype.getViews=function(){if(this.story instanceof U.MediaStory)return this.story&&this.story.getViews()},e.prototype.setReplies=function(e){if(this.story instanceof U.MediaStory)return this.story&&this.story.setReplies(e)},e.prototype.setViews=function(e){if(this.story instanceof U.MediaStory)return this.story&&this.story.setViews(e)},e.prototype.indexToUnread=function(e){var t;void 0===e&&(e=!1);var o=this.data.items,i=null;for(var r in o)if(o[r].unread&&!this.layer._hasContext("all")){i=Number(r);break}if(null==i&&(null===(t=this.data.grouped)||void 0===t?void 0:t.some((function(e){return e.items.some((function(e){return e.unread}))})))&&(i=this.getFullItemsLength()-1),null==i&&(i=0),e)return i;this.index=i,this._setPreview()},e.prototype.indexToStoryById=function(e){var t=this.data.items,o=-1;for(var i in t)if(t[i].raw_id===e){o=Number(i);break}this.layer._hasContext("all")&&(o=0),o>-1?(this.index=o,this._setPreview()):this.indexToUnread()},e.prototype.fillTimeLine=function(){var e=this.timeLineEl;if(e&&this.data.type!==s.StoryBlockType.discover)for(var t=0;t<e.children.length;t++){var o=(0,g.geByClass1)("stories_time_line_item_cont_active",e.children[t]);t===this.index&&(this._currentTimeLineEl=o,this._currentTimeLineAdditionalEl=(0,g.geByClass1)("stories_time_line_item_wick",e.children[t]));var i=t<this.index?100:0;(0,g.setStyle)(o,"transform","translateX("+i+"%)")}},e.prototype._destroyStory=function(){var e;if(this.story){var t=this.getCurStoryData();this.isFooterPanelsActive=!1,this.needHideSentReactions&&(this.needHideSentReactions=!1,(null==t?void 0:t.new_reactions)&&delete t.new_reactions),this.updateBottom(!0),window.tooltips&&window.tooltips.hideAll(),this.hideTooltip(),this.destroyProfileQuestionTooltipIfNeeded(),this._resetErrors(),this._destroyFeedBackTT(),this.closeFeatureTooltip(!1),this.story.pause(),t&&t.clickable_stickers&&(a.unmountComponentAtNode(this.contStickers),this.stickerLayers=null),cancelAnimationFrame(this.timeLineAnim);try{this.story instanceof U.MediaStory&&this.contWrap.removeChild(this.story.getContainer()),this.story.destroy()}catch(e){(0,D.logError)(e)}this._replyHideEnd(),(0,b.removeEvent)(this.followBtn),this.authorButtons&&(this.authorButtons.innerHTML=""),null===(e=this.metaStoryTitle)||void 0===e||e.remove(),(0,b.removeEvent)(this.answersEl),this.hideInlineLoader(),this.destroyActionButton(),delete this.story}},e.prototype._timeLineUpdate=function(){var e=this.story;if(e&&!e.isPaused()&&!this.isActiveLive()&&this.data.type!==s.StoryBlockType.discover){var t=this.getStoryProgressPercent(),o=t/100;if((0,g.setStyle)(this._currentTimeLineEl,"transform","translateX("+t+"%) translateZ(0)"),this._currentTimeLineAdditionalEl&&this._currentTimeLineEl){var i=this._currentTimeLineEl.clientWidth*o;(0,g.setStyle)(this._currentTimeLineAdditionalEl,"transform","translateX("+i+"px) translateZ(0)")}t<100?this.timeLineAnim=requestAnimationFrame(this._timeLineUpdate.bind(this)):this._onPlayEnd(!0)}},e.prototype.getStoryProgressPercent=function(){if(!this.story)return 0;var e=this.story.getCurrentTime(),t=this.story.getDuration();return Math.max(0,Math.min(100,e/t*100))},e.prototype._onLoadingStart=function(){this._loadingStartTime=+new Date},e.prototype._onLoadingEnd=function(){var e=this.getRawId();e&&this._loadingStartTime&&(this.loadingTime=+Date.now()-this._loadingStartTime,this.layer.sendViewerStartTime(e,this.loadingTime),this._loadingStartTime=0)},e.prototype._onPlay=function(){this._resetErrors(),this._stopLoader(),this._timeLineUpdate(),this.preloadNextStory(),this.opts.onPlayStory(),(0,g.removeClass)(this.wrapEl,"animate_story"),(0,g.removeClass)(this.wrapEl,"autoplay_failed");var e=this.data.items[this.getIndex()];e&&(e.unread=!1),this._updateFeedStoryPreview(),(0,m.onPlayerChange)(this)},e.prototype._onPause=function(){cancelAnimationFrame(this.timeLineAnim),(0,m.onPlayerChange)(this)},e.prototype._onPlayEnd=function(e){void 0===e&&(e=!1),this._markSeenIfNeeded(),this.nextStory(e)},e.prototype.getOffsetLeft=function(){return this.wrapEl.offsetLeft+this.wrapEl.offsetWidth/2},e.prototype.getWidth=function(){return this.wrapEl.offsetWidth},e.prototype.removeStoryBox=function(){var e=this,t=this.getCurStoryData();if(t){var o=t.isPartOfNarrative?(0,T.getLang)("stories_remove_from_narrative_warning"):(0,T.getLang)("stories_remove_warning");this.hideFeedbackTooltip(),this.pauseStory();var i=(0,C.showFastBox)({title:(0,T.getLang)("global_warning")},o,(0,T.getLang)("stories_remove_confirm"),this.removeStory.bind(this),(0,T.getLang)("global_cancel"),(function(){i.hide(),e.playStory()}))}else(0,D.logError)(new Error("Fail: removeStoryBox"),{environment:"stories"})},e.prototype.removeStoryFromNarrative=function(){var e=this,t=this.getCurStoryData();if(t){var o=(0,T.getLang)("stories_remove_only_from_narrative_warning");this.hideFeedbackTooltip(),this.pauseStory();var i=(0,C.showFastBox)({title:(0,T.getLang)("global_warning")},o,(0,T.getLang)("stories_remove_confirm"),(function(o){var i=e.getCurrentNarrative();if(i){var r=e.getIndex();i.stories=i.stories.filter((function(e){return e.rawId!==t.raw_id})),(0,E.lockButton)(o),e.editNarrativeRequest(i).then((function(){var t=(0,L.curBox)();t&&t.hide(),i.storiesCount=i.stories.length,e._popStoryAndClearList(r),e.updateNarrativeBlockIfNeeded(),e.layer.sendNavigationStatEvents("delete_from_narrative")})).catch((function(){var e=(0,L.curBox)();e&&e.hide(),(0,D.logError)(new Error("Fail: removeStoryFromNarrative"),{environment:"stories"})}))}}),(0,T.getLang)("global_cancel"),(function(){i.hide(),e.playStory()}))}else(0,D.logError)(new Error("Fail: removeStoryFromNarrative"),{environment:"stories"})},e.prototype.removeStory=function(e){var t=this;this.pauseStory();var o=this.getIndex(),i=this.getRawId(),r={act:"remove_story",story_raw:i,hash:this.data.remove_hash,moder_remove_hash:this.data.moder_remove_hash};(0,B.isClaimContent)()&&(r.claim=window.nav.objLoc.claim),window.ajax.post("al_stories.php",r,{onDone:function(){var e;t.layer.sendNavigationStatEvents("delete"),(0,L.curBox)().hide(),t._popStoryAndClearList(o),1!==t.layer.renderedStoryList.length||t.layer.renderedStoryList[0]||t.opts.removeCurrentList(),t.updateNarrativeBlockIfNeeded(),(0,J.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module&&(null===(e=window.Profile)||void 0===e||e.updateStories()),null===window||void 0===window||window.removeStoryFromStoriesArchive(i)},showProgress:function(){return(0,E.lockButton)(e)},hideProgress:function(){return(0,E.unlockButton)(e)}})},e.prototype.removeNarrativeBox=function(){var e=this;this.hideFeedbackTooltip(),this.pauseStory();var t=(0,C.showFastBox)({title:(0,T.getLang)("global_warning")},(0,T.getLang)("stories_narrative_remove_warning"),(0,T.getLang)("stories_remove_confirm"),this.removeNarrative.bind(this),(0,T.getLang)("global_cancel"),(function(){t.hide(),e.playStory()}))},e.prototype.removeNarrative=function(e){var t=this;this.pauseStory();var o=this.getCurrentNarrative();if(o){var i=o.ownerId,r=o.id;window.ajax.post("al_stories.php",{act:"remove_narrative",narrative_raw:i+"_"+r,hash:this.data.remove_hash,moder_remove_hash:this.data.moder_remove_hash},{onDone:function(){var e,o;(0,L.curBox)().hide(),t.opts.removeCurrentList(),t.remove(),t.updateNarrativeBlockIfNeeded(),null===(o=(e=t.opts).afterNarrativeRemoved)||void 0===o||o.call(e)},showProgress:function(){return(0,E.lockButton)(e)},hideProgress:function(){return(0,E.unlockButton)(e)}})}else(0,D.logError)(new Error("Fail: removeNarrative"),{environment:"stories"})},e.prototype.hideDiscover=function(){var e=this;this.data.discover_hide_hash&&(this.pauseStory(),(0,C.showFastBox)({title:(0,T.getLang)("stories_discover_hiding_title"),onHide:function(){e.playStory()}},(0,T.getLang)("stories_discover_hiding_warning").replace("{link}",'<a href="/settings" target="_blank">').replace("{/link}","</a>"),(0,T.getLang)("stories_add_blacklist_button"),(function(t){window.ajax.post("al_settings.php",{act:"toggle_story_discover_visible",hash:e.data.discover_hide_hash,enabled:0},{onDone:function(){var t,o,i,r=(0,L.curBox)();r&&r.hide(),e.layer.sendNavigationStatEvents("hide_discover");var n=d.getPrevLayer();(null===(o=null===(t=null==n?void 0:n.activeStory)||void 0===t?void 0:t.data)||void 0===o?void 0:o.type)===s.StoryBlockType.discover&&(null===(i=null==n?void 0:n.activeStory)||void 0===i||i.remove(!0,(function(){(0,L.showDoneBox)((0,T.getLang)("stories_discover_hidden_text"))}))),d.hideAllLayers(!0)},showProgress:function(){return(0,E.lockButton)(t)},hideProgress:function(){return(0,E.unlockButton)(t)}})}),(0,T.getLang)("global_cancel")))},e.prototype.sendNarrativeBookmarkButtonDidPress=function(){var e=this,t=this.getCurrentNarrative();t?window.ajax.post("al_bookmarks.php",{act:"bookmark",owner_id:t.ownerId,object_id:t.id,type:"narrative",state:t.isBookmarked?1:0,hash:t.bookmarkHash,ref:window.cur.module},{onDone:function(o){(0,L.showDoneBox)(o||(0,T.getLang)("stories_narrative_bookmark_deleted"),{className:"stories_done_msg"}),t.isBookmarked||(0,R.sendNarrativeAnalytic)(R.NarrativeAnalyticEventType.addToBookmarks,t,R.NarrativeAnalyticNavScreen.storyViewer),t.isBookmarked=!t.isBookmarked,e.updateBottom()}}):(0,D.logError)(new Error("Fail: sendNarrativeBookmarkButtonDidPress"),{environment:"stories"})},e.prototype.sendNarrativeEditButtonDidPress=function(){var e=this.getCurrentNarrative();if(this.data.author){var t=this.data.author.id,o=this.data.author.href;e?((0,R.sendNarrativeAnalytic)(R.NarrativeAnalyticEventType.clickToEditNarrative,e,R.NarrativeAnalyticNavScreen.storyViewer),oe.Ranges.isUserId(t)?this.editCurrentNarrative():window.nav.go(o+"?act=narrative_edit&nid="+e.id)):(0,D.logError)(new Error("Fail: sendNarrativeEditButtonDidPress"),{environment:"stories"})}},e.prototype.editNarrativeRequest=function(e){var t,o,r=e.id,s=e.ownerId,n=e.editHash,a=e.title,l=e.stories,d=e.coverStoryRawId;return d&&(t=(0,i.__read)(null==d?void 0:d.split("_"),2),o=t[1]),new Promise((function(e,t){window.ajax.post("al_stories.php",{act:"edit_narrative",owner_id:s,title:a,cover_story_id:o,hash:n,story_ids:(0,N.prepareStoriesForPublishing)(l),narrative_id:r},{onDone:function(){e()},onFail:function(e){return(0,L.showDoneBox)(e||(0,T.getLang)("global_error")),t(),!0}})}))},e.prototype._popStoryAndClearList=function(e){if(this._removeStoryFromMemoryByIndex(e),0===this.data.items.length){var t=this.getOwnerId();t&&d.onReplyDeleted(t)}},e.prototype._removeStoryFromMemoryByIndex=function(e,t){if(void 0===t&&(t=!1),this.data.items[e]){this.data.items.splice(e,1);var o=this.getFullItemsLength();o?(this._initTimeLine(),o>e?this.isActive&&this.playStory(!0):this.isActive&&this.nextStory()):this.remove(t)}},e.prototype.remove=function(e,t){var o,i;null===(i=(o=this.opts).onStoryBlockRemoved)||void 0===i||i.call(o,e,t)},e.prototype.shareBox=function(){var e=this;if(this.story instanceof U.MediaStory)if(this.getCurStoryData()){var t,o=this.getCurrentNarrative();t=o?"narrative"+o.rawId:"story"+this.story.getId(),this.pauseStory(),(0,C.showBox)("like.php",{act:"publish_box",object:t,from:"wkview"},{onDone:function(){e.autoResumeStory()},params:{onHide:function(){e.autoResumeStory()}}})}else(0,D.logError)(new Error("Fail: shareBox"),{environment:"stories"})},e.prototype.toggleLikeStory=function(){var e=this;if(this.story instanceof U.MediaStory){var t=this.story.data,o=t.isLiked,i=t.likeHash,r=this.getRawId(),s={act:o?"delete_like":"like",hash:i,story_raw_id:r};t.isLiked=!o,this.updateBottom(),window.ajax.post("al_stories.php",s,{onDone:function(){e.layer.sendNavigationStatEvents(o?"click_to_unlike":"click_to_like")},onFail:function(){return t.isLiked=o,e.updateBottom(),!0}})}},e.prototype.toggleReaction=function(e){var t=this;if(this.story instanceof U.MediaStory){var o=this.story.data,r=o.user_reaction_id,s=o.reaction_set_id,n=(0,i.__read)(this.getRawId().split("_"),2),a=n[0],l=n[1];r===e?delete this.story.data.user_reaction_id:this.story.data.user_reaction_id=e,this.updateBottom(),void 0!==this.story.data.user_reaction_id?(0,X.api)("likes.add",{type:"story",owner_id:Number(a),item_id:Number(l),reaction_id:e}).then((function(){t.layer.sendNavigationStatEvents("reaction_send",!0,{reaction_set_id:s,reaction_id:e})}),(function(){o.user_reaction_id=r,t.updateBottom()})):(0,X.api)("likes.delete",{type:"story",owner_id:Number(a),item_id:Number(l)}).then((function(){t.layer.sendNavigationStatEvents("reaction_remove",!0,{reaction_set_id:s,reaction_id:e})}),(function(){o.user_reaction_id=r,t.updateBottom()}))}},e.prototype.onAnswerSend=function(e,t,o,i){var r=this;void 0===t&&(t=[]),void 0===o&&(o={}),void 0===i&&(i={});var s=this.getSendText();if(this.story instanceof U.MediaStory&&(s||t.length)&&this.story)if(this.isActiveLive())this.story.sendMessage(s,e);else{var n=this.getCurrentNarrative();n?t.push(["narrative",n.ownerId+"_"+n.id]):t.push(["story",this.story.getId()]),window.ajax.post("al_im.php",Object.assign({act:"a_send",msg:s,hash:this.data.send_hash,media:(0,P.convertAttachesToPhpMedia)(t),entrypoint:"stories_comment",to:this.getOwnerId()},o),{onDone:function(){r.onAnswerSent(e,o,i)},onFail:function(e){return r.showMessage(e).catch((function(e){(0,D.logError)(e)})),!0},showProgress:function(){(0,g.val)(r.sendFormButton,r._getLoaderHtml()),(0,g.addClass)(r.sendFormButton,"sending")},hideProgress:function(){(0,g.val)(r.sendFormButton,""),(0,g.removeClass)(r.sendFormButton,"sending")}})}},e.prototype.onAnswerSent=function(e,t,o){var i=this;if(void 0===e&&(e=function(){}),void 0===t&&(t={}),void 0===o&&(o={}),!this.isActiveLive()){this.showMessage((0,T.getLang)("stories_answer_sent")).then((function(){i.playStory()})).catch((function(e){(0,D.logError)(e)}));var r=t.sticker_referrer||"",s={},n="";"story_keyboard"===r?n="sticker_keyboard_send":r.startsWith("story_suggestion_")?n="sticker_suggestion_send":"story_reaction"===r?(n="sticker_reaction_send",s.reaction_name=o.reactionName):n="comment_send",this.layer.sendNavigationStatEvents(n,!0,s)}(0,g.val)((0,g.geByClass1)("stories_send_form_text",this.wrapEl),""),(0,S.cancelStackPop)(),this.pauseStory(),e&&e()},e.prototype.onSendFormFocus=function(){var e=this;this.pauseStory(),this.isActiveLive()||this._toggleSendFormOverlay(!0),this.hideTooltip(!0),this.hideFeedbackTooltip(),(0,S.cancelStackPush)("stories_form_focus",(function(){f.Emoji.shown||(e.resetSendForm(),e._blurSendForm())}))},e.prototype._toggleSendFormOverlay=function(e){void 0===e&&(e=!1),this.isSendFormFocused=e,(0,Y.isNewDesignEnabled)()||(0,g.toggleClass)(this.storySendFormOverlay,"stories_bottom_overlay_available",this.isSendFormFocused)},e.prototype.toggleFooterPanelsActive=function(e){this.isFooterPanelsActive=e,e&&this.toggleFeedbackTooltip(!1),e&&this.pauseStory(),e||this.playStory()},e.prototype._blurSendForm=function(){var e=(0,g.geByClass1)("stories_send_form_text",this.wrapEl);e&&e.blur()},e.prototype.getSendText=function(){var e=f.Emoji.editableVal((0,g.geByClass1)("stories_send_form_text",this.wrapEl));return(0,k.trim)(e)},e.prototype.onSendFormBlur=function(){var e=this.getSendText();this.isActiveLive()||this._toggleSendFormOverlay(!1),e||this.resetSendForm()},e.prototype._unlockSendForm=function(){this.isSendFormFocused&&(this.isSendFormFocused=!1)},e.prototype.resetSendForm=function(){(0,g.val)((0,g.geByClass1)("stories_send_form_text",this.wrapEl),""),this._unlockSendForm(),this.playStory()},e.prototype._getLoaderHtml=function(){return'<svg class="stories_view_loader_circular" viewBox="25 25 50 50">\n      <circle class="stories_view_loader_circular_path" cx="50" cy="50" r="20" fill="none" stroke-width="4" stroke-miterlimit="10"/>\n    </svg>'},e.prototype.preloadNextStory=function(e){if(void 0===e&&(e=this.index+1),!this.preloadedStories[e]){var t=this.data.items[e];if(t){this.preloadedStories[e]=!0;var o="video"===t.type?t.video_url:t.photo_url;o&&("video"===t.type?(0,l.default)(o).catch((function(e){return(0,D.logError)(e)})):(0,l.loadMedia)(o).catch((function(e){return(0,D.logError)(e)})))}}},e.prototype.addToBlacklist=function(){window.cur.storyLayer&&window.cur.storyLayer.pauseStory();var e=this.getOwnerId();e&&(0,C.showFastBox)({title:(0,T.getLang)("stories_add_blacklist_title"),onHide:function(){window.cur.storyLayer&&window.cur.storyLayer.playStory()}},oe.Ranges.isGroupId(e)?(0,T.getLang)("stories_add_blacklist_message_group"):(0,T.getLang)("stories_add_blacklist_message"),(0,T.getLang)("stories_add_blacklist_button"),this._doAddToBlacklist.bind(this),(0,T.getLang)("global_cancel"))},e.prototype._doAddToBlacklist=function(e){var t=this;window.ajax.post("al_stories.php",{act:"blacklist_add",owner_id:this.getOwnerId(),hash:this.data.blacklist_hash,source_story:this.getRawId(),track_code:this.getTrackCode()},{onDone:function(){t.data.can_blacklist=!1,t.layer.sendNavigationStatEvents("hide_from_stories"),(0,L.curBox)().hide(),t.opts.removeCurrentList(),t.remove()},showProgress:function(){return(0,E.lockButton)(e)},hideProgress:function(){return(0,E.unlockButton)(e)}})},e.prototype.markNotInterested=function(){var e=this,t=this.getCurStoryData();if(t)if(t.isAds){var o="",i=t.track_code,r=(0,C.showBox)("reports.php",{act:"hide_ad_box",track_code:i,type:"story"},{onDone:function(){var e=(0,g.geByClass)("radiobtn","ad_hide");window.radioBtns.ad_hide={val:0,els:e};var t=(0,g.ge)("ad_csrf");o=t?t.value:o},params:{onClean:function(){delete window.radioBtns.ad_hide,e.playStory()}},stat:["reports.css"]});r.removeButtons(),r.addButton((0,T.getLang)("box_send"),(function(s){(0,E.lockButton)(s),window.ajax.post("reports.php",{act:"hide_ad",track_code:i,reason_id:window.radioBtns.ad_hide.val,hash:o},{onDone:function(){(0,E.unlockButton)(s),r.hide(),e._markNotInterested(t.track_code,t.canMarkNotInterestedHash)}})})),r.addButton((0,T.getLang)("global_cancel"),!1,"no")}else this._markNotInterested(t.track_code,t.canMarkNotInterestedHash);else(0,D.logError)(new Error("Fail: markNotInterested"),{environment:"stories"})},e.prototype._markNotInterested=function(e,t){var o=this;this.showMessage((0,T.getLang)("stories_thanks_feedback")).catch((function(e){(0,D.logError)(e)})),window.ajax.post("al_stories.php",{act:"mark_not_interested",story_raw_id:this.getRawId(),track_code:e,hash:t},{onDone:function(){o.layer.sendNavigationStatEvents("mark_not_interested")}})},e.prototype._resetErrors=function(){var e=(0,g.geByClass1)("stories_error_wrap",this.contWrap);e&&((0,b.removeEvent)((0,g.geByClass1)("stories_error_button",e)),(0,g.re)(e)),(0,g.removeClass)(this.wrapEl,"failed"),(0,g.removeClass)(this.wrapEl,"fatal_error")},e.prototype._showError=function(e){var t=this;if(this.contWrap){var o,i,r=e;switch(e){case"load":o=(0,T.getLang)("stories_error_cant_load"),i=(0,g.ce)("div",{className:"stories_error_button",innerHTML:(0,T.getLang)("stories_try_again")}),(0,b.addEvent)(i,"click",(function(){t._destroyStory(),t.playStory()}));break;case"expired":o=(0,T.getLang)("stories_error_expired");break;case"deleted":o=(0,T.getLang)("stories_error_deleted");break;case"private":o=(0,T.getLang)("stories_error_private");break;case"deleted-narrative":o=(0,T.getLang)("stories_error_deleted_narrative");break;case"private-narrative":o=(0,T.getLang)("stories_error_private_narrative");break;case"isOneTimeSeen":o=(0,T.getLang)("stories_error_one_time_seen");break;default:o=(0,T.getLang)("global_unknown_error")}this._resetErrors(),this._stopLoader();var s=(0,g.ce)("div",{className:"stories_error_wrap"}),n=(0,g.ce)("div",{className:"stories_error"}),a=(0,g.ce)("div",{className:"stories_error_cont"});n.appendChild(a),a.appendChild((0,g.ce)("div",{className:"stories_error_icon "+r})),a.appendChild((0,g.ce)("div",{className:"stories_error_caption",innerHTML:o})),i&&a.appendChild(i),s.appendChild(n),this.contWrap.appendChild(s),(0,g.addClass)(this.wrapEl,"failed"),(0,k.inArray)(e,["expired","deleted","private","deleted-narrative","private-narrative"])&&(0,g.addClass)(this.wrapEl,"fatal_error")}},e.prototype._stopLoader=function(){var e=this;setTimeout((function(){(0,g.re)((0,g.geByClass1)("stories_loader",e.contWrap))}),0)},e.prototype._showLoader=function(){if(this._stopLoader(),this.isActive&&(!this.isLoaded()||this.isPaused())&&this.contWrap){var e=(0,g.ce)("div",{className:"stories_loader",innerHTML:this._getLoaderHtml()});this.contWrap.appendChild(e)}},e.prototype._onFollowBtnClick=function(){var e=this;if(this.pauseStory(),!this.followBtnLock&&(this.followBtnLock=!0,this.data.author)){var t,o,i=this.data.author.id;oe.Ranges.isUserIdTransitional(i)?(o="al_friends",t=this.data.author.can_follow?"add":"remove"):(o="al_groups",t=this.data.author.can_follow?"a_enter":"a_leave"),window.ajax.post(o+".php",{act:t,mid:i,gid:-i,hash:this.data.author.hash,from:"stories"},{onDone:function(){if(e.data.author){if(e.data.author.can_follow&&e.sendStatEvent("follow"),e.data.author.can_follow=!e.data.author.can_follow,e.data.author.can_follow){var t=(0,q.getIcon24UserAddOutline)();e.followBtn.innerHTML=t.icon}else{t=(0,Q.getIcon24UserAddedOutline)();e.followBtn.innerHTML=t.icon,e.layer.listName===s.StoryListName.discover&&e.layer.sendNavigationStatEvents("add_to_friends")}e.showMessage(e.data.author.can_follow?(0,T.getLang)("stories_unfollowed"):(0,T.getLang)("stories_followed")).then((function(){return e.playStory()})).catch((function(e){(0,D.logError)(e)})),window.tooltips&&window.tooltips.destroy(e.followBtn),(0,b.triggerEvent)(e.followBtn,"mouseover")}},showProgress:function(){return e.showInlineLoader()},hideProgress:function(){e.hideInlineLoader(),e.followBtnLock=!1}})}},e.prototype.markAsActive=function(){this.isActive=!0,(0,g.addClass)(this.wrapEl,"animate_story")},e.prototype._destroyFeedBackTT=function(){delete this.feedback,this.hideFeedbackTooltip()},e.prototype.hideFeedbackTooltip=function(e){void 0===e&&(e=!0),this.isFeedbackTooltipShow&&(this.isFeedbackTooltipShow=!1,this.autoResumeStory(),this.updateBottom(),e&&(0,S.cancelStackPop)())},e.prototype.showFeedbackTooltip=function(){var e=this,t=this.getCurStoryData();t?this.isFeedbackTooltipShow||(this.needHideSentReactions=Boolean(t.new_reactions),this.hideTooltip(),this.pauseStory(),this.isFeedbackTooltipShow=!0,this.updateBottom(),this.layer.sendNavigationStatEvents("open_replies_list"),(0,S.cancelStackPush)("stories_feedback_tt",(function(t){e.hideFeedbackTooltip(!1),(null==t?void 0:t.isCloseBtnClick)&&(0,S.cancelStackPop)(t)}))):(0,D.logError)(new Error("Fail: showFeedbackTooltip"),{environment:"stories"})},e.prototype.initProfileQuestionTooltipIfNeeded=function(){var e=this;if((0,O.partConfigEnabled)("profile_questions_enabled")&&this.descEl){var t=this.getCurStoryData();if(null==t?void 0:t.isProfileQuestion){var o=this.descEl.querySelector(".StoryProfileQuestionLink"),i=null==o?void 0:o.querySelector(".StoryInfo__icon");if(!o||!i)return;this.profileQuestionTooltipContent=(0,g.se)('\n          <div class="StoryProfileQuestionTooltip__inner">\n            <div class="StoryProfileQuestionTooltip__title">'+(0,T.getLang)("global_ask_feature")+'</div>\n            <div class="StoryProfileQuestionTooltip__text">'+(0,T.getLang)("stories_profile_question_tooltip_description")+'</div>\n            <a href="/question?ref=story" class="StoryProfileQuestionTooltip__btn" target="_blank">'+(0,T.getLang)("stories_profile_question_tooltip_btn")+"</a>\n          </div>\n        ");var r=!1;this.profileQuestionTooltip=new w.ElementTooltip(i,{appendTo:this.wrapEl,forceSide:"bottom",align:"left",centerShift:(0,g.getXY)(this.authorImg)[0]-(0,g.getXY)(i)[0],cls:"StoryProfileQuestionTooltip",noHideOnClick:!0,width:291,content:this.profileQuestionTooltipContent,onShow:function(){e.isPaused()?r=!0:e.pauseStory()},onHide:function(){r||e.playStory()}}),null==o||o.addEventListener("mouseenter",this.showMyProfileQuestionsTooltip)}}},e.prototype.destroyProfileQuestionTooltipIfNeeded=function(){var e;if(this.profileQuestionTooltip){var t=null===(e=this.descEl)||void 0===e?void 0:e.querySelector(".StoryProfileQuestionLink");null==t||t.removeEventListener("mouseenter",this.showMyProfileQuestionsTooltip),this.profileQuestionTooltip.destroy()}},e.prototype._onModalsShownChange=function(e){void 0===e&&(e=!1),this.isModalShown=e},e.prototype.showInlineLoader=function(){(0,g.show)(this.inlineLoader)},e.prototype.hideInlineLoader=function(){(0,g.hide)(this.inlineLoader)},e.prototype.volumeUpdate=function(){var e=this.story;e&&e.volumeUpdate&&e.volumeUpdate()},e.prototype._onAutoPlayFail=function(){(0,g.addClass)(this.wrapEl,"autoplay_failed")},e.prototype.hideReply=function(){var e=this;(0,C.showFastBox)({title:(0,T.getLang)("global_warning"),onHide:function(){e.autoResumeStory()}},(0,T.getLang)("stories_hide_reply_warning"),(0,T.getLang)("global_continue"),this._doHideReply.bind(this),(0,T.getLang)("global_cancel"))},e.prototype._doHideReply=function(){var e=this;if(this.data.author){this.pauseStory(),(0,g.addClass)(this.wrapEl,"hiding_reply"),(0,L.curBox)().hide();var t=this.getIndex(),o=this.data.author.gender,i=(0,g.se)('<div class="stories_hide_reply_wrap loading">\n  <div class="stories_inline_loader">'+(0,A.getProgressHtml)()+'</div>\n  <div class="stories_hide_reply_cont">\n    <div class="stories_hide_reply_icon"></div>\n    <div class="stories_hide_reply_info">'+(0,T.getLang)("stories_reply_hidden")+'</div>\n    <div class="stories_hide_reply_continue_button _stories_reply_continue">'+(0,T.getLang)("stories_hide_reply_continue")+'</div>\n  </div>\n  <div class="stories_hide_reply_other_actions">\n    <div class="stories_hide_reply_other_action _stories_hide_replies">'+(0,T.langSex)(o,(0,T.getLang)("stories_hide_all_replies"))+'</div>\n    <div></div>\n    <div class="stories_hide_reply_other_action _stories_reply_ban">'+(0,T.getLang)("stories_reply_add_to_blacklist")+"</div>\n  </div>\n</div>");(0,b.addEvent)((0,g.geByClass1)("_stories_reply_restore",i),"click",this._restoreReply.bind(this)),(0,b.addEvent)((0,g.geByClass1)("_stories_reply_continue",i),"click",(function(){return e._replyHideEnd(t)})),(0,b.addEvent)((0,g.geByClass1)("_stories_hide_replies",i),"click",this._hideAllReplies.bind(this)),(0,b.addEvent)((0,g.geByClass1)("_stories_reply_ban",i),"click",this._ban.bind(this)),this.contWrap.appendChild(i),window.ajax.post("al_stories.php",{act:"hide_reply",raw_id:this.getRawId(),hash:this.data.reply_hide_hash},{onDone:function(){e.opts.removeCurrentList(),window.cur.needUpdateFeedStories=!0,(0,g.removeClass)(i,"loading")},onFail:function(){return e._resetReplyHide(),e.playStory(),!0}})}},e.prototype._restoreReply=function(e){var t=this;(0,b.cancelEvent)(e);var o=(0,g.geByClass1)("stories_hide_reply_wrap",this.contWrap);window.ajax.post("al_stories.php",{act:"restore_reply",raw_id:this.getRawId(),hash:this.data.reply_hide_hash},{onDone:function(){t._resetReplyHide(),t.playStory()},showProgress:function(){return(0,g.addClass)(o,"loading")},hideProgress:function(){return(0,g.removeClass)(o,"loading")}})},e.prototype._resetReplyHide=function(){(0,g.re)((0,g.geByClass1)("stories_hide_reply_wrap",this.contWrap)),(0,g.removeClass)(this.wrapEl,"hiding_reply")},e.prototype._hideAllReplies=function(){if(this.data.author){var e=this.data.author.first_name_gen;(0,C.showFastBox)({title:(0,T.getLang)("global_warning")},(0,T.getLang)("stories_delete_all_replies_confirm").replace("{name}",e),(0,T.getLang)("global_continue"),this._doHideAllReplies.bind(this),(0,T.getLang)("global_cancel"))}},e.prototype._doHideAllReplies=function(e){var t=this;window.ajax.post("al_stories.php",{act:"hide_all_replies",owner_id:this.getOwnerId(),hash:this.data.reply_hide_hash},{onDone:function(){(0,L.curBox)().hide(),t.opts.removeCurrentList(),t.data.items=[];var e=(0,g.geByClass1)("_stories_hide_replies",t.contWrap);(0,g.val)(e,(0,T.getLang)("stories_all_replies_hidden")),(0,g.addClass)(e,"disabled")},showProgress:function(){return(0,E.lockButton)(e)},hideProgress:function(){return(0,E.unlockButton)(e)}})},e.prototype._ban=function(){if(this.data.author){var e=this.data.author.first_name_gen;(0,C.showFastBox)({title:(0,T.getLang)("global_warning")},(0,T.getLang)("stories_ban_confirm").replace("{name}",e),(0,T.getLang)("global_continue"),this._doBan.bind(this),(0,T.getLang)("global_cancel"))}},e.prototype._doBan=function(e){var t=this;window.ajax.post("al_stories.php",{act:"ban",owner_id:this.getOwnerId(),hash:this.data.stories_ban_hash},{onDone:function(){(0,L.curBox)().hide(),t.opts.removeCurrentList(),t.data.items=[];var e=(0,g.geByClass1)("_stories_reply_ban",t.contWrap);(0,g.val)(e,(0,T.getLang)("stories_banned")),(0,g.addClass)(e,"disabled")},showProgress:function(){return(0,E.lockButton)(e)},hideProgress:function(){return(0,E.unlockButton)(e)}})},e.prototype._replyHideEnd=function(e){if((0,g.geByClass1)("stories_hide_reply_wrap",this.contWrap)){if(this.data.items.length<=1){var t=this.getOwnerId();t&&d.onReplyDeleted(t)}this._resetReplyHide(),this._removeStoryFromMemoryByIndex(e||this.getIndex(),!(0,k.isNumeric)(e))}},e.prototype._feedbackRemoveReplyFromDom=function(e){var t=(0,g.geByClass1)("stories_feedback_content",this.wrapEl);if(t){var o=t.querySelector("#feed_story_"+e);o&&(0,g.addClass)(o,"removed")}},e.prototype.onReplyDeleted=function(e){this._feedbackRemoveReplyFromDom(e)},e.prototype._updateFeedStoryPreview=function(){var e,t=(0,g.ge)("feed_story_"+this.layer.getBlockKey(this.data));if(t&&!t.classList.contains("stories_feed_reply_item")&&t.classList.contains("stories_feed_preview_item")){var o=this.indexToUnread(!0);if(o){var i=this.data.items[o];!i&&this.getFullItemsLength()-1===o&&(null===(e=this.data.grouped)||void 0===e?void 0:e.length)&&this.data.grouped.some((function(e){return e.items.some((function(e){if(e.unread)return i=e,!0}))})),i&&i.small_preview&&(0,g.setStyle)(t,"background-image","url("+i.small_preview+")")}}},e.prototype.sendStatEvent=function(e){var t=this.getCurStoryData();t?window.ajax.post("al_stories.php",(0,k.extend)({act:"stat",source_story:this.getRawId(),track_code:this.getTrackCode()},t.stats[e])):this.isActiveMetaStory()||(0,D.logError)(new Error("Fail: sendStatEvent"),{environment:"stories"})},e.prototype.report=function(){var e=this,t=this.getCurStoryData(),o=this.getCurrentNarrative();if(t)if(t.isAds){var r=t.track_code,n="",a=(0,C.showBox)("/reports.php",{act:"report_ad_box",track_code:r,type:"story"},{onDone:function(){var e=(0,g.geByClass)("radiobtn","ad_report");window.radioBtns.ad_report={val:0,els:e};var t=(0,g.ge)("ad_csrf");n=t?t.value:n},params:{onClean:function(){delete window.radioBtns.ad_report,e.playStory()}},stat:["reports.css"]});a.removeButtons(),a.addButton((0,T.getLang)("box_send"),(function(t){window.ajax.post("reports.php",{act:"report_ad_common",track_code:r,reason:window.radioBtns.ad_report.val,hash:n},{onDone:function(){var t=e.index,i=e.layer.listName===s.StoryListName.groups;a.hide(),e.layer.sendNavigationStatEvents("claim"),i||o||e._popStoryAndClearList(t),(0,L.showDoneBox)((0,T.getLang)("stories_report_sent"),{className:"stories_done_msg"}),e.updateNarrativeBlockIfNeeded()},showProgress:function(){return(0,E.lockButton)(t)},hideProgress:function(){return(0,E.unlockButton)(t)}})})),a.addButton((0,T.getLang)("global_cancel"),!1,"no")}else{if(this.isActiveLive())return void this.showReportLiveBox();var l=function(){return e.playStory()};if(o)(0,F.showReportForm)("narrative",o.ownerId,o.id,void 0,l);else{var d=(0,i.__read)(this.getRawId().split("_"),2),_=d[0],c=d[1],u=parseInt(_),p=parseInt(c);(0,F.showReportForm)("story",u,p,void 0,l)}}else(0,D.logError)(new Error("Fail: report"),{environment:"stories"})},e.prototype.showReportLiveBox=function(){var e=this,t=(0,C.showBox)("al_stories.php",{act:"report_box"},{onDone:function(){var e=(0,g.geByClass)("radiobtn","stories_report");window.radioBtns.stories_report={val:0,els:e}},params:{onClean:function(){delete window.radioBtns.stories_report,e.playStory()}}});t.removeButtons(),t.addButton((0,T.getLang)("box_send"),this._sendReportButtonDidPress.bind(this)),t.addButton((0,T.getLang)("global_cancel"),!1,"no")},e.prototype._sendReportButtonDidPress=function(e){var t=this,o=this.getCurStoryData();if(o){var i,r,n=this.index,a=o.report_hash,l=this.getCurrentNarrative(),d=this.layer.listName===s.StoryListName.groups;l?(i=""+l.rawId,r=l.reportHash):(i=this.getRawId(),r=a),window.ajax.post("al_stories.php",{act:"report",type:l?"narrative":"story",item_raw:i,reason:window.radioBtns.stories_report.val,hash:r},{onDone:function(){(0,L.curBox)().hide(),t.layer.sendNavigationStatEvents("claim"),d||l||t._popStoryAndClearList(n),(0,L.showDoneBox)((0,T.getLang)("stories_report_sent"),{className:"stories_done_msg"})},showProgress:function(){return(0,E.lockButton)(e)},hideProgress:function(){return(0,E.unlockButton)(e)}})}else(0,D.logError)(new Error("Fail: _sendReportButtonDidPress"),{environment:"stories"})},e.prototype.onLiveEnded=function(e){void 0===e&&(e=!1),this.isActiveLive()&&(this.data.items[this.index]&&(this.data.items[this.index].can_share=!e),this.story&&this.story.onLiveEnded(),this.updateBottom())},e.prototype.updateLiveViewersCount=function(e){this.descEl&&(this.descEl.innerHTML=e)},e.prototype.isActiveStoryOneTime=function(){return this.story instanceof U.MediaStory&&(this.story&&this.story.isOneTime())},e.prototype.buildStoryArchiveByActive=function(){var e=this.getRawId(),t=this.getCurStoryData();if(e&&t){var o=(0,i.__read)(e.split("_"),2)[1];return{id:Number(o),rawId:e,listId:this.layer.listName,preview:t.small_preview,originalPreviewUrl:t.small_preview,time:t.time}}},e.prototype.editCurrentNarrative=function(){var e=this,t=this.getCurStoryData(),o=this.getCurrentNarrative(),r=this.getOwnerId();if(t&&r&&(this.pauseStory(),this.isModalShown=!0,o)){var s=[];(null==o?void 0:o.stories.length)&&(s=(0,i.__spreadArray)([],(0,i.__read)(o.stories),!1));var n={selectedStories:s,narrative:o,onSave:function(){var t,o;null===(o=(t=e.opts).afterNarrativeEdited)||void 0===o||o.call(t)},onClose:function(t){e.isModalShown=!1,e.updateBottom(),t&&(e.updateNarrativeBlockIfNeeded(),e.opts.removeCurrentList(),e.remove(!1))},navScreen:R.NarrativeAnalyticNavScreen.storyViewer};(0,x.showNarrativeEditorBox)(r,n)}},e.prototype.updateNarrativeBlockIfNeeded=function(){(0,N.updateNarrativeBlock)()},e.prototype.showDoneBox=function(e){(0,L.showDoneBox)(e,{className:"stories_done_msg"})},e}()},304755:(e,t,o)=>{o.d(t,{onPlayerChange:()=>l});var i,r=o(10769),s=o(798262),n=o(659397),a=o(66433);function l(e){if(r.HAS_MEDIA_SESSION){var t=(i=e).getCurStoryData(),o=i.isActiveMetaStory();if(t)if(["video"].includes(t.type)&&!t.noSound){var s=i.data.author?(0,n.decodeHTMLEntities)(i.data.author.name):"",l=(0,n.decodeHTMLEntities)(t.date),p=t.small_preview||t.photo_url||t.first_frame||t.preview_url,h=p?[{sizes:"800x1497",src:p}]:[];!function(){if(!r.HAS_MEDIA_SESSION)return;navigator.mediaSession.setActionHandler("play",d),navigator.mediaSession.setActionHandler("pause",_),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",c),navigator.mediaSession.setActionHandler("nexttrack",u)}(),(0,r.updateMediaSessionMetadata)({title:s,artist:l,album:"",artwork:h})}else(0,r.clear)();else o||(0,a.logError)(new Error("Fail story media session"),{environment:"stories"})}}function d(){i.playStory(),(0,s.statlogsValueEvent)("global_media_controls","story_player","play")}function _(){i.pauseStory(),(0,s.statlogsValueEvent)("global_media_controls","story_player","pause")}function c(){i.prevStory(),(0,s.statlogsValueEvent)("global_media_controls","story_player","previous_track")}function u(){i.nextStory(),(0,s.statlogsValueEvent)("global_media_controls","story_player","next_track")}},269373:(e,t,o)=>{o.d(t,{STORY_DURATION:()=>i});var i=5e3},488158:(e,t,o)=>{o.d(t,{default:()=>d});var i=o(570655),r=o(540211),s=o(533228),n=o(873589),a=o(274642),l=o(152278);const d=function(e){function t(t,o,i){var r=e.call(this,t,o,i)||this;return r.isFirstChunkLoaded=!1,r}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this;if(this.onStartLoading(),this.video)return this.video;var t=this.data.video_url;return this.video=document.createElement("video"),this.video.setAttribute("class","stories_video"),this.video.setAttribute("autoplay","false"),this.video.setAttribute("volume",(0,a.getAudioPlayer)().getVolume()),this.video.setAttribute("x-yandex-pip","false"),this.video.setAttribute("disablePictureInPicture","true"),(0,l.addEvent)(this.video,"error",(function(){e._loadingError()})),this._isFailed()||(this.loaded&&(this.video.currentTime=0),(0,l.addEvent)(this.video,"canplay",this.canPlay.bind(this)),this.video.src=t,this.volumeUpdate()),this.video},t.prototype.getContainer=function(){return this.video||this.render()},t.prototype.getImage=function(){var e=(0,n.getSize)(this.video),t=document.createElement("canvas");t.setAttribute("width",e[0].toString()),t.setAttribute("height",e[1].toString());var o=t.getContext("2d");return o&&o.drawImage(this.video,0,0,e[0],e[1]),t.toDataURL()},t.prototype.destroy=function(){e.prototype.destroy.call(this),(0,l.removeEvent)(this.video),delete this.video},t.prototype.play=function(){var t=this;if(e.prototype.play.call(this),this.loaded&&this.video){var o=this.video.play();void 0!==o&&o.catch((function(){var e,o;null===(o=(e=t.options).onAutoPlayFail)||void 0===o||o.call(e)}))}},t.prototype.pause=function(){e.prototype.pause.call(this),this.video&&this.video.pause()},t.prototype.setCurrentTime=function(e){void 0===e&&(e=0),e=+(e/1e3).toFixed(1),this.loaded&&this.video.currentTime<e&&(this.video.currentTime=e)},t.prototype.getCurrentTime=function(){return 1e3*this.video.currentTime},t.prototype.getDuration=function(){return 1e3*this.video.duration},t.prototype.volumeUpdate=function(){this.video.volume=s.getVolume()},t.prototype.canPlay=function(){e.prototype.canPlay.call(this),!this.isFirstChunkLoaded&&window.cur.storyLayer&&(this.isFirstChunkLoaded=!0,window.cur.storyLayer.sendNavigationStatEvents("view_story",!0,{preloading_duration:window.cur.storyLayer.activeStory&&window.cur.storyLayer.activeStory.loadingTime||0})),(0,n.setStyle)(this.video,"opacity",1),(0,l.removeEvent)(this.video,"canplay")},t}(r.MediaStory)},44610:(e,t,o)=>{o.d(t,{getPostElem:()=>i,replyUserImageLinkClosest:()=>r,replyUserImageImg:()=>s});var i=function(e,t){var o,i;return null!==(i=null!==(o=function(e){var t;if("string"==typeof e)return null!==(t=document.querySelector("#post"+e))&&void 0!==t?t:void 0}(e))&&void 0!==o?o:null==t?void 0:t.closest("._post, .wl_post"))&&void 0!==i?i:void 0},r=function(e){var t;return null!==(t=e.closest(".reply_image, ._reply_image"))&&void 0!==t?t:void 0},s=function(e){var t;return null!==(t=e.querySelector("img.reply_img"))&&void 0!==t?t:void 0}}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,loadStylesheet,installedCssChunks;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,o,i)=>{if(!t){var r=1/0;for(l=0;l<deferred.length;l++){for(var[t,o,i]=deferred[l],s=!0,n=0;n<t.length;n++)(!1&i||r>=i)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[n])))?t.splice(n--,1):(s=!1,i<r&&(r=i));if(s){deferred.splice(l--,1);var a=o();void 0!==a&&(e=a)}}return e}i=i||0;for(var l=deferred.length;l>0&&deferred[l-1][2]>i;l--)deferred[l]=deferred[l-1];deferred[l]=[t,o,i]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var o=Object.create(null);__webpack_require__.r(o);var i={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var r=2&t&&e;"object"==typeof r&&!~leafPrototypes.indexOf(r);r=getProto(r))Object.getOwnPropertyNames(r).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,__webpack_require__.d(o,i),o},__webpack_require__.d=(e,t)=>{for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,o)=>(__webpack_require__.f[o](e,t),t)),[])),__webpack_require__.u=e=>9375===e?"voice_message_player.1ca99e7ec51aef6df7b5.js":28762===e?"speech.ec5bb88b79217da0bc5d.js":57468===e?"SilentModeForms.710e5d0929fe4e8d2b72.js":75980===e?"menu_settings.0f17151bd588fe6a5267.js":29019===e?"ReportForm.d8b2beb68beec3cb688a.js":79344===e?"sticker.5413a9259b10196dbb52.js":55489===e?"lottie-light.19743fa6c7bec04c41d3.js":81937===e?e+".5e2064d44c49cedc17c5.js":28477===e?"79f240c94e0513d166c44bb8a64a95e6.9a39e7f1c21e2915eb30.js":31848===e?"f79ca980fcc26ca55859ad5158f5fea8.000a6aad63545130f346.js":882===e?"fba43c7a1c8ad19aa306e4c66812a52a.f50b883cde2d245ad9be.js":void 0,__webpack_require__.miniCssF=e=>882===e?"fba43c7a1c8ad19aa306e4c66812a52a.7cfe15ee6468bdce91ef.css":e+"."+{29019:"b2496d8ef6849a2fecca",57468:"28053bce032a9da83885",75980:"95eccc249ab38cb1e901",79344:"cd1e4159749f662b5108"}[e]+".css",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},__webpack_require__.l=(e,t,o,i)=>{if(inProgress[e])inProgress[e].push(t);else{var r,s;if(void 0!==o)for(var n=document.getElementsByTagName("script"),a=0;a<n.length;a++){var l=n[a];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")=="vk:"+o){r=l;break}}r||(s=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,__webpack_require__.nc&&r.setAttribute("nonce",__webpack_require__.nc),r.setAttribute("data-webpack","vk:"+o),r.src=e),inProgress[e]=[t];var d=(t,o)=>{r.onerror=r.onload=null,clearTimeout(_);var i=inProgress[e];if(delete inProgress[e],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach((e=>e(o))),t)return t(o)},_=setTimeout(d.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=d.bind(null,r.onerror),r.onload=d.bind(null,r.onload),s&&document.head.appendChild(r)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/dist/",loadStylesheet=e=>new Promise(((t,o)=>{var i=__webpack_require__.miniCssF(e),r=__webpack_require__.p+i;if(((e,t)=>{for(var o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var r=(n=o[i]).getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(r===e||r===t))return n}var s=document.getElementsByTagName("style");for(i=0;i<s.length;i++){var n;if((r=(n=s[i]).getAttribute("data-href"))===e||r===t)return n}})(i,r))return t();((e,t,o,i)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.onerror=r.onload=s=>{if(r.onerror=r.onload=null,"load"===s.type)o();else{var n=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=n,l.request=a,r.parentNode.removeChild(r),i(l)}},r.href=t,document.head.appendChild(r)})(e,r,t,o)})),installedCssChunks={75583:0},__webpack_require__.f.miniCss=(e,t)=>{installedCssChunks[e]?t.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{882:1,29019:1,57468:1,75980:1,79344:1}[e]&&t.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(t=>{throw delete installedCssChunks[e],t})))},(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={75583:0};__webpack_require__.f.j=(t,o)=>{var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)o.push(i[2]);else if(75980!=t){var r=new Promise(((o,r)=>i=e[t]=[o,r]));o.push(i[2]=r);var s=__webpack_require__.p+__webpack_require__.u(t),n=new Error;__webpack_require__.l(s,(o=>{if(__webpack_require__.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;n.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",n.name="ChunkLoadError",n.type=r,n.request=s,i[1](n)}}),"chunk-"+t,t)}else e[t]=0},__webpack_require__.O.j=t=>0===e[t];var t=(t,o)=>{var i,r,[s,n,a]=o,l=0;for(i in n)__webpack_require__.o(n,i)&&(__webpack_require__.m[i]=n[i]);if(a)var d=a(__webpack_require__);for(t&&t(o);l<s.length;l++)r=s[l],__webpack_require__.o(e,r)&&e[r]&&e[r][0](),e[s[l]]=0;return __webpack_require__.O(d)},o=self.webpackChunkvk=self.webpackChunkvk||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var __webpack_exports__=__webpack_require__.O(void 0,[76429,75514,24509,56990,98066,76400,40885,38288,68592,86164,22061,43639],(()=>__webpack_require__(228605)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();