(self.webpackChunkvk=self.webpackChunkvk||[]).push([[23299],{612214:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});const n=(0,r(951201).makeIcon)("Icon12OnlineMobile","online_mobile_12","0 0 8 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 8 12" id="online_mobile_12"><path fill="currentColor" d="M5.99 0C7.1 0 8 .9 8 2.01v7.98C8 11.1 7.1 12 5.99 12H2.01C.9 12 0 11.1 0 9.99V2.01C0 .9.9 0 2.01 0h3.98Zm.007 3H2.004a.502.502 0 0 0-.503.502v4.995c0 .278.225.503.503.503h3.995a.502.502 0 0 0 .502-.502V3.503A.502.502 0 0 0 5.997 3Z" /></symbol>',8,12,!1,void 0)},76109:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});const n=(0,r(951201).makeIcon)("Icon24Cancel","cancel_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="cancel_24"><path d="M7.536 6.264a.9.9 0 0 0-1.272 1.272L10.727 12l-4.463 4.464a.9.9 0 0 0 1.272 1.272L12 13.273l4.464 4.463a.9.9 0 1 0 1.272-1.272L13.273 12l4.463-4.464a.9.9 0 1 0-1.272-1.272L12 10.727 7.536 6.264Z" /></symbol>',24,24,!1,void 0)},718305:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});const n=(0,r(951201).makeIcon)("Icon28ChevronLeftOutline","chevron_left_outline_28","0 0 28 28",'<symbol fill="none" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" id="chevron_left_outline_28"><path d="m12.414 14 5.793-5.793a1 1 0 0 0-1.414-1.414l-6.5 6.5a1 1 0 0 0 0 1.414l6.5 6.5a1 1 0 0 0 1.414-1.414z" fill="currentColor" /></symbol>',28,28,!1,void 0)},921924:(e,t,r)=>{"use strict";var n=r(410492),a=r(155559),s=a(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&s(e,".prototype.")>-1?a(r):r}},155559:(e,t,r)=>{"use strict";var n=r(158612),a=r(410492),s=a("%Function.prototype.apply%"),o=a("%Function.prototype.call%"),i=a("%Reflect.apply%",!0)||n.call(o,s),u=a("%Object.getOwnPropertyDescriptor%",!0),c=a("%Object.defineProperty%",!0),l=a("%Math.max%");if(c)try{c({},"a",{value:1})}catch(e){c=null}e.exports=function(e){var t=i(n,o,arguments);if(u&&c){var r=u(t,"length");r.configurable&&c(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var d=function(){return i(n,s,arguments)};c?c(e.exports,"apply",{value:d}):e.exports.apply=d},410492:(e,t,r)=>{"use strict";var n,a=SyntaxError,s=Function,o=TypeError,i=function(e){try{return s('"use strict"; return ('+e+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(e){u=null}var c=function(){throw new o},l=u?function(){try{return c}catch(e){try{return u(arguments,"callee").get}catch(e){return c}}}():c,d=r(241405)(),p=Object.getPrototypeOf||function(e){return e.__proto__},f={},h="undefined"==typeof Uint8Array?n:p(Uint8Array),v={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d?p([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?p(p([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?p((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?p((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?p(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":a,"%ThrowTypeError%":l,"%TypedArray%":h,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},y=function e(t){var r;if("%AsyncFunction%"===t)r=i("async function () {}");else if("%GeneratorFunction%"===t)r=i("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=i("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var a=e("%AsyncGenerator%");a&&(r=p(a.prototype))}return v[t]=r,r},m={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},g=r(158612),b=r(117642),k=g.call(Function.call,Array.prototype.concat),C=g.call(Function.apply,Array.prototype.splice),_=g.call(Function.call,String.prototype.replace),w=g.call(Function.call,String.prototype.slice),I=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g,M=function(e){var t=w(e,0,1),r=w(e,-1);if("%"===t&&"%"!==r)throw new a("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new a("invalid intrinsic syntax, expected opening `%`");var n=[];return _(e,I,(function(e,t,r,a){n[n.length]=r?_(a,S,"$1"):t||e})),n},A=function(e,t){var r,n=e;if(b(m,n)&&(n="%"+(r=m[n])[0]+"%"),b(v,n)){var s=v[n];if(s===f&&(s=y(n)),void 0===s&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:s}}throw new a("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');var r=M(e),n=r.length>0?r[0]:"",s=A("%"+n+"%",t),i=s.name,c=s.value,l=!1,d=s.alias;d&&(n=d[0],C(r,k([0,1],d)));for(var p=1,f=!0;p<r.length;p+=1){var h=r[p],y=w(h,0,1),m=w(h,-1);if(('"'===y||"'"===y||"`"===y||'"'===m||"'"===m||"`"===m)&&y!==m)throw new a("property names with quotes must have matching quotes");if("constructor"!==h&&f||(l=!0),b(v,i="%"+(n+="."+h)+"%"))c=v[i];else if(null!=c){if(!(h in c)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&p+1>=r.length){var g=u(c,h);c=(f=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:c[h]}else f=b(c,h),c=c[h];f&&!l&&(v[i]=c)}}return c}},931807:e=>{var t=!("undefined"==typeof window||!window.document||!window.document.createElement);e.exports=t},404289:(e,t,r)=>{"use strict";var n=r(482215),a="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),s=Object.prototype.toString,o=Array.prototype.concat,i=Object.defineProperty,u=i&&function(){var e={};try{for(var t in i(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),c=function(e,t,r,n){var a;(!(t in e)||"function"==typeof(a=n)&&"[object Function]"===s.call(a)&&n())&&(u?i(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},l=function(e,t){var r=arguments.length>2?arguments[2]:{},s=n(t);a&&(s=o.call(s,Object.getOwnPropertySymbols(t)));for(var i=0;i<s.length;i+=1)c(e,s[i],t[s[i]],r[s[i]])};l.supportsDescriptors=!!u,e.exports=l},138820:(e,t,r)=>{"use strict";var n=r(289166),a=n("%Array.prototype%"),s=n("%RangeError%"),o=n("%SyntaxError%"),i=n("%TypeError%"),u=r(427840),c=Math.pow(2,32)-1,l=n("%Object.setPrototypeOf%",!0)||([].__proto__!==a?null:function(e,t){return e.__proto__=t,e});e.exports=function(e){if(!u(e)||e<0)throw new i("Assertion failed: `length` must be an integer Number >= 0");if(e>c)throw new s("length is greater than (2**32 - 1)");var t=arguments.length>1?arguments[1]:a,r=[];if(t!==a){if(!l)throw new o("ArrayCreate: a `proto` argument that is not `Array.prototype` is not supported in an environment that does not support setting the [[Prototype]]");l(r,t)}return 0!==e&&(r.length=e),r}},929120:(e,t,r)=>{"use strict";var n=r(289166),a=n("%Symbol.species%",!0),s=n("%TypeError%"),o=r(138820),i=r(570317),u=r(259340),c=r(702370),l=r(427840),d=r(854300);e.exports=function(e,t){if(!l(t)||t<0)throw new s("Assertion failed: length must be an integer >= 0");if(!u(e))return o(t);var r=i(e,"constructor");if(a&&"Object"===d(r)&&null===(r=i(r,a))&&(r=void 0),void 0===r)return o(t);if(!c(r))throw new s("C must be a constructor");return new r(t)}},599582:(e,t,r)=>{"use strict";var n=r(289166),a=r(921924),s=n("%TypeError%"),o=r(259340),i=n("%Reflect.apply%",!0)||a("%Function.prototype.apply%");e.exports=function(e,t){var r=arguments.length>2?arguments[2]:[];if(!o(r))throw new s("Assertion failed: optional `argumentsList`, if provided, must be a List");return i(e,t,r)}},542067:(e,t,r)=>{"use strict";var n=r(289166)("%TypeError%"),a=r(940509),s=r(568712),o=r(424825),i=r(270098),u=r(775239),c=r(974220),l=r(449845),d=r(854300);e.exports=function(e,t,r){if("Object"!==d(e))throw new n("Assertion failed: Type(O) is not Object");if(!c(t))throw new n("Assertion failed: IsPropertyKey(P) is not true");var p=o(e,t),f=!p||u(e);return!(p&&!p["[[Configurable]]"]||!f)&&a(i,l,s,e,t,{"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Value]]":r,"[[Writable]]":!0})}},305453:(e,t,r)=>{"use strict";var n=r(289166)("%TypeError%"),a=r(542067),s=r(974220),o=r(854300);e.exports=function(e,t,r){if("Object"!==o(e))throw new n("Assertion failed: Type(O) is not Object");if(!s(t))throw new n("Assertion failed: IsPropertyKey(P) is not true");var i=a(e,t,r);if(!i)throw new n("unable to create data property");return i}},126402:(e,t,r)=>{"use strict";var n=r(289166)("%TypeError%"),a=r(639146),s=r(940509),o=r(568712),i=r(352092),u=r(270098),c=r(974220),l=r(449845),d=r(157852),p=r(854300);e.exports=function(e,t,r){if("Object"!==p(e))throw new n("Assertion failed: Type(O) is not Object");if(!c(t))throw new n("Assertion failed: IsPropertyKey(P) is not true");var f=a({Type:p,IsDataDescriptor:u,IsAccessorDescriptor:i},r)?r:d(r);if(!a({Type:p,IsDataDescriptor:u,IsAccessorDescriptor:i},f))throw new n("Assertion failed: Desc is not a valid Property Descriptor");return s(u,l,o,e,t,f)}},91521:(e,t,r)=>{"use strict";var n=r(289166)("%TypeError%"),a=r(965376),s=r(599582),o=r(305453),i=r(570317),u=r(864741),c=r(259340),l=r(964653),d=r(260561);e.exports=function e(t,r,p,f,h){var v;arguments.length>5&&(v=arguments[5]);for(var y=f,m=0;m<p;){var g=d(m),b=u(r,g);if(!0===b){var k=i(r,g);if(void 0!==v){if(arguments.length<=6)throw new n("Assertion failed: thisArg is required when mapperFunction is provided");k=s(v,arguments[6],[k,m,r])}var C=!1;if(h>0&&(C=c(k)),C){var _=l(k);y=e(t,k,_,y,h-1)}else{if(y>=a)throw new n("index too large");o(t,d(y),k),y+=1}}m+=1}return y}},568712:(e,t,r)=>{"use strict";var n=r(314179),a=r(923005),s=r(854300);e.exports=function(e){return void 0!==e&&n(s,"Property Descriptor","Desc",e),a(e)}},570317:(e,t,r)=>{"use strict";var n=r(289166)("%TypeError%"),a=r(268896),s=r(974220),o=r(854300);e.exports=function(e,t){if("Object"!==o(e))throw new n("Assertion failed: Type(O) is not Object");if(!s(t))throw new n("Assertion failed: IsPropertyKey(P) is not true, got "+a(t));return e[t]}},864741:(e,t,r)=>{"use strict";var n=r(289166)("%TypeError%"),a=r(974220),s=r(854300);e.exports=function(e,t){if("Object"!==s(e))throw new n("Assertion failed: `O` must be an Object");if(!a(t))throw new n("Assertion failed: `P` must be a Property Key");return t in e}},352092:(e,t,r)=>{"use strict";var n=r(117642),a=r(314179),s=r(854300);e.exports=function(e){return void 0!==e&&(a(s,"Property Descriptor","Desc",e),!(!n(e,"[[Get]]")&&!n(e,"[[Set]]")))}},259340:(e,t,r)=>{"use strict";e.exports=r(87097)},299739:(e,t,r)=>{"use strict";e.exports=r(367195)},702370:(e,t,r)=>{"use strict";var n=r(908769)("%Reflect.construct%",!0),a=r(126402);try{a({},"",{"[[Get]]":function(){}})}catch(e){a=null}if(a&&n){var s={},o={};a(o,"length",{"[[Get]]":function(){throw s},"[[Enumerable]]":!0}),e.exports=function(e){try{n(e,o)}catch(e){return e===s}}}else e.exports=function(e){return"function"==typeof e&&!!e.prototype}},270098:(e,t,r)=>{"use strict";var n=r(117642),a=r(314179),s=r(854300);e.exports=function(e){return void 0!==e&&(a(s,"Property Descriptor","Desc",e),!(!n(e,"[[Value]]")&&!n(e,"[[Writable]]")))}},775239:(e,t,r)=>{"use strict";var n=r(289166),a=n("%Object.preventExtensions%",!0),s=n("%Object.isExtensible%",!0),o=r(673126);e.exports=a?function(e){return!o(e)&&s(e)}:function(e){return!o(e)}},427840:(e,t,r)=>{"use strict";var n=r(913015),a=r(46261),s=r(854300),o=r(631214),i=r(753060);e.exports=function(e){if("Number"!==s(e)||o(e)||!i(e))return!1;var t=n(e);return a(t)===t}},974220:e=>{"use strict";e.exports=function(e){return"string"==typeof e||"symbol"==typeof e}},938155:(e,t,r)=>{"use strict";var n=r(289166)("%Symbol.match%",!0),a=r(498420),s=r(63895);e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(n){var t=e[n];if(void 0!==t)return s(t)}return a(e)}},964653:(e,t,r)=>{"use strict";var n=r(289166)("%TypeError%"),a=r(570317),s=r(304840),o=r(854300);e.exports=function(e){if("Object"!==o(e))throw new n("Assertion failed: `obj` must be an Object");return s(a(e,"length"))}},424825:(e,t,r)=>{"use strict";var n=r(289166),a=r(594079),s=n("%TypeError%"),o=r(921924)("Object.prototype.propertyIsEnumerable"),i=r(117642),u=r(259340),c=r(974220),l=r(938155),d=r(157852),p=r(854300);e.exports=function(e,t){if("Object"!==p(e))throw new s("Assertion failed: O must be an Object");if(!c(t))throw new s("Assertion failed: P must be a Property Key");if(i(e,t)){if(!a){var r=u(e)&&"length"===t,n=l(e)&&"lastIndex"===t;return{"[[Configurable]]":!(r||n),"[[Enumerable]]":o(e,t),"[[Value]]":e[t],"[[Writable]]":!0}}return d(a(e,t))}}},186378:(e,t,r)=>{"use strict";e.exports=r(928631)},449845:(e,t,r)=>{"use strict";var n=r(631214);e.exports=function(e,t){return e===t?0!==e||1/e==1/t:n(e)&&n(t)}},63895:e=>{"use strict";e.exports=function(e){return!!e}},178974:(e,t,r)=>{"use strict";var n=r(913015),a=r(46261),s=r(819157),o=r(631214),i=r(753060),u=r(794099);e.exports=function(e){var t=s(e);return o(t)||0===t?0:i(t)?u(t)*a(n(t)):t}},304840:(e,t,r)=>{"use strict";var n=r(965376),a=r(178974);e.exports=function(e){var t=a(e);return t<=0?0:t>n?n:t}},819157:(e,t,r)=>{"use strict";var n=r(289166),a=n("%TypeError%"),s=n("%Number%"),o=n("%RegExp%"),i=n("%parseInt%"),u=r(921924),c=r(911652),l=r(673126),d=u("String.prototype.slice"),p=c(/^0b[01]+$/i),f=c(/^0o[0-7]+$/i),h=c(/^[-+]0x[0-9a-f]+$/i),v=c(new o("["+["","​","￾"].join("")+"]","g")),y=["\t\n\v\f\r   ᠎    ","         　\u2028","\u2029\ufeff"].join(""),m=new RegExp("(^["+y+"]+)|(["+y+"]+$)","g"),g=u("String.prototype.replace"),b=r(252159);e.exports=function e(t){var r=l(t)?t:b(t,s);if("symbol"==typeof r)throw new a("Cannot convert a Symbol value to a number");if("bigint"==typeof r)throw new a("Conversion from 'BigInt' to 'number' is not allowed.");if("string"==typeof r){if(p(r))return e(i(d(r,2),2));if(f(r))return e(i(d(r,2),8));if(v(r)||h(r))return NaN;var n=function(e){return g(e,m,"")}(r);if(n!==r)return e(n)}return s(r)}},369058:(e,t,r)=>{"use strict";var n=r(289166)("%Object%"),a=r(186378);e.exports=function(e){return a(e),n(e)}},252159:(e,t,r)=>{"use strict";var n=r(41503);e.exports=function(e){return arguments.length>1?n(e,arguments[1]):n(e)}},157852:(e,t,r)=>{"use strict";var n=r(117642),a=r(289166)("%TypeError%"),s=r(854300),o=r(63895),i=r(299739);e.exports=function(e){if("Object"!==s(e))throw new a("ToPropertyDescriptor requires an object");var t={};if(n(e,"enumerable")&&(t["[[Enumerable]]"]=o(e.enumerable)),n(e,"configurable")&&(t["[[Configurable]]"]=o(e.configurable)),n(e,"value")&&(t["[[Value]]"]=e.value),n(e,"writable")&&(t["[[Writable]]"]=o(e.writable)),n(e,"get")){var r=e.get;if(void 0!==r&&!i(r))throw new a("getter must be a function");t["[[Get]]"]=r}if(n(e,"set")){var u=e.set;if(void 0!==u&&!i(u))throw new a("setter must be a function");t["[[Set]]"]=u}if((n(t,"[[Get]]")||n(t,"[[Set]]"))&&(n(t,"[[Value]]")||n(t,"[[Writable]]")))throw new a("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t}},260561:(e,t,r)=>{"use strict";var n=r(289166),a=n("%String%"),s=n("%TypeError%");e.exports=function(e){if("symbol"==typeof e)throw new s("Cannot convert a Symbol value to a string");return a(e)}},854300:(e,t,r)=>{"use strict";var n=r(461276);e.exports=function(e){return"symbol"==typeof e?"Symbol":"bigint"==typeof e?"BigInt":n(e)}},913015:(e,t,r)=>{"use strict";var n=r(289166)("%Math.abs%");e.exports=function(e){return n(e)}},46261:e=>{"use strict";var t=Math.floor;e.exports=function(e){return t(e)}},928631:(e,t,r)=>{"use strict";var n=r(289166)("%TypeError%");e.exports=function(e,t){if(null==e)throw new n(t||"Cannot call method on "+e);return e}},461276:e=>{"use strict";e.exports=function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0}},908769:(e,t,r)=>{"use strict";e.exports=r(289166)},940509:(e,t,r)=>{"use strict";var n=r(431044),a=r(289166),s=n()&&a("%Object.defineProperty%",!0),o=n.hasArrayLengthDefineBug(),i=o&&r(87097),u=r(921924)("Object.prototype.propertyIsEnumerable");e.exports=function(e,t,r,n,a,c){if(!s){if(!e(c))return!1;if(!c["[[Configurable]]"]||!c["[[Writable]]"])return!1;if(a in n&&u(n,a)!==!!c["[[Enumerable]]"])return!1;var l=c["[[Value]]"];return n[a]=l,t(n[a],l)}return o&&"length"===a&&"[[Value]]"in c&&i(n)&&n.length!==c["[[Value]]"]?(n.length=c["[[Value]]"],n.length===c["[[Value]]"]):(s(n,a,r(c)),!0)}},87097:(e,t,r)=>{"use strict";var n=r(289166)("%Array%"),a=!n.isArray&&r(921924)("Object.prototype.toString");e.exports=n.isArray||function(e){return"[object Array]"===a(e)}},314179:(e,t,r)=>{"use strict";var n=r(289166),a=n("%TypeError%"),s=n("%SyntaxError%"),o=r(117642),i={"Property Descriptor":function(e){var t={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in e)if(o(e,r)&&!t[r])return!1;var n=o(e,"[[Value]]"),s=o(e,"[[Get]]")||o(e,"[[Set]]");if(n&&s)throw new a("Property Descriptors may not be both accessor and data descriptors");return!0},"Match Record":r(187283)};e.exports=function(e,t,r,n){var o=i[t];if("function"!=typeof o)throw new s("unknown record type: "+t);if("Object"!==e(n)||!o(n))throw new a(r+" must be a "+t)}},923005:e=>{"use strict";e.exports=function(e){if(void 0===e)return e;var t={};return"[[Value]]"in e&&(t.value=e["[[Value]]"]),"[[Writable]]"in e&&(t.writable=!!e["[[Writable]]"]),"[[Get]]"in e&&(t.get=e["[[Get]]"]),"[[Set]]"in e&&(t.set=e["[[Set]]"]),"[[Enumerable]]"in e&&(t.enumerable=!!e["[[Enumerable]]"]),"[[Configurable]]"in e&&(t.configurable=!!e["[[Configurable]]"]),t}},594079:(e,t,r)=>{"use strict";var n=r(289166)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},753060:e=>{"use strict";var t=Number.isNaN||function(e){return e!=e};e.exports=Number.isFinite||function(e){return"number"==typeof e&&!t(e)&&e!==1/0&&e!==-1/0}},187283:(e,t,r)=>{"use strict";var n=r(117642);e.exports=function(e){return n(e,"[[StartIndex]]")&&n(e,"[[EndIndex]]")&&e["[[StartIndex]]"]>=0&&e["[[EndIndex]]"]>=e["[[StartIndex]]"]&&String(parseInt(e["[[StartIndex]]"],10))===String(e["[[StartIndex]]"])&&String(parseInt(e["[[EndIndex]]"],10))===String(e["[[EndIndex]]"])}},631214:e=>{"use strict";e.exports=Number.isNaN||function(e){return e!=e}},673126:e=>{"use strict";e.exports=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e}},639146:(e,t,r)=>{"use strict";var n=r(289166),a=r(117642),s=n("%TypeError%");e.exports=function(e,t){if("Object"!==e.Type(t))return!1;var r={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in t)if(a(t,n)&&!r[n])return!1;if(e.IsDataDescriptor(t)&&e.IsAccessorDescriptor(t))throw new s("Property Descriptors may not be both accessor and data descriptors");return!0}},965376:(e,t,r)=>{"use strict";var n=r(289166),a=n("%Math%"),s=n("%Number%");e.exports=s.MAX_SAFE_INTEGER||a.pow(2,53)-1},911652:(e,t,r)=>{"use strict";var n=r(921924)("RegExp.prototype.exec");e.exports=function(e){return function(t){return null!==n(e,t)}}},794099:e=>{"use strict";e.exports=function(e){return e>=0?1:-1}},289166:(e,t,r)=>{"use strict";var n,a=SyntaxError,s=Function,o=TypeError,i=function(e){try{return s('"use strict"; return ('+e+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(e){u=null}var c=function(){throw new o},l=u?function(){try{return c}catch(e){try{return u(arguments,"callee").get}catch(e){return c}}}():c,d=r(241405)(),p=Object.getPrototypeOf||function(e){return e.__proto__},f={},h="undefined"==typeof Uint8Array?n:p(Uint8Array),v={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d?p([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?p(p([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?p((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?p((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?p(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":a,"%ThrowTypeError%":l,"%TypedArray%":h,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},y=function e(t){var r;if("%AsyncFunction%"===t)r=i("async function () {}");else if("%GeneratorFunction%"===t)r=i("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=i("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var a=e("%AsyncGenerator%");a&&(r=p(a.prototype))}return v[t]=r,r},m={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},g=r(158612),b=r(117642),k=g.call(Function.call,Array.prototype.concat),C=g.call(Function.apply,Array.prototype.splice),_=g.call(Function.call,String.prototype.replace),w=g.call(Function.call,String.prototype.slice),I=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g,M=function(e){var t=w(e,0,1),r=w(e,-1);if("%"===t&&"%"!==r)throw new a("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new a("invalid intrinsic syntax, expected opening `%`");var n=[];return _(e,I,(function(e,t,r,a){n[n.length]=r?_(a,S,"$1"):t||e})),n},A=function(e,t){var r,n=e;if(b(m,n)&&(n="%"+(r=m[n])[0]+"%"),b(v,n)){var s=v[n];if(s===f&&(s=y(n)),void 0===s&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:s}}throw new a("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');var r=M(e),n=r.length>0?r[0]:"",s=A("%"+n+"%",t),i=s.name,c=s.value,l=!1,d=s.alias;d&&(n=d[0],C(r,k([0,1],d)));for(var p=1,f=!0;p<r.length;p+=1){var h=r[p],y=w(h,0,1),m=w(h,-1);if(('"'===y||"'"===y||"`"===y||'"'===m||"'"===m||"`"===m)&&y!==m)throw new a("property names with quotes must have matching quotes");if("constructor"!==h&&f||(l=!0),b(v,i="%"+(n+="."+h)+"%"))c=v[i];else if(null!=c){if(!(h in c)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&p+1>=r.length){var g=u(c,h);c=(f=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:c[h]}else f=b(c,h),c=c[h];f&&!l&&(v[i]=c)}}return c}},367195:e=>{"use strict";var t,r,n=Function.prototype.toString,a="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof a&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},a((function(){throw 42}),null,t)}catch(e){e!==r&&(a=null)}else a=null;var s=/^\s*class\b/,o=function(e){try{var t=n.call(e);return s.test(t)}catch(e){return!1}},i=Object.prototype.toString,u="function"==typeof Symbol&&!!Symbol.toStringTag,c="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};e.exports=a?function(e){if(e===c)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{a(e,null,t)}catch(e){if(e!==r)return!1}return!o(e)}:function(e){if(e===c)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(u)return function(e){try{return!o(e)&&(n.call(e),!0)}catch(e){return!1}}(e);if(o(e))return!1;var t=i.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}},268896:(e,t,r)=>{var n="function"==typeof Map&&Map.prototype,a=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,s=n&&a&&"function"==typeof a.get?a.get:null,o=n&&Map.prototype.forEach,i="function"==typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=i&&u&&"function"==typeof u.get?u.get:null,l=i&&Set.prototype.forEach,d="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,p="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,f="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,h=Boolean.prototype.valueOf,v=Object.prototype.toString,y=Function.prototype.toString,m=String.prototype.match,g=String.prototype.slice,b=String.prototype.replace,k=String.prototype.toUpperCase,C=String.prototype.toLowerCase,_=RegExp.prototype.test,w=Array.prototype.concat,I=Array.prototype.join,S=Array.prototype.slice,M=Math.floor,A="function"==typeof BigInt?BigInt.prototype.valueOf:null,x=Object.getOwnPropertySymbols,R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,E="function"==typeof Symbol&&"object"==typeof Symbol.iterator,U="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===E||"symbol")?Symbol.toStringTag:null,P=Object.prototype.propertyIsEnumerable,O=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function T(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||_.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-M(-e):M(e);if(n!==e){var a=String(n),s=g.call(t,a.length+1);return b.call(a,r,"$&_")+"."+b.call(b.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(t,r,"$&_")}var F=r(172006).custom,N=F&&D(F)?F:null;function q(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function L(e){return b.call(String(e),/"/g,"&quot;")}function j(e){return!("[object Array]"!==H(e)||U&&"object"==typeof e&&U in e)}function D(e){if(E)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!R)return!1;try{return R.call(e),!0}catch(e){}return!1}e.exports=function e(t,r,n,a){var i=r||{};if(G(i,"quoteStyle")&&"single"!==i.quoteStyle&&"double"!==i.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(G(i,"maxStringLength")&&("number"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var u=!G(i,"customInspect")||i.customInspect;if("boolean"!=typeof u&&"symbol"!==u)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(G(i,"indent")&&null!==i.indent&&"\t"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(G(i,"numericSeparator")&&"boolean"!=typeof i.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=i.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return W(t,i);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var k=String(t);return v?T(t,k):k}if("bigint"==typeof t){var _=String(t)+"n";return v?T(t,_):_}var M=void 0===i.depth?5:i.depth;if(void 0===n&&(n=0),n>=M&&M>0&&"object"==typeof t)return j(t)?"[Array]":"[Object]";var x=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=I.call(Array(e.indent+1)," ")}return{base:r,prev:I.call(Array(t+1),r)}}(i,n);if(void 0===a)a=[];else if(V(a,t)>=0)return"[Circular]";function F(t,r,s){if(r&&(a=S.call(a)).push(r),s){var o={depth:i.depth};return G(i,"quoteStyle")&&(o.quoteStyle=i.quoteStyle),e(t,o,n+1,a)}return e(t,i,n+1,a)}if("function"==typeof t){var B=function(e){if(e.name)return e.name;var t=m.call(y.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),z=X(t,F);return"[Function"+(B?": "+B:" (anonymous)")+"]"+(z.length>0?" { "+I.call(z,", ")+" }":"")}if(D(t)){var Y=E?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):R.call(t);return"object"!=typeof t||E?Y:K(Y)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var Z="<"+C.call(String(t.nodeName)),ee=t.attributes||[],te=0;te<ee.length;te++)Z+=" "+ee[te].name+"="+q(L(ee[te].value),"double",i);return Z+=">",t.childNodes&&t.childNodes.length&&(Z+="..."),Z+="</"+C.call(String(t.nodeName))+">"}if(j(t)){if(0===t.length)return"[]";var re=X(t,F);return x&&!function(e){for(var t=0;t<e.length;t++)if(V(e[t],"\n")>=0)return!1;return!0}(re)?"["+J(re,x)+"]":"[ "+I.call(re,", ")+" ]"}if(function(e){return!("[object Error]"!==H(e)||U&&"object"==typeof e&&U in e)}(t)){var ne=X(t,F);return"cause"in t&&!P.call(t,"cause")?"{ ["+String(t)+"] "+I.call(w.call("[cause]: "+F(t.cause),ne),", ")+" }":0===ne.length?"["+String(t)+"]":"{ ["+String(t)+"] "+I.call(ne,", ")+" }"}if("object"==typeof t&&u){if(N&&"function"==typeof t[N])return t[N]();if("symbol"!==u&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!s||!e||"object"!=typeof e)return!1;try{s.call(e);try{c.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var ae=[];return o.call(t,(function(e,r){ae.push(F(r,t,!0)+" => "+F(e,t))})),Q("Map",s.call(t),ae,x)}if(function(e){if(!c||!e||"object"!=typeof e)return!1;try{c.call(e);try{s.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var se=[];return l.call(t,(function(e){se.push(F(e,t))})),Q("Set",c.call(t),se,x)}if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{p.call(e,p)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return $("WeakMap");if(function(e){if(!p||!e||"object"!=typeof e)return!1;try{p.call(e,p);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return $("WeakSet");if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{return f.call(e),!0}catch(e){}return!1}(t))return $("WeakRef");if(function(e){return!("[object Number]"!==H(e)||U&&"object"==typeof e&&U in e)}(t))return K(F(Number(t)));if(function(e){if(!e||"object"!=typeof e||!A)return!1;try{return A.call(e),!0}catch(e){}return!1}(t))return K(F(A.call(t)));if(function(e){return!("[object Boolean]"!==H(e)||U&&"object"==typeof e&&U in e)}(t))return K(h.call(t));if(function(e){return!("[object String]"!==H(e)||U&&"object"==typeof e&&U in e)}(t))return K(F(String(t)));if(!function(e){return!("[object Date]"!==H(e)||U&&"object"==typeof e&&U in e)}(t)&&!function(e){return!("[object RegExp]"!==H(e)||U&&"object"==typeof e&&U in e)}(t)){var oe=X(t,F),ie=O?O(t)===Object.prototype:t instanceof Object||t.constructor===Object,ue=t instanceof Object?"":"null prototype",ce=!ie&&U&&Object(t)===t&&U in t?g.call(H(t),8,-1):ue?"Object":"",le=(ie||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(ce||ue?"["+I.call(w.call([],ce||[],ue||[]),": ")+"] ":"");return 0===oe.length?le+"{}":x?le+"{"+J(oe,x)+"}":le+"{ "+I.call(oe,", ")+" }"}return String(t)};var B=Object.prototype.hasOwnProperty||function(e){return e in this};function G(e,t){return B.call(e,t)}function H(e){return v.call(e)}function V(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function W(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return W(g.call(e,0,t.maxStringLength),t)+n}return q(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,z),"single",t)}function z(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+k.call(t.toString(16))}function K(e){return"Object("+e+")"}function $(e){return e+" { ? }"}function Q(e,t,r,n){return e+" ("+t+") {"+(n?J(r,n):I.call(r,", "))+"}"}function J(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+I.call(e,","+r)+"\n"+t.prev}function X(e,t){var r=j(e),n=[];if(r){n.length=e.length;for(var a=0;a<e.length;a++)n[a]=G(e,a)?t(e[a],e):""}var s,o="function"==typeof x?x(e):[];if(E){s={};for(var i=0;i<o.length;i++)s["$"+o[i]]=o[i]}for(var u in e)G(e,u)&&(r&&String(Number(u))===u&&u<e.length||E&&s["$"+u]instanceof Symbol||(_.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if("function"==typeof x)for(var c=0;c<o.length;c++)P.call(e,o[c])&&n.push("["+t(o[c])+"]: "+t(e[o[c]],e));return n}},697272:(e,t,r)=>{"use strict";var n=r(117642),a="function"==typeof Symbol&&"symbol"==typeof Symbol.unscopables,s=a&&Array.prototype[Symbol.unscopables],o=TypeError;e.exports=function(e){if("string"!=typeof e||!e)throw new o("method must be a non-empty string");if(!n(Array.prototype,e))throw new o("method must be on Array.prototype");a&&(s[e]=!0)}},41503:(e,t,r)=>{"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,a=r(34149),s=r(95320),o=r(618923),i=r(612636),u=function(e,t){if(null==e)throw new TypeError("Cannot call method on "+e);if("string"!=typeof t||"number"!==t&&"string"!==t)throw new TypeError('hint must be "string" or "number"');var r,n,o,i="string"===t?["toString","valueOf"]:["valueOf","toString"];for(o=0;o<i.length;++o)if(r=e[i[o]],s(r)&&(n=r.call(e),a(n)))return n;throw new TypeError("No default value")},c=function(e,t){var r=e[t];if(null!=r){if(!s(r))throw new TypeError(r+" returned for property "+t+" of object "+e+" is not a function");return r}};e.exports=function(e){if(a(e))return e;var t,r="default";if(arguments.length>1&&(arguments[1]===String?r="string":arguments[1]===Number&&(r="number")),n&&(Symbol.toPrimitive?t=c(e,Symbol.toPrimitive):i(e)&&(t=Symbol.prototype.valueOf)),void 0!==t){var s=t.call(e,r);if(a(s))return s;throw new TypeError("unable to convert exotic object to primitive")}return"default"===r&&(o(e)||i(e))&&(r="string"),u(e,"default"===r?"number":r)}},34149:e=>{"use strict";e.exports=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e}},417648:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,a="[object Function]";e.exports=function(e){var s=this;if("function"!=typeof s||n.call(s)!==a)throw new TypeError(t+s);for(var o,i=r.call(arguments,1),u=function(){if(this instanceof o){var t=s.apply(this,i.concat(r.call(arguments)));return Object(t)===t?t:this}return s.apply(e,i.concat(r.call(arguments)))},c=Math.max(0,s.length-i.length),l=[],d=0;d<c;d++)l.push("$"+d);if(o=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(u),s.prototype){var p=function(){};p.prototype=s.prototype,o.prototype=new p,p.prototype=null}return o}},158612:(e,t,r)=>{"use strict";var n=r(417648);e.exports=Function.prototype.bind||n},431044:(e,t,r)=>{"use strict";var n=r(256181)("%Object.defineProperty%",!0),a=function(){if(n)try{return n({},"a",{value:1}),!0}catch(e){return!1}return!1};a.hasArrayLengthDefineBug=function(){if(!a())return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=a},256181:(e,t,r)=>{"use strict";var n,a=SyntaxError,s=Function,o=TypeError,i=function(e){try{return s('"use strict"; return ('+e+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(e){u=null}var c=function(){throw new o},l=u?function(){try{return c}catch(e){try{return u(arguments,"callee").get}catch(e){return c}}}():c,d=r(241405)(),p=Object.getPrototypeOf||function(e){return e.__proto__},f={},h="undefined"==typeof Uint8Array?n:p(Uint8Array),v={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d?p([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?p(p([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?p((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?p((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?p(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":a,"%ThrowTypeError%":l,"%TypedArray%":h,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},y=function e(t){var r;if("%AsyncFunction%"===t)r=i("async function () {}");else if("%GeneratorFunction%"===t)r=i("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=i("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var a=e("%AsyncGenerator%");a&&(r=p(a.prototype))}return v[t]=r,r},m={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},g=r(158612),b=r(117642),k=g.call(Function.call,Array.prototype.concat),C=g.call(Function.apply,Array.prototype.splice),_=g.call(Function.call,String.prototype.replace),w=g.call(Function.call,String.prototype.slice),I=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g,M=function(e){var t=w(e,0,1),r=w(e,-1);if("%"===t&&"%"!==r)throw new a("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new a("invalid intrinsic syntax, expected opening `%`");var n=[];return _(e,I,(function(e,t,r,a){n[n.length]=r?_(a,S,"$1"):t||e})),n},A=function(e,t){var r,n=e;if(b(m,n)&&(n="%"+(r=m[n])[0]+"%"),b(v,n)){var s=v[n];if(s===f&&(s=y(n)),void 0===s&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:s}}throw new a("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');var r=M(e),n=r.length>0?r[0]:"",s=A("%"+n+"%",t),i=s.name,c=s.value,l=!1,d=s.alias;d&&(n=d[0],C(r,k([0,1],d)));for(var p=1,f=!0;p<r.length;p+=1){var h=r[p],y=w(h,0,1),m=w(h,-1);if(('"'===y||"'"===y||"`"===y||'"'===m||"'"===m||"`"===m)&&y!==m)throw new a("property names with quotes must have matching quotes");if("constructor"!==h&&f||(l=!0),b(v,i="%"+(n+="."+h)+"%"))c=v[i];else if(null!=c){if(!(h in c)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&p+1>=r.length){var g=u(c,h);c=(f=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:c[h]}else f=b(c,h),c=c[h];f&&!l&&(v[i]=c)}}return c}},241405:(e,t,r)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,a=r(455419);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&a())))}},455419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,t);if(42!==a.value||!0!==a.enumerable)return!1}return!0}},596410:(e,t,r)=>{"use strict";var n=r(455419);e.exports=function(){return n()&&!!Symbol.toStringTag}},117642:(e,t,r)=>{"use strict";var n=r(158612);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},95320:e=>{"use strict";var t=Function.prototype.toString,r=/^\s*class\b/,n=function(e){try{var n=t.call(e);return r.test(n)}catch(e){return!1}},a=Object.prototype.toString,s="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;e.exports=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(s)return function(e){try{return!n(e)&&(t.call(e),!0)}catch(e){return!1}}(e);if(n(e))return!1;var r=a.call(e);return"[object Function]"===r||"[object GeneratorFunction]"===r}},618923:e=>{"use strict";var t=Date.prototype.getDay,r=Object.prototype.toString,n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;e.exports=function(e){return"object"==typeof e&&null!==e&&(n?function(e){try{return t.call(e),!0}catch(e){return!1}}(e):"[object Date]"===r.call(e))}},498420:(e,t,r)=>{"use strict";var n,a,s,o,i=r(921924),u=r(596410)();if(u){n=i("Object.prototype.hasOwnProperty"),a=i("RegExp.prototype.exec"),s={};var c=function(){throw s};o={toString:c,valueOf:c},"symbol"==typeof Symbol.toPrimitive&&(o[Symbol.toPrimitive]=c)}var l=i("Object.prototype.toString"),d=Object.getOwnPropertyDescriptor;e.exports=u?function(e){if(!e||"object"!=typeof e)return!1;var t=d(e,"lastIndex");if(!(t&&n(t,"value")))return!1;try{a(e,o)}catch(e){return e===s}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===l(e)}},612636:(e,t,r)=>{"use strict";var n=Object.prototype.toString;if(r(241405)()){var a=Symbol.prototype.toString,s=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==n.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&s.test(a.call(e))}(e)}catch(e){return!1}}}else e.exports=function(e){return!1}},905876:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});const n=r(556169).default.Symbol},858746:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var n=r(905876),a=r(818948),s=r(873636),o=n.default?n.default.toStringTag:void 0;const i=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?(0,a.default)(e):(0,s.default)(e)}},147408:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var n=r(151257),a=/^\s+/;const s=function(e){return e?e.slice(0,(0,n.default)(e)+1).replace(a,""):e}},748277:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});const n="object"==typeof global&&global&&global.Object===Object&&global},818948:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var n=r(905876),a=Object.prototype,s=a.hasOwnProperty,o=a.toString,i=n.default?n.default.toStringTag:void 0;const u=function(e){var t=s.call(e,i),r=e[i];try{e[i]=void 0;var n=!0}catch(e){}var a=o.call(e);return n&&(t?e[i]=r:delete e[i]),a}},873636:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});var n=Object.prototype.toString;const a=function(e){return n.call(e)}},556169:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var n=r(748277),a="object"==typeof self&&self&&self.Object===Object&&self;const s=n.default||a||Function("return this")()},151257:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});var n=/\s/;const a=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},290808:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var n=r(589122),a=r(459641),s=r(147422),o=Math.max,i=Math.min;const u=function(e,t,r){var u,c,l,d,p,f,h=0,v=!1,y=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var r=u,n=c;return u=c=void 0,h=t,d=e.apply(n,r)}function b(e){return h=e,p=setTimeout(C,t),v?g(e):d}function k(e){var r=e-f;return void 0===f||r>=t||r<0||y&&e-h>=l}function C(){var e=(0,a.default)();if(k(e))return _(e);p=setTimeout(C,function(e){var r=t-(e-f);return y?i(r,l-(e-h)):r}(e))}function _(e){return p=void 0,m&&u?g(e):(u=c=void 0,d)}function w(){var e=(0,a.default)(),r=k(e);if(u=arguments,c=this,f=e,r){if(void 0===p)return b(f);if(y)return clearTimeout(p),p=setTimeout(C,t),g(f)}return void 0===p&&(p=setTimeout(C,t)),d}return t=(0,s.default)(t)||0,(0,n.default)(r)&&(v=!!r.leading,l=(y="maxWait"in r)?o((0,s.default)(r.maxWait)||0,t):l,m="trailing"in r?!!r.trailing:m),w.cancel=function(){void 0!==p&&clearTimeout(p),h=0,u=f=c=p=void 0},w.flush=function(){return void 0===p?d:_((0,a.default)())},w}},589122:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});const n=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},623195:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});const n=function(e){return null!=e&&"object"==typeof e}},197828:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var n=r(858746),a=r(623195);const s=function(e){return"symbol"==typeof e||(0,a.default)(e)&&"[object Symbol]"==(0,n.default)(e)}},459641:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});var n=r(556169);const a=function(){return n.default.Date.now()}},858848:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var n=r(290808),a=r(589122);const s=function(e,t,r){var s=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,a.default)(r)&&(s="leading"in r?!!r.leading:s,o="trailing"in r?!!r.trailing:o),(0,n.default)(e,t,{leading:s,maxWait:t,trailing:o})}},147422:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var n=r(147408),a=r(589122),s=r(197828),o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;const l=function(e){if("number"==typeof e)return e;if((0,s.default)(e))return NaN;if((0,a.default)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,a.default)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=(0,n.default)(e);var r=i.test(e);return r||u.test(e)?c(e.slice(2),r?2:8):o.test(e)?NaN:+e}},130845:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var n=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function a(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(a=e[r],s=t[r],!(a===s||n(a)&&n(s)))return!1;var a,s;return!0}const s=function(e,t){var r;void 0===t&&(t=a);var n,s=[],o=!1;return function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];return o&&r===this&&t(a,s)||(n=e.apply(this,a),o=!0,r=this,s=a),n}}},968641:()=>{},380283:()=>{},183638:()=>{},895593:()=>{},351667:()=>{},974580:()=>{},936021:()=>{},360862:()=>{},97839:()=>{},628392:()=>{},29354:()=>{},618987:(e,t,r)=>{"use strict";var n;if(!Object.keys){var a=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=r(250884),i=Object.prototype.propertyIsEnumerable,u=!i.call({toString:null},"toString"),c=i.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!p["$"+e]&&a.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===s.call(e),n=o(e),i=t&&"[object String]"===s.call(e),p=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var h=c&&r;if(i&&e.length>0&&!a.call(e,0))for(var v=0;v<e.length;++v)p.push(String(v));if(n&&e.length>0)for(var y=0;y<e.length;++y)p.push(String(y));else for(var m in e)h&&"prototype"===m||!a.call(e,m)||p.push(String(m));if(u)for(var g=function(e){if("undefined"==typeof window||!f)return d(e);try{return d(e)}catch(e){return!1}}(e),b=0;b<l.length;++b)g&&"constructor"===l[b]||!a.call(e,l[b])||p.push(l[b]);return p}}e.exports=n},482215:(e,t,r)=>{"use strict";var n=Array.prototype.slice,a=r(250884),s=Object.keys,o=s?function(e){return s(e)}:r(618987),i=Object.keys;o.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return a(e)?i(n.call(e)):i(e)})}else Object.keys=o;return Object.keys||o},e.exports=o},250884:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var r=t.call(e),n="[object Arguments]"===r;return n||(n="[object Array]"!==r&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),n}},274061:(e,t,r)=>{"use strict";r.d(t,{FixedSizeList:()=>C,VariableSizeList:()=>k});var n=r(722122),a=r(663349),s=r(841788),o=r(130845),i=r(667294),u=(r(419756),"object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()});function c(e){cancelAnimationFrame(e.id)}function l(e,t){var r=u();var n={id:requestAnimationFrame((function a(){u()-r>=t?e.call(null):n.id=requestAnimationFrame(a)}))};return n}var d=null;function p(e){if(void 0===e&&(e=!1),null===d||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),a=n.style;return a.width="100px",a.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?d="positive-descending":(t.scrollLeft=1,d=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),d}return d}var f=function(e,t){return e};function h(e){var t,r=e.getItemOffset,u=e.getEstimatedTotalSize,d=e.getItemSize,h=e.getOffsetForIndexAndAlignment,y=e.getStartIndexForOffset,m=e.getStopIndexForStartIndex,g=e.initInstanceProps,b=e.shouldResetStyleCacheOnItemSizeChange,k=e.validateProps;return t=function(e){function t(t){var n;return(n=e.call(this,t)||this)._instanceProps=g(n.props,(0,a.default)(n)),n._outerRef=void 0,n._resetIsScrollingTimeoutId=null,n.state={instance:(0,a.default)(n),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof n.props.initialScrollOffset?n.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},n._callOnItemsRendered=void 0,n._callOnItemsRendered=(0,o.default)((function(e,t,r,a){return n.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:r,visibleStopIndex:a})})),n._callOnScroll=void 0,n._callOnScroll=(0,o.default)((function(e,t,r){return n.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:r})})),n._getItemStyle=void 0,n._getItemStyle=function(e){var t,a=n.props,s=a.direction,o=a.itemSize,i=a.layout,u=n._getItemStyleCache(b&&o,b&&i,b&&s);if(u.hasOwnProperty(e))t=u[e];else{var c=r(n.props,e,n._instanceProps),l=d(n.props,e,n._instanceProps),p="horizontal"===s||"horizontal"===i,f="rtl"===s,h=p?c:0;u[e]=t={position:"absolute",left:f?void 0:h,right:f?h:void 0,top:p?0:c,height:p?"100%":l,width:p?l:"100%"}}return t},n._getItemStyleCache=void 0,n._getItemStyleCache=(0,o.default)((function(e,t,r){return{}})),n._onScrollHorizontal=function(e){var t=e.currentTarget,r=t.clientWidth,a=t.scrollLeft,s=t.scrollWidth;n.setState((function(e){if(e.scrollOffset===a)return null;var t=n.props.direction,o=a;if("rtl"===t)switch(p()){case"negative":o=-a;break;case"positive-descending":o=s-r-a}return o=Math.max(0,Math.min(o,s-r)),{isScrolling:!0,scrollDirection:e.scrollOffset<a?"forward":"backward",scrollOffset:o,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._onScrollVertical=function(e){var t=e.currentTarget,r=t.clientHeight,a=t.scrollHeight,s=t.scrollTop;n.setState((function(e){if(e.scrollOffset===s)return null;var t=Math.max(0,Math.min(s,a-r));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._outerRefSetter=function(e){var t=n.props.outerRef;n._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},n._resetIsScrollingDebounced=function(){null!==n._resetIsScrollingTimeoutId&&c(n._resetIsScrollingTimeoutId),n._resetIsScrollingTimeoutId=l(n._resetIsScrolling,150)},n._resetIsScrolling=function(){n._resetIsScrollingTimeoutId=null,n.setState({isScrolling:!1},(function(){n._getItemStyleCache(-1,null)}))},n}(0,s.default)(t,e),t.getDerivedStateFromProps=function(e,t){return v(e,t),k(e),null};var C=t.prototype;return C.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},C.scrollToItem=function(e,t){void 0===t&&(t="auto");var r=this.props.itemCount,n=this.state.scrollOffset;e=Math.max(0,Math.min(e,r-1)),this.scrollTo(h(this.props,e,t,n,this._instanceProps))},C.componentDidMount=function(){var e=this.props,t=e.direction,r=e.initialScrollOffset,n=e.layout;if("number"==typeof r&&null!=this._outerRef){var a=this._outerRef;"horizontal"===t||"horizontal"===n?a.scrollLeft=r:a.scrollTop=r}this._callPropsCallbacks()},C.componentDidUpdate=function(){var e=this.props,t=e.direction,r=e.layout,n=this.state,a=n.scrollOffset;if(n.scrollUpdateWasRequested&&null!=this._outerRef){var s=this._outerRef;if("horizontal"===t||"horizontal"===r)if("rtl"===t)switch(p()){case"negative":s.scrollLeft=-a;break;case"positive-ascending":s.scrollLeft=a;break;default:var o=s.clientWidth,i=s.scrollWidth;s.scrollLeft=i-o-a}else s.scrollLeft=a;else s.scrollTop=a}this._callPropsCallbacks()},C.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&c(this._resetIsScrollingTimeoutId)},C.render=function(){var e=this.props,t=e.children,r=e.className,a=e.direction,s=e.height,o=e.innerRef,c=e.innerElementType,l=e.innerTagName,d=e.itemCount,p=e.itemData,h=e.itemKey,v=void 0===h?f:h,y=e.layout,m=e.outerElementType,g=e.outerTagName,b=e.style,k=e.useIsScrolling,C=e.width,_=this.state.isScrolling,w="horizontal"===a||"horizontal"===y,I=w?this._onScrollHorizontal:this._onScrollVertical,S=this._getRangeToRender(),M=S[0],A=S[1],x=[];if(d>0)for(var R=M;R<=A;R++)x.push((0,i.createElement)(t,{data:p,key:v(R,p),index:R,isScrolling:k?_:void 0,style:this._getItemStyle(R)}));var E=u(this.props,this._instanceProps);return(0,i.createElement)(m||g||"div",{className:r,onScroll:I,ref:this._outerRefSetter,style:(0,n.default)({position:"relative",height:s,width:C,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:a},b)},(0,i.createElement)(c||l||"div",{children:x,ref:o,style:{height:w?"100%":E,pointerEvents:_?"none":void 0,width:w?E:"100%"}}))},C._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],r=e[1],n=e[2],a=e[3];this._callOnItemsRendered(t,r,n,a)}if("function"==typeof this.props.onScroll){var s=this.state,o=s.scrollDirection,i=s.scrollOffset,u=s.scrollUpdateWasRequested;this._callOnScroll(o,i,u)}},C._getRangeToRender=function(){var e=this.props,t=e.itemCount,r=e.overscanCount,n=this.state,a=n.isScrolling,s=n.scrollDirection,o=n.scrollOffset;if(0===t)return[0,0,0,0];var i=y(this.props,o,this._instanceProps),u=m(this.props,i,o,this._instanceProps),c=a&&"backward"!==s?1:Math.max(1,r),l=a&&"forward"!==s?1:Math.max(1,r);return[Math.max(0,i-c),Math.max(0,Math.min(t-1,u+l)),i,u]},t}(i.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var v=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},y=function(e,t,r){var n=e.itemSize,a=r.itemMetadataMap,s=r.lastMeasuredIndex;if(t>s){var o=0;if(s>=0){var i=a[s];o=i.offset+i.size}for(var u=s+1;u<=t;u++){var c=n(u);a[u]={offset:o,size:c},o+=c}r.lastMeasuredIndex=t}return a[t]},m=function(e,t,r,n,a){for(;n<=r;){var s=n+Math.floor((r-n)/2),o=y(e,s,t).offset;if(o===a)return s;o<a?n=s+1:o>a&&(r=s-1)}return n>0?n-1:0},g=function(e,t,r,n){for(var a=e.itemCount,s=1;r<a&&y(e,r,t).offset<n;)r+=s,s*=2;return m(e,t,Math.min(r,a-1),Math.floor(r/2),n)},b=function(e,t){var r=e.itemCount,n=t.itemMetadataMap,a=t.estimatedItemSize,s=t.lastMeasuredIndex,o=0;if(s>=r&&(s=r-1),s>=0){var i=n[s];o=i.offset+i.size}return o+(r-s-1)*a},k=h({getItemOffset:function(e,t,r){return y(e,t,r).offset},getItemSize:function(e,t,r){return r.itemMetadataMap[t].size},getEstimatedTotalSize:b,getOffsetForIndexAndAlignment:function(e,t,r,n,a){var s=e.direction,o=e.height,i=e.layout,u=e.width,c="horizontal"===s||"horizontal"===i?u:o,l=y(e,t,a),d=b(e,a),p=Math.max(0,Math.min(d-c,l.offset)),f=Math.max(0,l.offset-c+l.size);switch("smart"===r&&(r=n>=f-c&&n<=p+c?"auto":"center"),r){case"start":return p;case"end":return f;case"center":return Math.round(f+(p-f)/2);default:return n>=f&&n<=p?n:n<f?f:p}},getStartIndexForOffset:function(e,t,r){return function(e,t,r){var n=t.itemMetadataMap,a=t.lastMeasuredIndex;return(a>0?n[a].offset:0)>=r?m(e,t,a,0,r):g(e,t,Math.max(0,a),r)}(e,r,t)},getStopIndexForStartIndex:function(e,t,r,n){for(var a=e.direction,s=e.height,o=e.itemCount,i=e.layout,u=e.width,c="horizontal"===a||"horizontal"===i?u:s,l=y(e,t,n),d=r+c,p=l.offset+l.size,f=t;f<o-1&&p<d;)f++,p+=y(e,f,n).size;return f},initInstanceProps:function(e,t){var r={itemMetadataMap:{},estimatedItemSize:e.estimatedItemSize||50,lastMeasuredIndex:-1};return t.resetAfterIndex=function(e,n){void 0===n&&(n=!0),r.lastMeasuredIndex=Math.min(r.lastMeasuredIndex,e-1),t._getItemStyleCache(-1),n&&t.forceUpdate()},r},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.itemSize}}),C=h({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,r,n){var a=e.direction,s=e.height,o=e.itemCount,i=e.itemSize,u=e.layout,c=e.width,l="horizontal"===a||"horizontal"===u?c:s,d=Math.max(0,o*i-l),p=Math.min(d,t*i),f=Math.max(0,t*i-l+i);switch("smart"===r&&(r=n>=f-l&&n<=p+l?"auto":"center"),r){case"start":return p;case"end":return f;case"center":var h=Math.round(f+(p-f)/2);return h<Math.ceil(l/2)?0:h>d+Math.floor(l/2)?d:h;default:return n>=f&&n<=p?n:n<f?f:p}},getStartIndexForOffset:function(e,t){var r=e.itemCount,n=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(t/n)))},getStopIndexForStartIndex:function(e,t,r){var n=e.direction,a=e.height,s=e.itemCount,o=e.itemSize,i=e.layout,u=e.width,c=t*o,l="horizontal"===n||"horizontal"===i?u:a,d=Math.ceil((l+r-c)/o);return Math.max(0,Math.min(s-1,t+d-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}})},39352:(e,t,r)=>{"use strict";r.d(t,{default:()=>g});var n=r(896156),a=r(306610),s=r(5991),o=r(858848),i=r(290808),u=r(931807),c=r.n(u),l=null,d=null;function p(){if(null===l){if("undefined"==typeof document)return l=0;var e=document.body,t=document.createElement("div");t.classList.add("simplebar-hide-scrollbar"),e.appendChild(t);var r=t.getBoundingClientRect().right;e.removeChild(t),l=r}return l}function f(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window}function h(e){return e&&e.ownerDocument?e.ownerDocument:document}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}c()&&window.addEventListener("resize",(function(){d!==window.devicePixelRatio&&(d=window.devicePixelRatio,l=null)}));var m=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.default)(this,e),this.onScroll=function(){var e=f(r.el);r.scrollXTicking||(e.requestAnimationFrame(r.scrollX),r.scrollXTicking=!0),r.scrollYTicking||(e.requestAnimationFrame(r.scrollY),r.scrollYTicking=!0),r.isScrolling||(r.isScrolling=!0,r.el.classList.add(r.classNames.scrolling)),r.onStopScrolling()},this.scrollX=function(){r.axis.x.isOverflowing&&r.positionScrollbar("x"),r.scrollXTicking=!1},this.scrollY=function(){r.axis.y.isOverflowing&&r.positionScrollbar("y"),r.scrollYTicking=!1},this.onStopScrolling=function(){r.el.classList.remove(r.classNames.scrolling),r.isScrolling=!1},this.onMouseEnter=function(){r.isMouseEntering||(r.el.classList.add(r.classNames.mouseEntered),r.isMouseEntering=!0),r.onMouseEntered()},this.onMouseEntered=function(){r.el.classList.remove(r.classNames.mouseEntered),r.isMouseEntering=!1},this.onMouseMove=function(e){r.mouseX=e.clientX,r.mouseY=e.clientY,(r.axis.x.isOverflowing||r.axis.x.forceVisible)&&r.onMouseMoveForAxis("x"),(r.axis.y.isOverflowing||r.axis.y.forceVisible)&&r.onMouseMoveForAxis("y")},this.onMouseLeave=function(){r.onMouseMove.cancel(),(r.axis.x.isOverflowing||r.axis.x.forceVisible)&&r.onMouseLeaveForAxis("x"),(r.axis.y.isOverflowing||r.axis.y.forceVisible)&&r.onMouseLeaveForAxis("y"),r.mouseX=-1,r.mouseY=-1},this.onWindowResize=function(){r.scrollbarWidth=e.getScrollbarWidth(),r.hideNativeScrollbar()},this.onPointerEvent=function(e){var t,n;r.axis.x.track.rect=r.axis.x.track.el.getBoundingClientRect(),r.axis.y.track.rect=r.axis.y.track.el.getBoundingClientRect(),(r.axis.x.isOverflowing||r.axis.x.forceVisible)&&(t=r.isWithinBounds(r.axis.x.track.rect)),(r.axis.y.isOverflowing||r.axis.y.forceVisible)&&(n=r.isWithinBounds(r.axis.y.track.rect)),(t||n)&&(e.stopPropagation(),"pointerdown"===e.type&&"touch"!==e.pointerType&&(t&&(r.axis.x.scrollbar.rect=r.axis.x.scrollbar.el.getBoundingClientRect(),r.isWithinBounds(r.axis.x.scrollbar.rect)?r.onDragStart(e,"x"):r.onTrackClick(e,"x")),n&&(r.axis.y.scrollbar.rect=r.axis.y.scrollbar.el.getBoundingClientRect(),r.isWithinBounds(r.axis.y.scrollbar.rect)?r.onDragStart(e,"y"):r.onTrackClick(e,"y"))))},this.drag=function(t){var n=r.axis[r.draggedAxis].track,a=n.rect[r.axis[r.draggedAxis].sizeAttr],s=r.axis[r.draggedAxis].scrollbar,o=r.contentWrapperEl[r.axis[r.draggedAxis].scrollSizeAttr],i=parseInt(r.elStyles[r.axis[r.draggedAxis].sizeAttr],10);t.preventDefault(),t.stopPropagation();var u=(("y"===r.draggedAxis?t.pageY:t.pageX)-n.rect[r.axis[r.draggedAxis].offsetAttr]-r.axis[r.draggedAxis].dragOffset)/(a-s.size)*(o-i);"x"===r.draggedAxis&&(u=r.isRtl&&e.getRtlHelpers().isScrollOriginAtZero?u-(a+s.size):u),r.contentWrapperEl[r.axis[r.draggedAxis].scrollOffsetAttr]=u},this.onEndDrag=function(e){var t=h(r.el),n=f(r.el);e.preventDefault(),e.stopPropagation(),r.el.classList.remove(r.classNames.dragging),t.removeEventListener("mousemove",r.drag,!0),t.removeEventListener("mouseup",r.onEndDrag,!0),r.removePreventClickId=n.setTimeout((function(){t.removeEventListener("click",r.preventClick,!0),t.removeEventListener("dblclick",r.preventClick,!0),r.removePreventClickId=null}))},this.preventClick=function(e){e.preventDefault(),e.stopPropagation()},this.el=t,this.minScrollbarWidth=20,this.stopScrollDelay=175,this.options=y(y({},e.defaultOptions),n),this.classNames=y({contentEl:"simplebar-content",contentWrapper:"simplebar-content-wrapper",offset:"simplebar-offset",mask:"simplebar-mask",wrapper:"simplebar-wrapper",placeholder:"simplebar-placeholder",scrollbar:"simplebar-scrollbar",track:"simplebar-track",heightAutoObserverWrapperEl:"simplebar-height-auto-observer-wrapper",heightAutoObserverEl:"simplebar-height-auto-observer",visible:"simplebar-visible",horizontal:"simplebar-horizontal",vertical:"simplebar-vertical",hover:"simplebar-hover",dragging:"simplebar-dragging",scrolling:"simplebar-scrolling",scrollable:"simplebar-scrollable",mouseEntered:"simplebar-mouse-entered"},this.options.classNames),this.axis={x:{scrollOffsetAttr:"scrollLeft",sizeAttr:"width",scrollSizeAttr:"scrollWidth",offsetSizeAttr:"offsetWidth",offsetAttr:"left",overflowAttr:"overflowX",dragOffset:0,isOverflowing:!0,isVisible:!1,forceVisible:!1,track:{},scrollbar:{}},y:{scrollOffsetAttr:"scrollTop",sizeAttr:"height",scrollSizeAttr:"scrollHeight",offsetSizeAttr:"offsetHeight",offsetAttr:"top",overflowAttr:"overflowY",dragOffset:0,isOverflowing:!0,isVisible:!1,forceVisible:!1,track:{},scrollbar:{}}},this.removePreventClickId=null,this.isScrolling=!1,this.isMouseEntering=!1,e.instances.has(this.el)||(n.classNames&&console.warn("simplebar: classNames option is deprecated. Please override the styles with CSS instead."),n.autoHide&&console.warn("simplebar: autoHide option is deprecated. Please use CSS instead: '.simplebar-scrollbar::before { opacity: 0.5 };' for autoHide: false"),this.onMouseMove=(0,o.default)(this.onMouseMove,64),this.onWindowResize=(0,i.default)(this.onWindowResize,64,{leading:!0}),this.onStopScrolling=(0,i.default)(this.onStopScrolling,this.stopScrollDelay),this.onMouseEntered=(0,i.default)(this.onMouseEntered,this.stopScrollDelay),this.init())}return(0,s.default)(e,[{key:"init",value:function(){e.instances.set(this.el,this),c()&&(this.initDOM(),this.rtlHelpers=e.getRtlHelpers(),this.scrollbarWidth=e.getScrollbarWidth(),this.recalculate(),this.initListeners())}},{key:"initDOM",value:function(){var e=this;if(Array.prototype.filter.call(this.el.children,(function(t){return t.classList.contains(e.classNames.wrapper)})).length)this.wrapperEl=this.el.querySelector(".".concat(this.classNames.wrapper)),this.contentWrapperEl=this.options.scrollableNode||this.el.querySelector(".".concat(this.classNames.contentWrapper)),this.contentEl=this.options.contentNode||this.el.querySelector(".".concat(this.classNames.contentEl)),this.offsetEl=this.el.querySelector(".".concat(this.classNames.offset)),this.maskEl=this.el.querySelector(".".concat(this.classNames.mask)),this.placeholderEl=this.findChild(this.wrapperEl,".".concat(this.classNames.placeholder)),this.heightAutoObserverWrapperEl=this.el.querySelector(".".concat(this.classNames.heightAutoObserverWrapperEl)),this.heightAutoObserverEl=this.el.querySelector(".".concat(this.classNames.heightAutoObserverEl)),this.axis.x.track.el=this.findChild(this.el,".".concat(this.classNames.track,".").concat(this.classNames.horizontal)),this.axis.y.track.el=this.findChild(this.el,".".concat(this.classNames.track,".").concat(this.classNames.vertical));else{for(this.wrapperEl=document.createElement("div"),this.contentWrapperEl=document.createElement("div"),this.offsetEl=document.createElement("div"),this.maskEl=document.createElement("div"),this.contentEl=document.createElement("div"),this.placeholderEl=document.createElement("div"),this.heightAutoObserverWrapperEl=document.createElement("div"),this.heightAutoObserverEl=document.createElement("div"),this.wrapperEl.classList.add(this.classNames.wrapper),this.contentWrapperEl.classList.add(this.classNames.contentWrapper),this.offsetEl.classList.add(this.classNames.offset),this.maskEl.classList.add(this.classNames.mask),this.contentEl.classList.add(this.classNames.contentEl),this.placeholderEl.classList.add(this.classNames.placeholder),this.heightAutoObserverWrapperEl.classList.add(this.classNames.heightAutoObserverWrapperEl),this.heightAutoObserverEl.classList.add(this.classNames.heightAutoObserverEl);this.el.firstChild;)this.contentEl.appendChild(this.el.firstChild);this.contentWrapperEl.appendChild(this.contentEl),this.offsetEl.appendChild(this.contentWrapperEl),this.maskEl.appendChild(this.offsetEl),this.heightAutoObserverWrapperEl.appendChild(this.heightAutoObserverEl),this.wrapperEl.appendChild(this.heightAutoObserverWrapperEl),this.wrapperEl.appendChild(this.maskEl),this.wrapperEl.appendChild(this.placeholderEl),this.el.appendChild(this.wrapperEl)}if(!this.axis.x.track.el||!this.axis.y.track.el){var t=document.createElement("div"),r=document.createElement("div");t.classList.add(this.classNames.track),r.classList.add(this.classNames.scrollbar),t.appendChild(r),this.axis.x.track.el=t.cloneNode(!0),this.axis.x.track.el.classList.add(this.classNames.horizontal),this.axis.y.track.el=t.cloneNode(!0),this.axis.y.track.el.classList.add(this.classNames.vertical),this.el.appendChild(this.axis.x.track.el),this.el.appendChild(this.axis.y.track.el)}this.axis.x.scrollbar.el=this.axis.x.track.el.querySelector(".".concat(this.classNames.scrollbar)),this.axis.y.scrollbar.el=this.axis.y.track.el.querySelector(".".concat(this.classNames.scrollbar)),this.options.autoHide||(this.axis.x.scrollbar.el.classList.add(this.classNames.visible),this.axis.y.scrollbar.el.classList.add(this.classNames.visible)),this.el.setAttribute("data-simplebar","init")}},{key:"initListeners",value:function(){var e=this,t=f(this.el);if(this.el.addEventListener("mouseenter",this.onMouseEnter),this.el.addEventListener("pointerdown",this.onPointerEvent,!0),this.el.addEventListener("mousemove",this.onMouseMove),this.el.addEventListener("mouseleave",this.onMouseLeave),this.contentWrapperEl.addEventListener("scroll",this.onScroll),t.addEventListener("resize",this.onWindowResize),window.ResizeObserver){var r=!1,n=t.ResizeObserver||ResizeObserver;this.resizeObserver=new n((function(){r&&t.requestAnimationFrame((function(){e.recalculate()}))})),this.resizeObserver.observe(this.el),this.resizeObserver.observe(this.contentEl),t.requestAnimationFrame((function(){r=!0}))}this.mutationObserver=new t.MutationObserver((function(){t.requestAnimationFrame((function(){e.recalculate()}))})),this.mutationObserver.observe(this.contentEl,{childList:!0,subtree:!0,characterData:!0})}},{key:"recalculate",value:function(){var e=f(this.el);this.elStyles=e.getComputedStyle(this.el),this.isRtl="rtl"===this.elStyles.direction;var t=this.contentEl.offsetWidth,r=this.heightAutoObserverEl.offsetHeight<=1,n=this.heightAutoObserverEl.offsetWidth<=1||t>0,a=this.contentWrapperEl.offsetWidth,s=this.elStyles.overflowX,o=this.elStyles.overflowY;this.contentEl.style.padding="".concat(this.elStyles.paddingTop," ").concat(this.elStyles.paddingRight," ").concat(this.elStyles.paddingBottom," ").concat(this.elStyles.paddingLeft),this.wrapperEl.style.margin="-".concat(this.elStyles.paddingTop," -").concat(this.elStyles.paddingRight," -").concat(this.elStyles.paddingBottom," -").concat(this.elStyles.paddingLeft);var i=this.contentEl.scrollHeight,u=this.contentEl.scrollWidth;this.contentWrapperEl.style.height=r?"auto":"100%",this.placeholderEl.style.width=n?"".concat(t||u,"px"):"auto",this.placeholderEl.style.height="".concat(i,"px");var c=this.contentWrapperEl.offsetHeight;this.axis.x.isOverflowing=0!==t&&u>t,this.axis.y.isOverflowing=i>c,this.axis.x.isOverflowing="hidden"!==s&&this.axis.x.isOverflowing,this.axis.y.isOverflowing="hidden"!==o&&this.axis.y.isOverflowing,this.axis.x.forceVisible="x"===this.options.forceVisible||!0===this.options.forceVisible,this.axis.y.forceVisible="y"===this.options.forceVisible||!0===this.options.forceVisible,this.hideNativeScrollbar();var l=this.axis.x.isOverflowing?this.scrollbarWidth:0,d=this.axis.y.isOverflowing?this.scrollbarWidth:0;this.axis.x.isOverflowing=this.axis.x.isOverflowing&&u>a-d,this.axis.y.isOverflowing=this.axis.y.isOverflowing&&i>c-l,this.axis.x.scrollbar.size=this.getScrollbarSize("x"),this.axis.y.scrollbar.size=this.getScrollbarSize("y"),this.axis.x.scrollbar.el.style.width="".concat(this.axis.x.scrollbar.size,"px"),this.axis.y.scrollbar.el.style.height="".concat(this.axis.y.scrollbar.size,"px"),this.positionScrollbar("x"),this.positionScrollbar("y"),this.toggleTrackVisibility("x"),this.toggleTrackVisibility("y")}},{key:"getScrollbarSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";if(!this.axis[e].isOverflowing)return 0;var t,r=this.contentEl[this.axis[e].scrollSizeAttr],n=this.axis[e].track.el[this.axis[e].offsetSizeAttr],a=n/r;return t=Math.max(~~(a*n),this.options.scrollbarMinSize),this.options.scrollbarMaxSize&&(t=Math.min(t,this.options.scrollbarMaxSize)),t}},{key:"positionScrollbar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";if(this.axis[t].isOverflowing){var r=this.contentWrapperEl[this.axis[t].scrollSizeAttr],n=this.axis[t].track.el[this.axis[t].offsetSizeAttr],a=parseInt(this.elStyles[this.axis[t].sizeAttr],10),s=this.axis[t].scrollbar,o=this.contentWrapperEl[this.axis[t].scrollOffsetAttr],i=(o="x"===t&&this.isRtl&&e.getRtlHelpers().isScrollOriginAtZero?-o:o)/(r-a),u=~~((n-s.size)*i);u="x"===t&&this.isRtl&&e.getRtlHelpers().isScrollingToNegative?-u+(n-s.size):u,s.el.style.transform="x"===t?"translate3d(".concat(u,"px, 0, 0)"):"translate3d(0, ".concat(u,"px, 0)")}}},{key:"toggleTrackVisibility",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y",t=this.axis[e].track.el,r=this.axis[e].scrollbar.el;this.axis[e].isOverflowing||this.axis[e].forceVisible?(t.style.visibility="visible",this.contentWrapperEl.style[this.axis[e].overflowAttr]="scroll",this.el.classList.add("".concat(this.classNames.scrollable,"-").concat(e))):(t.style.visibility="hidden",this.contentWrapperEl.style[this.axis[e].overflowAttr]="hidden",this.el.classList.remove("".concat(this.classNames.scrollable,"-").concat(e))),this.axis[e].isOverflowing?r.style.display="block":r.style.display="none"}},{key:"hideNativeScrollbar",value:function(){this.offsetEl.style[this.isRtl?"left":"right"]=this.axis.y.isOverflowing||this.axis.y.forceVisible?"-".concat(this.scrollbarWidth,"px"):0,this.offsetEl.style.bottom=this.axis.x.isOverflowing||this.axis.x.forceVisible?"-".concat(this.scrollbarWidth,"px"):0}},{key:"onMouseMoveForAxis",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";this.axis[e].track.rect=this.axis[e].track.el.getBoundingClientRect(),this.axis[e].scrollbar.rect=this.axis[e].scrollbar.el.getBoundingClientRect();var t=this.isWithinBounds(this.axis[e].scrollbar.rect);t?this.axis[e].scrollbar.el.classList.add(this.classNames.hover):this.axis[e].scrollbar.el.classList.remove(this.classNames.hover),this.isWithinBounds(this.axis[e].track.rect)?this.axis[e].track.el.classList.add(this.classNames.hover):this.axis[e].track.el.classList.remove(this.classNames.hover)}},{key:"onMouseLeaveForAxis",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";this.axis[e].track.el.classList.remove(this.classNames.hover),this.axis[e].scrollbar.el.classList.remove(this.classNames.hover)}},{key:"onDragStart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y",r=h(this.el),n=f(this.el),a=this.axis[t].scrollbar,s="y"===t?e.pageY:e.pageX;this.axis[t].dragOffset=s-a.rect[this.axis[t].offsetAttr],this.draggedAxis=t,this.el.classList.add(this.classNames.dragging),r.addEventListener("mousemove",this.drag,!0),r.addEventListener("mouseup",this.onEndDrag,!0),null===this.removePreventClickId?(r.addEventListener("click",this.preventClick,!0),r.addEventListener("dblclick",this.preventClick,!0)):(n.clearTimeout(this.removePreventClickId),this.removePreventClickId=null)}},{key:"onTrackClick",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";if(this.options.clickOnTrack){e.preventDefault();var n=f(this.el);this.axis[r].scrollbar.rect=this.axis[r].scrollbar.el.getBoundingClientRect();var a=this.axis[r].scrollbar,s=a.rect[this.axis[r].offsetAttr],o=parseInt(this.elStyles[this.axis[r].sizeAttr],10),i=this.contentWrapperEl[this.axis[r].scrollOffsetAttr],u="y"===r?this.mouseY-s:this.mouseX-s,c=u<0?-1:1,l=-1===c?i-o:i+o,d=40,p=function e(){-1===c?i>l&&(i-=d,t.contentWrapperEl[t.axis[r].scrollOffsetAttr]=i,n.requestAnimationFrame(e)):i<l&&(i+=d,t.contentWrapperEl[t.axis[r].scrollOffsetAttr]=i,n.requestAnimationFrame(e))};p()}}},{key:"getContentElement",value:function(){return this.contentEl}},{key:"getScrollElement",value:function(){return this.contentWrapperEl}},{key:"removeListeners",value:function(){var e=f(this.el);this.el.removeEventListener("mouseenter",this.onMouseEnter),this.el.removeEventListener("pointerdown",this.onPointerEvent,!0),this.el.removeEventListener("mousemove",this.onMouseMove),this.el.removeEventListener("mouseleave",this.onMouseLeave),this.contentWrapperEl&&this.contentWrapperEl.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onWindowResize),this.mutationObserver&&this.mutationObserver.disconnect(),this.resizeObserver&&this.resizeObserver.disconnect(),this.onMouseMove.cancel(),this.onWindowResize.cancel(),this.onStopScrolling.cancel(),this.onMouseEntered.cancel()}},{key:"unMount",value:function(){this.removeListeners(),e.instances.delete(this.el)}},{key:"isWithinBounds",value:function(e){return this.mouseX>=e.left&&this.mouseX<=e.left+e.width&&this.mouseY>=e.top&&this.mouseY<=e.top+e.height}},{key:"findChild",value:function(e,t){var r=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;return Array.prototype.filter.call(e.children,(function(e){return r.call(e,t)}))[0]}}],[{key:"getRtlHelpers",value:function(){if(e.rtlHelpers)return e.rtlHelpers;var t=document.createElement("div");t.innerHTML='<div class="simplebar-dummy-scrollbar-size"><div></div></div>';var r=t.firstElementChild,n=r.firstElementChild;document.body.appendChild(r),r.scrollLeft=0;var a=e.getOffset(r),s=e.getOffset(n);r.scrollLeft=-999;var o=e.getOffset(n);return document.body.removeChild(r),e.rtlHelpers={isScrollOriginAtZero:a.left!==s.left,isScrollingToNegative:s.left!==o.left},e.rtlHelpers}},{key:"getScrollbarWidth",value:function(){try{return"none"===getComputedStyle(this.contentWrapperEl,"::-webkit-scrollbar").display||"scrollbarWidth"in document.documentElement.style||"-ms-overflow-style"in document.documentElement.style?0:p()}catch(e){return p()}}},{key:"getOffset",value:function(e){var t=e.getBoundingClientRect(),r=h(e),n=f(e);return{top:t.top+(n.pageYOffset||r.documentElement.scrollTop),left:t.left+(n.pageXOffset||r.documentElement.scrollLeft)}}}]),e}();m.defaultOptions={autoHide:!0,forceVisible:!1,clickOnTrack:!0,scrollbarMinSize:25,scrollbarMaxSize:0},m.instances=new WeakMap;const g=m},804590:(e,t,r)=>{"use strict";r.d(t,{default:()=>f});var n=r(722122),a=r(896156),s=r(781253),o=r(667294),i=r(45697),u=r.n(i),c=r(39352);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=o.forwardRef((function(e,t){var r=e.children,a=e.scrollableNodeProps,i=void 0===a?{}:a,u=(0,s.default)(e,["children","scrollableNodeProps"]),l=(0,o.useRef)(),p=(0,o.useRef)(),f=(0,o.useRef)(),h={},v={};return Object.keys(u).forEach((function(e){Object.prototype.hasOwnProperty.call(c.default.defaultOptions,e)?h[e]=u[e]:v[e]=u[e]})),(0,o.useEffect)((function(){var e;return l.current=i.ref?i.ref.current:l.current,p.current&&(e=new c.default(p.current,d(d(d({},h),l&&{scrollableNode:l.current}),f.current&&{contentNode:f.current})),t&&(t.current=e)),function(){e.unMount(),e=null}}),[]),o.createElement("div",(0,n.default)({ref:p,"data-simplebar":!0},v),o.createElement("div",{className:"simplebar-wrapper"},o.createElement("div",{className:"simplebar-height-auto-observer-wrapper"},o.createElement("div",{className:"simplebar-height-auto-observer"})),o.createElement("div",{className:"simplebar-mask"},o.createElement("div",{className:"simplebar-offset"},"function"==typeof r?r({scrollableNodeRef:l,contentNodeRef:f}):o.createElement("div",(0,n.default)({},i,{className:"simplebar-content-wrapper".concat(i.className?" ".concat(i.className):"")}),o.createElement("div",{className:"simplebar-content"},r)))),o.createElement("div",{className:"simplebar-placeholder"})),o.createElement("div",{className:"simplebar-track simplebar-horizontal"},o.createElement("div",{className:"simplebar-scrollbar"})),o.createElement("div",{className:"simplebar-track simplebar-vertical"},o.createElement("div",{className:"simplebar-scrollbar"})))}));p.displayName="SimpleBar",p.propTypes={children:u().oneOfType([u().node,u().func]),scrollableNodeProps:u().object};const f=p},277165:(e,t,r)=>{"use strict";r.d(t,{Player:()=>d});var n=r(28991),a=r(306610),s=r(5991),o=r(110379),i=r(460446),u=r(995420),c=r(753985),l="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",d=function(e){(0,o.default)(r,e);var t=(0,i.default)(r);function r(e){var s;return(0,a.default)(this,r),(s=t.call(this)).state=e,s.player=document.createElement("audio"),s.player.volume=e.volume/100,s.player.src=l,s.player.playbackRate=e.playbackRate,s.player.addEventListener("ended",(function(){var e=s.state.currentTrackEntity;if(null==e?void 0:e.audioTrack){var t=(0,n.default)((0,n.default)({},s.state),{},{status:"ended"});s.setState(t),s.stopCurrentTrackAutomatically(),s.startNextTrackAutomatically()}})),s.player.addEventListener("error",(function(){s.stopCurrentTrackByError()})),s.player.addEventListener("timeupdate",(function(){var e,t=(0,n.default)({},s.state);if(null!==(e=t.currentTrackEntity)&&void 0!==e&&e.audioTrack){var r=s.player,a=r.currentTime,o=r.duration,i=t.currentTrackEntity.audioTrack,u=i.duration,c=i.progress,l=i.id,d=a/u;d>0&&(t.playedTimeAccumulator[l]=function(e){for(var t=e.played,r=0,n=0;n<t.length;n++)r+=t.end(n)-t.start(n);return r}(s.player)),s.setState((0,n.default)((0,n.default)({},t),{},{currentTrackEntity:(0,n.default)((0,n.default)({},t.currentTrackEntity),{},{audioTrack:(0,n.default)((0,n.default)({},t.currentTrackEntity.audioTrack),{},{progress:d>1?1:d})})})),o===1/0&&(0===d&&0!==c||d>1)&&s.player.dispatchEvent(new Event("ended"))}})),s}return(0,s.default)(r,[{key:"play",value:function(e,t){var r,n;(null===(r=this.state.currentTrackEntity)||void 0===r||null===(n=r.audioTrack)||void 0===n?void 0:n.url)!==e.audioTrack.url?("stopped"!==this.state.status&&this.stopCurrentTrackBeforeStartingNewTrack(),this.startNewTrack(e,t)):"stopped"===this.state.status?this.repeateCurrentTrack(e,t):"paused"===this.state.status?this.resumeTrack(e,t):this.player.currentTime=e.audioTrack.duration*e.audioTrack.progress}},{key:"playNext",value:function(e,t){var r=this.getState(),n=r.shuffle,a=r.repeatMode,s=t.getNext(e,n,a);s&&this.play(s,t)}},{key:"playPrev",value:function(e,t){var r=this.getState(),n=r.shuffle,a=r.repeatMode,s=t.getPrev(e,n,a);s&&this.play(s,t)}},{key:"pause",value:function(){var e=this.state,t=e.currentTrackEntity,r=e.playlist,a=e.playedTimeAccumulator,s=null==t?void 0:t.audioTrack;if(s){var o=this.player.currentTime,i=s.duration,u=(0,n.default)((0,n.default)({},this.state),{},{status:"paused",playlist:r,playedTimeAccumulator:a,currentTrackEntity:(0,n.default)((0,n.default)({},t),{},{audioTrack:(0,n.default)((0,n.default)({},s),{},{progress:o/i})})});this.setState(u),this.player.pause();var l={state:u};this.emit(c.PlayerEventTypes.PAUSE_CURRENT_TRACK,l)}}},{key:"resume",value:function(){var e=this.state,t=e.currentTrackEntity,r=e.playlist;(null==t?void 0:t.audioTrack)&&this.resumeTrack(t,r)}},{key:"resetCurrentTrackState",value:function(){var e=this.state,t=e.currentTrackEntity,r=e.playlist,a=e.playedTimeAccumulator,s=null==t?void 0:t.audioTrack;if(s){var o=(0,n.default)((0,n.default)({},this.state),{},{status:"stopped",playlist:r,playedTimeAccumulator:a,currentTrackEntity:(0,n.default)((0,n.default)({},t),{},{audioTrack:(0,n.default)((0,n.default)({},s),{},{progress:0})})});this.setState(o)}}},{key:"startNewTrack",value:function(e,t){var r=this.getState(),a=(0,n.default)((0,n.default)({},r),{},{status:"playing",playlist:t,playedTimeAccumulator:{},currentTrackEntity:e});this.setState(a);var s={state:a};this.emit(c.PlayerEventTypes.START_NEW_TRACK,s);var o=e.audioTrack.url,i=e.audioTrack.duration*e.audioTrack.progress;this.playHTML5Player(o,i)}},{key:"resumeTrack",value:function(e,t){var r,a,s,o,i,u=this.getState(),l=(0,n.default)((0,n.default)({},u),{},{status:"playing",playlist:t,playedTimeAccumulator:u.playedTimeAccumulator,currentTrackEntity:e}),d=null===(r=u.currentTrackEntity)||void 0===r||null===(a=r.audioTrack)||void 0===a?void 0:a.url;this.player.duration!==1/0&&(null===(s=this.state.currentTrackEntity)||void 0===s||null===(o=s.audioTrack)||void 0===o?void 0:o.progress)!==e.audioTrack.progress&&(i=e.audioTrack.duration*e.audioTrack.progress),this.setState(l);var p={state:l};this.emit(c.PlayerEventTypes.RESUME_TRACK,p),this.playHTML5Player(d,i)}},{key:"repeateCurrentTrack",value:function(e,t){this.startNewTrack(e,t)}},{key:"startNextTrackAutomatically",value:function(){var e=this.getState(),t=e.playlist,r=e.currentTrackEntity,a=e.repeatMode,s=e.shuffle,o={state:e};if(t&&r){var i="one"===a?(0,n.default)((0,n.default)({},r),{},{audioTrack:(0,n.default)((0,n.default)({},r.audioTrack),{},{progress:0})}):t.getNext(r,s,a);if(i){var u=(0,n.default)((0,n.default)({},e),{},{status:"playing",playlist:t,playedTimeAccumulator:{},currentTrackEntity:i});this.setState(u),o={state:u},this.emit(c.PlayerEventTypes.START_NEXT_TRACK_AUTOMATICALLY,o);var l=i.audioTrack.url,d=i.audioTrack.duration*i.audioTrack.progress;this.playHTML5Player(l,d)}else this.emit(c.PlayerEventTypes.PLAYLIST_ENDED,o)}else this.emit(c.PlayerEventTypes.PLAYLIST_ENDED,o)}},{key:"stopCurrentTrackAutomatically",value:function(){if(this.state.currentTrackEntity){var e={state:(0,n.default)({},this.state)};this.emit(c.PlayerEventTypes.STOP_CURRENT_TRACK_AUTOMATICALLY,e),this.resetCurrentTrackState(),this.player.duration===1/0&&(this.player.src="")}}},{key:"stopCurrentTrackBeforeStartingNewTrack",value:function(){var e=this.state,t=e.currentTrackEntity,r=e.status,a=null==t?void 0:t.audioTrack;if(a&&"playing"===r){this.player.pause();var s={state:(0,n.default)((0,n.default)({},this.state),{},{status:"stopped"})};this.emit(c.PlayerEventTypes.STOP_CURRENT_TRACK_BEFORE_STARTING_NEW_TRACK,s),this.resetCurrentTrackState()}else a&&"paused"===r&&this.resetCurrentTrackState()}},{key:"stopCurrentTrackByError",value:function(){var e=this.state.currentTrackEntity;if(null==e?void 0:e.audioTrack){this.resetCurrentTrackState();var t={state:this.state};this.emit(c.PlayerEventTypes.STOP_CURRENT_TRACK_BY_ERROR,t)}}},{key:"stopPlayer",value:function(){var e;null!==(e=this.state.currentTrackEntity)&&void 0!==e&&e.audioTrack&&(this.pause(),this.resetCurrentTrackState(),this.setState((0,n.default)((0,n.default)({},this.state),{},{currentTrackEntity:void 0,playlist:void 0})))}},{key:"seek",value:function(e){var t=this.getState(),r=t.currentTrackEntity,a=null==r?void 0:r.audioTrack;if(a){var s=(0,n.default)((0,n.default)({},t),{},{currentTrackEntity:(0,n.default)((0,n.default)({},r),{},{audioTrack:(0,n.default)((0,n.default)({},a),{},{progress:e})})});this.player.currentTime=a.duration*e,this.setState(s)}}},{key:"setState",value:function(e){this.state=e,this.player.volume=e.volume/100,this.player.muted=e.mute,this.player.playbackRate=e.playbackRate,this.emit("stateupdated",e)}},{key:"getState",value:function(){return(0,n.default)({},this.state)}},{key:"forceUpdate",value:function(e){var t,r;this.setState(e),this.player.src=(null===(t=e.currentTrackEntity)||void 0===t||null===(r=t.audioTrack)||void 0===r?void 0:r.url)||l}},{key:"setVolume",value:function(e){var t=(0,n.default)((0,n.default)({},this.getState()),{},{mute:!1,volume:e});this.setState(t)}},{key:"setMute",value:function(e){var t=(0,n.default)((0,n.default)({},this.getState()),{},{mute:e});this.setState(t)}},{key:"setShuffle",value:function(e){var t=this.getState(),r=(0,n.default)((0,n.default)({},t),{},{shuffle:e});this.setState(r)}},{key:"setRepeatMode",value:function(e){var t=this.getState(),r=(0,n.default)((0,n.default)({},t),{},{repeatMode:e});this.setState(r)}},{key:"setPlaybackRate",value:function(e){var t=this.getState();this.setState((0,n.default)((0,n.default)({},t),{},{playbackRate:e}))}},{key:"playHTML5Player",value:function(e,t){var r=this;"number"==typeof t&&(this.player.currentTime=t),e&&this.player.src!==e&&(this.player.src=e),this.player.play().then((function(){"playing"!==r.getState().status&&r.player.pause(),e&&r.player.src!==e&&r.player.pause()})).catch((function(){r.stopCurrentTrackByError()}))}}]),r}(u.EventEmitter)},565161:(e,t,r)=>{"use strict";r.d(t,{PlayerStorage:()=>c,VoicePlayerStorage:()=>l});var n=r(306610),a=r(5991),s=r(110379),o=r(460446),i=r(617254),u=r(819423),c=function(e){(0,s.default)(r,e);var t=(0,o.default)(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,a.default)(r,[{key:"getPlaylist",value:function(){var e=this.get("reforged_audio_player_playlist");if(e&&(0,u.isRestoredConvoAudiosPlaylist)(e))return new u.ConvoAudiosPlaylist(e)}},{key:"getCurrentTrack",value:function(){var e=this.get("reforged_audio_player_track");if((0,u.isConvoAudioTrack)(e))return e}},{key:"getVolume",value:function(){return this.get("reforged_audio_player_volume")}},{key:"storeVolume",value:function(e){this.set("reforged_audio_player_volume",e)}},{key:"getMute",value:function(){return this.get("reforged_audio_player_mute")}},{key:"storeMute",value:function(e){this.set("reforged_audio_player_mute",e)}},{key:"getShuffle",value:function(){return this.get("reforged_audio_player_shuffle")}},{key:"storeShuffle",value:function(e){this.set("reforged_audio_player_shuffle",e)}},{key:"getRepeatMode",value:function(){return this.get("reforged_audio_player_repeat_mode")}},{key:"storeRepeatMode",value:function(e){this.set("reforged_audio_player_repeat_mode",e)}},{key:"invalidatePlayerStateCache",value:function(){var e=this.get("reforged_audio_player_saved")||0;Date.now()-72e5>e&&(this.del("reforged_audio_player_playlist"),this.del("reforged_audio_player_saved"),this.del("reforged_audio_player_track"))}},{key:"restorePlayerState",value:function(){this.invalidatePlayerStateCache();var e=this.getVolume()||100,t=this.getMute()||!1,r=this.getShuffle()||!1,n=this.getRepeatMode()||"none";return{status:"stopped",playedTimeAccumulator:{},currentTrackEntity:this.getCurrentTrack(),playlist:this.getPlaylist(),volume:e,mute:t,shuffle:r,repeatMode:n,playbackRate:1}}},{key:"storePlayerState",value:function(e){var t=e.currentTrackEntity,r=e.playlist,n=e.volume;this.set("reforged_audio_player_saved",Date.now()),this.set("reforged_audio_player_volume",n),t?this.set("reforged_audio_player_track",t):this.del("reforged_audio_player_track"),r?r instanceof u.ConvoAudiosPlaylist&&this.set("reforged_audio_player_playlist",{meta:r.getPlaylistMeta(),list:r.getConvoAudiosList()}):this.del("reforged_audio_player_playlist")}}]),r}(i.Storage),l=function(e){(0,s.default)(r,e);var t=(0,o.default)(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,a.default)(r,[{key:"getVolume",value:function(){return this.get("reforged_voice_player_volume")}},{key:"storeVolume",value:function(e){this.set("reforged_voice_player_volume",e)}},{key:"getMute",value:function(){return this.get("reforged_voice_player_mute")}},{key:"storeMute",value:function(e){this.set("reforged_voice_player_mute",e)}},{key:"getPlaybackRate",value:function(){return this.get("reforged_voice_player_playback_rate")}},{key:"storePlaybackRate",value:function(e){this.set("reforged_voice_player_playback_rate",e)}},{key:"restorePlayerState",value:function(){return{status:"stopped",playedTimeAccumulator:{},volume:this.getVolume()||100,mute:this.getMute()||!1,shuffle:!1,repeatMode:"none",playbackRate:this.getPlaybackRate()||1}}}]),r}(i.Storage)},371820:(e,t,r)=>{"use strict";r.d(t,{BroadcastChannel:()=>d});var n=r(306610),a=r(5991),s=r(663349),o=r(110379),i=r(460446),u=r(805533),c=r(777608),l=r(995420),d=function(e){(0,o.default)(r,e);var t=(0,i.default)(r);function r(){var e,a;return(0,n.default)(this,r),(a=t.call(this)).connectionId="queue_connection_events_queue78668286",window.addEventListener("storage",(function(t){try{if(t.key===a.connectionId&&t.newValue){var n=JSON.parse(t.newValue),o=null==n?void 0:n.__act;o&&(0,u.default)((e=(0,s.default)(a),(0,c.default)(r.prototype)),"emit",e).call(e,o)}}catch(e){}})),a}return(0,a.default)(r,[{key:"emit",value:function(e){var t=this.connectionId,r=JSON.stringify(function(e){return{__act:e}}(e));window.localStorage.removeItem(t),window.localStorage.setItem(t,r)}},{key:"emitLocally",value:function(e,t){(0,u.default)((0,c.default)(r.prototype),"emit",this).call(this,e,t)}}]),r}(l.EventEmitter)},817170:(e,t,r)=>{"use strict";r.d(t,{ExternalEvents:()=>i});var n=r(111965),a=r(5991),s=r(306610),o=r(896156),i=(0,a.default)((function e(){var t=this;(0,s.default)(this,e),(0,o.default)(this,"listeners",[]),(0,o.default)(this,"send",(function(e,r){var a,s=(0,n.default)(t.listeners);try{for(s.s();!(a=s.n()).done;){(0,a.value)(e,r)}}catch(e){s.e(e)}finally{s.f()}})),(0,o.default)(this,"subscribe",(function(e){return t.listeners.push(e),function(){t.listeners=t.listeners.filter((function(t){return t!==e}))}}))}))},879161:(e,t,r)=>{"use strict";r.d(t,{MEAppMediaMediator:()=>i});var n=r(5991),a=r(306610),s=r(896156),o=r(371820),i=(0,n.default)((function e(){var t=this;(0,a.default)(this,e),(0,s.default)(this,"broadcastChannel",new o.BroadcastChannel),(0,s.default)(this,"player",null),(0,s.default)(this,"voicePlayer",null),(0,s.default)(this,"videoMessagePlayer",null),(0,s.default)(this,"currentMedia",null),(0,s.default)(this,"prevMedia",null),(0,s.default)(this,"destroy",(function(){t.currentMedia=null,t.prevMedia=null,t.player=null,t.voicePlayer=null,t.videoMessagePlayer=null,t.broadcastChannel.unsubscribe("audio_start",t.pauseCurrentMedia),t.broadcastChannel.unsubscribe("video_message_start",t.pauseCurrentMedia),t.broadcastChannel.unsubscribe("stories_video_start",t.pauseCurrentMedia)})),(0,s.default)(this,"pauseCurrentMedia",(function(){var e;null!==(e=t.currentMedia)&&void 0!==e&&e.isPlaying()&&t.currentMedia.handleMediaMediatorPause()})),(0,s.default)(this,"handlePlayerOn",(function(e){if(t.broadcastChannel.emit("audio_start"),t.player=e,t.currentMedia){if(t.currentMedia&&t.currentMedia!==t.player){t.currentMedia.isPlaying()?(t.currentMedia.handleMediaMediatorPause(),t.prevMedia=t.currentMedia,t.currentMedia=t.player):(t.prevMedia=null,t.currentMedia=t.player)}}else t.prevMedia=null,t.currentMedia=t.player})),(0,s.default)(this,"handleVoicePlayerOn",(function(e){if(t.broadcastChannel.emit("audio_start"),t.voicePlayer=e,t.currentMedia){if(t.currentMedia&&t.currentMedia!==t.voicePlayer){t.currentMedia.isPlaying()?(t.currentMedia.handleMediaMediatorPause(),t.prevMedia=t.currentMedia,t.currentMedia=t.voicePlayer):(t.prevMedia=null,t.currentMedia=t.voicePlayer)}}else t.prevMedia=null,t.currentMedia=t.voicePlayer})),(0,s.default)(this,"handleVoicePlayerOff",(function(e){t.voicePlayer=e,t.currentMedia&&t.currentMedia===t.voicePlayer&&(t.currentMedia=null,t.prevMedia&&(t.prevMedia.handleMediaMediatorResume(),t.currentMedia=t.prevMedia,t.prevMedia=null))})),(0,s.default)(this,"handleVideoMessagePlayerOn",(function(e){if(t.broadcastChannel.emit("video_message_start"),t.videoMessagePlayer=e,t.currentMedia){if(t.currentMedia&&t.currentMedia!==t.videoMessagePlayer){t.currentMedia.isPlaying()?(t.currentMedia.handleMediaMediatorPause(),t.prevMedia=t.currentMedia,t.currentMedia=t.videoMessagePlayer):(t.prevMedia=null,t.currentMedia=t.videoMessagePlayer)}}else t.prevMedia=null,t.currentMedia=t.videoMessagePlayer})),(0,s.default)(this,"handleVideoMessagePlayerOff",(function(e){t.videoMessagePlayer=e,t.currentMedia&&t.currentMedia===t.videoMessagePlayer&&(t.currentMedia=null,t.prevMedia&&(t.prevMedia.handleMediaMediatorResume(),t.currentMedia=t.prevMedia,t.prevMedia=null))})),(0,s.default)(this,"handleVoiceRecorderOn",(function(){if(t.broadcastChannel.emit("audio_start"),t.currentMedia||t.prevMedia!==t.player)if(t.currentMedia){if(t.currentMedia){t.currentMedia.isPlaying()?(t.currentMedia.handleMediaMediatorPause(),t.prevMedia=t.currentMedia,t.currentMedia=null):(t.prevMedia=null,t.currentMedia=null)}}else t.prevMedia=null,t.currentMedia=null})),(0,s.default)(this,"handleVoiceRecorderOff",(function(){t.prevMedia&&t.prevMedia===t.player?(t.prevMedia.handleMediaMediatorResume(),t.currentMedia=t.prevMedia,t.prevMedia=null):(t.currentMedia=null,t.prevMedia=null)})),this.broadcastChannel.subscribe("audio_start",this.pauseCurrentMedia),this.broadcastChannel.subscribe("video_message_start",this.pauseCurrentMedia),this.broadcastChannel.subscribe("stories_video_start",this.pauseCurrentMedia)}))},551625:(e,t,r)=>{"use strict";r.d(t,{MEAppPlayer:()=>m,MEAppVoicePlayer:()=>g,MEAppVideoMessagePlayer:()=>b});var n=r(28991),a=r(306610),s=r(5991),o=r(663349),i=r(805533),u=r(777608),c=r(110379),l=r(460446),d=r(896156),p=r(277165),f=r(477519),h=r(565161),v=r(753985),y=r(190831),m=function(e){(0,c.default)(r,e);var t=(0,l.default)(r);function r(e){var s;return(0,a.default)(this,r),s=t.call(this,{status:"stopped",playedTimeAccumulator:{},volume:100,mute:!1,shuffle:!1,repeatMode:"none",playbackRate:1}),(0,d.default)((0,o.default)(s),"init",(function(e){s.playerStorage=new h.PlayerStorage(y.STORAGE_DB_NAME),s.playerStorage.identify(e);var t=s.playerStorage.restorePlayerState();s.forceUpdate(t)})),s.subscribe(v.PlayerEventTypes.START_NEW_TRACK,(function(e){s.playerStorage.storePlayerState((0,n.default)((0,n.default)({},e.state),{},{status:"stopped"}))})),s.subscribe(v.PlayerEventTypes.START_NEXT_TRACK_AUTOMATICALLY,(function(e){s.playerStorage.storePlayerState((0,n.default)((0,n.default)({},e.state),{},{status:"stopped"}))})),s.mediaMediator=e,s}return(0,s.default)(r,[{key:"play",value:function(e,t){return this.mediaMediator.handlePlayerOn(this),(0,i.default)((0,u.default)(r.prototype),"play",this).call(this,e,t)}},{key:"setVolume",value:function(e){(0,i.default)((0,u.default)(r.prototype),"setVolume",this).call(this,e);var t=this.getState(),n=t.volume,a=t.mute;this.playerStorage.storeVolume(n),this.playerStorage.storeMute(a)}},{key:"setMute",value:function(e){(0,i.default)((0,u.default)(r.prototype),"setMute",this).call(this,e);var t=this.getState(),n=t.volume,a=t.mute;this.playerStorage.storeVolume(n),this.playerStorage.storeMute(a)}},{key:"setShuffle",value:function(e){(0,i.default)((0,u.default)(r.prototype),"setShuffle",this).call(this,e);var t=this.getState().shuffle;this.playerStorage.storeShuffle(t)}},{key:"setRepeatMode",value:function(e){(0,i.default)((0,u.default)(r.prototype),"setRepeatMode",this).call(this,e);var t=this.getState().repeatMode;this.playerStorage.storeRepeatMode(t)}},{key:"stopPlayer",value:function(){(0,i.default)((0,u.default)(r.prototype),"stopPlayer",this).call(this);var e=this.getState();this.playerStorage.storePlayerState((0,n.default)((0,n.default)({},e),{},{status:"stopped"}))}},{key:"isPlaying",value:function(){return"playing"===this.getState().status}},{key:"handleMediaMediatorResume",value:function(){(0,i.default)((0,u.default)(r.prototype),"resume",this).call(this)}},{key:"handleMediaMediatorPause",value:function(){(0,i.default)((0,u.default)(r.prototype),"pause",this).call(this)}}]),r}(p.Player),g=function(e){(0,c.default)(r,e);var t=(0,l.default)(r);function r(e){var n,s;return(0,a.default)(this,r),s=t.call(this,{status:"stopped",playedTimeAccumulator:{},volume:100,mute:!1,shuffle:!1,repeatMode:"none",playbackRate:1}),(0,d.default)((0,o.default)(s),"init",(function(e){s.playerStorage=new h.VoicePlayerStorage(y.STORAGE_DB_NAME),s.playerStorage.identify(e);var t=s.playerStorage.restorePlayerState();s.forceUpdate(t)})),(0,d.default)((0,o.default)(s),"pause",(function(){(0,i.default)((n=(0,o.default)(s),(0,u.default)(r.prototype)),"pause",n).call(n),s.mediaMediator.handleVoicePlayerOff((0,o.default)(s))})),s.mediaMediator=e,s.subscribe(v.PlayerEventTypes.PLAYLIST_ENDED,(function(){return s.mediaMediator.handleVoicePlayerOff((0,o.default)(s))})),s}return(0,s.default)(r,[{key:"setVolume",value:function(e){var t,n;(0,i.default)((0,u.default)(r.prototype),"setVolume",this).call(this,e);var a=this.getState(),s=a.volume,o=a.mute;null===(t=this.playerStorage)||void 0===t||t.storeVolume(s),null===(n=this.playerStorage)||void 0===n||n.storeMute(o)}},{key:"setMute",value:function(e){var t,n;(0,i.default)((0,u.default)(r.prototype),"setMute",this).call(this,e);var a=this.getState(),s=a.volume,o=a.mute;null===(t=this.playerStorage)||void 0===t||t.storeVolume(s),null===(n=this.playerStorage)||void 0===n||n.storeMute(o)}},{key:"setPlaybackRate",value:function(e){var t;(0,i.default)((0,u.default)(r.prototype),"setPlaybackRate",this).call(this,e);var n=this.getState().playbackRate;null===(t=this.playerStorage)||void 0===t||t.storePlaybackRate(n)}},{key:"play",value:function(e,t){return this.mediaMediator.handleVoicePlayerOn(this),(0,i.default)((0,u.default)(r.prototype),"play",this).call(this,e,t)}},{key:"isPlaying",value:function(){return"playing"===this.getState().status}},{key:"handleMediaMediatorResume",value:function(){(0,i.default)((0,u.default)(r.prototype),"resume",this).call(this)}},{key:"handleMediaMediatorPause",value:function(){(0,i.default)((0,u.default)(r.prototype),"pause",this).call(this)}}]),r}(p.Player),b=function(e){(0,c.default)(r,e);var t=(0,l.default)(r);function r(e){var n,s;return(0,a.default)(this,r),s=t.call(this,{status:"stopped",settings:{volume:1,playbackRate:1,muted:!1}}),(0,d.default)((0,o.default)(s),"pause",(function(){(0,i.default)((n=(0,o.default)(s),(0,u.default)(r.prototype)),"pause",n).call(n),s.mediaMediator.handleVideoMessagePlayerOff((0,o.default)(s))})),s.mediaMediator=e,s}return(0,s.default)(r,[{key:"play",value:function(e,t){this.mediaMediator.handleVideoMessagePlayerOn(this),(0,i.default)((0,u.default)(r.prototype),"play",this).call(this,e,t)}},{key:"resume",value:function(){this.mediaMediator.handleVideoMessagePlayerOn(this),(0,i.default)((0,u.default)(r.prototype),"resume",this).call(this)}},{key:"stop",value:function(){this.mediaMediator.handleVideoMessagePlayerOff(this),(0,i.default)((0,u.default)(r.prototype),"stop",this).call(this)}},{key:"destroy",value:function(){this.mediaMediator.destroy()}},{key:"isPlaying",value:function(){return"playing"===this.getState().status}},{key:"handleMediaMediatorResume",value:function(){(0,i.default)((0,u.default)(r.prototype),"resume",this).call(this)}},{key:"handleMediaMediatorPause",value:function(){(0,i.default)((0,u.default)(r.prototype),"pause",this).call(this)}}]),r}(f.VideoMessagePlayer)},617254:(e,t,r)=>{"use strict";r.d(t,{Storage:()=>d});var n=r(190484),a=r(692137),s=r(306610),o=r(5991),i=r(896156),u=r(887757),c=r.n(u),l=r(891047),d=function(){function e(t){var r=this;(0,s.default)(this,e),(0,i.default)(this,"idbStoreName","storage"),(0,i.default)(this,"identify",(function(e){r.viewerPeerId=e})),(0,i.default)(this,"get",(function(e){var t=r.mapKey(e);try{var n=localStorage.getItem(t);if(!n)return;return JSON.parse(n,f)}catch(e){return}})),(0,i.default)(this,"set",(function(e,t){var n=r.mapKey(e);try{localStorage.setItem(n,JSON.stringify(t,p))}catch(e){}})),(0,i.default)(this,"del",(function(e){var t=r.mapKey(e);try{localStorage.removeItem(t)}catch(e){}})),(0,i.default)(this,"getIDB",function(){var e=(0,a.default)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.mapKey(t),e.next=3,l.get(n,r.idbStorage);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,i.default)(this,"setIDB",function(){var e=(0,a.default)(c().mark((function e(t,n){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.mapKey(t),e.next=3,l.set(a,n,r.idbStorage);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),(0,i.default)(this,"delIDB",function(){var e=(0,a.default)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.mapKey(t),e.next=3,l.del(n,r.idbStorage);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.dbName=t,this.idbStorage=window.indexedDB&&l.createStore(t,this.idbStoreName)}return(0,o.default)(e,[{key:"mapKey",value:function(e){if(!this.viewerPeerId)throw new Error("Перед использованием Storage должен быть идентифицирован!");return"".concat(this.dbName,"-").concat(this.viewerPeerId,"-").concat(e)}}]),e}();function p(e,t){return t instanceof Map?{dataType:"Map",entries:Array.from(t.entries())}:t instanceof Set?{dataType:"Set",values:Array.from(t.values())}:t}function f(e,t){if("object"===(0,n.default)(t)&&null!==t){if("Map"===t.dataType)return new Map(t.entries);if("Set"===t.dataType)return new Set(t.values)}return t}},477519:(e,t,r)=>{"use strict";r.d(t,{VideoMessagePlayer:()=>d});var n=r(28991),a=r(306610),s=r(5991),o=r(110379),i=r(460446),u=r(995420),c=r(753985),l={volume:1,playbackRate:1},d=function(e){(0,o.default)(r,e);var t=(0,i.default)(r);function r(e){var n;(0,a.default)(this,r),(n=t.call(this)).state=e;var s=localStorage.getItem("videomessage_settings");return n.state.settings=s?JSON.parse(s):l,n}return(0,s.default)(r,[{key:"setVolume",value:function(e){this.setState((0,n.default)((0,n.default)({},this.state),{},{settings:(0,n.default)((0,n.default)({},this.state.settings),{},{muted:!1,volume:e})})),localStorage.setItem("videomessage_settings",JSON.stringify(this.state.settings))}},{key:"setMuted",value:function(e){var t=(0,n.default)((0,n.default)({},this.state),{},{settings:(0,n.default)((0,n.default)({},this.state.settings),{},{muted:e})});this.setState(t)}},{key:"setPlaybackRate",value:function(e){this.setState((0,n.default)((0,n.default)({},this.state),{},{settings:(0,n.default)((0,n.default)({},this.state.settings),{},{playbackRate:e})})),localStorage.setItem("videomessage_settings",JSON.stringify(this.state.settings))}},{key:"stop",value:function(){this.setState((0,n.default)((0,n.default)({},this.state),{},{status:"stopped",currentVideoMessageTrack:void 0}))}},{key:"play",value:function(e,t){this.setState((0,n.default)((0,n.default)({},this.state),{},{status:"playing",convoPeerId:e,currentVideoMessageTrack:t}))}},{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.state.currentVideoMessageTrack){var r=t?e.getPrev(this.state.currentVideoMessageTrack):e.getNext(this.state.currentVideoMessageTrack),n=e.getPlaylistMeta(),a=n.convoPeerId;if(r)return this.play(a,r),this.scrollToMessage(),r;this.stop()}}},{key:"pause",value:function(){this.state.currentVideoMessageTrack&&this.setState((0,n.default)((0,n.default)({},this.state),{},{status:"paused"}))}},{key:"resume",value:function(){this.state.currentVideoMessageTrack&&this.setState((0,n.default)((0,n.default)({},this.state),{},{status:"playing"}))}},{key:"endTrack",value:function(e){this.setState((0,n.default)((0,n.default)({},this.state),{},{status:"ended"})),e?this.move(e):this.stop()}},{key:"setProgress",value:function(e){var t=this.state.currentVideoMessageTrack;t&&this.setState((0,n.default)((0,n.default)({},this.state),{},{currentVideoMessageTrack:(0,n.default)((0,n.default)({},t),{},{progress:e})}))}},{key:"scrollToMessage",value:function(){this.state.currentVideoMessageTrack&&this.emit(c.VideoMessagePlayerEventTypes.SCROLL_TO_MESSAGE,this.state.currentVideoMessageTrack.id)}},{key:"stopCurrentTrackByError",value:function(e){var t=this.state.currentVideoMessageTrack;(null==t?void 0:t.id)===e&&this.setState((0,n.default)((0,n.default)({},this.state),{},{status:"stopped",currentVideoMessageTrack:(0,n.default)((0,n.default)({},t),{},{progress:0})}))}},{key:"setState",value:function(e){this.state=e,this.emit(c.VideoMessagePlayerEventTypes.STATE_UPDATED,e)}},{key:"getState",value:function(){return this.state}},{key:"forceUpdate",value:function(e){this.setState(e)}}]),r}(u.EventEmitter)},26003:(e,t,r)=>{"use strict";r.d(t,{searchConversations:()=>d,searchMessages:()=>f,searchUsersGlobal:()=>v});var n=r(28991),a=r(692137),s=r(887757),o=r.n(s),i=r(975474),u=r(314432),c=r(341570),l=r(190831);function d(e,t,r,n){return p.apply(this,arguments)}function p(){return(p=(0,a.default)(o().mark((function e(t,r,n,a){var s,u,c,d,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("messages.searchConversations",{q:n,count:l.SEARCH_CONVOS_COUNT,extended:1,group_id:a});case 2:return s=e.sent,u=s.profiles,c=s.groups,d=s.items,p=s.contacts,r({profiles:u,groups:c,conversations:d,contacts:p}),e.abrupt("return",d.reduce((function(e,t){var r=(0,i.fromApiConvo)(t);return r&&e.add(r.convo.peerId),e}),new Set));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,t,r,n){return h.apply(this,arguments)}function h(){return(h=(0,a.default)(o().mark((function e(t,r,a,s){var i,u,d,p,f,h,v,y;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("messages.search",(0,n.default)((0,n.default)({},s),{},{extended:1,count:l.SEARCH_MESSAGES_COUNT}));case 2:return i=e.sent,u=i.items,d=i.count,p=i.conversations,f=i.contacts,h=i.profiles,v=i.groups,a({profiles:h,groups:v,conversations:p,contacts:f}),y=u.reduce((function(e,t){var n=(0,c.fromApiMessage)(t).message;return"Normal"===n.kind?e.push(n):r.error("Сообщение неожиданного типа вернулось из message.search: ".concat(n.kind)),e}),[]),e.abrupt("return",{results:y,count:d,apiItemsCount:u.length});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t,r){return y.apply(this,arguments)}function y(){return(y=(0,a.default)(o().mark((function e(t,r,n){var a,s,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("users.search",n);case 2:return a=e.sent,s=a.items,i=a.count,r({profiles:s}),c=s.map((function(e){return u.resolveId(e.id)})),e.abrupt("return",{results:c,count:i});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},607880:(e,t,r)=>{"use strict";r.d(t,{useApiFetch:()=>u});var n=r(28991),a=r(784970),s=r(667294),o=r(767084),i=r(51496);function u(){var e=(0,a.useBrowserEnv)().api,t=(0,s.useRef)(new Set);return(0,s.useEffect)((function(){return function(){t.current.forEach((function(r){e.dangerouslyAbort(r),t.current.delete(r)}))}}),[e]),(0,s.useCallback)((function(r,a,s){var u=o.IApi.resolveTrackId(r,(0,i.nanoid)(5));return t.current.add(u),e.fetch(r,a,(0,n.default)((0,n.default)({},s),{},{trackId:u}))}),[e])}},48521:(e,t,r)=>{"use strict";r.d(t,{Module:()=>f,useModuleKeyBoardHandlers:()=>m,useGlobalKeyBoardHandlers:()=>g});var n,a=r(111965),s=r(334738),o=r(678927),i=r(5991),u=r(306610),c=r(896156),l=r(21705),d=r(667294),p=r(812869);e=r.hmd(e);var f={PhotoViewer:"PhotoViewer",Modal:"Modal",SimpleComposer:"SimpleComposer",FCComposer:"FCComposer",FCWindow:"FCWindow",RightPanel:"RightPanel",Composer:"Composer",ConvoMain:"ConvoMain"},h=(n={},(0,c.default)(n,f.PhotoViewer,{priority:1001}),(0,c.default)(n,f.Modal,{priority:1e3,blockGlobalHandlers:!0,blockOtherModules:!0}),(0,c.default)(n,f.SimpleComposer,{priority:902}),(0,c.default)(n,f.FCComposer,{priority:901}),(0,c.default)(n,f.FCWindow,{priority:900}),(0,c.default)(n,f.RightPanel,{priority:500}),(0,c.default)(n,f.Composer,{priority:200}),(0,c.default)(n,f.ConvoMain,{priority:100}),n),v=(0,i.default)((function t(){var r=this;(0,u.default)(this,t),(0,c.default)(this,"isSubscribed",!1),(0,c.default)(this,"isGlobalHandlersBlocked",!1),(0,c.default)(this,"globalHandlers",new Map),(0,c.default)(this,"moduleConfig",new Map(Object.entries(h))),(0,c.default)(this,"moduleHandlers",new Map),(0,c.default)(this,"subscribeModuleKeyDown",(function(t,n){var a;if(l.isDev&&!r.moduleConfig.has(t))throw new Error("Module ".concat(e," must be in moduleConfig."));var s=null!==(a=r.moduleHandlers.get(t))&&void 0!==a?a:new Set;return s.add(n),r.moduleHandlers.set(t,s),r.onModuleHandlersUpdated(),function(){s.delete(n),0===s.size&&r.moduleHandlers.delete(t),r.onModuleHandlersUpdated()}})),(0,c.default)(this,"subscribeGlobalKeyDown",(function(e,t){var n=r.globalHandlers.has(e);if(l.isDev&&n)throw new Error("Global keyCombo ".concat(e," is already subscribed. Unsubscribe it first"));return r.globalHandlers.set(e,t),r.updateSubscription(),function(){r.globalHandlers.delete(e),r.updateSubscription()}})),(0,c.default)(this,"addModuleConfig",(function(e,t){r.moduleConfig.set(e,t)})),(0,c.default)(this,"updateSubscription",(function(){var e=r.globalHandlers.size>0||r.moduleHandlers.size>0;e&&!r.isSubscribed&&(document.addEventListener("keydown",r.keyDownHandler),r.isSubscribed=!0),!e&&r.isSubscribed&&(document.removeEventListener("keydown",r.keyDownHandler),r.isSubscribed=!1)})),(0,c.default)(this,"onModuleHandlersUpdated",(function(){r.updateGlobalHandlersBlocked(),r.updateSubscription()})),(0,c.default)(this,"callModuleSubscription",(function(e,t){for(var n=(0,o.default)(r.moduleConfig.entries()).sort((function(e,t){return t[1].priority-e[1].priority})).map((function(e){return(0,s.default)(e,1)[0]})),i=0;i<n.length;i++){var u,c=n[i];if(void 0!==c){var l=r.moduleHandlers.get(c);if(l){var d,p=!1,f=function(t){var r=t===e;return r&&(p=!0),r},h=(0,a.default)(Array.from(l).reverse());try{for(h.s();!(d=h.n()).done;){if((0,d.value)(f,t),p)break}}catch(e){h.e(e)}finally{h.f()}if(p=p||!(null===(u=r.moduleConfig.get(c))||void 0===u||!u.blockOtherModules))break}}}})),(0,c.default)(this,"callGlobalSubscription",(function(e,t){if(r.isGlobalHandlersBlocked)t();else{var n=r.globalHandlers.get(e);n&&(!1!==n.autoPreventDefault?(t(),n.handler()):n.handler(t))}})),(0,c.default)(this,"updateGlobalHandlersBlocked",(function(){var e=(0,o.default)(r.moduleHandlers.keys()).some((function(e){var t;return null===(t=r.moduleConfig.get(e))||void 0===t?void 0:t.blockGlobalHandlers}));r.isGlobalHandlersBlocked=e})),(0,c.default)(this,"keyDownHandler",(function(e){if(e instanceof KeyboardEvent){var t=(0,p.getKeyCombo)(e),n=e.preventDefault.bind(e);(0,p.isGlobalKeyCombo)(t)?r.callGlobalSubscription(t,n):(0,p.isModuleKeyCombo)(t)&&r.canCallModuleSubscription()&&r.callModuleSubscription(t,n)}})),(0,c.default)(this,"canCallModuleSubscription",(function(){var e=document.activeElement;return null===e||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&!(e instanceof HTMLElement&&!0===e.isContentEditable)}))})),y=new v;function m(e){var t=e.moduleName,r=e.config;return void 0!==r&&y.addModuleConfig(t,r),{subscribeKeyDown:(0,d.useCallback)((function(e){return y.subscribeModuleKeyDown(t,e)}),[t])}}var g=function(){return{subscribeGlobalKeyDown:y.subscribeGlobalKeyDown}}},871570:(e,t,r)=>{"use strict";r.d(t,{useTabListNavigation:()=>s});var n=r(334738),a=r(667294);function s(){var e=(0,a.useState)(-1),t=(0,n.default)(e,2),r=t[0],s=t[1],o=(0,a.useRef)(0),i=(0,a.useCallback)((function(e){return o.current=e}),[]),u=(0,a.useRef)(),c=(0,a.useCallback)((function(e){return u.current=e}),[]),l=(0,a.useCallback)((function(){s(-1)}),[]),d=(0,a.useCallback)((function(e,t){var n;if(0!==o.current)switch(e){case"Enter":t(),null===(n=u.current)||void 0===n||n.call(u,r);break;case"ArrowDown":t(),s((function(e){return e+1<o.current?e+1:0}));break;case"ArrowUp":t(),s((function(e){return e>0?e-1:o.current-1}))}}),[r]);return{setTabsCount:i,setSelectHandler:c,indexToSelect:r,onKeyDown:d,resetIndexToSelect:l}}},364832:(e,t,r)=>{"use strict";r.d(t,{useModal:()=>o,useSubModal:()=>i,useModalGroup:()=>u});var n=r(667294),a=r(16032),s=r(707731),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"popup";return c({groupId:e,stackName:t})},i=function(e){return c({groupId:e,isSubModal:!0})},u=function(){var e=(0,s.useModalContext)(),t=e.createGroup,r=e.closeGroup,a=(0,n.useRef)();a.current||(a.current=t());var o=a.current.data.id,i=(0,n.useCallback)((function(){return r(o)}),[r,o]);return(0,n.useEffect)((function(){return function(){var e;null===(e=a.current)||void 0===e||e.remove()}}),[]),{id:o,closeGroup:i}},c=function(e){var t,r=null!==(t=null==e?void 0:e.stackName)&&void 0!==t?t:"popup",o=(0,s.useModalContext)(),i=o.createModal,u=o.createGroup,c=o.getModalGroup,d=o.closeModalForced,p=(0,n.useRef)();p.current||(p.current=null!=e&&e.groupId?{data:c(e.groupId)}:u());var f=(0,n.useRef)();f.current||(f.current=i(p.current.data.id,null==e?void 0:e.isSubModal,null!=e&&e.id?a.resolveId(e.id):void 0));var h=f.current.id;return(0,n.useEffect)((function(){return function(){var e,t,n;d(h,r),null===(e=p.current)||void 0===e||null===(t=e.remove)||void 0===t||t.call(e),null===(n=f.current)||void 0===n||n.remove()}}),[d,h,r]),l(h,r)},l=function(e,t){var r=(0,s.useModalContext)(),a=r.openedModals,o=r.openModal,i=r.closeModal,u=r.findIndexInStack,c=(0,n.useCallback)((function(){return o(e,t)}),[o,e,t]),l=(0,n.useCallback)((function(){return i(e,t)}),[i,e,t]),d=u(e,t);return(0,n.useMemo)((function(){return{isActive:Boolean(a[t].find((function(t){return t===e}))),indexInStack:d,isInStack:null!==d,open:c,close:l}}),[l,e,c,a,d,t])}},837105:(e,t,r)=>{"use strict";r.d(t,{useConvoSearch:()=>C,useSearchHandlers:()=>_,useConvoSearchData:()=>I,useMessagesSearchData:()=>M,useUsersGlobalSearchData:()=>x});var n=r(678927),a=r(692137),s=r(334738),o=r(28991),i=r(781253),u=r(887757),c=r.n(u),l=r(667294),d=r(784970),p=r(314432),f=r(233600),h=r(26003),v=r(871570),y=r(82424),m=r(837021),g=r(607880),b=r(190831),k=["query","setNavigationParams"];function C(e){var t=e.onSelect,r=e.searchIndex,n=e.defaultResults,a=(0,v.useTabListNavigation)(),s=a.setTabsCount,u=a.setSelectHandler,c=a.resetIndexToSelect,d=a.onKeyDown,p=a.indexToSelect,f=_(),h=f.query,y=f.setNavigationParams,m=(0,i.default)(f,k);(0,l.useEffect)((function(){y({resetIndexToSelect:c,onKeyDown:d})}),[y,c,d]);var g=I({searchIndex:r,defaultResults:n,query:h}),b=g.results,C=g.isLoading,w=g.isDefault,S=(0,l.useMemo)((function(){var e;return null!==(e=R(b))&&void 0!==e?e:[]}),[b]),M=(0,l.useCallback)((function(e){var r=S[e];void 0!==r&&t(r)}),[S,t]);return(0,l.useEffect)((function(){u(M)}),[M,u]),(0,l.useEffect)((function(){s(S.length)}),[S,s]),(0,o.default)((0,o.default)({query:h},m),{},{results:b,isLoading:C,isDefault:w,indexToSelect:p})}function _(){var e=(0,l.useRef)(null),t=(0,l.useCallback)((function(t){return e.current=t}),[]),r=(0,l.useState)(""),n=(0,s.default)(r,2),a=n[0],o=n[1],i=(0,l.useState)(!1),u=(0,s.default)(i,2),c=u[0],d=u[1],p=(0,l.useCallback)((function(t){var r;o(t),null===(r=e.current)||void 0===r||r.resetIndexToSelect()}),[]),f=(0,l.useCallback)((function(e){return p(e.target.value)}),[p]),h=(0,l.useMemo)((function(){return(0,y.onElementKeyDownFactory)((function(t,r){var n;if("Escape"===t)r(),p("");null===(n=e.current)||void 0===n||n.onKeyDown(t,r)}))}),[p]),v=(0,l.useCallback)((function(){var t;d(!0),null===(t=e.current)||void 0===t||t.resetIndexToSelect()}),[]),m=(0,l.useCallback)((function(){var t;d(!1),null===(t=e.current)||void 0===t||t.resetIndexToSelect()}),[]),g=(0,l.useCallback)((function(){p("")}),[p]),b=(0,l.useRef)(),k=(0,l.useState)(!1),C=(0,s.default)(k,2),_=C[0],w=C[1];return(0,l.useLayoutEffect)((function(){c&&w(!1)}),[c]),(0,l.useLayoutEffect)((function(){w(!a&&!!b.current),b.current=a}),[a]),{onChange:f,onKeyDown:h,onFocus:v,onBlur:m,reset:g,isFocused:c,becameEmpty:_,setNavigationParams:t,query:a,setQuery:p}}var w=new Set;function I(e){var t=e.defaultResults,r=void 0===t?w:t,i=e.searchIndex,u=e.query,v=(0,l.useState)({isLoading:!1,results:r}),y=(0,s.default)(v,2),k=y[0],C=y[1],_=(0,l.useRef)(!0),I=(0,d.useDebounced)(u,b.SEARCH_DEBOUNCE_MS),S=I.debounced,M=I.debouncedUpdatesCount,A=(0,g.useApiFetch)(),x=(0,d.useOwner)(),R=(0,d.useInsertIntoCache)(),E=0===u.length,U=(0,d.usePeers)();(0,l.useEffect)((function(){E&&(_.current=!0,C({isLoading:!1,results:r}))}),[E,r]),(0,l.useEffect)((function(){if(!E){_.current=!1;var e=i?f.search(i,u):new Set;C({isLoading:!0,results:e})}}),[u,E]);var P=(0,l.useRef)(u);P.current=u;var O=(0,l.useCallback)(function(){var e=(0,a.default)(c().mark((function e(t){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return");case 2:return C((function(e){return(0,o.default)((0,o.default)({},e),{},{loading:!0})})),e.prev=3,e.next=6,(0,h.searchConversations)(A,R,t,(0,m.getOwnerGroupId)(x.id));case 6:if(r=e.sent,P.current===t){e.next=9;break}return e.abrupt("return");case 9:C((function(e){var t=new Set((0,n.default)(e.results.values()));return r.forEach((function(e){if(p.isContactPeerId(e)){var r=U.get(e);if("Contact"===(null==r?void 0:r.kind)&&r.userId)return}t.has(e)||t.add(e)})),{isLoading:!1,results:t}})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),C((function(e){return(0,o.default)((0,o.default)({},e),{},{loading:!1})}));case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),[A,R,x.id,U]);(0,l.useEffect)((function(){O(S)}),[M,S]);var T=k.isLoading,F=k.results;return{results:u&&T&&0===F.size?"loading":u&&!T&&0===F.size?"empty":F,isLoading:T,isDefault:_.current}}var S=[];function M(e){var t=e.query,r=e.date,i=e.peerId,u=0===t.length&&!r,p=(0,d.useBrowserEnv)().logger,f=(0,d.useOwner)(),v=(0,d.useInsertIntoCache)(),y=(0,g.useApiFetch)(),b=(0,l.useState)({isLoading:!1,hasMore:!0,results:S}),k=(0,s.default)(b,2),C=k[0],_=k[1],w=(0,l.useRef)(0),I=(0,l.useRef)(t);I.current=t;var M=(0,l.useCallback)(function(){var e=(0,a.default)(c().mark((function e(t){var a,s,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=2;break}return e.abrupt("return");case 2:return _((function(e){return(0,o.default)((0,o.default)({},e),{},{isLoading:!0})})),e.prev=3,e.next=6,(0,h.searchMessages)(y,p,v,{q:t,peer_id:i,date:r,offset:w.current,group_id:(0,m.getOwnerGroupId)(f.id)});case 6:if(a=e.sent,I.current===t){e.next=9;break}return e.abrupt("return");case 9:s=a.results,l=a.count,d=a.apiItemsCount,w.current+=d,_((function(e){return{isLoading:!1,hasMore:l>w.current&&d>0,results:[].concat((0,n.default)(e.results),(0,n.default)(s))}})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),_((function(e){return(0,o.default)((0,o.default)({},e),{},{isLoading:!1,hasMore:!1})}));case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),[u,i,r,y,v,p,f.id]),A=C.isLoading,x=C.hasMore,R=C.results,E=(0,l.useCallback)((function(){x&&!A&&M(t)}),[x,A,M,t]);return(0,l.useLayoutEffect)((function(){w.current=0,u?_({isLoading:!1,hasMore:!1,results:S}):(_({isLoading:!0,hasMore:!0,results:[]}),M(t))}),[u,t,i,r]),{results:0===R.length&&!A&&!x&&!u?"empty":R,isLoading:A,hasMore:x,loadMore:E}}var A=[];function x(e){var t=e.query,r=0===t.length,i=(0,g.useApiFetch)(),u=!(0,d.useFeatureFlags)().vkm_global_search,p=(0,d.useInsertIntoCache)(),f=(0,l.useState)({isLoading:!1,hasMore:!0,results:A}),v=(0,s.default)(f,2),y=v[0],m=v[1],b=(0,l.useRef)(0),k=(0,l.useRef)(t);k.current=t;var C=(0,l.useCallback)(function(){var e=(0,a.default)(c().mark((function e(t){var a,s,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=2;break}return e.abrupt("return");case 2:return m((function(e){return(0,o.default)((0,o.default)({},e),{},{isLoading:!0})})),e.prev=3,e.next=6,(0,h.searchUsersGlobal)(i,p,{q:t,offset:b.current,count:20});case 6:if(a=e.sent,k.current===t){e.next=9;break}return e.abrupt("return");case 9:s=a.results,u=a.count,b.current+=20,m((function(e){return{isLoading:!1,hasMore:u>b.current&&0!==s.length,results:[].concat((0,n.default)(e.results),(0,n.default)(s))}})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),m((function(e){return(0,o.default)((0,o.default)({},e),{},{isLoading:!1,hasMore:!1})}));case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),[r,i,p]),_=y.isLoading,w=y.hasMore,I=y.results,S=(0,l.useCallback)((function(){!w||_||u||C(t)}),[w,_,C,t,u]);return(0,l.useLayoutEffect)((function(){b.current=0,r||u?m({isLoading:!1,hasMore:!1,results:A}):(m({isLoading:!0,hasMore:!0,results:A}),C(t))}),[r,t,u]),{results:0===I.length&&!_&&!w&&!r?"empty":I,isLoading:_,hasMore:w,loadMore:S}}var R=function(e){return"empty"===e||"loading"===e?null:Array.from(e.values())}},606729:(e,t,r)=>{"use strict";r.d(t,{Avatar:()=>h});var n=r(106623),a=r(334738),s=(r(380283),r(667294)),o=r(20700),i=r.n(o),u=r(784970),c=r(314432),l=r(21705),d=r(612214),p=r(124301),f=r(785893),h=s.memo((function(e){var t=e.peer,r=e.size,o=e.activityIndicator,d=e.withOnline,h=void 0!==d&&d,y=e.withBirthday,m=void 0!==y&&y,g=e.activeCall,b=e.className,k=(0,u.useOnline)(t.id),C=(0,u.usePixelDensity)(),_=function(e,t){if("User"!==e.kind)return"Offline";if(t)switch(e.lastSeen.platform){case"vkme":case"mobile":return"Mobile";case"other":return"Online";default:return(0,l.exhaustivenessCheck)(e.lastSeen.platform)}return"Offline"}(t,h&&k),w=!!g,I=m&&function(e){var t;if("User"!==e.kind||!e.bdate)return!1;var r=new Date,a=String(r.getDate()),s=String(r.getMonth()+1),o=(null===(t=(0,n.default)(/(\d+)\.(\d+)/,{day:1,month:2}).exec(e.bdate))||void 0===t?void 0:t.groups)||{},i=o.day,u=o.month;return i===a&&u===s}(t),S=function(e,t,r){var n;if("Contact"===e.kind)return e.photo50;r&&(t*=2);var a=[{size:50,url:e.photo50},{size:100,url:e.photo100||e.photo50},{size:200,url:e.photo200||e.photo100||e.photo50}];return null===(n=a.find((function(e){return t<=e.size&&Boolean(e.url)})))||void 0===n?void 0:n.url}(t,r,C),M=(0,s.useState)((function(){if(!S)return!1;var e=new Image;return e.src=S,e.complete||e.width+e.height>0})),A=(0,a.default)(M,2),x=A[0],R=A[1],E=(0,s.useMemo)((function(){return{width:r,height:r}}),[r]),U=function(e,t,r){return"mePeerFrame".concat(e).concat(t).concat(r?"c":"")}(_,r,w||I),P="url(#".concat(U,"Mask").concat(t.id,")"),O=i()("MEAvatar","MEAvatar--size-".concat(r),{"MEAvatar--withActivity":!!o,"MEAvatar--emptyCall":"empty"===g},b);return(0,f.jsxs)("figure",{style:E,className:O,children:[(0,f.jsxs)("div",{className:"MEAvatar__imgWrapper",style:{clipPath:P},children:[(0,f.jsx)(p.AvatarNoPhoto,{peer:t,size:r}),S&&(0,f.jsx)("img",{className:i()("MEAvatar__img",{"MEAvatar__img--ready":x}),alt:c.name(t),src:S,onLoad:function(){return R(!0)}}),o&&(0,f.jsx)("div",{className:"MEAvatar__activityIndicator",children:o})]}),(0,f.jsx)(v,{frameType:_}),I&&(0,f.jsx)("div",{className:"MEAvatar__upperRightIcon MEAvatar__birthday",children:(0,f.jsx)("svg",{className:"MEAvatar__upperRightIconSvg",children:(0,f.jsx)("use",{href:"#meCake10"})})}),w&&(0,f.jsx)("div",{className:"MEAvatar__upperRightIcon MEAvatar__call",children:(0,f.jsx)("svg",{className:"MEAvatar__upperRightIconSvg",children:(0,f.jsx)("use",{href:"#mePhone10"})})}),(0,f.jsxs)("svg",{className:"MEAvatar__svg",children:[(0,f.jsx)("clipPath",{id:U+"Mask"+t.id,children:(0,f.jsx)("use",{href:"#"+U})}),(0,f.jsx)("use",{href:"#"+U,className:"MEAvatar__shadow",clipPath:P})]})]})}));var v=function(e){var t=e.frameType;switch(t){case"Me":case"Mobile":return(0,f.jsx)("div",{className:"MEAvatar__mobile",children:(0,f.jsx)(d.default,{})});case"Online":return(0,f.jsx)("div",{className:"MEAvatar__online"});case"Offline":return null;default:(0,l.exhaustivenessCheck)(t)}}},124301:(e,t,r)=>{"use strict";r.d(t,{AvatarNoPhoto:()=>i,AvatarNoPhotoSimple:()=>u});r(183638),r(667294);var n=r(20700),a=r.n(n),s=r(314432),o=r(785893),i=function(e){var t=e.peer,r=e.size,n=e.className;return(0,o.jsx)(u,{peerId:t.id,size:r,className:n,text:s.initials(t)})},u=function(e){var t=e.text,r=e.peerId,n=e.size,i=e.className,u=void 0!==r&&s.isContactPeerId(r)?"AvatarNoPhoto--color-contact":"AvatarNoPhoto--color-".concat(Math.abs((null!=r?r:0)%6));return(0,o.jsx)("div",{className:a()("AvatarNoPhoto","AvatarNoPhoto--size-".concat(n),u,i),children:t})}},291384:(e,t,r)=>{"use strict";r.d(t,{FormattedLangKey:()=>l});var n=r(28991),a=r(781253),s=r(667294),o=r(784970),i=r(21705),u=r(785893),c=["className","langkey"],l=function(e){var t=(0,o.useBrowserEnv)().lang,r=e.className,l=e.langkey,d=(0,a.default)(e,c);return t.fold(l,(function(e){return(0,u.jsx)(u.Fragment,{children:e})}),(function(e){return i.isDev&&(e=e.map((function(e,t){return"string"==typeof e?(0,u.jsx)(s.Fragment,{children:e},t):s.cloneElement(e,(0,n.default)((0,n.default)({},e.props),{},{key:t}))}))),(0,u.jsx)("span",{className:r,children:e})}),d)}},478372:(e,t,r)=>{"use strict";r.d(t,{ModalBackdrop:()=>u});r(895593);var n=r(667294),a=r(20700),s=r.n(a),o=r(242037),i=r(785893),u=function(e){var t,r=e.isClear,a=e.isBodyScrollDisabled,u=e.onClick,c=e.children,l=s()("RE_ModalBackdrop",{"RE_ModalBackdrop--tinted":!r}),d=(0,n.useContext)(o.ModalConfigContext).isFullScreen,p=s()("RE_ModalBackdrop__container",d?"RE_ModalBackdrop__container--fullScreen":"RE_ModalBackdrop__container--window");return t=Boolean(a),(0,n.useEffect)((function(){var e=document.body;if(t){var r=e.getBoundingClientRect(),n=window.innerWidth-(r.left+r.right);if(0!==n){var a=document.createElement("style");return a.innerText="body { overflow-y: hidden !important; }",e.appendChild(a),e.style.borderRight="".concat(n,"px solid transparent"),function(){e.style.borderRight="",e.removeChild(a)}}}}),[t]),(0,i.jsxs)("div",{className:l,children:[u&&(0,i.jsx)("div",{className:"RE_ModalBackdrop__flesh",onClick:u}),(0,i.jsx)("div",{className:p,children:c})]})}},643771:(e,t,r)=>{"use strict";r.d(t,{ModalBody:()=>c});r(351667);var n=r(667294),a=r(20700),s=r.n(a),o=r(804590),i=r(242037),u=r(785893),c=function(e){var t=e.children,r=e.withCustomLayout,a=e.withScrollHandling,c=(0,n.useContext)(i.ModalConfigContext).isFullScreen,l=s()("RE_ModalBody",{"RE_ModalBody--standard":!r,"RE_ModalBody--scrollable":a,"RE_ModalBody--fullScreen":c}),d=a?o.default:"div";return(0,u.jsx)(d,{className:l,children:t})}},242037:(e,t,r)=>{"use strict";r.d(t,{ModalConfigContext:()=>o,ModalsConfigProvider:()=>i});var n=r(667294),a=r(417388),s=r(785893),o=(0,n.createContext)({isFullScreen:!1}),i=function(e){var t=e.children,r=(0,a.useLayoutData)(),i=(0,n.useMemo)((function(){return{isFullScreen:"one-column"===r.mode}}),[r.mode]);return(0,s.jsx)(o.Provider,{value:i,children:t})}},232675:(e,t,r)=>{"use strict";r.d(t,{ModalFooter:()=>a});r(974580),r(667294);var n=r(785893),a=function(e){var t=e.buttons,r=e.hint,a=e.children;return(0,n.jsxs)("footer",{className:"RE_ModalFooter",children:[r&&(0,n.jsx)("div",{className:"RE_ModalFooter__hint",children:r}),a&&(0,n.jsx)("div",{className:"RE_ModalFooter__content",children:a}),t&&(0,n.jsx)("div",{className:"RE_ModalFooter__actions",children:t})]})}},623536:(e,t,r)=>{"use strict";r.d(t,{ModalHeader:()=>u});r(936021),r(667294);var n=r(718305),a=r(76109),s=r(20700),o=r.n(s),i=r(785893),u=function(e){var t=e.onClose,r=e.closeLabel,s=e.backLabel,u=e.onBack,c=e.title,l=e.children,d=e.className,p=e.closeClassName;return(0,i.jsxs)("header",{className:o()("RE_ModalHeader",d),children:[(0,i.jsxs)("div",{className:"RE_ModalHeader__content",children:[s&&u&&(0,i.jsxs)("button",{className:"RE_ModalHeader__back",onClick:u,children:[(0,i.jsx)("span",{className:"RE_ModalHeader__backIcon",children:(0,i.jsx)(n.default,{})}),s]}),c&&(0,i.jsx)("h1",{className:"RE_ModalHeader__title",children:c}),l&&(0,i.jsx)("div",{className:"RE_ModalHeader__container",children:l})]}),(0,i.jsx)("button",{className:o()("RE_ModalHeader__close",p),"aria-label":r,onClick:t,children:(0,i.jsx)(a.default,{})})]})}},467025:(e,t,r)=>{"use strict";r.d(t,{ModalInterface:()=>l});r(360862),r(667294);var n=r(250443),a=r(478372),s=r(499396),o=r(623536),i=r(643771),u=r(232675),c=r(785893),l=function(e){var t=e.onClose,r=e.closeLabel,l=e.onBack,d=e.backLabel,p=e.title,f=e.contextClass,h=e.panelClass,v=e.hasClearBackdrop,y=e.isHidden,m=e.portalTarget,g=e.buttons,b=e.withCustomLayout,k=e.children,C=e.footerHint;return(0,c.jsx)(n.ModalView,{onEscape:t,contextClass:f,portalTarget:m,isHidden:y,children:(0,c.jsx)(a.ModalBackdrop,{onClick:t,isClear:v,children:(0,c.jsxs)(s.ModalPanel,{className:h,children:[(0,c.jsx)(o.ModalHeader,{closeLabel:r,onClose:t,backLabel:d,onBack:l,title:p}),(0,c.jsx)(i.ModalBody,{withCustomLayout:b,children:k}),g&&(0,c.jsx)(u.ModalFooter,{buttons:g,hint:C})]})})})}},499396:(e,t,r)=>{"use strict";r.d(t,{ModalPanel:()=>u});r(97839);var n=r(667294),a=r(20700),s=r.n(a),o=r(242037),i=r(785893),u=function(e){var t=e.children,r=e.className,a=(0,n.useContext)(o.ModalConfigContext).isFullScreen,u=s()("RE_ModalPanel",r,{"RE_ModalPanel--fullScreen":a});return(0,i.jsx)("article",{className:u,children:t})}},250443:(e,t,r)=>{"use strict";r.d(t,{ModalView:()=>l});r(628392);var n=r(667294),a=r(20700),s=r.n(a),o=r(826954),i=r(656151),u=r(48521),c=r(785893),l=function(e){var t=e.children,r=e.isHidden,a=e.onEscape,l=e.contextClass,d=e.portalTarget,p=(0,i.useLayer)(),f=s()("RE_ModalView",{"RE_ModalView--hidden":Boolean(r)}),h=(0,u.useModuleKeyBoardHandlers)({moduleName:u.Module.Modal}).subscribeKeyDown,v=(0,n.useCallback)((function(e,t){void 0!==a&&e("Escape")&&(t(),a())}),[a]);return(0,n.useEffect)((function(){if(!r)return h(v)}),[h,v,r]),(0,c.jsx)(o.Portal,{portalClassName:l,portalTarget:d||p,children:(0,c.jsx)("div",{className:f,children:t})})}},675130:(e,t,r)=>{"use strict";r.d(t,{OnlineStatus:()=>o});var n=r(667294),a=r(784970),s=r(785893),o=n.memo((function(e){var t=e.className,r=e.user,n=(0,a.useBrowserEnv)().lang,o=(0,a.useOnline)(r.id),i=(0,a.useNow)(6e5);if("Contact"===r.kind){if(r.lastSeen&&["today","recently"].includes(r.lastSeen)){var u={today:n.use("global_online_was_today",{sex:"male"}),recently:n.use("global_online_was_recently",{sex:"male"})}[r.lastSeen];return(0,s.jsx)("span",{className:t,role:"status",children:u})}return null}if(o)return(0,s.jsx)("span",{className:t,role:"status",children:n.use("global_online",{sex:r.sex})});if(!r.lastSeen.isVisible)return(0,s.jsx)("span",{className:t,role:"status",children:n.use("global_online_was_recently",{sex:r.sex})});if(!r.lastSeen.at)return null;if(r.lastSeen.isVisible)return(0,s.jsx)("span",{className:t,role:"status",children:n.formatDate(r.lastSeen.at,{now:i,variant:"time-ago"})});var c,l=864e5,d=6048e5,p=i-r.lastSeen.at;switch(!0){case p<l:c="global_online_was_recently";break;case p<d:c="global_online_was_week";break;case p<24192e5:c="global_online_this_month";break;default:c="global_online_long_ago"}return(0,s.jsx)("span",{role:"status",className:t,children:n.use(c,{sex:r.sex})})}))},82424:(e,t,r)=>{"use strict";r.d(t,{onElementKeyDownFactory:()=>a});var n=r(812869),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(r){var a=(0,n.getKeyCombo)(r);!t&&(0,n.isGlobalKeyCombo)(a)||(0,n.isModuleKeyCombo)(a)&&(r.stopPropagation(),e(a,r.preventDefault.bind(r)))}}},812869:(e,t,r)=>{"use strict";r.d(t,{isModuleKeyCombo:()=>d,isGlobalKeyCombo:()=>f,getKeyCombo:()=>h});var n,a,s,o=r(896156),i=r(887075);!function(e){e.Mod="Mod",e.Alt="Alt",e.Shift="Shift",e.Meta="Meta"}(a||(a={})),function(e){e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.ArrowUp="ArrowUp",e.Escape="Escape",e.Enter="Enter",e.Backspace="Backspace",e.Tab="Tab",e.Slash="/",e.PageDown="PageDown",e.PageUp="PageUp",e.Home="Home",e.End="End",e.Space="Space"}(s||(s={}));var u,c={" ":s.Space};!function(e){e.F="F"}(u||(u={}));var l=[a.Shift,s.ArrowDown,s.ArrowUp,s.Enter,s.Escape,s.Backspace,"".concat(a.Shift,"+").concat(s.Enter),"".concat(a.Mod,"+").concat(s.Enter),s.ArrowLeft,s.ArrowRight,s.Tab,s.Space],d=function(e){return l.includes(e)},p=["".concat(a.Mod,"+").concat(u.F),"".concat(a.Mod,"+").concat(a.Shift,"+").concat(u.F),"".concat(a.Mod,"+").concat(s.Slash)],f=function(e){return p.includes(e)},h=function(e){try{var t,r=[];Object.values(a).forEach((function(t){v[t](e)&&r.push(t)}));var n=null!==(t=c[e.key])&&void 0!==t?t:e.key;return Object.values(s).forEach((function(e){return n===e&&r.push(e)})),Object.values(u).forEach((function(t){n.toUpperCase()!==t?e.code.slice(3)===t&&r.push(t):r.push(t)})),r.join("+")}catch(e){return""}},v=(n={},(0,o.default)(n,a.Mod,(function(e){return i.isMac?e.metaKey:e.ctrlKey})),(0,o.default)(n,a.Alt,(function(e){return e.altKey})),(0,o.default)(n,a.Shift,(function(e){return e.shiftKey})),(0,o.default)(n,a.Meta,(function(e){return i.isMac?e.ctrlKey:e.metaKey})),n)},782597:(e,t,r)=>{"use strict";r.d(t,{empty:()=>o,snakeCaseId:()=>u,getLockId:()=>c,isLoaded:()=>l,push:()=>d,refresh:()=>p,updateCounters:()=>f,sorter:()=>h});var n=r(111965),a=r(28991),s=r(716352);function o(){var e={channelIds:new Set,hasMore:!0,unreadCount:0,totalCount:0,boundary:{channelId:s.resolveId(0),majorSortId:1/0,minorSortId:1/0}};return{all:(0,a.default)({kind:"all"},e),unread:(0,a.default)({kind:"unread"},e),archive:(0,a.default)({kind:"archive",isHidden:!1},e)}}var i={all:"all",unread:"unread",archive:"archived"};function u(e){return i[e]}function c(e){return"filter_".concat(e)}function l(e){return e.boundary.minorSortId!==1/0&&e.boundary.majorSortId!==1/0}function d(e,t,r,a){var o,i=(0,n.default)(r);try{for(i.s();!(o=i.n()).done;){var u=o.value;v(e,t,u),p(e,u)}}catch(e){i.e(e)}finally{i.f()}e[t].hasMore=a,e[t].hasMore||(e[t].boundary={majorSortId:0,minorSortId:0,channelId:s.resolveId(0)})}function p(e,t){e.all.channelIds.delete(t.id),e.unread.channelIds.delete(t.id),e.archive.channelIds.delete(t.id),t.isMember&&(t.isArchived?y(e.archive,t)&&e.archive.channelIds.add(t.id):(y(e.all,t)&&e.all.channelIds.add(t.id),s.isUnread(t)&&y(e.unread,t)&&e.unread.channelIds.add(t.id)))}function f(e,t){var r=t.unread,n=t.archiveTotal;void 0!==r&&(e.all.unreadCount=r,e.unread.unreadCount=r),void 0!==n&&(e.archive.totalCount=n)}function h(e,t){return e.majorSortId!==t.majorSortId?t.majorSortId-e.majorSortId:t.minorSortId!==e.minorSortId?t.minorSortId-e.minorSortId:e.id-t.id}function v(e,t,r){s.isHidden(r)||(r.majorSortId<e[t].boundary.majorSortId?e[t].boundary={channelId:r.id,majorSortId:r.majorSortId,minorSortId:r.minorSortId}:r.majorSortId===e[t].boundary.majorSortId&&r.minorSortId<e[t].boundary.minorSortId?(e[t].boundary.channelId=r.id,e[t].boundary.minorSortId=r.minorSortId):r.majorSortId===e[t].boundary.majorSortId&&r.minorSortId===e[t].boundary.minorSortId&&(e[t].boundary.channelId=r.id),"all"===t&&v(e,"unread",r))}function y(e,t){return!s.isHidden(t)&&(!(t.majorSortId<e.boundary.majorSortId)&&(t.majorSortId>e.boundary.majorSortId||!(t.minorSortId<e.boundary.minorSortId)&&(t.minorSortId>e.boundary.minorSortId||!(t.id>e.boundary.channelId))))}},252229:(e,t,r)=>{"use strict";r.d(t,{empty:()=>i,snakeCaseId:()=>c,isLoaded:()=>l,getLockId:()=>d,isVisible:()=>p,push:()=>f,refresh:()=>h,updateCounters:()=>v,sorter:()=>y,toggleArchiveVisibility:()=>m,toggleBusinessNotifyVisibility:()=>g});var n=r(111965),a=r(28991),s=r(509727),o=r(21705);function i(){var e={peerIds:new Set,hasMore:!0,unreadCount:0,unreadUnmutedCount:0,totalCount:0,boundary:{majorSortId:1/0,minorSortId:1/0}};return{all:(0,a.default)({kind:"all"},e),unread:(0,a.default)({kind:"unread",headerNotMutedUnread:0},e),chats:(0,a.default)({kind:"chats"},e),archive:(0,a.default)({kind:"archive",hasMentions:!1,isHidden:!1},e),messageRequest:(0,a.default)({kind:"messageRequest"},e),businessNotify:(0,a.default)({kind:"businessNotify",isHidden:!1},e)}}var u={all:"all",unread:"unread",chats:"chats",messageRequest:"message_request",businessNotify:"business_notify",archive:"archive"};function c(e){return u[e]}function l(e){return e.boundary.majorSortId!==1/0&&e.boundary.minorSortId!==1/0}function d(e){return"filter_".concat(e)}function p(e){switch(e.kind){case"all":case"unread":case"chats":return!0;case"messageRequest":return e.peerIds.size>0||e.hasMore;case"businessNotify":return!e.isHidden&&(e.totalCount>0||e.unreadCount>0);default:return!e.isHidden&&(e.peerIds.size>0||e.hasMore)}}function f(e,t,r,a){var s,o=(0,n.default)(r);try{for(o.s();!(s=o.n()).done;){var i=s.value;b(e,t,i),h(e,i)}}catch(e){o.e(e)}finally{o.f()}e[t].hasMore=a,e[t].hasMore||(e[t].boundary={majorSortId:0,minorSortId:0})}function h(e,t){switch(t.kind){case"ChatConvo":case"GroupConvo":case"UserConvo":case"ContactConvo":case"MessageRequestUserConvo":case"MessageRequestChatConvo":case"BusinessNotify":return e.all.peerIds.delete(t.peerId),e.unread.peerIds.delete(t.peerId),e.archive.peerIds.delete(t.peerId),e.messageRequest.peerIds.delete(t.peerId),e.businessNotify.peerIds.delete(t.peerId),s.isBusinessNotify(t)?void(k(e.businessNotify,t)&&e.businessNotify.peerIds.add(t.peerId)):s.isMR(t)?void(s.isPendingMR(t)&&k(e.messageRequest,t)&&e.messageRequest.peerIds.add(t.peerId)):t.isArchived?void(k(e.archive,t)&&e.archive.peerIds.add(t.peerId)):(k(e.all,t)&&e.all.peerIds.add(t.peerId),s.isUnread(t)&&k(e.unread,t)&&e.unread.peerIds.add(t.peerId),void("ChatConvo"===t.kind&&k(e.chats,t)&&e.chats.peerIds.add(t.peerId)));default:return(0,o.exhaustivenessCheck)(t)}}function v(e,t){var r=t.unread,n=t.unreadUnmuted,a=t.headerNotMutedUnread,s=t.archive,o=t.archiveTotal,i=t.archiveMentions,u=t.messageRequests,c=t.businessNotify,l=t.businessNotifyTotal;void 0!==r&&(e.all.unreadCount=r,e.unread.unreadCount=r),void 0!==n&&(e.all.unreadUnmutedCount=n,e.unread.unreadUnmutedCount=n),void 0!==a&&(e.unread.headerNotMutedUnread=a),void 0!==s&&(e.archive.unreadCount=s),void 0!==i&&(e.archive.hasMentions=!!i),void 0!==o&&(e.archive.totalCount=o),void 0!==u&&(e.messageRequest.totalCount=u),void 0!==c&&(e.businessNotify.unreadCount=c),void 0!==l&&(e.businessNotify.totalCount=l)}function y(e,t){if(e.majorSortId!==t.majorSortId)return t.majorSortId-e.majorSortId;var r,n,a=e&&s.head(e),o=t&&s.head(t);return"Queued"===(null==a?void 0:a.kind)||"Queued"===(null==o?void 0:o.kind)?(null!==(r=null==o?void 0:o.sentAt)&&void 0!==r?r:0)-(null!==(n=null==a?void 0:a.sentAt)&&void 0!==n?n:0):t.minorSortId-e.minorSortId}function m(e,t){e.archive.isHidden=!t}function g(e,t){e.businessNotify.isHidden=!t}function b(e,t,r){s.isHidden(r)||(r.majorSortId<e[t].boundary.majorSortId?e[t].boundary={majorSortId:r.majorSortId,minorSortId:r.minorSortId}:r.majorSortId===e[t].boundary.majorSortId&&r.minorSortId<e[t].boundary.minorSortId&&(e[t].boundary.minorSortId=r.minorSortId),"all"===t&&(b(e,"unread",r),b(e,"chats",r)))}function k(e,t){return!s.isHidden(t)&&(t.majorSortId>e.boundary.majorSortId||t.majorSortId===e.boundary.majorSortId&&t.minorSortId>=e.boundary.minorSortId)}},527119:(e,t,r)=>{"use strict";r.d(t,{refresh:()=>i,refreshChannels:()=>u,empty:()=>c,isEqual:()=>l,canHavePinnedConvos:()=>d,filterToTab:()=>p,tabToFilter:()=>f,tabToChannelFilter:()=>h});var n=r(21705),a=r(252229),s=r(782597),o=r(360202);function i(e,t){o.refresh(e.folders,t),a.refresh(e.filters,t)}function u(e,t){s.refresh(e.channelFilters,t)}function c(){return{filters:a.empty(),folders:o.empty(),channelFilters:s.empty()}}function l(e,t){if(e.kind!==t.kind)return!1;switch(e.kind){case"filters":return e.filter===t.filter;case"folders":return e.id===t.id;default:(0,n.exhaustivenessCheck)(e)}}function d(e){return"filters"===e.kind}function p(e){switch(e){case"archive":case"unread":case"businessNotify":case"messageRequest":return e;default:return}}function f(e){switch(e){case"archive":case"unread":case"businessNotify":case"messageRequest":return e;default:return"all"}}function h(e){switch(e){case"archive":case"unread":return e;default:return"all"}}},120052:(e,t,r)=>{"use strict";r.d(t,{VIEWER_DEFAULT_PUSH_SETTINGS:()=>n,isEdu:()=>a});var n={userConvo:{isEnabled:!0,withMessageText:!0},chatConvo:{isEnabled:!0,withMessageText:!0},groupConvo:{isEnabled:!0,withMessageText:!0},mention:"every-mention"};function a(e){return"edu"===e}},107134:(e,t,r)=>{"use strict";r.d(t,{fromApiChatMembers:()=>a});var n=r(314432);function a(e){return e.reduce((function(e,t){var r=n.resolveId(t.member_id);if(!n.isUserPeerId(r)&&!n.isGroupPeerId(r)&&!n.isContactPeerId(r))return e;var a={isAdmin:Boolean(t.is_admin),canKick:Boolean(t.can_kick),isMessageRequest:Boolean(t.is_message_request),peerId:r};return t.is_message_request&&t.request_date&&(a.requestDate=1e3*t.request_date),e.members.push(a),n.isContactPeerId(r)||(t.is_admin&&e.adminIds.push(r),t.is_owner&&(e.ownerId=r)),e}),{members:[],adminIds:[]})}},10454:(e,t,r)=>{"use strict";r.d(t,{fromApiComment:()=>d});var n=r(28991),a=r(251766),s=r(314432),o=r(30966),i=r(716352),u=r(194170),c=r(641450),l=r(303460);function d(e){var t,r,p,f,h,v={cmid:a.resolveCmid(e.id),postCmid:o.resolveCmid(e.post_id||0),channelId:i.resolveId(e.owner_id||0),canEdit:Boolean(e.can_edit),rootCmid:null!==(t=e.parents_stack)&&void 0!==t&&t[0]?a.resolveCmid(e.parents_stack[0]):void 0,replies:{count:(null==e||null===(r=e.thread)||void 0===r?void 0:r.count)||0,history:((null===(p=e.thread)||void 0===p?void 0:p.items)||[]).map(d)},sentAt:1e3*e.date};return e.deleted?(0,n.default)({kind:"Deleted"},v):(0,n.default)((0,n.default)({kind:"Normal"},v),{},{chunks:e.text?c.fromServerText(e.text):[],attaches:(0,l.fromApiWallReplyAttach)(e.attachments||[]),likes:{count:(null===(f=e.likes)||void 0===f?void 0:f.count)||0,reactionId:Boolean(null===(h=e.likes)||void 0===h?void 0:h.user_likes)?u.resolveId(0):void 0,availableReactionIds:[],peerIds:new Set},peerId:s.resolveId(e.from_id)})}},103589:(e,t,r)=>{"use strict";r.d(t,{fromApiViewerAccount:()=>a,fromApiViewerProfileInfo:()=>s,fromApiProfileType:()=>o});var n=r(314432);function a(e){var t,r;return{id:n.resolveRealId("User",e.id),profileType:o(e.profile_type),firstName:null!==(t=e.first_name)&&void 0!==t?t:"",lastName:null!==(r=e.last_name)&&void 0!==r?r:"",photo:e.photo_100}}function s(e){var t=e.screen_name,r=e.phone,a=e.id,s=e.photo_200,o=e.first_name,i=e.last_name;return{screenName:t,phoneNumber:r,id:n.resolveRealId("User",a),avatarPhoto:s,firstName:o,lastName:i}}function o(e){var t;return null!==(t={0:"normal",2:"edu"}[null!=e?e:0])&&void 0!==t?t:"normal"}},211719:(e,t,r)=>{"use strict";r.d(t,{Engine:()=>f});var n=r(678927),a=r(28991),s=r(692137),o=r(5991),i=r(306610),u=r(896156),c=r(887757),l=r.n(c),d=r(21705),p=r(190831),f=(0,o.default)((function e(t,r){var o=this;(0,i.default)(this,e),(0,u.default)(this,"isWorking",!1),(0,u.default)(this,"empty",(function(){return{kind:"Buffer",buffer:[]}})),(0,u.default)(this,"queued",this.empty()),(0,u.default)(this,"connect",(function(e){if(!o.isWorking){o.isWorking=!0,o.queued=o.empty();var t=function(){var t=(0,s.default)(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.isWorking){t.next=18;break}if("Buffer"!==o.queued.kind){t.next=7;break}if(!(o.queued.buffer.reduce((function(e,t){return"Batch"===t.kind?e+t.updates.length:e+1}),0)>=1e3)){t.next=7;break}return o.isWorking=!1,o.dispatch({kind:"Failure"}),t.abrupt("return");case 7:return t.prev=7,t.delegateYield(l().mark((function t(){var r,n,s,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="https://".concat(e.server,"?version=").concat(o.version,"&mode=").concat(682),n=new AbortController,s=setTimeout((function(){return n.abort()}),3e4),t.next=5,o.request(r,{act:"a_check",key:e.key,ts:e.ts,wait:25},n.signal).finally((function(){return clearTimeout(s)}));case 5:if(!("failed"in(i=t.sent))){t.next=8;break}throw i;case 8:e.ts=i.ts,e.pts=i.pts,o.dispatch((0,a.default)({kind:"Batch"},i));case 11:case"end":return t.stop()}}),t)}))(),"t0",9);case 9:t.next=16;break;case 11:t.prev=11,t.t1=t.catch(7),o.logger.info("[ENGINE] Error",t.t1),o.isWorking=!1,o.dispatch({kind:"Failure"});case 16:t.next=0;break;case 18:case"end":return t.stop()}}),t,null,[[7,11]])})));return function(){return t.apply(this,arguments)}}();t().catch((function(e){o.isWorking=!1,o.logger.error("[ENGINE] Drain error",e)})),o.logger.info("[ENGINE] Connected")}})),(0,u.default)(this,"dispatch",(function(e){if("Callback"===o.queued.kind)return o.queued.resolve(e),void(o.queued=o.empty());switch(e.kind){case"Failure":return void o.queued.buffer.push(e);case"Batch":var t,r=o.queued.buffer[o.queued.buffer.length-1];if(r&&"Failure"!==r.kind&&r.pts===e.pts)r.ts=e.ts,r.pts=e.pts,(t=r.updates).push.apply(t,(0,n.default)(e.updates));else o.queued.buffer.push(e);return;default:(0,d.exhaustivenessCheck)(e)}})),(0,u.default)(this,"poll",(function(){if("Callback"===o.queued.kind)return o.queued.reject("Engine.poll вызван повторно до обработки первого вызова!"),new Promise((function(e,t){o.queued={kind:"Callback",resolve:e,reject:t}}));var e=o.queued.buffer.shift();return e?Promise.resolve(e):o.isWorking?new Promise((function(e,t){o.queued={kind:"Callback",resolve:e,reject:t}})):Promise.reject("Engine.connect еще не был вызван!")})),(0,u.default)(this,"isConnected",(function(){return o.isWorking})),this.logger=t,this.request=r,this.version=p.ENGINE_VERSION}))},995420:(e,t,r)=>{"use strict";r.d(t,{EventEmitter:()=>o});var n=r(306610),a=r(5991),s=r(896156),o=function(){function e(){(0,n.default)(this,e),(0,s.default)(this,"subscriptions",{})}return(0,a.default)(e,[{key:"subscribe",value:function(e,t){var r;Array.isArray(this.subscriptions[e])?null===(r=this.subscriptions[e])||void 0===r||r.push(t):this.subscriptions[e]=[t]}},{key:"unsubscribe",value:function(e,t){var r;Array.isArray(this.subscriptions[e])&&(this.subscriptions[e]=(null===(r=this.subscriptions[e])||void 0===r?void 0:r.filter((function(e){return e!==t})))||[])}},{key:"emit",value:function(e,t){var r;Array.isArray(this.subscriptions[e])&&(null===(r=this.subscriptions[e])||void 0===r||r.forEach((function(e){return e(t)})))}}]),e}()},767084:(e,t,r)=>{"use strict";r.d(t,{IApi:()=>n});var n,a=r(5991),s=r(306610),o=r(663349),i=r(110379),u=r(460446),c=r(723415);!function(e){e.resolveTrackId=function(e,t){if(0===t.length)throw new Error("Нельзя отдавать пустую строку в IApi.resolveTrackId");return"".concat(e,"-").concat(t)};var t=function(e){(0,i.default)(r,e);var t=(0,u.default)(r);function r(e){var n;return(0,s.default)(this,r),n=t.call(this,e),Object.setPrototypeOf((0,o.default)(n),r.prototype),n}return(0,a.default)(r)}((0,c.default)(Error));e.TimeoutError=t;var r=function(e){(0,i.default)(r,e);var t=(0,u.default)(r);function r(e){var n;return(0,s.default)(this,r),n=t.call(this,e),Object.setPrototypeOf((0,o.default)(n),r.prototype),n}return(0,a.default)(r)}((0,c.default)(Error));e.AbortError=r;var n=function(e){(0,i.default)(r,e);var t=(0,u.default)(r);function r(e,n,a){var i;return(0,s.default)(this,r),(i=t.call(this,n)).code=e,i.payload=a,Object.setPrototypeOf((0,o.default)(i),r.prototype),i}return(0,a.default)(r)}((0,c.default)(Error));e.RequestError=n;var l=function(e){(0,i.default)(r,e);var t=(0,u.default)(r);function r(e){var n;return(0,s.default)(this,r),(n=t.call(this,String(e[0].error_code))).list=e.map((function(e){return{code:e.error_code,message:e.error_msg}})),Object.setPrototypeOf((0,o.default)(n),r.prototype),n}return(0,a.default)(r)}((0,c.default)(Error));e.ExecuteErrors=l}(n||(n={}))},753985:(e,t,r)=>{"use strict";var n,a;r.d(t,{PlayerEventTypes:()=>n,VideoMessagePlayerEventTypes:()=>a}),function(e){e.STATE_UPDATED="stateupdated",e.START_NEW_TRACK="startNewTrack",e.START_NEXT_TRACK="startNextTrack",e.START_PREV_TRACK="startPrevTrack",e.RESUME_TRACK="resumeTrack",e.START_NEXT_TRACK_AUTOMATICALLY="startNextTrackAutomatically",e.STOP_CURRENT_TRACK_AUTOMATICALLY="stopCurrentTrackAutomatically",e.PLAYLIST_ENDED="playlistEnded",e.STOP_CURRENT_TRACK_BEFORE_STARTING_NEW_TRACK="stopCurrentTrackBeforeStartingNewTrack",e.STOP_CURRENT_TRACK_BY_ERROR="stopCurrentTrackByError",e.PAUSE_CURRENT_TRACK="pauseCurrentTrack"}(n||(n={})),function(e){e.SCROLL_TO_MESSAGE="scrollToMessage",e.STATE_UPDATED="stateUpdated"}(a||(a={}))},563549:(e,t,r)=>{"use strict";r.d(t,{IUploader:()=>n});var n,a=r(5991),s=r(306610),o=r(663349),i=r(110379),u=r(460446),c=r(723415);!function(e){var t=function(e){(0,i.default)(r,e);var t=(0,u.default)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Aborted";return(0,s.default)(this,r),e=t.call(this,n),Object.setPrototypeOf((0,o.default)(e),r.prototype),e}return(0,a.default)(r)}((0,c.default)(Error));e.AbortError=t;var r=function(e){(0,i.default)(r,e);var t=(0,u.default)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Timeout";return(0,s.default)(this,r),e=t.call(this,n),Object.setPrototypeOf((0,o.default)(e),r.prototype),e}return(0,a.default)(r)}((0,c.default)(Error));e.TimeoutError=r}(n||(n={}))},63843:(e,t,r)=>{"use strict";r.d(t,{IMAGE_TYPES:()=>_,VIDEO_TYPES:()=>w,AUDIO_TYPES:()=>I,Uploader:()=>T,areImages:()=>q,areVideos:()=>j,areAudios:()=>B,preloadImage:()=>G,isChannelUpload:()=>K,isConvoUpload:()=>$});var n=r(678927),a=r(28991),s=r(663349),o=r(110379),i=r(460446),u=r(692137),c=r(334738),l=r(306610),d=r(5991),p=r(896156),f=r(887757),h=r.n(f),v=r(303460),y=r(563549),m=r(21705),g=r(190831),b=r(314432),k=r(716352),C=r(210746),_=["image/png","image/gif","image/jpeg","image/webp"],w=["video/x-msvideo","video/mp4","video/mpeg","video/3gpp","video/quicktime","video/x-flv","video/x-ms-wmv"],I=["audio/mp3","audio/ogg","audio/wav","audio/mpeg","audio/flac","audio/aac","audio/m4a","audio/mp4","audio/x-m4a"],S=function(e){return"image"===e.kind},M=function(e){return"video"===e.kind},A=function(e){return"audio"===e.kind},x=function(e){return"doc"===e.kind},R=function(e){return"owner-photo"===e.kind},E=function(e){return"chat-photo"===e.kind},U=function(){function e(){var t=this;(0,l.default)(this,e),(0,p.default)(this,"cache",new Map),setInterval((function(){t.dropCache.call(t)}),6e4)}return(0,d.default)(e,[{key:"getUploadServer",value:function(e,t){var r=this,n=this.cache.get(e);return n?n instanceof Promise?n:this.validateCache(n.timestamp)?Promise.resolve(n.url):(this.cache.delete(e),this.getUploadServer(e,t)):(n=t().then((function(t){return r.cache.set(e,{url:t,timestamp:Date.now()}),t})),this.cache.set(e,n),n)}},{key:"dropCache",value:function(){var e=this;0!==this.cache.size&&Array.from(this.cache.entries()).forEach((function(t){var r=(0,c.default)(t,2),n=r[0],a=r[1];a instanceof Promise||(e.validateCache(a.timestamp)||e.cache.delete(n))}))}},{key:"validateCache",value:function(e){return Date.now()-e<=5e3}}]),e}(),P=function(){function e(t){var r=this;(0,l.default)(this,e),(0,p.default)(this,"emitter",new F),(0,p.default)(this,"requestTimeout",0),(0,p.default)(this,"freeResources",5),(0,p.default)(this,"waiting",[]),(0,p.default)(this,"photosUploadUrlCache",new U),(0,p.default)(this,"wallPhotosUploadUrlCache",new U),(0,p.default)(this,"docsUploadUrlCache",new U),(0,p.default)(this,"wallDocsUploadUrlCache",new U),(0,p.default)(this,"lock",(function(){return 0!==r.freeResources&&(r.freeResources=Math.max(r.freeResources-1,0),!0)})),(0,p.default)(this,"release",(function(){setTimeout((function(){r.freeResources=Math.min(r.freeResources+1,5);var e=r.waiting.shift();e&&e()}),g.API_RATE_LIMIT_WINDOW+50)})),this.api=t}var t,r,n,a,s,o,i,c,f,y,m,k;return(0,d.default)(e,[{key:"uploadImage",value:(k=(0,u.default)(h().mark((function e(t,r){var n,a,s,o,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={peer_id:r.viewerId,group_id:r.groupId,upload_v2:0},a=function(){return i.api.fetch("photos.getMessagesUploadServer",n).then((function(e){return e.upload_url}))},s=function(){return i.photosUploadUrlCache.getUploadServer(JSON.stringify(n),a)},(o=new FormData).append("photo",t.file),e.abrupt("return",this.uploadRequest(s,o,t.trackId,(function(e){var t=e.data,r=t.server,n=t.hash,a=t.photo;return i.api.fetch("photos.saveMessagesPhoto",{server:r,hash:n,photo:a}).then((function(e){if(0===e.length||void 0===e[0])throw new Error("Метод photos.saveMessagesPhoto не вернул фотографию");var t=(0,v.fromApiPhoto)(e[0]);if(void 0===t)throw new Error("Не удалось конвертировать фотографию с сервера");return t}))})));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"uploadVideo",value:(m=(0,u.default)(h().mark((function e(t,r){var n,a,s,o=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={target:r,preview:1,no_comments:1},a=function(){return o.api.fetch("video.save",n).then((function(e){var t=e.upload_url;if(!t)throw new Error("В методе video.save не вернулся upload_url");return t}))},(s=new FormData).append("video_file",t.file),e.abrupt("return",this.uploadRequest(a,s,t.trackId,(function(e){var t=e.data,r=t.video_id,n=t.owner_id;return Promise.resolve({kind:"Video",id:r,ownerId:n,image:[{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAA1JREFUGFdjYGBg+A8AAQQBAHAgZQsAAAAASUVORK5CYII=",width:1,height:1}],views:0})})));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"uploadAudio",value:(y=(0,u.default)(h().mark((function e(t){var r,n,a,s=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},n=function(){return s.api.fetch("audio.getUploadServer",r).then((function(e){return e.upload_url}))},(a=new FormData).append("file",t.file),e.abrupt("return",this.uploadRequest(n,a,t.trackId,(function(e){var t=e.data,r=t.server,n=t.audio,a=t.hash;return s.api.fetch("audio.save",{server:r,audio:n,hash:a}).then((function(e){return(0,v.fromApiAudio)(e)}))})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"uploadDoc",value:(f=(0,u.default)(h().mark((function e(t,r){var n,a,s,o,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:"doc",peer_id:r.targetPeerId},a=function(){return i.api.fetch("docs.getMessagesUploadServer",n).then((function(e){return e.upload_url}))},s=function(){return i.docsUploadUrlCache.getUploadServer(JSON.stringify(n),a)},(o=new FormData).append("file",t.file),e.abrupt("return",this.uploadRequest(s,o,t.trackId,(function(e){var t=e.data.file;return i.api.fetch("docs.save",{file:t}).then((function(e){if(!e.doc)throw new Error("Метод doc.save не вернул документ");var t=(0,v.fromApiDoc)(e.doc);if(!t)throw new Error("Не удалось конвертировать документ (нет поля url)");return t}))})));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"uploadWallDoc",value:(c=(0,u.default)(h().mark((function e(t,r){var n,a,s,o,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={group_id:0},a=function(){return i.api.fetch("docs.getWallUploadServer",n).then((function(e){return e.upload_url}))},s=function(){return i.wallDocsUploadUrlCache.getUploadServer(JSON.stringify(n),a)},(o=new FormData).append("file",t.file),e.abrupt("return",this.uploadRequest(s,o,t.trackId,(function(e){var t=e.data.file;return i.api.fetch("docs.save",{file:t,group_id:0}).then((function(e){if(!e.doc)throw new Error("Метод doc.save не вернул документ");var t=(0,v.fromApiDoc)(e.doc);if(!t)throw new Error("Не удалось конвертировать документ (нет поля url)");return t}))})));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"uploadVoice",value:(i=(0,u.default)(h().mark((function e(t,r){var n,a,s,o=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:"audio_message",peer_id:r.targetPeerId},a=function(){return o.api.fetch("docs.getMessagesUploadServer",n).then((function(e){return e.upload_url}))},(s=new FormData).append("file",t.file),e.abrupt("return",this.uploadRequest(a,s,t.trackId,(function(e){var t=e.data.file;return o.api.fetch("docs.save",{file:t}).then((function(e){if(!e.audio_message)throw new Error("Метод doc.save не вернул аудиосообщение");return(0,v.fromApiVoice)(e.audio_message)}))})));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"uploadChatPhoto",value:(o=(0,u.default)(h().mark((function e(t,r){var n,a,s,o,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.targetPeerId&&b.isChatPeerId(r.targetPeerId)){e.next=2;break}throw new Error("Для обновления аватара чата targetPeerId обязательно должен быть ChatId");case 2:return e.next=4,V(t);case 4:return n=e.sent,a={chat_id:r.targetPeerId-2e9,crop_x:n.x,crop_y:n.y,crop_width:n.width},s=function(){return i.api.fetch("photos.getChatUploadServer",a).then((function(e){return e.upload_url}))},(o=new FormData).append("photo",t.file),e.abrupt("return",this.uploadRequest(s,o,t.trackId,(function(e){var t=e.data.response;return i.api.fetch("messages.setChatPhoto",{file:t,user_id:r.viewerId}).then((function(){}))})));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"uploadOwnerPhoto",value:(s=(0,u.default)(h().mark((function e(t,r){var n,a,s,o=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={owner_id:r.viewerId},a=function(){return o.api.fetch("photos.getOwnerPhotoUploadServer",n).then((function(e){return e.upload_url}))},(s=new FormData).append("photo",t.file),e.abrupt("return",this.uploadRequest(a,s,t.trackId,(function(e){var t=e.data,n=t.hash,a=t.photo,s=t.server;return o.api.fetch("photos.saveOwnerPhoto",{owner_id:r.viewerId,server:s,hash:n,photo:a}).then((function(){}))})));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"uploadWallImage",value:(a=(0,u.default)(h().mark((function e(t,r){var n,a,s,o,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={group_id:Math.abs(r.targetPeerId),upload_v2:0},a=function(){return i.api.fetch("photos.getWallUploadServer",n).then((function(e){return e.upload_url}))},s=function(){return i.wallPhotosUploadUrlCache.getUploadServer(JSON.stringify(n),a)},(o=new FormData).append("photo",t.file),e.abrupt("return",this.uploadRequest(s,o,t.trackId,(function(e){var t=e.data,n=t.server,a=t.hash,s=t.photo;return i.api.fetch("photos.saveWallPhoto",{group_id:Math.abs(r.targetPeerId),server:n,hash:a,photo:s}).then((function(e){if(0===e.length||void 0===e[0])throw new Error("Метод photos.saveWallPhoto не вернул фотографию");var t=(0,v.fromApiPhoto)(e[0]);if(void 0===t)throw new Error("Не удалось конвертировать фотографию с сервера");return t}))})));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"convoUpload",value:(n=(0,u.default)(h().mark((function e(t,r){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S(t)){e.next=2;break}return e.abrupt("return",this.uploadImage(t,r));case 2:if(!M(t)){e.next=4;break}return e.abrupt("return",this.uploadVideo(t,"messages"));case 4:if(!A(t)){e.next=6;break}return e.abrupt("return",this.uploadAudio(t));case 6:if(!x(t)){e.next=8;break}return e.abrupt("return",this.uploadDoc(t,r));case 8:if("voice"!==t.kind){e.next=10;break}return e.abrupt("return",this.uploadVoice(t,r));case 10:if(!E(t)){e.next=12;break}return e.abrupt("return",this.uploadChatPhoto(t,r));case 12:if(!R(t)){e.next=14;break}return e.abrupt("return",this.uploadOwnerPhoto(t,r));case 14:return e.abrupt("return",Promise.reject());case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"channelsUpload",value:(r=(0,u.default)(h().mark((function e(t,r){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S(t)){e.next=2;break}return e.abrupt("return",this.uploadWallImage(t,r));case 2:if(!M(t)){e.next=4;break}return e.abrupt("return",this.uploadVideo(t,"wall"));case 4:if(!A(t)){e.next=6;break}return e.abrupt("return",this.uploadAudio(t));case 6:if(!x(t)){e.next=8;break}return e.abrupt("return",this.uploadWallDoc(t,r));case 8:return e.abrupt("return",Promise.reject());case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"upload",value:(t=(0,u.default)(h().mark((function e(t,r){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!W(r)){e.next=2;break}return e.abrupt("return",this.channelsUpload(t,r));case 2:if(!z(r)){e.next=4;break}return e.abrupt("return",this.convoUpload(t,r));case 4:return e.abrupt("return",Promise.reject());case 5:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"uploadRequest",value:function(e,t,r,n){var a=this,s=r,o=new AbortController,i=function(){var r=(0,u.default)(h().mark((function r(){var i;return h().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e();case 2:return i=r.sent,r.abrupt("return",Q(i,t,{signal:o.signal,timeout:a.requestTimeout,headers:{Accept:"application/json, text/plain, */*"},onUploadProgress:function(e){a.emitter.emit(s,{loaded:e.loaded,total:e.total})}}).then((function(e){return a.emitter.removeListener(s),n(e)})).then((function(e){return a.release(),e})).catch((function(e){return a.release(),Promise.reject(e)})));case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return this.lock()?{abort:function(){return o.abort()},trackId:r,response:i()}:{abort:function(){return o.abort()},trackId:r,response:new Promise((function(e,t){a.waiting.push((function(){return i().then(e).catch(t)}))}))}}},{key:"trackProgress",value:function(e,t){this.emitter.addListener(e,t)}}]),e}(),O=function(){function e(){(0,l.default)(this,e),(0,p.default)(this,"attaches",new Map),(0,p.default)(this,"emitter",new F)}return(0,d.default)(e,[{key:"subscribe",value:function(e,t){var r=this;return this.emitter.addListener(e,t),function(){r.emitter.removeListener(e)}}},{key:"get",value:function(e){return this.attaches.get(e)}},{key:"filterMissing",value:function(e){var t=this;return e.filter((function(e){return!t.attaches.has(e)}))}},{key:"update",value:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var r=this.attaches.get(e),n="function"==typeof t?t(r):t;n&&(this.attaches.set(e,n),this.emitter.emit(e,n))}))},{key:"remove",value:function(e){var t=this;new Set(e).forEach((function(e){t.attaches.delete(e),t.emitter.removeListener(e)}))}}]),e}(),T=function(e){(0,o.default)(r,e);var t=(0,i.default)(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),(0,p.default)((0,s.default)(e),"uploads",new Map),(0,p.default)((0,s.default)(e),"failedUploads",new Map),(0,p.default)((0,s.default)(e),"state",new O),e}return(0,d.default)(r,[{key:"uploadFiles",value:function(e,t,r){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.forEach((function(e){n.toUploaderFileInfo(e,t).then((function(e){n.doUpload(e,r,a)})).catch((function(){var e;null===(e=a.onError)||void 0===e||e.call(a)}))}))}},{key:"abortUpload",value:function(e){var t,r,n=this.uploads.get(e);n&&(n.process.abort(),null===(t=(r=n.handlers).onUploadAbort)||void 0===t||t.call(r,e),this.uploads.delete(e));var a,s,o=this.failedUploads.get(e);o&&(null===(a=(s=o.handlers).onUploadAbort)||void 0===a||a.call(s,e),this.failedUploads.delete(e));this.state.remove([e])}},{key:"retryUpload",value:function(e){var t=this.failedUploads.get(e);if(t){this.failedUploads.delete(e);var r=t.file,n=t.messengerData,s=t.handlers;this.doUpload(r,n,s),this.state.update(r.trackId,(function(e){if(e)return(0,a.default)((0,a.default)({},e),{},{error:!1,abortable:!1})}))}}},{key:"getOrphans",value:function(e){return this.state.filterMissing(e)}},{key:"subscribe",value:function(e,t){var r=this;if(0===e.length)return function(){};t(this.getState(e));var n=e.map((function(n){return r.state.subscribe(n,(function(){t(r.getState(e))}))}));return function(t){n.forEach((function(e){return e()})),t(e)}}},{key:"getState",value:function(e){var t=this;if(0===e.length)return{};var r=e.reduce((function(e,r){var n=t.state.get(r);return n&&e.push(n),e}),[]);return this.buildOptimisticAttachments(r)}},{key:"doUpload",value:function(e,t,r){var n,a=this,s=e.trackId;null===(n=r.onUploadStart)||void 0===n||n.call(r,[s]),this.upload(e,t).then((function(e){return a.uploads.set(s,{process:e,handlers:r}),a.trackProgress(s,(function(e){var t=e.loaded,n=e.total;return a.updateAttachProgress(s,{loaded:t,total:n,error:!1,abortable:t!==n},r)})),Promise.resolve(e.response).then((function(e){var t,n=a.modifyUploadedAttach(s,e),o=new Map(n?[[s,n]]:[]);null===(t=r.onUploadFinish)||void 0===t||t.call(r,o),a.state.remove([s])})).catch((function(e){return e instanceof y.IUploader.AbortError?Promise.resolve():Promise.reject(e)})).finally((function(){a.uploads.delete(s)}))})).catch((function(n){var o;console.error("[UPLOADER] Ошибка загрузки",n),null===(o=r.onError)||void 0===o||o.call(r),a.failedUploads.set(s,{file:e,messengerData:t,handlers:r}),a.updateAttachProgress.call(a,s,{loaded:0,total:0,error:!0,abortable:!1},r)}))}},{key:"toUploaderFileInfo",value:function(e,t){var n=this,s=t.asFiles,o=t.asVoice,i=t.asChatPhoto,c=t.asOwnerPhoto;if(!(e instanceof File)){if(!o)throw new Error("Загрузить аудиосообщения можно только с флагом asVoice");var l=e.blob,d=e.duration,p=e.waveform,f=new File([l],"voice_recording",{type:"audio/ogg"}),v=r.toFileInfo(f,"voice");return function(e,t,r,n){return Promise.resolve({kind:"OptimisticVoice",id:e.trackId,blob:t,duration:r,waveform:n,loaded:0,total:e.file.size})}(v,l,d,p).then((function(e){return n.state.update(v.trackId,e),v}))}var y,m=e;if(i){var g=r.toFileInfo(m,"chat-photo");return Promise.resolve(g)}if(c){var b=r.toFileInfo(m,"owner-photo");return Promise.resolve(b)}if(!s&&N(m)){var k=r.toFileInfo(m,"image");return(y=k,new Promise((function(e){G(y.file).then((function(t){e({kind:"OptimisticPhoto",id:y.trackId,image:t,loaded:0,total:y.file.size})}))}))).then((function(e){return n.state.update(k.trackId,e),k}))}if(!s&&L(m)){var C=r.toFileInfo(m,"video");return function(e){return new Promise((function(t){(function(e){return H(URL.createObjectURL(e))})(e.file).then((function(r){(function(e){function t(e,t){return new Promise((function(r,n){e.onseeked=function(){e.videoWidth&&e.videoHeight||r(void 0);var t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;var n=t.getContext("2d");n?(n.drawImage(e,0,0),r(t.toDataURL("image/jpeg"))):r(void 0)},e.onerror=n,e.currentTime=t}))}return t(e,.5*e.duration).catch(function(){var r=(0,u.default)(h().mark((function r(n){var a,s,o,i;return h().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("string"!=typeof n){r.next=2;break}return r.abrupt("return",Promise.reject(n));case 2:if((o=null===(a=n.composedPath())||void 0===a?void 0:a[0])instanceof HTMLVideoElement&&4===(null==o||null===(s=o.error)||void 0===s?void 0:s.code)){r.next=5;break}return r.abrupt("return",Promise.reject(n));case 5:return r.next=7,H(e.src);case 7:return i=r.sent,r.abrupt("return",t(i,Math.min(e.duration,1)));case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())})(r).then((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t({kind:"OptimisticVideo",id:e.trackId,duration:Math.floor(r.duration),loaded:0,total:e.file.size,image:{url:n,width:r.videoWidth,height:r.videoHeight}})}))}))}))}(C).then((function(e){return n.state.update(C.trackId,e),C}))}if(!s&&D(m)){var _=r.toFileInfo(m,"audio");return function(e){return new Promise((function(t){var r=new Audio,n=URL.createObjectURL(e.file);r.addEventListener("loadedmetadata",(function(){t({kind:"OptimisticAudio",id:e.trackId,duration:r.duration,artist:"",title:e.file.name,loaded:0,total:e.file.size})})),r.src=n}))}(_).then((function(e){return n.state.update(_.trackId,e),_}))}var w=r.toFileInfo(m,"doc");return function(e){return new Promise((function(t){var r=/\.([0-9a-z]+)$/i.exec(e.file.name),n={kind:"OptimisticDoc",id:e.trackId,title:e.file.name,size:e.file.size,ext:(null==r?void 0:r[1])||"",loaded:0,total:e.file.size};N(e.file)?G(e.file).then((function(e){return t((0,a.default)((0,a.default)({},n),{},{image:e}))})):t(n)}))}(w).then((function(e){return n.state.update(w.trackId,e),w}))}},{key:"modifyUploadedAttach",value:function(e,t){if(!t)return null;var r=this.state.get(e),n=t;return"Video"===t.kind&&"OptimisticVideo"===(null==r?void 0:r.kind)&&r&&(n=(0,a.default)((0,a.default)({},t),{},{duration:r.duration,image:[r.image]})),n}},{key:"updateAttachProgress",value:function(e,t,r){var n=r.onUploadProgressUpdate;this.state.update(e,(function(e){if(e){switch(e.kind){case"OptimisticPhoto":null==n||n("photo");break;case"OptimisticVideo":null==n||n("video");break;case"OptimisticDoc":null==n||n("file")}return(0,a.default)((0,a.default)({},e),t)}}))}},{key:"buildOptimisticAttachments",value:function(e){return e.reduce((function(e,t){var r=[],a=[],s=[],o=[];switch(t.kind){case"OptimisticPhoto":r.push(t);break;case"OptimisticVideo":a.push(t);break;case"OptimisticAudio":s.push(t);break;case"OptimisticDoc":o.push(t);break;case"OptimisticVoice":e.voice=t}return r.length&&(e.photos=[].concat((0,n.default)(e.photos||[]),r)),a.length&&(e.videos=[].concat((0,n.default)(e.videos||[]),a)),s.length&&(e.audios=[].concat((0,n.default)(e.audios||[]),s)),o.length&&(e.docs=[].concat((0,n.default)(e.docs||[]),o)),e}),{})}}],[{key:"clearOptimisticAttachments",value:function(e,t){t.forEach((function(t){if("photos"in e){if(!e.photos)return;var r=(0,m.toNonEmpty)(e.photos.filter((function(e){return e.id!==t})));r?e.photos=r:delete e.photos}if("videos"in e){if(!e.videos)return;var n=(0,m.toNonEmpty)(e.videos.filter((function(e){return e.id!==t})));n?e.videos=n:delete e.videos}if("audios"in e){if(!e.audios)return;var a=(0,m.toNonEmpty)(e.audios.filter((function(e){return e.id!==t})));a?e.audios=a:delete e.audios}if("docs"in e){if(!e.docs)return;var s=(0,m.toNonEmpty)(e.docs.filter((function(e){return e.id!==t})));s?e.docs=s:delete e.docs}"voice"in e&&delete e.voice}))}},{key:"buildAttachments",value:function(e){return e.reduce((function(e,t){return(0,C.produce)(e,(function(r){var a,s,o,i,u=null,c=null,l=null,d=null;switch(t.kind){case"Photo":u=(0,m.toNonEmpty)([t]);break;case"Video":c=(0,m.toNonEmpty)([t]);break;case"Audio":l=(0,m.toNonEmpty)([t]);break;case"Doc":d=(0,m.toNonEmpty)([t]);break;case"Voice":r.voice=t}null!==(a=u)&&void 0!==a&&a.length&&(r.photos=[].concat((0,n.default)(e.photos||[]),(0,n.default)(u))),null!==(s=c)&&void 0!==s&&s.length&&(r.videos=[].concat((0,n.default)(e.videos||[]),(0,n.default)(c))),null!==(o=l)&&void 0!==o&&o.length&&(r.audios=[].concat((0,n.default)(e.audios||[]),(0,n.default)(l))),null!==(i=d)&&void 0!==i&&i.length&&(r.docs=[].concat((0,n.default)(e.docs||[]),(0,n.default)(d)))}))}),{})}},{key:"hash",value:function(){return Math.floor(1e8*Math.random()+1e8).toString(16)}},{key:"resolveTrackId",value:function(e,t){if(0===t.length)throw new Error("Нельзя отдавать пустую строку в Uploader.resolveTrackId");return"".concat(e,"-").concat(t)}},{key:"toFileInfo",value:function(e,t){switch(t){case"image":return{kind:"image",trackId:r.resolveTrackId("image",r.hash()),file:e};case"video":return{kind:"video",trackId:r.resolveTrackId("video",r.hash()),file:e};case"audio":return{kind:"audio",trackId:r.resolveTrackId("audio",r.hash()),file:e};case"doc":return{kind:"doc",trackId:r.resolveTrackId("doc",r.hash()),file:e};case"voice":return{kind:"voice",trackId:r.resolveTrackId("voice",r.hash()),file:e};case"chat-photo":return{kind:"chat-photo",trackId:r.resolveTrackId("chat-photo",r.hash()),file:e};case"owner-photo":return{kind:"owner-photo",trackId:r.resolveTrackId("owner-photo",r.hash()),file:e};default:(0,m.exhaustivenessCheck)(t)}}}]),r}(P),F=function(){function e(){(0,l.default)(this,e),(0,p.default)(this,"map",new Map)}return(0,d.default)(e,[{key:"addListener",value:function(e,t){this.map.set(e,[].concat((0,n.default)(this.map.get(e)||[]),[t]))}},{key:"removeListener",value:function(e){this.map.delete(e)}},{key:"emit",value:function(e,t){var r;null===(r=this.map.get(e))||void 0===r||r.forEach((function(e){return e(t)}))}}]),e}();function N(e){return!(e instanceof DataTransferItem&&"file"!==e.kind)&&Boolean(e.type&&_.includes(e.type))}function q(e){return e.every(N)}function L(e){return!(e instanceof DataTransferItem&&"file"!==e.kind)&&Boolean(e.type&&w.includes(e.type))}function j(e){return e.every(L)}function D(e){return!(e instanceof DataTransferItem&&"file"!==e.kind)&&Boolean(e.type&&I.includes(e.type))}function B(e){return e.every(D)}function G(e){var t=URL.createObjectURL(e);return new Promise((function(e,r){var n=new Image;n.onload=function(){e({url:t,width:n.width,height:n.height})},n.onerror=r,n.src=t}))}function H(e){return new Promise((function(t,r){var n=document.createElement("video");n.volume=0,n.preload="metadata",n.onloadedmetadata=function(){return t(n)},n.onerror=r,n.src=e}))}function V(e){return new Promise((function(t){var r=new Image,n=URL.createObjectURL(e.file);r.onload=function(){var e=Math.min(r.width,r.height),n=Math.floor((r.width-e)/2),a=Math.floor((r.height-e)/2);t({x:n,y:a,width:e})},r.src=n}))}function W(e){return!!e.targetPeerId&&k.isChannelId(e.targetPeerId)}function z(e){return!W(e)}function K(e){return!!e&&k.isChannelId(e)}function $(e){return!!e&&!k.isChannelId(e)}function Q(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(n,a){var s=r.method,o=void 0===s?"POST":s,i=r.signal,u=r.onUploadProgress,l=r.headers,d=void 0===l?{}:l,p=r.timeout;if(null!=i&&i.aborted)return a(new y.IUploader.AbortError);var f=new XMLHttpRequest,h=function(){return f.abort()};i&&(i.addEventListener("abort",h),f.addEventListener("readystatechange",(function(){4===f.readyState&&i.removeEventListener("abort",h)}))),f.addEventListener("abort",(function(){a(new y.IUploader.AbortError)})),f.addEventListener("error",a),f.addEventListener("timeout",(function(){a(new y.IUploader.TimeoutError)})),f.upload.addEventListener("progress",(function(e){e.lengthComputable&&(null==u||u(e))})),f.addEventListener("loadend",(function(){var e,t=f.readyState,r=f.status,s=f.responseText;try{e=JSON.parse(s)}catch(e){return a(e)}return 4===t&&200===r?n({data:e}):a(e)})),f.open(o,e,!0),Object.entries(d).forEach((function(e){var t=(0,c.default)(e,2),r=t[0],n=t[1];f.setRequestHeader(r,n)})),p&&(f.timeout=p),f.send(t)}))}},716192:(e,t,r)=>{"use strict";r.d(t,{handler:()=>s});var n=r(837021),a=r(314432),s=function(e,t,r){var s=t.profiles,o=t.groups,i=t.conversations,u=t.mutualFriends,c=t.contacts;if((0,n.insertConvos)(e,i||[]),(0,n.insertPeers)(e,{apiUsers:s||[],apiGroups:o||[],apiContacts:c||[]}),u){var l=e.peers.get(a.resolveId(u.peerId));l&&a.updateMutualFriends(l,u.hint.map(a.resolveId),u.count)}return[]}},104571:(e,t,r)=>{"use strict";r.d(t,{handler:()=>b});var n=r(111965),a=r(334738),s=r(678927),o=r(28991),i=r(692137),u=r(887757),c=r.n(u),l=r(837021),d=r(21705),p=r(527119),f=r(782597),h=r(716352),v=r(30966),y=r(314432),m=r(610557),g=r(190831),b=function(e,t){switch(t.variant.kind){case"FromChannelEngine":return k(e,t.variant);case"FromChannelEngineWithMissingData":return function(e,t){var r=t.next,n=(0,a.default)(t.response,2),o=n[0],i=n[1];o&&(0,l.insertChannels)(e,{apiChannels:o.items||[],apiGroups:o.groups||[],dangerouslyMerge:!0});(i||o)&&(0,l.insertPeers)(e,{apiUsers:[].concat((0,s.default)(i||[]),(0,s.default)((null==o?void 0:o.profiles)||[])),apiGroups:(null==o?void 0:o.groups)||[],apiContacts:[]});return k(e,{kind:"FromChannelEngine",isRetry:!0,next:r})}(e,t.variant);case"FromChannelEngineApiHistory":return function(e,t){var r,a=t.ts,o=t.history,i=t.posts,u=new Map,c=(0,n.default)(i);try{for(c.s();!(r=c.n()).done;){var l=r.value,d=u.get(l.channel_id);d||(d=new Map,u.set(l.channel_id,d)),d.set(l.cmid,l)}}catch(e){c.e(e)}finally{c.f()}return k(e,{kind:"FromChannelEngine",next:{kind:"Batch",ts:a,updates:o.reduce((function(e,t){switch(t[0]){case 70001:case 70002:var r,n=null===(r=u.get(t[1]))||void 0===r?void 0:r.get(t[2]);return n?(e.push([].concat((0,s.default)(t),[n])),e):e;default:return e.push(t),e}}),[])}})}(e,t.variant);default:return(0,d.exhaustivenessCheck)(t.variant)}};function k(e,t){var r=t.isRetry,u=t.next;if("Failure"===u.kind){e.channelConn.status="resyncing";var l=e.channelConn.ts;return[function(){var e=(0,i.default)(c().mark((function e(t){var r,n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.api,n=t.channelEngine){e.next=3;break}return e.abrupt("return",{type:"Noop"});case 3:return e.next=5,(0,d.sleep)(1e3);case 5:return e.prev=5,e.next=8,r.fetch("channels.getLongPollHistory",{lp_version:n.version,ts:l,limit:1e3,extended:1},{retries:1/0,timeout:g.CHANNELS_GLPH_TIMEOUT});case 8:a=e.sent,e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(5),e.abrupt("return",{type:"Noop"});case 14:return n.connect((0,o.default)((0,o.default)({},a.credentials),{},{ts:a.new_ts})),e.abrupt("return",{type:"ChannelEngineBatchReceived",variant:{kind:"FromChannelEngineApiHistory",ts:a.new_ts,history:a.history,posts:a.messages||[]}});case 16:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}()]}if(!r){var b=function(e,t){var r=new Set,s=new Set;function o(t){switch(t[0]){case 70001:var i,u,c,l,d=(0,a.default)(t,5),p=d[1],f=d[4],v=h.resolveId(p);if(e.channels.has(v)||r.add(v),null!==(i=f.attachments)&&void 0!==i&&null!==(u=i[0])&&void 0!==u&&null!==(c=u.wall.copy_history)&&void 0!==c&&null!==(l=c[0])&&void 0!==l&&l.from_id){var m=y.resolveId(f.attachments[0].wall.copy_history[0].from_id);if(y.isUserPeerId(m)){s.add(m);break}if(y.isGroupPeerId(m)){r.add(h.resolveId(m));break}}break;case 70002:case 70003:case 70004:case 70010:case 70007:case 70008:break;case 70005:var g=(0,a.default)(t,3),b=g[1];if(g[2]){var k=h.resolveId(b);r.add(k)}break;case 70009:var C=(0,a.default)(t,3),_=C[1];if(C[2]){var w=h.resolveId(_);r.add(w)}break;case 70011:var I,S=(0,n.default)(t[1]);try{for(S.s();!(I=S.n()).done;){o(I.value)}}catch(e){S.e(e)}finally{S.f()}break;default:}}var i,u=(0,n.default)(t.updates);try{for(u.s();!(i=u.n()).done;){o(i.value)}}catch(e){u.e(e)}finally{u.f()}return{channelIds:r,userIds:s}}(e,u);if(b.channelIds.size>0||b.userIds.size>0)return[function(){var e=(0,i.default)(c().mark((function e(t){var r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetchMany([b.channelIds.size>0&&{method:"channels.getById",params:{channel_ids:Array.from(b.channelIds).join(","),extended:1}},b.userIds.size>0&&{method:"users.get",params:{user_ids:Array.from(b.userIds).map(y.toRealId).join(","),extended:1}}],{retries:1/0});case 4:return n=e.sent,e.abrupt("return",{type:"ChannelEngineBatchReceived",variant:{kind:"FromChannelEngineWithMissingData",next:u,response:n}});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"Noop"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]}e.channelConn.status="running",e.channelConn.ts=u.ts;var k=u.updates.flatMap((function t(r){switch(r[0]){case 70001:return function(e,t){var r=(0,a.default)(t,5),s=r[1],o=r[3],i=r[4],u=h.resolveId(s),c=e.channels.get(u);if(!c)return[];h.setSortId(c,{minorSortId:o});var l,d=(0,m.fromApiPost)(i),f=d.post,v=d.reactions,y=(0,n.default)(v);try{for(y.s();!(l=y.n()).done;){var g=l.value;e.reactions.set(g.id,g)}}catch(e){y.e(e)}finally{y.f()}h.appendPost(c,f),p.refreshChannels(e.organisers,c),e.locks.channelsCleanup.has(u)||h.cleanup(c);return[]}(e,r);case 70002:return function(e,t){var r=(0,a.default)(t,4),s=r[1],o=r[3],i=h.resolveId(s),u=e.channels.get(i);if(!u)return[];var c,l=(0,m.fromApiPost)(o),d=l.post,p=l.reactions,f=(0,n.default)(p);try{for(f.s();!(c=f.n()).done;){var v=c.value;e.reactions.set(v.id,v)}}catch(e){f.e(e)}finally{f.f()}return h.replacePost(u,d),[]}(e,r);case 70003:return function(e,t){var r=(0,a.default)(t,4),n=r[1],s=r[2],o=r[3],i=h.resolveId(n),u=v.resolveCmid(s),c=e.channels.get(i);if(!c)return[];return h.setSortId(c,{minorSortId:o}),h.deletePost(c,u,!1),[]}(e,r);case 70004:return function(e,t){var r=(0,a.default)(t,4),n=r[1],s=r[2],o=r[3],i=h.resolveId(n),u=v.resolveCmid(s),c=e.channels.get(i);if(!c)return[];return h.readUntil(c,u,o),[]}(e,r);case 70005:return function(e,t){var r=(0,a.default)(t,4),n=r[1],s=r[2],o=r[3],i=h.resolveId(n),u=e.channels.get(i);if(!u)return[];return h.setArchived(u,!s),f.updateCounters(e.organisers.channelFilters,{archiveTotal:o}),p.refreshChannels(e.organisers,u),[]}(e,r);case 70007:return function(e,t){var r=(0,a.default)(t,3),n=r[1],s=r[2],o=h.resolveId(n),i=e.channels.get(o);if(!i)return[];return h.setMuted(i,0!==s),[]}(e,r);case 70008:return function(e,t){var r=(0,a.default)(t,2)[1];return f.updateCounters(e.organisers.channelFilters,{unread:r}),[]}(e,r);case 70009:return function(e,t){var r=(0,a.default)(t,3),n=r[1],s=r[2],o=h.resolveId(n),i=e.channels.get(o);if(!i)return[];return h.setMembership(i,Boolean(s)),p.refreshChannels(e.organisers,i),[]}(e,r);case 70010:return function(e,t){var r=(0,a.default)(t,5),n=r[1],s=r[4],o=h.resolveId(n),i=e.channels.get(o);if(!i)return[];var u=(0,m.fromApiPost)(s).post;"Normal"===u.kind&&h.restorePost(i,u.cmid,u);return[]}(e,r);case 70011:return r[1].flatMap(t);default:return[]}}));return[].concat((0,s.default)(k),[function(){var e=(0,i.default)(c().mark((function e(t){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.channelEngine){e.next=3;break}return e.abrupt("return",{type:"Noop"});case 3:return e.next=5,r.poll();case 5:return e.t0=e.sent,e.t1={kind:"FromChannelEngine",next:e.t0},e.abrupt("return",{type:"ChannelEngineBatchReceived",variant:e.t1});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()])}},160136:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(782597),u=r(837021),c=function(e,t){switch(t.type){case"ChannelsOnboardingDone":return 0===t.pickedChannelsIds.length?(i.push(e.organisers.channelFilters,"all",[],!1),[function(){var e=(0,n.default)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.next=3,r.fetch("account.hideHelpHint",{hint_id:"im:channels_onboarding"},{retries:1/0});case 3:return e.abrupt("return",{type:"Noop"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]):[function(){var e=(0,n.default)(s().mark((function e(r){var n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.api,e.prev=1,e.next=4,n.fetch("channels.unarchive",{channel_ids:t.pickedChannelsIds.join(",")||"",extended:1});case 4:return a=e.sent,e.abrupt("return",{type:"ChannelsOnboardingDone_RequestSucceeded",responseChannels:a});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"ChannelsOnboardingDone_RequestFailed"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"ChannelsOnboardingDone_RequestSucceeded":var r=(0,u.insertChannels)(e,{apiChannels:t.responseChannels.succeeded||[],apiGroups:t.responseChannels.groups||[]});return i.push(e.organisers.channelFilters,"all",r,!1),[function(){var e=(0,n.default)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.next=3,r.fetch("account.hideHelpHint",{hint_id:"im:channels_onboarding"},{retries:1/0});case 3:return e.abrupt("return",{type:"Noop"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];case"ChannelsOnboardingDone_RequestFailed":return[];default:(0,o.exhaustivenessCheck)(t)}}},103820:(e,t,r)=>{"use strict";r.d(t,{handler:()=>x});var n=r(399809),a=r(896156),s=r(111965),o=r(678927),i=r(28991),u=r(334738),c=r(692137),l=r(887757),d=r.n(l),p=r(837021),f=r(281385),h=r(341570),v=r(527119),y=r(252229),m=r(314432),g=r(509727),b=r(980662),k=r(360202),C=r(208134),_=r(21705),w=r(190831),I=r(975474),S=r(583906),M=r(590917),A=r(767084),x=function(e,t,r){switch(t.type){case"EngineBatchReceived":var n=t.variant;switch(n.kind){case"FromEngine":return R(r,e,n);case"FromEngineWithMissingData":return function(e,t,r){var n=r.apiConvos,a=r.apiMessages,s=r.apiUsers,o=r.apiGroups,i=r.apiContacts,u=U(a,n);return(0,p.insertConvos)(t,n.map((function(e){return{conversation:e,last_message:u.messages_legacy.get(e.last_message_id)}})),{dangerouslyMerge:!0}),(0,p.insertPeers)(t,{apiUsers:s,apiGroups:o,apiContacts:i}),R(e,t,{kind:"FromEngine",next:r.skippedBatch},u)}(r,e,n);case"FromApiEngineHistory":return function(e,t,r){var n,a=r.next,s=r.apiMessages,i=r.apiConvos,u=r.apiUsers,l=r.apiGroups,f=r.apiContacts,h=r.apiCounters,v=U(s,i);(0,p.insertConvos)(t,i.map((function(e){return{conversation:e,last_message:v.messages_legacy.get(e.last_message_id)}})),{dangerouslyMerge:!0}),(0,p.insertPeers)(t,{apiUsers:u,apiGroups:l,apiContacts:f},{dangerouslyOverwrite:!0}),y.updateCounters(t.organisers.filters,{unread:h.messages||0,unreadUnmuted:h.messages_unread_unmuted||0,headerNotMutedUnread:0,archive:h.messages_archive_unread||0,archiveMentions:h.messages_archive_mentions_count||0,archiveTotal:h.messages_archive||0,messageRequests:h.message_requests||0}),null===(n=h.messages_folders)||void 0===n||n.forEach((function(e){k.setUnreadCounters(t.organisers.folders,k.resolveId(e.folder_id),e.total_count,e.unmuted_count)}));var m=t.organisers.filters.unread.unreadUnmutedCount;return[].concat((0,o.default)(R(e,t,{kind:"FromEngine",next:a},v)),[function(){var e=(0,c.default)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.notification.setCounters({unread:m}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()])}(r,e,n);default:return(0,_.exhaustivenessCheck)(n)}case"EngineBatchReceived_TypingsTimedOut":var a=t.peerId,s=t.typingType,i=t.timestamp,u=e.typings.get(a);if(!u)return[];var l=u[s];return l?(l.updatedAt<=i&&delete u[s],0===Object.keys(u).length&&e.typings.delete(a),[]):[];case"UpdateMessageRequestsCounter":return[function(){var e=(0,c.default)(d().mark((function e(t){var r,n,a,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,n=A.IApi.resolveTrackId("account.getCounters","message_requests"),r.dangerouslyAbort(n),e.next=6,r.fetch("account.getCounters",{filter:"message_requests"},{trackId:n});case 6:return a=e.sent,s=a.message_requests,e.abrupt("return",{type:"UpdateMessageRequestsCounter_RequestCompleted",count:null!=s?s:0});case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",{type:"Noop"});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()];case"UpdateMessageRequestsCounter_RequestCompleted":return y.updateCounters(e.organisers.filters,{messageRequests:t.count}),[];case"TemporaryHackForResync":case"LoadChatMembers":case"LoadChatInfo":case"UpdateComposerDraftOnMessageDelete":case"ActualizeArchiveMentions":return[];default:return(0,_.exhaustivenessCheck)(t)}};function R(e,t,r,l){var A=r.next;if("Failure"===A.kind){t.convoConn.status="resyncing";var x=t.convoConn.pts,R=t.ownerId;return[function(){var e=(0,c.default)(d().mark((function e(t){var r,n,a,s,o,c,l,f;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,a=t.engine,s=t.queue,e.next=3,(0,_.sleep)(1e3);case 3:return e.prev=3,e.next=7,n.fetchSeq([{method:"messages.getLongPollHistory",params:{lp_version:a.version,credentials:1,pts:x,msgs_limit:1100,events_limit:1100,last_n:1e3,extended:1,group_id:(0,p.getOwnerGroupId)(R)}},{method:"account.getCounters",params:{filter:"all"}}],{retries:1/0});case 7:l=e.sent,f=(0,u.default)(l,2),o=f[0],c=f[1],e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(3),e.abrupt("return",{type:"Noop"});case 16:if(!(x<(o.from_pts||0))){e.next=20;break}return s.disconnect(),console.error("Выполняется полный ресинк"),e.abrupt("return",{type:"TemporaryHackForResync"});case 20:if(o.credentials&&o.credentials.pts){e.next=22;break}throw new Error("В ответе getLongPollHistory отсутствуют новые креды!");case 22:return e.next=24,a.connect((0,i.default)((0,i.default)({},o.credentials),{},{pts:o.credentials.pts}));case 24:return e.abrupt("return",{type:"EngineBatchReceived",variant:{kind:"FromApiEngineHistory",apiMessages:(null===(r=o.messages)||void 0===r?void 0:r.items)||[],apiConvos:o.conversations||[],apiUsers:o.profiles||[],apiGroups:o.groups||[],apiContacts:o.contacts||[],apiCounters:c,next:{kind:"Batch",pts:o.credentials.pts,ts:o.credentials.ts,updates:o.history||[]}}});case 25:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}()]}if(!(void 0!==l)&&function(e,t,r){var n,a=(0,s.default)(t.updates);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(f.IEngine.isIncompleteUpdate(o))return!0;switch(o[0]){case 20:case 21:var i=(0,u.default)(o,2)[1],c=m.resolveId(i);if(!e.convos.has(c))return!0;break;case 52:var l=(0,u.default)(o,4),d=l[1],p=l[2],v=l[3],y=m.resolveId(p),g=e.convos.get(y);if(!g)break;switch(d){case f.IEngine.ChatUpdateType.TitleChanged:case f.IEngine.ChatUpdateType.AvatarChanged:case f.IEngine.ChatUpdateType.BannerChanged:case f.IEngine.ChatUpdateType.MessageRequestChanged:case f.IEngine.ChatUpdateType.MessageRequestCanceled:case f.IEngine.ChatUpdateType.MessageRequestAccepted:case f.IEngine.ChatUpdateType.MessageRequestRejected:case f.IEngine.ChatUpdateType.CallInProgressChanged:case f.IEngine.ChatUpdateType.ContactConverted:case f.IEngine.ChatUpdateType.ContactJoined:case f.IEngine.ChatUpdateType.DescriptionChanged:return!0;case f.IEngine.ChatUpdateType.UserJoined:case f.IEngine.ChatUpdateType.UserLeft:case f.IEngine.ChatUpdateType.UserKicked:var k=m.resolveId(v);if(!e.peers.has(k))return!0;if(d===f.IEngine.ChatUpdateType.UserJoined&&k===e.ownerId)return!0;break;case f.IEngine.ChatUpdateType.Pinned:var C=(0,u.default)(o,4)[3];if(0===C)break;var _=b.resolveCmid(C);return!g.persisted.has(_);case f.IEngine.ChatUpdateType.CopyFlagChanged:case f.IEngine.ChatUpdateType.AdminGrated:case f.IEngine.ChatUpdateType.FlagsChanged:case f.IEngine.ChatUpdateType.AdminKicked:case f.IEngine.ChatUpdateType.KeyboardChanged:case f.IEngine.ChatUpdateType.BusinessNotifyDataChanged:case f.IEngine.ChatUpdateType.DonUnsubscribed:case f.IEngine.ChatUpdateType.DonSubscribed:case f.IEngine.ChatUpdateType.IsNewChange:case f.IEngine.ChatUpdateType.StyleChanged:case f.IEngine.ChatUpdateType.ShortPollReactionsChanged:break;default:}break;case 10013:var w=(0,u.default)(o,2)[1],I=m.resolveId(w);return e.convos.has(I);case 63:case 64:case 65:case 66:case 67:case 68:case 1:case 2:case 3:case 6:case 7:case 10:case 11:case 12:case 80:case 114:case 115:case 119:case 501:case 502:case 503:case 504:case 505:case 506:case 507:case 508:case 601:case 602:case 10001:case 10002:case 10006:case 10007:break;case 10003:var S=(0,u.default)(o,4),M=S[2],A=S[3];if(f.IEngine.isIncompleteUpdate(o))break;var x=m.resolveId(A),R=e.convos.get(x);if(!R)break;var E=b.convertFlags(M),U=E.isDeleted,T=E.isSpam;if((U||T)&&R)return!0;break;case 4:case 10004:var F=(0,u.default)(o,9),N=F[4],q=F[7],L=F[8],j=m.resolveId(N),D=e.convos.get(j);if(!D)return!0;var B=P(D);if(O(L,B))return!0;if(q.has_template)return!0;var G=(0,h.fromEngineMessage)(o,e.ownerId,B).message;if(!e.peers.has(G.peerId)||!e.peers.has(G.authorId))return!0;if(m.isUserPeerId(G.authorId)&&G.peerId===G.authorId&&!e.onlines.has(G.authorId))return!0;break;case 5:case 18:case 10005:case 10018:var H=(0,u.default)(o,8),V=H[2],W=H[3],z=H[7],K=m.resolveId(W),$=e.convos.get(K);if(!$)break;if(O(z,P($)))return!0;b.convertFlags(V);if(r.vkm_reactions)return!0;break;case 19:case 10019:return!0;default:}}}catch(e){a.e(e)}finally{a.f()}return!1}(t,A,e))return[E(t.convoConn.pts,A,t.ownerId)];t.convoConn.status="running",t.convoConn.pts=A.pts;var U=A.updates.flatMap((function(e){switch(e[0]){case 1:case 2:case 3:return function(e,t,r){var n=(0,u.default)(t,4),a=n[0],s=n[1],o=n[2],i=n[3],c=m.resolveId(i),l=b.resolveId(s),d=e.convos.get(c);if(!d)return[];var p=g.findMessageById(d,l);if(!p)return[];return T(e,[{1:10001,2:10002,3:10003}[a],p.cmid,o,i])}(t,e);case 4:case 5:case 18:case 19:return function(e,t,r){var n,a=(0,u.default)(t,2)[1],s=null==r?void 0:r.messages_legacy.get(a);switch(t[0]){case 4:if(f.IEngine.isIncompleteUpdate(t)){if(!s)return[];var o=(0,u.default)(t,4),i=o[2],c=o[3];n=[10004,s.conversation_message_id,i,c,s.peer_id];break}var l=(0,u.default)(t,12),d=l[2],p=l[3],h=l[4],v=l[5],y=l[6],m=l[7],g=l[8],b=l[9];n=[10004,l[10],d,p,h,v,y,m,g,b,a,l[11]];break;case 5:if(f.IEngine.isIncompleteUpdate(t)){if(!s)return[];var k=(0,u.default)(t,3)[2];n=[10005,s.conversation_message_id,k,s.peer_id];break}var C=(0,u.default)(t,11),w=C[2],I=C[3],S=C[4],M=C[5],A=C[6],x=C[7],R=C[8];n=[10005,C[9],w,I,S,M,A,x,R,a,C[10]];break;case 18:if(f.IEngine.isIncompleteUpdate(t)){if(!s)return[];var E=(0,u.default)(t,3)[2];n=[10018,s.conversation_message_id,E,s.peer_id];break}var U=(0,u.default)(t,11),P=U[2],O=U[3],T=U[4],N=U[5],q=U[6],L=U[7],j=U[8];n=[10018,U[9],P,O,T,N,q,L,j,a,U[10]];break;case 19:if(!s)return[];n=[10019,s.conversation_message_id,s.peer_id];break;default:(0,_.exhaustivenessCheck)(t)}return F(e,n,r)}(t,e,l);case 6:case 7:return function(e,t,r){var n,a=(0,u.default)(t,2),s=a[0],o=a[1],i=m.resolveId(o),c=e.convos.get(i);if(!c)return[];var l=null==r?void 0:r.convos.get(o),d=l&&(null===(n=(0,I.fromApiConvo)(l))||void 0===n?void 0:n.convo);if(!d)return[];return 6===s?g.readInUntil(c,d.inReadBy,d.unreadCount):g.readOutUntil(c,d.outReadBy),v.refresh(e.organisers,c),[]}(t,e,l);case 10:case 11:case 12:return function(e,t){var r=(0,u.default)(t,3),n=r[0],a=r[1],s=r[2],o=m.resolveId(a),i=e.convos.get(o);if(!i)return[];var c={10:"unset",11:"replace",12:"set"}[n];return g.updateFlags(i,c,s),v.refresh(e.organisers,i),[]}(t,e);case 20:return function(e,t){var r=(0,u.default)(t,3),n=r[1],a=r[2],s=m.resolveId(n),o=e.convos.get(s);if(!o)return[];return g.updateSortId(o,{majorSortId:a}),v.refresh(e.organisers,o),[]}(t,e);case 21:return function(e,t){var r=(0,u.default)(t,3),n=r[1],a=r[2],s=m.resolveId(n),o=e.convos.get(s);if(!o)return[];g.updateSortId(o,{minorSortId:a}),v.refresh(e.organisers,o);var i=a<=0,l=e.organisers.filters.messageRequest.totalCount>0;if(i&&l)return[(0,c.default)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"UpdateMessageRequestsCounter",peerId:s});case 1:case"end":return e.stop()}}),e)})))];return[]}(t,e);case 52:return function(e,t,r,n){var a=(0,u.default)(t,4),s=a[1],o=a[2],i=a[3],l=m.resolveId(o),p=e.convos.get(l);if(!p)return[];var h=null==n?void 0:n.convos.get(o),y=h&&(0,I.fromApiConvo)(h);switch(s){case f.IEngine.ChatUpdateType.CopyFlagChanged:case f.IEngine.ChatUpdateType.TitleChanged:case f.IEngine.ChatUpdateType.AvatarChanged:case f.IEngine.ChatUpdateType.FlagsChanged:return[];case f.IEngine.ChatUpdateType.Pinned:if("ChatConvo"!==p.kind)return[];var k=i,C=b.resolveCmid(k);if(p.pinnedMessage){var _=p.persisted.get(p.pinnedMessage.cmid);"Normal"===(null==_?void 0:_.kind)&&b.unpinMessage(_)}if(e.hiddenPinnedMessages.delete(l),(null==y?void 0:y.convo.kind)===p.kind)return y.convo.pinnedMessage&&g.pinMessage(p,y.convo.pinnedMessage),[];if(0===C)g.unpinMessage(p);else{var w=p.persisted.get(C);"Normal"===(null==w?void 0:w.kind)&&g.pinMessage(p,b.toPinned(w))}return[];case f.IEngine.ChatUpdateType.ContactJoined:return[];case f.IEngine.ChatUpdateType.UserJoined:if("ChatConvo"!==p.kind)return[];var S=m.resolveId(i);if(!m.isUserPeerId(S)&&!m.isGroupPeerId(S))return[];if(p.members){var M={peerId:S,isAdmin:p.adminIds.has(S),canKick:p.adminIds.has(e.viewer.id),isMessageRequest:!1};g.addMembers(p,[M])}return S===e.ownerId?(g.changeUserState(p,"in"),g.allowWrite(p),e.locks.getConversationMembers.add(l),[m.isChatPeerId(l)&&(0,c.default)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"LoadChatMembers",peerId:l});case 1:case"end":return e.stop()}}),e)}))),m.isChatPeerId(l)&&(0,c.default)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"LoadChatInfo",peerId:l});case 1:case"end":return e.stop()}}),e)})))]):[];case f.IEngine.ChatUpdateType.UserLeft:if("ChatConvo"!==p.kind)return[];var A=m.resolveId(i);return m.isUserPeerId(A)||m.isGroupPeerId(A)?(A===e.ownerId&&g.changeUserState(p,"left"),g.removeMember(p,A),[]):[];case f.IEngine.ChatUpdateType.UserKicked:if("ChatConvo"!==p.kind)return[];var x=m.resolveId(i);if(!m.isUserPeerId(x)&&!m.isGroupPeerId(x))break;x===e.ownerId&&(g.changeUserState(p,"kicked"),g.restrictWrite(p,"kicked")),g.removeMember(p,x);break;case f.IEngine.ChatUpdateType.KeyboardChanged:return[];case f.IEngine.ChatUpdateType.CallInProgressChanged:return"ChatConvo"===p.kind&&(null==y?void 0:y.convo.kind)===p.kind&&g.updateActiveCall(p,y.convo.activeCall),[];case f.IEngine.ChatUpdateType.IsNewChange:return g.updateIsNew(p,!!i),[];case f.IEngine.ChatUpdateType.MessageRequestChanged:var R=i;switch(R){case f.IEngine.MRStatus.Accepted:if("MessageRequestChatConvo"!==p.kind&&"MessageRequestUserConvo"!==p.kind||"pending"!==p.MRStatus){v.refresh(e.organisers,p);break}var E=g.fromAcceptedMessageRequest(p,null==y?void 0:y.convo);e.convos.set(l,E),v.refresh(e.organisers,E);break;case f.IEngine.MRStatus.New:var U;null!=y&&y.convo&&e.convos.set(l,null==y?void 0:y.convo),v.refresh(e.organisers,null!==(U=null==y?void 0:y.convo)&&void 0!==U?U:p);break;case f.IEngine.MRStatus.Deleted:if("MessageRequestChatConvo"!==p.kind&&"MessageRequestUserConvo"!==p.kind&&"UserConvo"!==p.kind)break;var P=g.fromCancelledMessageRequest(p);e.convos.set(l,P),v.refresh(e.organisers,P);break;case f.IEngine.MRStatus.Rejected:if(g.isRejectedMR(p)){v.refresh(e.organisers,p);break}if("MessageRequestChatConvo"!==p.kind&&"MessageRequestUserConvo"!==p.kind&&"UserConvo"!==p.kind)break;var O=g.fromRejectedMessageRequest(p);e.convos.set(l,O),v.refresh(e.organisers,O);break;default:}return[(0,c.default)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"UpdateMessageRequestsCounter",peerId:l});case 1:case"end":return e.stop()}}),e)})))];case f.IEngine.ChatUpdateType.AdminGrated:var T=m.resolveId(i);return"ChatConvo"!==p.kind||!m.isUserPeerId(T)&&!m.isGroupPeerId(T)||p.adminIds.add(T),[];case f.IEngine.ChatUpdateType.AdminKicked:var F=m.resolveId(i);return"ChatConvo"!==p.kind||!m.isUserPeerId(F)&&!m.isGroupPeerId(F)||p.adminIds.delete(F),[];case f.IEngine.ChatUpdateType.ContactConverted:var N=m.resolveId(i),q=e.convos.get(N),L=e.peers.get(N);return L&&q&&"Contact"===L.kind&&m.isUserPeerId(l)?(m.convertContact(L,l),g.updateSortId(q,{minorSortId:0}),[function(){var e=(0,c.default)(d().mark((function e(t){var r,n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.router,"ConvoRoute"===(n=r.currentRoute).kind&&n.peerId===N&&r.replace({kind:"ConvoRoute",entrypoint:"list_all",peerId:l}),e.abrupt("return",{type:"Noop"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]):[];case f.IEngine.ChatUpdateType.BannerChanged:return"UserConvo"!==p.kind||(null==y?void 0:y.convo.kind)!==p.kind||(p.convoBanner=null==y?void 0:y.convo.convoBanner),[];case f.IEngine.ChatUpdateType.DescriptionChanged:return"ChatConvo"!==p.kind||(null==y?void 0:y.convo.kind)!==p.kind||(p.description=y.convo.description),[];case f.IEngine.ChatUpdateType.ShortPollReactionsChanged:return"ChatConvo"!==p.kind||(p.shouldShortPollReactions=Boolean(i)),[];case f.IEngine.ChatUpdateType.BusinessNotifyDataChanged:case f.IEngine.ChatUpdateType.MessageRequestAccepted:case f.IEngine.ChatUpdateType.MessageRequestCanceled:case f.IEngine.ChatUpdateType.MessageRequestRejected:case f.IEngine.ChatUpdateType.DonSubscribed:case f.IEngine.ChatUpdateType.DonUnsubscribed:case f.IEngine.ChatUpdateType.StyleChanged:return[];default:}return[]}(t,e,0,l);case 63:case 64:case 65:case 66:case 67:case 68:return function(e,t){var r=(0,u.default)(t,5),n=r[0],s=r[1],o=r[2],l=r[3],p=r[4],f=m.resolveId(s),h=new Set(o.map((function(e){return m.resolveId(e)})));if(h.delete(e.viewer.id),!e.convos.get(f))return[];var v={63:"text",64:"voice",65:"photo",66:"video",67:"file",68:"videomessage"}[n],y=(0,i.default)((0,i.default)({},e.typings.get(f)||{}),{},(0,a.default)({},v,{peerIds:h,updatedAt:p,totalCount:l}));return e.typings.set(f,y),[function(){var e=(0,c.default)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.sleep)(w.TYPING_EXPIRATION_TIME);case 2:return e.abrupt("return",{type:"EngineBatchReceived_TypingsTimedOut",peerId:f,typingType:v,timestamp:p});case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()]}(t,e);case 80:return function(e,t){var r=(0,u.default)(t,10),n=r[1],a=r[2],s=r[4],o=r[6],i=r[7],l=r[9];return y.updateCounters(e.organisers.filters,{unread:n,headerNotMutedUnread:o,unreadUnmuted:a,archive:i,archiveMentions:l,businessNotify:s}),[function(){var e=(0,c.default)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.notification.setCounters({unreadIdle:o,unread:a}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()]}(t,e);case 114:return function(e,t){var r=(0,u.default)(t,2)[1].peer_id,n=m.resolveId(r),a=e.convos.get(n);if(!a)return[];var s=(0,I.fromLongpollPushSettings)(t);return g.updatePush(a,s),[]}(t,e);case 115:return function(e,t){var r=(0,u.default)(t,2)[1];return[function(){var e=(0,c.default)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=t.calls)||void 0===n||n.showIncomingCall(r),e.abrupt("return",{type:"Noop"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}(0,e);case 119:return function(e,t){var r=(0,u.default)(t,2)[1],n=m.resolveId(r.peer_id),a=m.resolveId(r.owner_id),s=e.convos.get(n),o=e.peers.get(n),i=e.peers.get(a),l=s&&o&&i?(0,S.fromApiMessageEvent)(o,i,r):void 0;return[function(){var e=(0,c.default)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l&&t.botKeyboard.update(l),e.abrupt("return",{type:"Noop"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}(t,e);case 501:return function(e,t){var r=(0,u.default)(t,3),n=r[1],a=r[2];return(0,p.insertFolders)(e,[{id:n,name:a}]),[]}(t,e);case 502:return function(e,t){var r=(0,u.default)(t,2)[1],n=k.resolveId(r);k.deleteFolder(e.organisers.folders,n);var a,o=(0,s.default)(e.convos.values());try{for(o.s();!(a=o.n()).done;){var i=a.value;g.removeFolder(i,n)}}catch(e){o.e(e)}finally{o.f()}return[]}(t,e);case 503:return function(e,t){var r=(0,u.default)(t,3),n=r[1],a=r[2],s=k.resolveId(n),o=e.organisers.folders.find((function(e){return e.id===s}));if(!o)return[];return k.setName(o,a),[]}(t,e);case 504:return function(e,t){var r=(0,n.default)(t),a=r[1],s=r.slice(2),o=k.resolveId(a),i=(0,p.getConvosByIds)(e,s);if(!e.organisers.folders.find((function(e){return e.id===o})))return[];return(0,p.addConvosToFolder)(e,o,i),[]}(t,e);case 505:return function(e,t){var r=(0,n.default)(t),a=r[1],s=r.slice(2),o=k.resolveId(a),i=(0,p.getConvosByIds)(e,s);if(!e.organisers.folders.find((function(e){return e.id===o})))return[];return(0,p.removeConvosFromFolder)(e,o,i),[]}(t,e);case 506:return function(e,t){var r=(0,n.default)(t).slice(1);return k.reorderFolders(e.organisers.folders,r.map((function(e){return k.resolveId(e)}))),[]}(t,e);case 507:return function(e,t){var r,a=(0,n.default)(t).slice(1),o=(0,s.default)(a);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(!(i.length<3)){var u=k.resolveId(i[0]);k.setUnreadCounters(e.organisers.folders,u,i[1],i[2])}}}catch(e){o.e(e)}finally{o.f()}return[]}(t,e);case 508:return function(e,t){var r=(0,u.default)(t,2)[1],n=k.resolveId(r),a=e.organisers.folders.find((function(e){return e.id===n}));if(!a)return[];return k.replaceFolder(e.organisers.folders,(0,M.fromApiFolder)({id:n,name:a.name})),[]}(t,e);case 601:return function(e,t){var r=(0,u.default)(t,4),a=r[1],s=r[2],o=r[3],i=e.convos.get(m.resolveId(s));if(!i)return[];var c=i.persisted.get(b.resolveCmid(o));if("Normal"!==(null==c?void 0:c.kind))return[];var l=0,d=[];switch(a){case 1:var p=(0,n.default)(t),f=p[4],h=p[5],v=p.slice(6);b.setCurrentUserReaction(c,C.resolveId(f)),l=h,d=v;break;case 2:case 3:case 4:var y=(0,n.default)(t);l=y[4],d=y.slice(5),3===a&&b.setCurrentUserReaction(c,void 0);break;default:return[]}for(var g=[],k=0,_=0;_<l;_++){var w=d[k];if(!w)return[];var I=d.slice(k+1,k+1+w);k+=1+w;var S=I.slice(0,3),M=(0,u.default)(S,3),A=M[0],x=M[1],R=M[2];if(void 0===A||void 0===x||void 0===R)return[];var E=I.slice(3,3+R).map(m.resolveId);g.push({reactionId:C.resolveId(A),count:x,peerIds:new Set(E)})}return b.setReactions(c,g),[]}(t,e);case 602:return function(e,t){var r=(0,n.default)(t),a=r[1],s=r.slice(2),o=m.resolveId(a),i=e.convos.get(o);if(!i)return[];var u=s[0];if(!u)return[];var c=s.slice(1,u+1).map(b.resolveCmid);return g.replaceUnreadReactions(i,c),[]}(t,e);case 10001:case 10002:case 10003:return T(t,e,l);case 10004:case 10005:case 10018:case 10019:return F(t,e,l);case 10006:case 10007:return function(e,t){var r=(0,u.default)(t,4),n=r[0],a=r[1],s=r[2],o=r[3],i=m.resolveId(a),c=b.resolveCmid(s),l=e.convos.get(i);if(!l)return[];10006===n?(g.readInUntil(l,c,o),m.isFavorites(l.peerId,e.ownerId)&&g.readOutUntil(l,c)):g.readOutUntil(l,c);return v.refresh(e.organisers,l),[]}(t,e);case 10013:return function(e,t,r){var n=(0,u.default)(t,3),a=n[1],s=n[2],o=m.resolveId(a),i=b.resolveCmid(s),l=e.convos.get(o);if(!l)return[];if(l.persistedCmid!==i)return[];var p=null==r?void 0:r.convos.get(a),f=p&&(0,I.fromApiConvo)(p);if(!f)return[function(){var e=(0,c.default)(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.logger.error("[EngineBatchReceived]",new Error("В ".concat(t[0]," отсутствует дозагруженная беседа"))),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));function r(t){return e.apply(this,arguments)}return r}()];e.convos.set(f.convo.peerId,f.convo),f.peer&&e.peers.set(f.peer.id,f.peer);return v.refresh(e.organisers,l),[]}(t,e,l);default:return[]}}));return[function(){var e=(0,c.default)(d().mark((function e(t){var r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.engine,e.next=3,r.poll();case 3:return e.t0=e.sent,e.t1={kind:"FromEngine",next:e.t0},e.abrupt("return",{type:"EngineBatchReceived",variant:e.t1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()].concat((0,o.default)(U))}function E(e,t,r){return function(){var n=(0,c.default)(d().mark((function n(a){var s,o,i,u;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=a.api,i=a.engine,a.logger,n.prev=1,n.next=4,o.fetch("messages.getLongPollHistory",{pts:e,lp_version:i.version,extended:1,group_id:(0,p.getOwnerGroupId)(r)},{retries:1/0});case 4:u=n.sent,n.next=10;break;case 7:return n.prev=7,n.t0=n.catch(1),n.abrupt("return",{type:"Noop"});case 10:return n.abrupt("return",{type:"EngineBatchReceived",variant:{kind:"FromEngineWithMissingData",apiConvos:u.conversations||[],apiMessages:(null===(s=u.messages)||void 0===s?void 0:s.items)||[],apiUsers:u.profiles||[],apiGroups:u.groups||[],skippedBatch:t,apiContacts:u.contacts||[]}});case 11:case"end":return n.stop()}}),n,null,[[1,7]])})));return function(e){return n.apply(this,arguments)}}()}function U(e,t){var r,n=new Map,a=(0,s.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,i=n.get(o.peer_id);i||(i=new Map,n.set(o.peer_id,i)),i.set(o.conversation_message_id,o)}}catch(e){a.e(e)}finally{a.f()}return{messages_legacy:new Map(e.map((function(e){return[e.id,e]}))),messagesByPeerId:n,convos:new Map(t.map((function(e){return[e.peer.id,e]})))}}function P(e){return function(t){var r=e.persisted.get(t);return"Normal"===(null==r?void 0:r.kind)?r:void 0}}function O(e,t){if(e.fwd&&!e.reply)return!0;if(e.reply){var r=JSON.parse(e.reply);if(!t(b.resolveCmid(r.conversation_message_id)))return!0}if(e.geo)return!0;if(e.attachments&&e.attach1_type&&!e.attach2_type)try{var n=JSON.parse(e.attachments);if(Array.isArray(n)&&n[0].type===e.attach1_type)return!1}catch(e){return!0}return!!e.attach1_type}function T(e,t,r){var n=(0,u.default)(t,9),a=n[0],s=n[1],o=n[2],i=n[3],l=b.resolveCmid(s),p=m.resolveId(i),f=e.convos.get(p);if(!f)return[];var v=b.convertFlags(o);if(10003===a){var y=v.isDeleted,k=v.isSpam;if((y||k)&&s){var C,_=null==r||null===(C=r.messagesByPeerId.get(i))||void 0===C?void 0:C.get(s);if(_){var w=(0,h.fromApiMessage)(_);g.restoreMessage(f,w.message,w.mentions.hasDirect||w.mentions.hasMass)}}}var I={10001:"replace",10002:"set",10003:"unset"}[a],S=f.persisted.get(l);return S?(g.updateMessageFlags(f,S.cmid,I,o),[(0,c.default)(d().mark((function e(){var t,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(10002===a){e.next=2;break}return e.abrupt("return",{type:"Noop"});case 2:if(t=v.isDeleted,r=v.isDeletedForAll,!t&&!r){e.next=5;break}return e.abrupt("return",{type:"UpdateComposerDraftOnMessageDelete",peerId:p,deletedMessagesCmid:[l]});case 5:return e.abrupt("return",{type:"Noop"});case 6:case"end":return e.stop()}}),e)})))]):[]}function F(e,t,r){var n,a,o=(0,u.default)(t,2)[1];switch(t[0]){case 10004:a=t[4];break;case 10005:case 10018:a=t[3];break;case 10019:a=t[2];break;default:(0,_.exhaustivenessCheck)(t)}var i=m.resolveId(a),l=e.convos.get(i);if(!l)return[];var y,k,C,w=null==r||null===(n=r.messagesByPeerId.get(a))||void 0===n?void 0:n.get(o);if(w){var I,M=(0,h.fromApiMessage)(w);y=M.message,k=M.mentions;var A=null==r||null===(I=r.convos.get(i))||void 0===I?void 0:I.current_keyboard;if(A){var x=(0,S.fromApiKeyboard)(A,i);C="InputKeyboard"===x.kind?{kind:"InputKeyboardUpsertEvent",keyboard:x}:void 0}else C={kind:"InputKeyboardDeleteEvent"}}else{if(f.IEngine.isIncompleteUpdate(t)||10019===t[0])return[];var R=(0,h.fromEngineMessage)(t,e.ownerId,P(l));y=R.message,k=R.mentions,C=R.keyboardEvent}switch(t[0]){case 10004:var E,U=e.typings.get(l.peerId);if(U){var O,T=(0,s.default)(p.TypingVariants);try{for(T.s();!(O=T.n()).done;){var F=O.value,N=U[F];N&&N.peerIds.has(y.authorId)&&(N.peerIds.delete(y.authorId),N.totalCount--,0===N.totalCount&&delete U[F],0===Object.keys(U).length&&e.typings.delete(l.peerId))}}catch(e){T.e(e)}finally{T.f()}}var q=t[3],L=k.hasDirect||k.hasMass;"ChatConvo"===l.kind?g.appendMessage(l,y,q,L,C):g.appendMessage(l,y,q,!1,C),v.refresh(e.organisers,l);var j=L&&l.isArchived;e.locks.convosCleanup.has(l.peerId)||g.cleanup(l),"InputKeyboardUpsertEvent"===(null===(E=C)||void 0===E?void 0:E.kind)&&e.hiddenBotKeyboards.delete(l.peerId);var D,B=b.convertFlags(t[2]),G=g.isMessageUnread(l,y),H=e.viewer.settings,V=H.browserNotifications,W=H.soundNotifications,z=H.push,K=!y.isOut&&!B.noPush&&G&&!g.isMuted(l)&&W&&!y.isSilent,$=null;switch(l.kind){case"UserConvo":$=z.userConvo;break;case"ChatConvo":$=z.chatConvo;break;case"GroupConvo":$=z.groupConvo}switch(!0){case y.isOut:case!G:case"nothing"===l.push.mode||"nothing"===z.mention:case null!==$&&!$.isEnabled:case!V:case B.noPush:D=!1;break;case!g.isMuted(l):D=!0;break;case"direct-mention"===l.push.mode||"direct-mention"===z.mention:D=k.hasDirect;break;case"every-mention"===l.push.mode&&"every-mention"===z.mention:D=L;break;default:D=!0}return[function(){var e=(0,c.default)(d().mark((function e(t){var r,n,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.notification,n=t.router,a="ConvoRoute"===n.screenRoute.kind&&n.screenRoute.peerId===i,D&&r.notify({message:y},{mode:a?"idle":"normal"}),K&&r.playSound(),e.abrupt("return",{type:"Noop"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(0,c.default)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j?{type:"ActualizeArchiveMentions",undoHideOnNewMention:!0}:{type:"Noop"});case 1:case"end":return e.stop()}}),e)})))];case 10005:case 10018:case 10019:return g.replaceMessage(l,y,k.hasDirect||k.hasMass),[];default:return(0,_.exhaustivenessCheck)(t)}}},257889:(e,t,r)=>{"use strict";r.d(t,{handler:()=>a});var n=r(837021),a=function(e,t){return(0,n.insertPeers)(e,{apiUsers:t.profile?[t.profile]:[],apiContacts:[t.contact],apiGroups:[]},{dangerouslyOverwrite:!0}),(0,n.insertContacts)(e,[t.contact]),[]}},970996:(e,t,r)=>{"use strict";r.d(t,{handler:()=>d});var n=r(28991),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=r(509727),c=r(837021),l=r(975474),d=function(e,t){switch(t.type){case"LoadChatInfo":var r=t.peerId,s=(0,c.getOwnerGroupId)(e.ownerId);return e.locks.getConversationInfo.add(r),[function(){var e=(0,a.default)(o().mark((function e(t){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.next=4,n.fetch("messages.getConversationsById",{peer_ids:r.toString(),group_id:s,extended:0});case 4:return a=e.sent,e.abrupt("return",{type:"LoadChatInfo_RequestComplete",peerId:r,convo:a.items[0],hasFailed:!a.items[0]});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"LoadChatInfo_RequestComplete",peerId:r,hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"LoadChatInfo_RequestComplete":var d=t.peerId,p=t.convo,f=t.hasFailed;e.locks.getConversationInfo.delete(d);var h=e.convos.get(d);if("ChatConvo"!==(null==h?void 0:h.kind)||f||!p)return[];var v=(0,l.fromApiConvo)(p);return"ChatConvo"!==(null==v?void 0:v.convo.kind)||(u.updateAcl(h,(0,n.default)({},v.convo.acl)),u.updateMembersCount(h,v.convo.membersCount)),[];default:(0,i.exhaustivenessCheck)(t)}}},10998:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(509727),u=r(837021),c=r(107134),l=function(e,t){switch(t.type){case"LoadChatMembers":var r=t.peerId,a=(0,u.getOwnerGroupId)(e.ownerId);return[function(){var e=(0,n.default)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.t0=r,e.next=5,n.fetch("messages.getConversationMembers",{peer_id:r,extended:1,group_id:a},{retries:1});case 5:return e.t1=e.sent,e.abrupt("return",{type:"LoadChatMembers_RequestComplete",peerId:e.t0,response:e.t1,hasFailed:!1});case 9:return e.prev=9,e.t2=e.catch(1),e.abrupt("return",{type:"LoadChatMembers_RequestComplete",peerId:r,hasFailed:!0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()];case"LoadChatMembers_RequestComplete":var l=t.peerId,d=t.response,p=t.hasFailed;e.locks.getConversationMembers.delete(l);var f=e.convos.get(l);if("ChatConvo"!==(null==f?void 0:f.kind)||p||!d)return[];var h=(0,c.fromApiChatMembers)(d.items),v=h.members,y=h.adminIds,m=h.ownerId;return i.addMembers(f,v),y.forEach((function(e){i.addAdmin(f,e)})),m&&i.setOwner(f,m),(0,u.insertPeers)(e,{apiUsers:d.profiles||[],apiGroups:d.groups||[],apiContacts:d.contacts||[]}),[];default:(0,o.exhaustivenessCheck)(t)}}},581738:(e,t,r)=>{"use strict";r.d(t,{handler:()=>u});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(837021),u=function(e,t){switch(t.type){case"LoadContactList":return e.locks.contactList?[]:(e.locks.contactList=!0,[function(){var e=(0,n.default)(s().mark((function e(r){var n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.api,e.prev=1,e.next=4,n.fetch("account.getContactList",{extended:1,offset:t.offset},{retries:1});case 4:return a=e.sent,e.abrupt("return",{type:"LoadContactList_RequestCompleted",contacts:a.contacts||[],profiles:a.profiles||[],items:a.items||[]});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"LoadContactList_RequestCompleted",contacts:[],profiles:[],items:[]});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]);case"LoadContactList_RequestCompleted":return e.locks.contactList=!1,(0,i.insertContacts)(e,t.contacts),(0,i.insertContactItems)(e,t.items,t.profiles),e.contacts.hasMore=!1,[];default:(0,o.exhaustivenessCheck)(t)}}},455995:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c,getImportantMessageKey:()=>l});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(341570),u=r(837021),c=function(e,t,r){switch(t.type){case"LoadImportantMessages":var a=20*Math.floor(e.importantMessages.messages.size/20),c=e.ownerId;return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.getImportantMessages",{count:20,offset:a,extended:1,group_id:(0,u.getOwnerGroupId)(c)});case 4:return n=e.sent,e.abrupt("return",{type:"LoadImportantMessages_RequestCompleted",hasFailed:!1,response:n});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"Noop"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"LoadImportantMessages_RequestCompleted":var d,p,f=t.response,h=f.messages,v=f.profiles,y=f.groups,m=f.conversations;return((null===(d=h.items)||void 0===d?void 0:d.length)||0)<20&&(e.importantMessages.hasMore=!1),(0,u.insertConvos)(e,m||[]),(0,u.insertPeers)(e,{apiUsers:v||[],apiGroups:y||[],apiContacts:[]}),null===(p=h.items)||void 0===p||p.forEach((function(t){var r=(0,i.fromApiMessage)(t).message;"Normal"===r.kind&&e.importantMessages.messages.set(l(r.peerId,r.cmid),r)})),[];case"UserClosedImportantMessages":return e.importantMessages.messages.clear(),e.importantMessages.hasMore=!0,[];default:return(0,o.exhaustivenessCheck)(t)}},l=function(e,t){return"".concat(e,"-").concat(t)}},653752:(e,t,r)=>{"use strict";r.d(t,{IMPORTANT_USERS_COUNT:()=>c,handler:()=>l});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(837021),u=r(975474),c=10,l=function(e,t,r){switch(t.type){case"LoadImportantUsers":if(e.locks.getImportantUsers||null!==e.importantUsers)return[];e.locks.getImportantUsers=!0;var a=(0,i.getOwnerGroupId)(e.ownerId);return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,t.logger,e.prev=1,e.next=4,r.fetch("messages.searchConversations",{q:" ",count:c,extended:1,group_id:a},{retries:2});case 4:return n=e.sent,e.abrupt("return",{type:"LoadImportantUsers_RequestCompleted",hasFailed:!1,response:n});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"LoadImportantUsers_RequestCompleted",hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"LoadImportantUsers_RequestCompleted":if(e.locks.getImportantUsers=!1,t.hasFailed)return[];var l=t.response,d=l.profiles,p=l.groups,f=l.items,h=l.contacts;(0,i.insertConvos)(e,f),(0,i.insertPeers)(e,{apiUsers:d||[],apiGroups:p||[],apiContacts:h||[]});var v=f.reduce((function(e,t){var r=(0,u.fromApiConvo)(t);return r&&e.add(r.convo.peerId),e}),new Set);return e.importantUsers=v,[];default:(0,o.exhaustivenessCheck)(t)}}},478635:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(692137),a=r(678927),s=r(887757),o=r.n(s),i=r(21705),u=r(378399),c=function(e,t){switch(t.type){case"LoadStickers":var r=e.stickers,s=e.locks.loadStickers,c=t.stickerIds.filter((function(e){return!s.has(e)&&!r.has(e)}));return c.length?(e.locks.loadStickers=new Set([].concat((0,a.default)(s),(0,a.default)(c))),[function(){var e=(0,n.default)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("store.getStickers",{sticker_ids:c.join()});case 4:return e.t0=e.sent,e.abrupt("return",{type:"LoadStickers_RequestCompleted",response:e.t0});case 8:e.prev=8,e.t1=e.catch(1);case 10:return e.abrupt("return",{type:"LoadStickers_RequestCompleted",hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]):[];case"LoadStickers_RequestCompleted":var l=t.response;if(t.hasFailed||!l)return[];var d=e.stickers;return l.forEach((function(e){var t=(0,u.fromApiSticker)(e);t&&d.set(t.id,t)})),[];default:(0,i.exhaustivenessCheck)(t)}}},903975:(e,t,r)=>{"use strict";r.d(t,{handler:()=>d});var n=r(28991),a=r(692137),s=r(887757),o=r.n(s),i=r(837021),u=r(190831),c=r(782597),l=r(21705),d=function(e,t){switch(t.type){case"MoreChannelsNeeded":var r=t.organiser,s=r.filter,d=c.getLockId(s);if(e.locks.getChannels[d]||!e.organisers.channelFilters[s].hasMore)return[];var p=e.organisers.channelFilters[s].boundary,f=p.minorSortId,h=p.channelId;e.locks.getChannels[d]=!0;var v=u.CHANNELS_PER_PAGE+1,y=c.isLoaded(e.organisers.channelFilters[s])?f:void 0;return[function(){var e=(0,a.default)(o().mark((function e(a){var s,i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.api,e.prev=1,e.next=4,s.fetch("channels.get",{count:v,offset_minor_sort_id:y,offset_channel_id:h,filter:c.snakeCaseId(r.filter),extended:1},{retries:3});case 4:return u=e.sent,e.abrupt("return",(0,n.default)((0,n.default)({},t),{},{type:"MoreChannelsNeeded_RequestCompleted",hasFailed:!1,response:u,hasMore:((null===(i=u.items)||void 0===i?void 0:i.length)||0)>=v}));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",(0,n.default)((0,n.default)({},t),{},{type:"MoreChannelsNeeded_RequestCompleted",hasFailed:!0,hasMore:!1}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"MoreChannelsNeeded_RequestCompleted":var m=t.hasFailed,g=t.organiser,b=t.hasMore,k="";if("channelFilters"===g.kind)k=c.getLockId(g.filter);else(0,l.exhaustivenessCheck)(g.kind);if(e.locks.getChannels[k]=!1,m)return[];var C=t.response;if(C){var _=(0,i.insertChannels)(e,{apiChannels:C.items||[],apiGroups:C.groups||[]});if((0,i.insertPeers)(e,{apiUsers:C.profiles||[],apiGroups:C.groups||[],apiContacts:[]}),"channelFilters"===g.kind)c.push(e.organisers.channelFilters,g.filter,_,b);else(0,l.exhaustivenessCheck)(g.kind)}return[];default:(0,l.exhaustivenessCheck)(t)}}},338779:(e,t,r)=>{"use strict";r.d(t,{handler:()=>p});var n=r(28991),a=r(692137),s=r(887757),o=r.n(s),i=r(837021),u=r(190831),c=r(252229),l=r(21705),d=r(360202),p=function(e,t,r){switch(t.type){case"MoreConvosNeeded":var s,p=t.organiser,f=e.ownerId,h="";switch(p.kind){case"filters":var v=p.filter;if(h=c.getLockId(v),e.locks.getConversations[h]||!e.organisers.filters[v].hasMore)return[];s={start_message_id:c.isLoaded(e.organisers.filters[v])?e.organisers.filters[v].boundary.minorSortId:void 0,filter:c.snakeCaseId(v),extended:1,group_id:(0,i.getOwnerGroupId)(f)};break;case"folders":var y=p.id,m=p.filter;h=d.getLockId(y,m);var g=e.organisers.folders.find((function(e){return e.id===y}));if(!g)throw new Error("Не найдена папка");if(e.locks.getConversations[h]||d.isLoaded(g,m)&&!g[m].hasMore)return[];s={start_message_id:d.isLoaded(g,m)?g[m].boundaryMinorId:void 0,folder_id:g.id,filter:m,extended:1,group_id:(0,i.getOwnerGroupId)(f)};break;default:(0,l.exhaustivenessCheck)(p)}return e.locks.getConversations[h]=!0,[function(){var e=(0,a.default)(o().mark((function e(r){var a,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.api,e.prev=1,s){e.next=4;break}throw new Error("Нет параметров запроса");case 4:return i=u.CONVOS_PER_PAGE,e.next=7,a.fetch("messages.getConversations",(0,n.default)((0,n.default)({},s),{},{count:i}),{retries:3});case 7:return c=e.sent,e.abrupt("return",(0,n.default)((0,n.default)({},t),{},{type:"MoreConvosNeeded_RequestCompleted",hasFailed:!1,requestedCount:i,hasMore:c.items.length>=i,response:c}));case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",(0,n.default)((0,n.default)({},t),{},{type:"MoreConvosNeeded_RequestCompleted",hasMore:!1,hasFailed:!0}));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()];case"MoreConvosNeeded_RequestCompleted":var b=t.hasFailed,k=t.organiser,C=t.hasMore,_="";switch(k.kind){case"filters":_=c.getLockId(k.filter);break;case"folders":_=d.getLockId(k.id,k.filter);break;default:(0,l.exhaustivenessCheck)(k)}if(e.locks.getConversations[_]=!1,b)return[];var w=t.response;if(w){var I=(0,i.insertConvos)(e,w.items,{dangerouslyMerge:!0});switch((0,i.insertPeers)(e,{apiUsers:w.profiles||[],apiGroups:w.groups||[],apiContacts:w.contacts||[]}),k.kind){case"filters":c.push(e.organisers.filters,k.filter,I,C);break;case"folders":var S=e.organisers.folders.find((function(e){return e.id===k.id}));if(!S)return[];d.push(e.organisers.folders,k.id,k.filter,I,C);break;default:(0,l.exhaustivenessCheck)(k)}}return[];default:(0,l.exhaustivenessCheck)(t)}}},426578:(e,t,r)=>{"use strict";r.d(t,{handler:()=>d});var n=r(111965),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=r(980662),c=r(837021),l=r(667361),d=function(e,t,r){if(!r.vkm_reactions)return[];switch(t.type){case"PollConvoReactions":var s=t.peerId,d=t.fromCmid,p=t.toCmid,f=e.convos.get(s);if(!f)return[];var h=Array.from(f.persisted.keys()).filter((function(e){return e>=d&&e<=(null!=p?p:f.persistedCmid)})).slice(-100),v=e.ownerId;return[function(){var e=(0,a.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.getMessagesReactions",{peer_id:s,cmids:h.join(","),extended:1,group_id:(0,c.getOwnerGroupId)(v)});case 4:return n=e.sent,e.abrupt("return",{type:"PollConvoReactions_RequestSucceed",peerId:s,cmids:h,apiResponse:n});case 8:e.prev=8,e.t0=e.catch(1);case 10:return e.abrupt("return",{type:"Noop"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"PollConvoReactions_RequestSucceed":var y=t.peerId,m=t.apiResponse,g=t.cmids;(0,c.insertPeers)(e,{apiUsers:m.profiles||[],apiGroups:m.groups||[],apiContacts:m.contacts||[]});var b=e.convos.get(y);if(!b)return[];var k=new Set(m.items.map((function(e){return u.resolveCmid(e.cmid)})));g.filter((function(e){return!k.has(e)})).forEach((function(e){var t=b.persisted.get(u.resolveCmid(e));"Normal"===(null==t?void 0:t.kind)&&0!==t.reactions.size&&u.setReactions(t,[])}));var C,_=(0,n.default)(m.items);try{for(_.s();!(C=_.n()).done;){var w=C.value,I=w.cmid,S=w.counters,M=b.persisted.get(u.resolveCmid(I));if("Normal"===(null==M?void 0:M.kind)){var A=(0,l.fromApiMessageReactions)(S);u.setReactions(M,Array.from(A.values()))}}}catch(e){_.e(e)}finally{_.f()}return[];default:(0,i.exhaustivenessCheck)(t)}}},135738:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(111965),a=r(28991),s=r(692137),o=r(887757),i=r.n(o),u=r(314432),c=r(604850),l=function(e,t){var r=t.next;if("Reconnecting"===r.kind)return[function(){var e=(0,s.default)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.queue,e.next=3,r.poll();case 3:return e.t0=e.sent,e.abrupt("return",{type:"QueueBatchReceived",next:e.t0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];if("Disconnected"===r.kind){if("manual"===r.reason)return[];var o=e.viewer.id;return[function(){var e=(0,s.default)(i().mark((function e(t){var r,n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.queue,n=t.api,e.next=3,n.fetch("queue.subscribe",{queue_ids:"onlfriends_".concat(o)},{retries:1/0});case 3:return s=e.sent,r.connect((0,a.default)({user_id:o},s)),e.next=7,r.poll();case 7:return e.t0=e.sent,e.abrupt("return",{type:"QueueBatchReceived",next:e.t0});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}var l,d=(0,n.default)(r.events);try{for(d.s();!(l=d.n()).done;){var p=l.value;switch(p.entity_type){case"online":var f=u.resolveId(p.data.user_id);if(!u.isUserPeerId(f))break;p.data.online?e.onlines.add(f):e.onlines.delete(f);var h=e.peers.get(f);if(!h||"User"!==h.kind)break;u.updateLastSeen(h,{at:1e3*p.data.last_seen,platform:(0,c.convertPlatform)(p.data.platform,p.data.app_id)});break;default:p.entity_type}}}catch(e){d.e(e)}finally{d.f()}return[function(){var e=(0,s.default)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.queue,e.next=3,r.poll();case 3:return e.t0=e.sent,e.abrupt("return",{type:"QueueBatchReceived",next:e.t0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}},901334:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(252229),u=r(837021),c=function(e,t){switch(t.type){case"ResetUpdatesCounter":var r=e.ownerId;return[function(){var e=(0,n.default)(s().mark((function e(t){var n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.next=4,n.fetch("messages.resetUpdatesCounter",{group_id:(0,u.getOwnerGroupId)(r)});case 4:return a=e.sent,e.abrupt("return",{type:"ResetUpdatesCounter_RequestCompleted",hasFailed:!a});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"ResetUpdatesCounter_RequestCompleted",hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"ResetUpdatesCounter_RequestCompleted":return t.hasFailed?[]:(i.updateCounters(e.organisers.filters,{headerNotMutedUnread:0}),[function(){var e=(0,n.default)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.notification.setCounters({unreadIdle:0}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]);default:(0,o.exhaustivenessCheck)(t)}}},53646:(e,t,r)=>{"use strict";r.d(t,{handler:()=>i});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=function(e,t){var r=t.type;switch(r){case"SettingThemeUpdated":e.locks.settings.add("theme");var a=e.viewer.settings.theme;return e.viewer.settings.theme=t.value,[function(){var e=(0,n.default)(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.storage.set("theme",t.value),e.abrupt("return",{type:"SettingThemeUpdated_RequestCompleted",hasFailed:!1,previousValue:a});case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",{type:"SettingThemeUpdated_RequestCompleted",hasFailed:!0,previousValue:a});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()];case"SettingThemeUpdated_RequestCompleted":return e.locks.settings.delete("theme"),t.hasFailed&&(e.viewer.settings.theme=t.previousValue),[];default:(0,o.exhaustivenessCheck)(r)}}},215857:(e,t,r)=>{"use strict";r.d(t,{MAX_RECENT_STICKERS:()=>u,handler:()=>c});var n=r(692137),a=r(678927),s=r(887757),o=r.n(s),i=r(21705),u=32,c=function e(t,r,s){switch(r.type){case"StickersAddToFavorite":var c=r.stickerId;return t.stickers.has(c)?(t.favoriteStickers=[].concat((0,a.default)(t.favoriteStickers.filter((function(e){return e!==c}))),[c]),[function(){var e=(0,n.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("store.addStickersToFavorite",{sticker_ids:"".concat(c)});case 4:return n=e.sent,e.abrupt("return",{type:"StickersAddToFavorite__RequestCompleted",stickerId:c,hasFailed:!Boolean(n)});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"StickersAddToFavorite__RequestCompleted",stickerId:c,hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]):[];case"StickersAddToFavorite__RequestCompleted":var l=r.stickerId;return r.hasFailed&&e(t,{type:"StickersRemoveFromFavorite",stickerId:l},s),[];case"StickersRemoveFromFavorite":var d=r.stickerId;return t.stickers.has(d)?(t.favoriteStickers=t.favoriteStickers.filter((function(e){return e!==d})),[function(){var e=(0,n.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("store.removeStickersFromFavorite",{sticker_ids:"".concat(d)});case 4:return n=e.sent,e.abrupt("return",{type:"StickersRemoveFromFavorite__RequestCompleted",stickerId:d,hasFailed:!Boolean(n)});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"StickersRemoveFromFavorite__RequestCompleted",stickerId:d,hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]):[];case"StickersRemoveFromFavorite__RequestCompleted":var p=r.stickerId;return r.hasFailed&&e(t,{type:"StickersAddToFavorite",stickerId:p},s),[];case"StickerAddToRecent":var f=r.stickerId;return t.recentStickers=[f].concat((0,a.default)(t.recentStickers.filter((function(e){return e!==f})))).slice(0,u),[];default:return(0,i.exhaustivenessCheck)(r)}}},564741:(e,t,r)=>{"use strict";r.d(t,{handler:()=>i});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=function(e,t){var r=t.type;switch(r){case"UserChangedBrowserNotifications":e.locks.settings.add("browserNotifications");var a=e.viewer.settings.browserNotifications;return e.viewer.settings.browserNotifications=t.value,[function(){var e=(0,n.default)(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.storage.set("settings-browser-notifications-on",t.value),e.abrupt("return",{type:"UserChangedBrowserNotifications_RequestCompleted",hasFailed:!1,previousValue:a});case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",{type:"UserChangedBrowserNotifications_RequestCompleted",hasFailed:!0,previousValue:a});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedBrowserNotifications_RequestCompleted":return e.locks.settings.delete("browserNotifications"),t.hasFailed&&(e.viewer.settings.browserNotifications=t.previousValue),[];default:(0,o.exhaustivenessCheck)(r)}}},849902:(e,t,r)=>{"use strict";r.d(t,{handler:()=>d});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(716352),u=r(527119),c={archive:"archive",unarchive:"unarchive",join:"join",leave:"join",mute:"mute",unmute:"unmute",mark_read:"mark_read"},l={archive:"unarchive",unarchive:"archive",join:"leave",leave:"join",mute:"unmute",unmute:"mute"},d=function e(t,r,a){var c=r.type;switch(c){case"UserChangedChannel":var d=r.channelId,f=r.userAction,h=p(r.userAction,d);if(t.locks.channelActions.has(h))return[];t.locks.channelActions.add(h);var v,y=t.channels.get(d);if(!y)return[];switch(f){case"archive":i.setArchived(y,!0),u.refreshChannels(t.organisers,y),v=function(e){return e.fetch("channels.archive",{channel_ids:String(d)}).then((function(e){return Boolean(e)}))};break;case"unarchive":i.setArchived(y,!1),u.refreshChannels(t.organisers,y),v=function(e){return e.fetch("channels.unarchive",{channel_ids:String(d),extended:1}).then((function(e){return Boolean(e)}))};break;case"join":i.setMembership(y,!0),u.refreshChannels(t.organisers,y),v=function(e){return e.fetch("channels.join",{channel_id:d,extended:1}).then((function(e){return Boolean(e)}))};break;case"leave":i.setMembership(y,!1),u.refreshChannels(t.organisers,y),v=function(e){return e.fetch("channels.leave",{channel_id:d})};break;case"mute":i.setMuted(y,!0),v=function(e){return e.fetch("channels.setNotificationMode",{channel_id:d,mode:"disabled"}).then((function(e){return Boolean(e)}))};break;case"unmute":i.setMuted(y,!1),v=function(e){return e.fetch("channels.setNotificationMode",{channel_id:d,mode:"enabled"}).then((function(e){return Boolean(e)}))};break;case"mark_read":var m=y.history[y.history.length-1];if(m&&"PostItem"===m.kind){var g=m.post.cmid;y.inReadCmid=g,v=function(e){return e.fetch("channels.markAsRead",{last_read_cmid:g,channel_id:d})}}break;default:(0,o.exhaustivenessCheck)(f)}return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.api,e.prev=1,n=!1,!v){e.next=7;break}return e.next=6,v(r);case 6:n=!e.sent;case 7:return e.abrupt("return",{type:"UserChangedChannel_RequestCompleted",channelId:d,hasFailed:n,userAction:f});case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedChannel_RequestCompleted",channelId:d,hasFailed:!0,userAction:f});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedChannel_RequestCompleted":var b=r.channelId,k=r.userAction,C=r.hasFailed,_=p(k,b);t.locks.channelActions.delete(_);var w=l[k];return C&&w&&(e(t,{type:"UserChangedChannel",userAction:w,channelId:b},a),t.locks.channelActions.delete(_)),[];default:(0,o.exhaustivenessCheck)(c)}},p=function(e,t){return"".concat(c[e],"-").concat(t.toString())}},475614:(e,t,r)=>{"use strict";r.d(t,{handler:()=>d});var n=r(692137),a=r(28991),s=r(887757),o=r.n(s),i=r(416872),u=r(21705),c=r(210746),l=r(461672),d=function(e,t){var r,s=t.channelId,d=null!==(r=e.channelComposerDrafts[s])&&void 0!==r?r:i.empty(),p=i.empty();switch(t.type){case"UserChangedChannelComposerDraft":switch(t.kind){case"text":var f=t.text,h=t.visibility,v=t.donutDelay,y=t.topic,m=t.date,g=t.sendOptions,b=t.resetSendOptions;p=(0,a.default)((0,a.default)({},d),{},{text:null!=f?f:d.text,visibility:h||d.visibility,donutDelay:v||d.donutDelay,topic:y||d.topic,date:m,sendOptions:g||d.sendOptions,resetSendOptions:b||d.resetSendOptions});break;case"addAttaches":case"removeAttach":case"removeVoice":case"startUploading":case"removeUploads":case"rearrangeAttaches":var k=(0,l.applyAttachmentActions)(d,t);p=(0,a.default)((0,a.default)({},d),k);break;default:(0,u.exhaustivenessCheck)(t)}break;case"UserClearedChannelComposerDraft":break;default:(0,u.exhaustivenessCheck)(t)}!p.text&&0===Object.keys(p.attaches).length&&0===p.uploadsTrackIds.size&&"all"===p.visibility&&"no_theme"===p.topic&&void 0===p.date&&-1===p.donutDelay&&0===p.sendOptions.selected.length&&0===p.sendOptions.disabled.length&&0===p.resetSendOptions.length?delete e.channelComposerDrafts[s]:e.channelComposerDrafts[s]=p;var C=(0,c.current)(e).channelComposerDrafts;return[function(){var e=(0,n.default)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.storage.set("channels-drafts",C),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}},146796:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(716352),u={delete:"delete",restore:"restore"},c={restore:"delete",delete:"restore"},l=function e(t,r,a){var u=r.type;switch(u){case"UserChangedChannelPost":var l=r.channelId,p=r.cmid,f=r.userAction,h=d(r.userAction,l,p);if(t.locks.channelPostActions.has(h))return[];t.locks.channelPostActions.add(h);var v=t.channels.get(l);if(!v)return[];var y,m=i.findPostByCmid(v,p);if(!m)return[];switch(f){case"delete":if("Deleted"===m.kind)break;i.deletePost(v,m.cmid,!0),y=function(e){return e.fetch("wall.delete",{owner_id:l,post_id:p}).then((function(e){return Boolean(e)}))};break;case"restore":if("Normal"===m.kind)break;i.restorePost(v,m.cmid),y=function(e){return e.fetch("wall.restore",{owner_id:l,post_id:p}).then((function(e){return Boolean(e)}))};break;default:(0,o.exhaustivenessCheck)(f)}return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.api,e.prev=1,n=!1,!y){e.next=7;break}return e.next=6,y(r);case 6:n=!e.sent;case 7:return e.abrupt("return",{type:"UserChangedChannelPost_RequestCompleted",channelId:l,cmid:p,hasFailed:n,userAction:f});case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedChannelPost_RequestCompleted",channelId:l,cmid:p,hasFailed:!0,userAction:f});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedChannelPost_RequestCompleted":var g=r.channelId,b=r.cmid,k=r.userAction,C=r.hasFailed,_=d(k,g,b);t.locks.channelPostActions.delete(_);var w=c[k];return C&&w&&(e(t,{type:"UserChangedChannelPost",userAction:w,channelId:g,cmid:b},a),t.locks.channelPostActions.delete(_)),[];default:(0,o.exhaustivenessCheck)(u)}},d=function(e,t,r){return"".concat(u[e],"-").concat(t.toString(),"-").concat(r)}},859451:(e,t,r)=>{"use strict";r.d(t,{handler:()=>d});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(314432),u=r(509727),c=r(151225),l=r(837021),d=function(e,t){var r=t.type;switch(r){case"UserChangedChatTitle":var a=t.peerId,d=t.title,p=i.toRealId(a),f=e.peers.get(a),h=e.ownerId;if(!f||"Chat"!==f.kind)return[];var v=f.title;return i.updateChatInfo(f,{title:d}),[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.editChat",{chat_id:p,title:d,group_id:(0,l.getOwnerGroupId)(h)},{retries:1});case 4:return n=e.sent,e.abrupt("return",{type:"UserChangedChatTitle_RequestCompleted",hasFailed:1!==n,peerId:a,title:1!==n?v:d});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedChatTitle_RequestCompleted",hasFailed:!0,peerId:a,title:v});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedChatTitle_RequestCompleted":var y=t.peerId,m=t.title,g=t.hasFailed,b=e.peers.get(y);return b&&"Chat"===b.kind&&g?(i.updateChatInfo(b,{title:m}),[]):[];case"UserChangedChatDescription":var k=t.peerId,C=t.description,_=i.toRealId(k),w=e.convos.get(k),I=e.ownerId;if(!w||"ChatConvo"!==w.kind&&"GroupConvo"!==w.kind)return[];var S=w.description;return u.setDescription(w,C),[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.editChat",{chat_id:_,description:C,group_id:(0,l.getOwnerGroupId)(I)},{retries:1});case 4:return n=e.sent,e.abrupt("return",{type:"UserChangedChatDescription_RequestCompleted",hasFailed:1!==n,peerId:k,description:1!==n?S:C});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedChatDescription_RequestCompleted",hasFailed:!0,peerId:k,description:S});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedChatDescription_RequestCompleted":var M=t.peerId,A=t.description,x=t.hasFailed,R=e.convos.get(M);return!R||"ChatConvo"!==R.kind&&"GroupConvo"!==R.kind?[]:x?(u.setDescription(R,A),[]):[];case"UserSetChatPhoto":var E,U,P,O=t.peerId,T=t.photo,F=e.peers.get(O);return F&&"Chat"===F.kind?(i.updateChatInfo(F,{photo50:null===(E=c.preview(T,50,50))||void 0===E?void 0:E.url,photo100:null===(U=c.preview(T,100,100))||void 0===U?void 0:U.url,photo200:null===(P=c.preview(T,200,200))||void 0===P?void 0:P.url}),[]):[];case"UserRemovedChatPhoto":var N=t.peerId,q=e.ownerId,L=i.toRealId(N),j=e.peers.get(N);return j&&"Chat"===j.kind?(i.updateChatInfo(j,{photo50:void 0,photo100:void 0,photo200:void 0}),[function(){var e=(0,n.default)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.deleteChatPhoto",{chat_id:L,group_id:(0,l.getOwnerGroupId)(q)},{retries:1});case 4:return e.abrupt("return",{type:"UserRemovedChatPhoto_RequestCompleted",hasFailed:!1,peerId:N});case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",{type:"UserRemovedChatPhoto_RequestCompleted",hasFailed:!0,peerId:N});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()]):[];case"UserRemovedChatPhoto_RequestCompleted":return[];case"UserChangedChatSettings":var D=t.peerId,B=t.isService,G=t.permissions,H=i.toRealId(D),V=e.ownerId;return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.editChat",{chat_id:H,is_service:B?1:0,permissions:JSON.stringify(G),group_id:(0,l.getOwnerGroupId)(V)},{retries:1});case 4:return n=e.sent,e.abrupt("return",{type:"UserChangedChatSettings_RequestCompleted",hasFailed:1!==n,permissions:G,peerId:D,isService:B});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedChatSettings_RequestCompleted",hasFailed:!0,permissions:G,peerId:D,isService:B});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedChatSettings_RequestCompleted":var W=t.peerId,z=t.isService,K=t.permissions;if(t.hasFailed)return[];var $=e.convos.get(W);return $&&"ChatConvo"===$.kind?(u.setChatPermissions($,K,z),[]):[];default:(0,o.exhaustivenessCheck)(r)}}},877185:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(314432),u=r(509727),c=r(837021),l=function(e,t){switch(t.type){case"UserChangedChatMember":var r=t.peerId,a=t.memberId,l=t.userAction;if(!e.convos.get(r))return[];var d=function(e,t){var r=t.userAction,n=t.peerId,a=t.memberId;switch(r){case"promote":return function(e){return e.api.fetch("messages.setMemberRole",{member_id:a,peer_id:n,role:"admin"})};case"demote":return function(e){return e.api.fetch("messages.setMemberRole",{member_id:a,peer_id:n,role:"member"})};case"cancel_invitation":case"remove":return function(t){return t.api.fetch("messages.removeChatUser",{chat_id:i.toRealId(n),member_id:a,group_id:(0,c.getOwnerGroupId)(e)})};default:return(0,o.exhaustivenessCheck)(r)}}(e.ownerId,t);return[function(){var e=(0,n.default)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d(t);case 3:return n=e.sent,e.abrupt("return",{type:"UserChangedChatMember_RequestCompleted",hasFailed:1!==n,peerId:r,memberId:a,userAction:l});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{type:"UserChangedChatMember_RequestCompleted",hasFailed:!0,peerId:r,memberId:a,userAction:l});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedChatMember_RequestCompleted":var p=t.peerId,f=t.memberId,h=t.userAction,v=t.hasFailed,y=e.convos.get(p);return v||"ChatConvo"!==(null==y?void 0:y.kind)?[]:("cancel_invitation"===h&&u.removeMember(y,f),i.isContactPeerId(f)||("promote"===h&&u.addAdmin(y,f),"demote"===h&&u.removeAdmin(y,f),"remove"===h&&u.removeMember(y,f)),[]);default:return(0,o.exhaustivenessCheck)(t)}}},617014:(e,t,r)=>{"use strict";r.d(t,{handler:()=>p});var n=r(28991),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=r(716352),c=r(30966),l=r(251766),d={delete:"delete",restore:"delete"},p=function e(t,r,s){var d,p=r.type,h=r.channelId,v=r.postCmid,y=r.commentCmid,m=r.replyCmid,g=r.userAction,b=f(g,h,v,m||y),k=t.channels.get(h),C=k&&u.findPostByCmid(k,v),_="Normal"===(null==C?void 0:C.kind)&&c.findCommentByCmid(C,y);if(!_)return[];if(m){var w=l.findReplyByCmid(_,m);if(!w||"Deleted"===w.kind)return[];d=w}else d=_;if(!_)return[];switch(p){case"UserDeleteComment":if(t.locks.commentActions.has(b)||"Normal"!==d.kind)return[];t.locks.commentActions.add(b);var I=l.markDeleted(d);return m?l.replaceReply(_,I):c.replaceComment(C,I),[function(){var e=(0,a.default)(o().mark((function e(t){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.api,e.prev=1,e.next=4,a.fetch("wall.deleteComment",{owner_id:h,comment_id:I.cmid});case 4:return s=e.sent,e.abrupt("return",(0,n.default)((0,n.default)({},r),{},{type:"UserDeleteComment_RequestCompleted",hasFailed:!Boolean(s),deletedComment:I}));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",(0,n.default)((0,n.default)({},r),{},{type:"UserDeleteComment_RequestCompleted",hasFailed:!0,deletedComment:I}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserRestoreComment":if(t.locks.commentActions.has(b)||"MarkedDeleted"!==d.kind)return[];t.locks.commentActions.add(b);var S=l.restoreDeleted(d);return m?l.replaceReply(_,S):c.replaceComment(C,S),[function(){var e=(0,a.default)(o().mark((function e(t){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.api,e.prev=1,e.next=4,a.fetch("wall.restoreComment",{owner_id:h,comment_id:S.cmid});case 4:return s=e.sent,e.abrupt("return",(0,n.default)((0,n.default)({},r),{},{type:"UserRestoreComment_RequestCompleted",hasFailed:!Boolean(s)}));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",(0,n.default)((0,n.default)({},r),{},{type:"UserRestoreComment_RequestCompleted",hasFailed:!0}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserDeleteComment_RequestCompleted":case"UserRestoreComment_RequestCompleted":var M=r.hasFailed;return t.locks.commentActions.delete(b),M&&e(t,(0,n.default)((0,n.default)({},r),"delete"===g?{type:"UserRestoreComment",userAction:"restore"}:{type:"UserDeleteComment",userAction:"delete"}),s),t.locks.commentActions.delete(b),[];default:(0,i.exhaustivenessCheck)(r)}},f=function(e,t,r,n){return"".concat(d[e],"-").concat(t,"-").concat(r,"-").concat(n)}},461672:(e,t,r)=>{"use strict";r.d(t,{handler:()=>f,applyAttachmentActions:()=>h});var n=r(678927),a=r(692137),s=r(28991),o=r(887757),i=r.n(o),u=r(689018),c=r(980662),l=r(151225),d=r(21705),p=r(210746),f=function(e,t){var r,n=t.peerId,o=null!==(r=e.composerDrafts[n])&&void 0!==r?r:u.empty(),l=u.empty();switch(t.type){case"UserChangedComposerDraft":switch(t.kind){case"text":var f=t.text;l=(0,s.default)((0,s.default)({},o),{},{text:null!=f?f:o.text});break;case"addAttaches":case"removeAttach":case"removeVoice":case"startUploading":case"removeUploads":case"rearrangeAttaches":var v=h(o,t);l=(0,s.default)((0,s.default)({},o),v);break;case"editing":var y=t.editing;l={editing:y,text:c.toRawText(y),attaches:y.attaches,uploadsTrackIds:o.uploadsTrackIds,forward:y.forwardedMessages&&{kind:"message",items:y.forwardedMessages},reply:y.replyMessage};break;case"forward":var m=t.forward,g=t.isForwardAuthorHidden;l=(0,s.default)((0,s.default)({},m&&o.editing?u.empty():o),{},{reply:void 0,forward:m,isForwardAuthorHidden:null!=g?g:u.DEFAULT_FORWARD_AUTHOR_HIDDEN});break;case"reply":var b=t.reply;l=(0,s.default)((0,s.default)({},b&&o.editing?u.empty():o),{},{forward:void 0,reply:b});break;default:(0,d.exhaustivenessCheck)(t)}break;case"UserClearedComposerDraft":break;case"UpdateComposerDraftOnMessageDelete":var k=o.editing;void 0!==k&&t.deletedMessagesCmid.includes(k.cmid)||(l=o);break;default:(0,d.exhaustivenessCheck)(t)}!(l.text||l.forward||l.reply||l.editing||0!==Object.keys(l.attaches).length||0!==l.uploadsTrackIds.size)?delete e.composerDrafts[n]:e.composerDrafts[n]=l;var C=(0,p.current)(e).composerDrafts;return[function(){var e=(0,a.default)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.storage.set("drafts",C),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]};function h(e,t){switch(t.kind){case"addAttaches":var r=t.attaches,a=t.trackIds,s=e.attaches;r&&(s=(0,p.produce)(s,(function(e){l.addAttach(e,r)})));var o=e.uploadsTrackIds;return null!=a&&a.length&&(o=(0,p.produce)(o,(function(e){a.forEach((function(t){e.delete(t)}))}))),{attaches:s,uploadsTrackIds:o};case"removeAttach":var i=t.attach,u=e.attaches;return i&&(u=(0,p.produce)(u,(function(e){l.removeAttach(e,i)}))),{attaches:u};case"removeVoice":return{attaches:(0,p.produce)(e.attaches,(function(e){e.voice&&delete e.voice}))};case"startUploading":var c=t.trackIds;return{uploadsTrackIds:new Set([].concat((0,n.default)(e.uploadsTrackIds),(0,n.default)(c)))};case"removeUploads":var f=t.trackIds;return{uploadsTrackIds:(0,p.produce)(e.uploadsTrackIds,(function(e){f.forEach((function(t){e.delete(t)}))}))};case"rearrangeAttaches":var h=t.key,v=t.currentPosition,y=t.newPosition,m=e.attaches;return-1!==y&&y!==v&&(m=(0,p.produce)(m,(function(e){l.rearrangeAttaches(e,{currentPosition:v,newPosition:y},h)}))),{attaches:m};default:(0,d.exhaustivenessCheck)(t)}}},117215:(e,t,r)=>{"use strict";r.d(t,{handler:()=>y});var n=r(678927),a=r(692137),s=r(887757),o=r.n(s),i=r(509727),u=r(314432),c=r(527119),l=r(980662),d=r(21705),p=r(210746),f=r(837021),h={mute:"mute",unmute:"mute",mute_until:"mute_until",pin:"pin",unpin:"pin",mark_read:"mark_read",mark_unread:"mark_read",archive:"archive",unarchive:"archive",clear:"clear",leave:"leave",leave_and_clear:"leave_and_clear",show_pinned_message:"show_pinned_message",hide_pinned_message:"show_pinned_message",show_bot_keyboard:"show_bot_keyboard",hide_bot_keyboard:"hide_bot_keyboard",pin_message_for_all:"pin_message_for_all",unpin_message_for_all:"pin_message_for_all",ban:"ban",unban:"unban",return_to_chat:"return_to_chat",business_notify_enable:"business_notify_enable",business_notify_disable:"business_notify_enable"},v={pin:"unpin",unpin:"pin",mark_read:"mark_unread",mark_unread:"mark_read",archive:"unarchive",unarchive:"archive",show_pinned_message:"hide_pinned_message",hide_pinned_message:"show_pinned_message",show_bot_keyboard:"hide_bot_keyboard",hide_bot_keyboard:"show_bot_keyboard"},y=function e(t,r,s){switch(r.type){case"UserChangedConvo":var h=r.peerId,y=r.userAction,g=t.organisers,b=t.viewer.id,k=m(r.userAction,h);if(t.locks.convoActions.has(k))return[];t.locks.convoActions.add(k);var C,_=t.convos.get(h),w=t.peers.get(h),I=t.ownerId;if(!_||!w)return[];switch(y){case"pin":C=function(e){return e.fetch("messages.pinConversation",{peer_id:h})};break;case"unpin":C=function(e){return e.fetch("messages.unpinConversation",{peer_id:h})};break;case"mark_read":_.isMarkedUnread=!1,C=function(e){return e.fetch("messages.markAsRead",{peer_id:h,mark_conversation_as_read:1,group_id:(0,f.getOwnerGroupId)(I)})};break;case"mark_unread":_.isMarkedUnread=!0,C=function(e){return e.fetch("messages.markAsUnreadConversation",{peer_id:h,group_id:0})};break;case"archive":case"unarchive":_.isArchived="archive"===y,c.refresh(g,_),C=function(e){return e.fetch("archive"===y?"messages.archiveConversation":"messages.unarchiveConversation",{peer_id:h})};break;case"hide_pinned_message":"ChatConvo"===_.kind&&_.pinnedMessage&&t.hiddenPinnedMessages.set(r.peerId,_.pinnedMessage.cmid);break;case"show_pinned_message":t.hiddenPinnedMessages.delete(r.peerId);break;case"hide_bot_keyboard":t.hiddenBotKeyboards.add(r.peerId);break;case"show_bot_keyboard":t.hiddenBotKeyboards.delete(r.peerId);break;case"clear":C=function(e){return e.fetch("messages.deleteConversation",{peer_id:h,group_id:(0,f.getOwnerGroupId)(I)}).then((function(e){var t=e.last_deleted_id;return Boolean(t)}))};break;case"leave":case"leave_and_clear":if("ChatConvo"!==_.kind)break;C=function(e){return e.fetch("messages.removeChatUser",{chat_id:u.toRealId(h),user_id:b,group_id:(0,f.getOwnerGroupId)(I)})};var S=t.peers.get(h);if(!S||"Chat"!==S.kind)break;i.clearChatDataOnLeave(_),u.clearChatDataOnLeave(S);break;case"ban":if(!("User"===w.kind&&"UserConvo"===_.kind||"Group"===w.kind&&"GroupConvo"===_.kind))break;u.updateIsPeerBlacklistedByMe(w,!0),"UserConvo"===_.kind&&i.restrictWrite(_,"peer_blacklisted_by_me"),C=u.isGroupPeerId(I)?function(e){return e.fetch("groups.ban",{owner_id:h,group_id:(0,f.getOwnerGroupId)(I)})}:u.isGroupPeerId(h)?function(e){return e.fetch("messages.denyMessagesFromGroup",{group_id:u.toRealId(h)})}:function(e){return e.fetch("account.ban",{owner_id:h})};break;case"unban":if(!("User"===w.kind&&"UserConvo"===_.kind||"Group"===w.kind&&"GroupConvo"===_.kind))break;u.updateIsPeerBlacklistedByMe(w,!1),"UserConvo"===_.kind&&i.allowWrite(_),C=u.isGroupPeerId(I)?function(e){return e.fetch("groups.unban",{owner_id:h,group_id:(0,f.getOwnerGroupId)(I)})}:u.isGroupPeerId(h)?function(e){return e.fetch("messages.allowMessagesFromGroup",{group_id:u.toRealId(h)})}:function(e){return e.fetch("account.unban",{owner_id:h})};break;case"return_to_chat":C=function(e){return e.fetch("messages.addChatUser",{chat_id:u.toRealId(h),user_id:b}).then((function(e){var t=e.result;return Boolean(t)}))};break;default:(0,d.exhaustivenessCheck)(y)}return[function(){var e=(0,a.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.api,e.prev=1,n=!1,!C){e.next=7;break}return e.next=6,C(r);case 6:n=!e.sent;case 7:return e.abrupt("return",{type:"UserChangedConvo_RequestCompleted",hasFailed:n,userAction:y,peerId:h});case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedConvo_RequestCompleted",hasFailed:!0,userAction:y,peerId:h});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedConvo_RequestCompleted":var M=r.peerId,A=r.userAction,x=r.hasFailed,R=m(A,M);t.locks.convoActions.delete(R);var E=v[A];if(x&&E)return e(t,{type:"UserChangedConvo",userAction:E,peerId:M},s),[];if(x)return[];switch(A){case"clear":case"pin":case"unpin":case"mark_read":case"mark_unread":case"unarchive":case"show_pinned_message":case"hide_pinned_message":case"show_bot_keyboard":case"hide_bot_keyboard":case"ban":case"unban":return[];case"archive":var U=t.convos.get(M);if(!U||"ChatConvo"!==U.kind||!U.unreadMentions.size)return[];var P=l.resolveCmid(Math.max.apply(Math,(0,n.default)(U.unreadMentions)));return[function(){var e=(0,a.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.storage,(n=r.get("archive-mentions-map"))&&P){e.next=4;break}return e.abrupt("return",{type:"Noop"});case 4:return n[M]=P,r.set("archive-mentions-map",n),e.abrupt("return",{type:"Noop"});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];case"leave":var O=t.convos.get(M);return"ChatConvo"===(null==O?void 0:O.kind)&&i.setConvoState(O,"left"),[];case"leave_and_clear":var T=t.convos.get(M);return"ChatConvo"!==(null==T?void 0:T.kind)?[]:(i.setConvoState(T,"left"),e(t,{type:"UserChangedConvo",userAction:"clear",peerId:M},s));case"return_to_chat":var F=t.convos.get(M);return"ChatConvo"===(null==F?void 0:F.kind)&&i.setConvoState(F,"in"),[];default:return(0,d.exhaustivenessCheck)(r)}case"UserChangedMute":var N=r.peerId,q=r.timer,L=r.userAction,j=m(r.userAction,N);if(t.locks.convoActions.has(j))return[];var D,B=t.convos.get(N);if(!B)return[];switch(L){case"mute":B.push={mode:"every-mention",disabledUntil:1/0},D=-1;break;case"unmute":B.push={mode:"everything",disabledUntil:0},D=0;break;case"mute_until":B.push={mode:"every-mention",disabledUntil:Date.now()+1e3*q},D=q;break;default:(0,d.exhaustivenessCheck)(L)}return[function(){var e=(0,a.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("account.setSilenceMode",{time:D,peer_id:N,sound:"unmute"===L?1:0});case 4:return n=e.sent,e.abrupt("return",{type:"UserChangedMute_RequestCompleted",hasFailed:1!==n,userAction:L,peerId:N});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedMute_RequestCompleted",hasFailed:!0,userAction:L,peerId:N});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedMute_RequestCompleted":var G=r.peerId,H=r.userAction,V=r.hasFailed,W=m(H,G);t.locks.convoActions.delete(W);var z={mute:"unmute",unmute:"mute",mute_until:"unmute"}[H];return V&&z?(e(t,{type:"UserChangedMute",userAction:z,peerId:G,timer:0},s),[]):[];case"UserPinMessage":var K=r.peerId,$=r.cmid,Q=r.userAction,J=m(r.userAction,K);if(t.locks.convoActions.has(J))return[];t.locks.convoActions.add(J);var X=t.convos.get(K),Y=t.ownerId;if(!X||"ChatConvo"!==X.kind)return[];var Z=X.pinnedMessage&&(0,p.current)(X.pinnedMessage),ee=X.persisted.get($);return"Normal"===(null==ee?void 0:ee.kind)&&i.pinMessage(X,l.toPinned(ee)),[function(){var e=(0,a.default)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.pin",{peer_id:K,conversation_message_id:$,group_id:(0,f.getOwnerGroupId)(Y)});case 4:return e.abrupt("return",{type:"UserPinMessage_RequestCompleted",hasFailed:!1,userAction:Q,peerId:K,cmid:$});case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",{type:"UserPinMessage_RequestCompleted",hasFailed:!0,userAction:Q,pinnedMessage:Z,peerId:K,cmid:$});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()];case"UserPinMessage_RequestCompleted":var te=r.peerId,re=r.hasFailed,ne=r.pinnedMessage,ae=r.userAction,se=m(ae,te);t.locks.convoActions.delete(se);var oe=t.convos.get(te);return oe&&"ChatConvo"===oe.kind?(re&&(i.unpinMessage(oe),ne&&i.pinMessage(oe,ne)),[]):[];case"UserUnpinMessage":var ie=r.peerId,ue=r.userAction,ce=m(r.userAction,ie);if(t.locks.convoActions.has(ce))return[];var le=t.convos.get(ie),de=t.ownerId;if(!le||"ChatConvo"!==le.kind)return[];var pe=(0,p.current)(i.unpinMessage(le));return[function(){var e=(0,a.default)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.unpin",{peer_id:ie,group_id:(0,f.getOwnerGroupId)(de)});case 4:return e.abrupt("return",{type:"UserUnpinMessage_RequestCompleted",hasFailed:!1,userAction:ue,peerId:ie});case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",{type:"UserUnpinMessage_RequestCompleted",hasFailed:!0,userAction:ue,prevPinnedMessage:pe,peerId:ie});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()];case"UserUnpinMessage_RequestCompleted":var fe=r.peerId,he=r.hasFailed,ve=r.prevPinnedMessage,ye=r.userAction,me=m(ye,fe);t.locks.convoActions.delete(me);var ge=t.convos.get(fe);return ge&&"ChatConvo"===ge.kind?(he&&ve&&i.pinMessage(ge,ve),[]):[];case"UserChangedBusinessNotify":var be=r.userAction,ke=r.peerId,Ce=m(r.userAction,ke);if(t.locks.convoActions.has(Ce))return[];var _e=t.peers.get(ke);return"Group"!==(null==_e?void 0:_e.kind)||_e.isBlacklistedByMe&&"business_notify_disable"===be||!_e.isBlacklistedByMe&&"business_notify_enable"===be?[]:(u.updateIsPeerBlacklistedByMe(_e,"business_notify_disable"===be),[function(){var e=(0,a.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("business_notify_disable"===be?"messages.denyMessagesFromGroup":"messages.allowMessagesFromGroup",{group_id:u.toRealId(ke)});case 4:return n=e.sent,e.abrupt("return",{type:"UserChangedBusinessNotify_RequestCompleted",hasFailed:1!==n,userAction:be,peerId:ke});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedBusinessNotify_RequestCompleted",hasFailed:!0,userAction:be,peerId:ke});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]);case"UserChangedBusinessNotify_RequestCompleted":var we=r.userAction,Ie=r.peerId,Se=r.hasFailed,Me=m(we,Ie);t.locks.convoActions.delete(Me);var Ae=t.peers.get(Ie);return"Group"!==(null==Ae?void 0:Ae.kind)||Se&&u.updateIsPeerBlacklistedByMe(Ae,!Ae.isBlacklistedByMe),[];default:(0,d.exhaustivenessCheck)(r)}},m=function(e,t){return"".concat(h[e],"-").concat(t.toString())}},154808:(e,t,r)=>{"use strict";r.d(t,{handler:()=>u});var n=r(692137),a=r(887757),s=r.n(a),o=r(314432),i=r(21705),u=function(e,t){switch(t.type){case"UserChangedFriendship":var r=e.peers.get(t.userId);if("User"!==(null==r?void 0:r.kind)||e.locks.updateFriendshipOrMembership.has(r.id))return[];var a=r.friendship;return o.updateFriendship(r,t.change),a===r.friendship?[]:(e.locks.updateFriendshipOrMembership.add(r.id),[function(){var e=(0,n.default)(s().mark((function e(r){var n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.api,a=!1,e.prev=2,e.next=5,n.fetch("friends.".concat(t.change),{user_id:t.userId});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),a=!0;case 10:return e.abrupt("return",{type:"UserChangedFriendship_RequestCompleted",userId:t.userId,change:t.change,hasFailed:a});case 11:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()]);case"UserChangedFriendship_RequestCompleted":e.locks.updateFriendshipOrMembership.delete(t.userId);var u=e.peers.get(t.userId);return"User"!==(null==u?void 0:u.kind)||t.hasFailed&&o.updateFriendship(u,{add:"delete",delete:"add"}[t.change]),[];default:return(0,i.exhaustivenessCheck)(t)}}},387079:(e,t,r)=>{"use strict";r.d(t,{handler:()=>u});var n=r(692137),a=r(887757),s=r.n(a),o=r(314432),i=r(21705),u=function(e,t){switch(t.type){case"UserChangedGroupMembership":var r=e.peers.get(t.groupId);if("Group"!==(null==r?void 0:r.kind)||e.locks.updateFriendshipOrMembership.has(r.id))return[];var a=r.membership;return o.updateMembership(r,t.change),a===r.membership?[]:(e.locks.updateFriendshipOrMembership.add(r.id),[function(){var e=(0,n.default)(s().mark((function e(r){var n,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.api,a="groups.".concat(t.change),o=!1,e.prev=3,e.next=6,n.fetch(a,{group_id:-t.groupId});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),o=!0;case 11:return e.abrupt("return",{type:"UserChangedGroupMembership_RequestCompleted",groupId:t.groupId,change:t.change,hasFailed:o});case 12:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}()]);case"UserChangedGroupMembership_RequestCompleted":e.locks.updateFriendshipOrMembership.delete(t.groupId);var u=e.peers.get(t.groupId);return"Group"!==(null==u?void 0:u.kind)||t.hasFailed&&o.updateMembership(u,{join:"leave",leave:"join"}[t.change]),[];default:return(0,i.exhaustivenessCheck)(t)}}},182931:(e,t,r)=>{"use strict";r.d(t,{handler:()=>f});var n=r(692137),a=r(887757),s=r.n(a),o=r(980662),i=r(509727),u=r(21705),c=r(455995),l=r(837021),d={mark_important:"unmark_important",unmark_important:"mark_important"},p={delete:"delete",restore:"restore",mark_important:"mark_important",unmark_important:"mark_important"},f=function e(t,r,a){switch(r.type){case"UpdateComposerDraftOnMessageDelete":return[];case"UserChangedMessage":for(var p=r.peerId,f=r.userAction,v=r.cmids,y=r.ids,m=0;m<v.length;m+=1){var g=v[m];if(!g)return[];var b=h(f,p,g);if(t.locks.messageActions.has(b))return[];t.locks.messageActions.add(b)}var k,C=t.convos.get(p);switch(f){case"mark_important":case"unmark_important":v.forEach((function(e){if(C){var r=C.persisted.get(e);"Normal"===(null==r?void 0:r.kind)&&(r.isImportant="mark_important"===f)}var n=t.importantMessages.messages.get((0,c.getImportantMessageKey)(p,e));n&&(n.isImportant="mark_important"===f)})),k=function(e){return e.fetch("messages.markAsImportant",{message_ids:"".concat(y.join(",")),important:"mark_important"===f?1:0}).then((function(e){return Boolean(e[0])}))};break;default:(0,u.exhaustivenessCheck)(f)}return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.api,e.prev=1,n=!1,!k){e.next=7;break}return e.next=6,k(r);case 6:n=!e.sent;case 7:return e.abrupt("return",{type:"UserChangedMessage_RequestCompleted",hasFailed:n,userAction:f,ids:y,cmids:v,peerId:p});case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedMessage_RequestCompleted",hasFailed:!0,userAction:f,ids:y,cmids:v,peerId:p});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedMessage_RequestCompleted":var _=r.peerId,w=r.userAction,I=r.hasFailed,S=r.cmids,M=r.ids;S.forEach((function(e){var r=h(w,_,e);t.locks.messageActions.delete(r)}));var A=d[w];return I&&A&&e(t,{type:"UserChangedMessage",userAction:A,ids:M,peerId:_,cmids:S},a),[];case"UserDeleteMessage":var x=r.deleteType,R=r.peerId,E=r.userAction,U=r.messages,P=t.ownerId,O=t.convos.get(R);if(!O)return[];for(var T=[],F=0;F<U.length;F+=1){var N=U[F];if(!N||"Normal"!==N.kind)return[];var q=h(E,R,N.cmid);if(t.locks.messageActions.has(q))return[];t.locks.messageActions.add(q);var L=o.markDeleted(N,"spam"===x);T.push(L);var j=i.isCasper(O)||o.isCall(N);switch(x){case"local":case"spam":if(j){i.deleteMessage(O,N.cmid);break}i.replaceMessage(O,L,!1);break;case"for_all":i.deleteMessage(O,N.cmid);break;default:(0,u.exhaustivenessCheck)(x)}}return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.delete",{message_ids:U.map((function(e){return e.id})).join(","),peer_id:R,delete_for_all:"for_all"===x?1:0,spam:"spam"===x?1:0,group_id:(0,l.getOwnerGroupId)(P)});case 4:return a=e.sent,e.abrupt("return",{type:"UserDeleteMessage_RequestCompleted",hasFailed:!Boolean(null===(n=a[0])||void 0===n?void 0:n.response),userAction:E,deleteType:x,peerId:R,messages:U,deletedMessages:T});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserDeleteMessage_RequestCompleted",hasFailed:!0,userAction:E,deleteType:x,peerId:R,messages:U,deletedMessages:T});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserDeleteFailedMessage":var D=r.peerId,B=r.randomId,G=t.convos.get(D);return G?(i.removeQueued(G,B),[]):[];case"UserDeleteAllFailedMessage":var H=r.peerId,V=t.convos.get(H);return V?(i.allQueuedMessages(V).filter((function(e){return e.hasFailed})).forEach((function(e){i.removeQueued(V,e.randomId)})),[]):[];case"UserDeleteMessage_RequestCompleted":var W=r.peerId,z=r.userAction,K=r.messages,$=r.hasFailed,Q=r.deletedMessages,J=t.convos.get(W);return $&&J&&Q.forEach((function(e){var t=o.restoreDeleted(e);i.restoreMessage(J,t,!1)})),K.forEach((function(e){var r=e.cmid,n=h(z,W,r);t.locks.messageActions.delete(n)})),[(0,n.default)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$?{type:"Noop"}:{type:"UpdateComposerDraftOnMessageDelete",peerId:W,deletedMessagesCmid:Q.map((function(e){return e.cmid}))});case 1:case"end":return e.stop()}}),e)})))];case"UserRestoreMessage":var X=r.peerId,Y=r.userAction,Z=r.cmid,ee=r.messageId,te=h(Y,X,Z);if(t.locks.messageActions.has(te))return[];t.locks.messageActions.add(te);var re=t.convos.get(X);if(!re)return[];var ne=t.ownerId,ae=re.persisted.get(Z);if(ae&&"MarkedDeleted"===ae.kind){var se=o.restoreDeleted(ae);i.restoreMessage(re,se,!1)}return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.restore",{message_id:ee,group_id:(0,l.getOwnerGroupId)(ne)});case 4:return n=e.sent,e.abrupt("return",{type:"UserRestoreMessage_RequestCompleted",hasFailed:!Boolean(n),userAction:Y,messageId:ee,peerId:X,cmid:Z});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserRestoreMessage_RequestCompleted",hasFailed:!0,userAction:Y,messageId:ee,peerId:X,cmid:Z});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserRestoreMessage_RequestCompleted":var oe=r.peerId,ie=r.userAction,ue=r.cmid,ce=r.hasFailed,le=h(ie,oe,ue);t.locks.messageActions.delete(le);var de=t.convos.get(oe),pe=null==de?void 0:de.persisted.get(ue);return ce&&de&&pe&&"Normal"===pe.kind&&e(t,{type:"UserDeleteMessage",messages:[pe],deleteType:"local",peerId:oe,userAction:"delete"},a),[];default:(0,u.exhaustivenessCheck)(r)}},h=function(e,t,r){return"".concat(p[e],"-").concat(t.toString(),"-").concat(r.toString())}},641117:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(692137),a=r(887757),s=r.n(a),o=r(341570),i=r(21705),u=r(509727),c=function(e,t){switch(t.type){case"UserChangedMessageAttachment":return[function(){var e=(0,n.default)(s().mark((function e(r){var n,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.api,e.prev=1,e.next=4,n.fetch("messages.getByConversationMessageId",{peer_id:t.peerId,conversation_message_ids:t.cmid.toString(),extended:1,group_id:t.groupId||0},{retries:3});case 4:if(a=e.sent,o=a.items[0]){e.next=8;break}return e.abrupt("return",{type:"UserChangedMessageAttachment_RequestCompleted",hasFailed:!0});case 8:return e.abrupt("return",{type:"UserChangedMessageAttachment_RequestCompleted",hasFailed:!1,peerId:t.peerId,apiMessage:o});case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedMessageAttachment_RequestCompleted",hasFailed:!0});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedMessageAttachment_RequestCompleted":if(t.hasFailed)return[];var r=(0,o.fromApiMessage)(t.apiMessage),a=r.message,c=r.mentions,l=e.convos.get(t.peerId);return l?(u.replaceMessage(l,a,c.hasDirect||c.hasMass),[]):[];default:(0,i.exhaustivenessCheck)(t)}}},425592:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(509727),u=r(527119),c=r(210746),l=function(e,t){var r=t.type,a=e.viewer.id;switch(r){case"UserAcceptedChatMessageRequest":var l=t.peerId;return e.locks.changeMessageRequest.has(l)?[]:(e.locks.changeMessageRequest.add(l),[function(){var e=(0,n.default)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.acceptMessageRequest",{peer_id:l,user_id:a});case 4:return e.abrupt("return",{type:"UserAcceptedChatMessageRequest_RequestCompleted",peerId:l});case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",{type:"UserAcceptedChatMessageRequest_RequestCompleted",peerId:l});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()]);case"UserRejectedMessageRequest":var d=t.peerId,p=t.isSpam;if(e.locks.changeMessageRequest.has(d))return[];e.locks.changeMessageRequest.add(d);var f=e.convos.get(d),h=(0,c.current)(f);if(void 0!==f&&("MessageRequestChatConvo"===f.kind||"MessageRequestUserConvo"===f.kind||"UserConvo"===f.kind)){var v=i.fromRejectedMessageRequest(f);e.convos.set(d,v),u.refresh(e.organisers,v)}return[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.rejectMessageRequest",{peer_id:d,user_id:a,spam:p?1:0});case 4:return n=e.sent,e.abrupt("return",{type:"UserRejectedChatMessageRequest_RequestCompleted",hasFailed:1!==n,peerId:d,prevConvo:h});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserRejectedChatMessageRequest_RequestCompleted",hasFailed:!0,peerId:d,prevConvo:h});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserAcceptedChatMessageRequest_RequestCompleted":var y=t.peerId;return e.locks.changeMessageRequest.delete(y),[];case"UserRejectedChatMessageRequest_RequestCompleted":var m=t.prevConvo,g=t.hasFailed,b=t.peerId;return e.locks.changeMessageRequest.delete(b),g&&void 0!==m&&(e.convos.set(b,m),u.refresh(e.organisers,m)),[];default:(0,o.exhaustivenessCheck)(r)}}},446116:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(111965),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=r(716352),c=r(610557),l=function(e,t){switch(t.type){case"UserChangedPostAttachment":var r=t.channelId,s=t.cmid;return[function(){var e=(0,a.default)(o().mark((function e(t){var n,a,i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.next=4,n.fetch("channels.getMessagesById",{channel_id:r,cmids:s.toString(),extended:1},{retries:3});case 4:if(i=e.sent,u=null===(a=i.items)||void 0===a?void 0:a[0]){e.next=8;break}return e.abrupt("return",{type:"UserChangedPostAttachment_RequestCompleted",hasFailed:!0});case 8:return e.abrupt("return",{type:"UserChangedPostAttachment_RequestCompleted",hasFailed:!1,channelId:r,apiPost:u});case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",{type:"UserChangedPostAttachment_RequestCompleted",hasFailed:!0});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedPostAttachment_RequestCompleted":if(t.hasFailed)return[];var l=t.apiPost,d=t.channelId,p=e.channels.get(d);if(!p)return[];var f,h=(0,c.fromApiPost)(l),v=h.post,y=h.reactions,m=(0,n.default)(y);try{for(m.s();!(f=m.n()).done;){var g=f.value;e.reactions.set(g.id,g)}}catch(e){m.e(e)}finally{m.f()}return u.replacePost(p,v),[];default:(0,i.exhaustivenessCheck)(t)}}},217698:(e,t,r)=>{"use strict";r.d(t,{handler:()=>u});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(767084),u=function(e,t){var r=t.type;switch(r){case"UserChangedSetting":var a=t.setting;e.locks.settings.add(a);var i=e.viewer.settings[t.setting];return e.viewer.settings[t.setting]=t.value,[function(){var e=(0,n.default)(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(r,t.setting,t.value);case 3:return n=e.sent,"transcriptAutoShow"===t.setting&&1===n&&r.stats.logEvent("type_action",{type:"type_settings_changes_item",type_settings_changes_item:{type:"general",name:"voice_transcription_autoshow",value_old:String(Number(i)),value_new:String(Number(t.value)),screen:"im_web_settings"}}),e.abrupt("return",{type:"UserChangedSetting_RequestCompleted",hasFailed:1!==n,setting:t.setting,previousValue:i});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{type:"UserChangedSetting_RequestCompleted",hasFailed:!0,setting:t.setting,previousValue:i});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserChangedSetting_RequestCompleted":var u=t.setting;return e.locks.settings.delete(u),t.hasFailed&&(e.viewer.settings[t.setting]=t.previousValue),[];default:(0,o.exhaustivenessCheck)(r)}};function c(e,t,r){var n=e.api,a=e.storage;switch(t){case"ctrSubmit":var s=i.IApi.resolveTrackId("account.setInfo","messages_multiline_input");return n.dangerouslyAbort(s),n.fetch("account.setInfo",{name:"messages_multiline_input",value:String(Number(r))},{trackId:s});case"soundNotifications":return a.set("settings-sound-notifications-on",r),Promise.resolve(1);case"showRecommendations":var u=i.IApi.resolveTrackId("account.setInfo","messages_recommendation_list_hidden");return n.dangerouslyAbort(u),n.fetch("account.setInfo",{name:"messages_recommendation_list_hidden",value:String(Number(!r))},{trackId:u});case"countOnlyNotMuted":var c=i.IApi.resolveTrackId("account.setInfo","show_only_not_muted_messages");return n.dangerouslyAbort(c),n.fetch("account.setInfo",{name:"show_only_not_muted_messages",value:String(Number(r))},{trackId:c});case"autoUnarchive":var l=i.IApi.resolveTrackId("account.setInfo","messages_auto_unarchive");return n.dangerouslyAbort(l),n.fetch("account.setInfo",{name:"messages_auto_unarchive",value:String(Number(r))},{trackId:l});case"transcriptAutoShow":var d=i.IApi.resolveTrackId("account.setInfo","messages_transcript_auto_show");return n.dangerouslyAbort(d),n.fetch("account.setInfo",{name:"messages_transcript_auto_show",value:String(Number(r))},{trackId:d});case"verticalFoldersView":return a.set("folders-view-vertical",r),Promise.resolve(1);default:(0,o.exhaustivenessCheck)(t)}}},139150:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(692137),a=r(887757),s=r.n(a),o=r(360202),i=r(21705),u=r(837021),c=r(767084),l=function(e,t,r){switch(t.type){case"UserCreatedFolder":var a=t.name,l=t.peerIds;return e.locks.newFolder?[]:(e.locks.newFolder=!0,[function(){var e=(0,n.default)(s().mark((function e(t){var r,n,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.createFolder",{name:a,included_peer_ids:l.join(",")});case 4:return n=e.sent,e.abrupt("return",{type:"UserCreatedFolder_CreateRequestCompleted",hasFailed:!1,peerIds:l,name:a,folderId:o.resolveId(n.folder_id)});case 8:return e.prev=8,e.t0=e.catch(1),e.t0 instanceof c.IApi.RequestError&&(i=e.t0.code),e.abrupt("return",{type:"UserCreatedFolder_CreateRequestCompleted",hasFailed:!0,name:a,error:i});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]);case"UserCreatedFolder_CreateRequestCompleted":var d=t.hasFailed;if(e.locks.newFolder=!1,d){if(t.error);else if(i.isDev)throw new Error("Не удалось создать папку");return[]}var p=(0,u.insertFolders)(e,[{id:t.folderId,name:t.name}]),f=(0,u.getConvosByIds)(e,t.peerIds);return(0,u.addConvosToFolder)(e,t.folderId,f),p[0]&&o.setHasMore(p[0],"all",!1),[];default:(0,i.exhaustivenessCheck)(t)}}},864669:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(692137),a=r(111965),s=r(887757),o=r.n(s),i=r(360202),u=r(509727),c=r(21705),l=function(e,t,r){switch(t.type){case"UserDeletedFolder":var s=t.folderId;if(e.locks.deleteFolder.has(s))return[];e.locks.deleteFolder.add(s),i.deleteFolder(e.organisers.folders,s);var l,d=(0,a.default)(e.convos.values());try{for(d.s();!(l=d.n()).done;){var p=l.value;u.removeFolder(p,s)}}catch(e){d.e(e)}finally{d.f()}return[function(){var e=(0,n.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.deleteFolder",{folder_id:s});case 4:return n=e.sent,e.abrupt("return",{type:"UserDeletedFolder_DeleteRequestCompleted",hasFailed:1!==n,folderId:s});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserDeletedFolder_DeleteRequestCompleted",hasFailed:!0,folderId:s});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserDeletedFolder_DeleteRequestCompleted":var f=t.hasFailed,h=t.folderId;if(e.locks.deleteFolder.delete(h),f&&c.isDev)throw new Error("Не удалось удалить папку");return[];default:(0,c.exhaustivenessCheck)(t)}}},632828:(e,t,r)=>{"use strict";r.d(t,{handler:()=>m});var n=r(334738),a=r(896156),s=r(28991),o=r(678927),i=r(692137),u=r(887757),c=r.n(u),l=r(252229),d=r(21705),p=r(210746),f=r(509727),h=r(980662),v=r(314432),y=r(837021),m=function(e,t){switch(t.type){case"UserHideFilter":if("archive"===t.kind){var r=(0,p.current)(e),u=r.organisers,m=r.ownerId;return u.filters.archive.hasMore&&(e.locks.hideFilter.archive=!0),[function(){var e=(0,i.default)(c().mark((function e(t){var r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.api,u.filters.archive.hasMore){e.next=3;break}return e.abrupt("return",{type:"UserHideFilter_Completed",kind:"archive"});case 3:return e.prev=3,e.next=6,g(u.filters.archive,r,m);case 6:return n=e.sent,e.abrupt("return",{type:"LoadArchiveConvos_RequestCompleted",hasFailed:!1,response:n,nextAction:{type:"UserHideFilter_Completed",kind:"archive"}});case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",{type:"LoadArchiveConvos_RequestCompleted",hasFailed:!0});case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()]}return"businessNotify"===t.kind?e.organisers.filters.businessNotify.unreadCount>0?[]:[function(){var e=(0,i.default)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.storage.set("business-notify-manually-hidden",!0),e.abrupt("return",{type:"UserHideFilter_Completed",kind:"businessNotify"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]:"all"===t.kind||"unread"===t.kind||"chats"===t.kind||"messageRequest"===t.kind?[]:(0,d.exhaustivenessCheck)(t.kind);case"LoadArchiveConvos_RequestCompleted":if(t.hasFailed)return[];var b=t.response,k=t.nextAction,C=(0,y.insertConvos)(e,b.items);return(0,y.insertPeers)(e,{apiUsers:b.profiles||[],apiGroups:b.groups||[],apiContacts:b.contacts||[]}),l.push(e.organisers.filters,"archive",C,!1),[(0,i.default)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",k);case 1:case"end":return e.stop()}}),e)})))];case"UserHideFilter_Completed":return"archive"===t.kind?(e.locks.hideFilter.archive=!1,l.toggleArchiveVisibility(e.organisers.filters,!1),[function(){var e=(0,i.default)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.storage.set("archive-manually-hidden",!0),e.abrupt("return",{type:"ActualizeArchiveMentions",undoHideOnNewMention:!1});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]):"businessNotify"===t.kind?(l.toggleBusinessNotifyVisibility(e.organisers.filters,!1),[]):"all"===t.kind||"unread"===t.kind||"chats"===t.kind||"messageRequest"===t.kind?[]:(0,d.exhaustivenessCheck)(t.kind);case"UserUndoHideFilter":return"archive"===t.kind?(l.toggleArchiveVisibility(e.organisers.filters,!0),[function(){var e=(0,i.default)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.storage.set("archive-manually-hidden",!1),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]):"businessNotify"===t.kind?(l.toggleBusinessNotifyVisibility(e.organisers.filters,!0),[function(){var e=(0,i.default)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.storage.set("business-notify-manually-hidden",!1),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]):"all"===t.kind||"unread"===t.kind||"chats"===t.kind||"messageRequest"===t.kind?[]:(0,d.exhaustivenessCheck)(t.kind);case"UserActualizeHideFilter":if("archive"===t.kind){var _=(0,p.current)(e.organisers.filters.archive).isHidden;return[function(){var e=(0,i.default)(c().mark((function e(t){var r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.storage,!(n=r.get("archive-manually-hidden"))||_){e.next=4;break}return e.abrupt("return",{type:"UserHideFilter",kind:"archive"});case 4:if(n||!_){e.next=6;break}return e.abrupt("return",{type:"UserUndoHideFilter",kind:"archive"});case 6:return e.abrupt("return",{type:"Noop"});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(0,i.default)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"ActualizeArchiveMentions",undoHideOnNewMention:!0});case 1:case"end":return e.stop()}}),e)})))]}if("businessNotify"===t.kind){var w=e.organisers.filters.businessNotify.unreadCount,I=e.organisers.filters.businessNotify.isHidden;return[function(){var e=(0,i.default)(c().mark((function e(t){var r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.storage,!(n=r.get("business-notify-manually-hidden"))||I){e.next=4;break}return e.abrupt("return",{type:"UserHideFilter",kind:"businessNotify"});case 4:if(n||!I){e.next=6;break}return e.abrupt("return",{type:"UserUndoHideFilter",kind:"businessNotify"});case 6:if(0!==w){e.next=8;break}return e.abrupt("return",{type:"Noop"});case 8:return e.abrupt("return",{type:"UserUndoHideFilter",kind:"businessNotify"});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}return"all"===t.kind||"unread"===t.kind||"chats"===t.kind||"messageRequest"===t.kind?[]:(0,d.exhaustivenessCheck)(t.kind);case"ActualizeArchiveMentions":if(e.organisers.filters.archive.hasMore){var S=(0,p.current)(e),M=S.organisers,A=S.ownerId;return[function(){var e=(0,i.default)(c().mark((function e(r){var n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.api,e.prev=1,e.next=4,g(M.filters.archive,n,A);case 4:return a=e.sent,e.abrupt("return",{type:"LoadArchiveConvos_RequestCompleted",hasFailed:!1,response:a,nextAction:{type:"ActualizeArchiveMentions",undoHideOnNewMention:t.undoHideOnNewMention}});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"LoadArchiveConvos_RequestCompleted",hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]}var x=e.organisers.filters.archive.peerIds,R=(0,o.default)(x).map((function(t){return f.safeGet(e.convos,t)})).reduce((function(e,t){if("ChatConvo"!==t.kind||!t.unreadMentions.size)return e;var r=h.resolveCmid(Math.max.apply(Math,(0,o.default)(t.unreadMentions)));return(0,s.default)((0,s.default)({},e),{},(0,a.default)({},t.peerId,r))}),{});return[function(){var e=(0,i.default)(c().mark((function e(r){var a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.storage,s=a.get("archive-mentions-map")||{},a.set("archive-mentions-map",R),!Object.entries(R).some((function(e){var t=(0,n.default)(e,2),r=t[0];return t[1]!==s[v.resolveId(Number(r))]}))||!t.undoHideOnNewMention){e.next=6;break}return e.abrupt("return",{type:"UserUndoHideFilter",kind:"archive"});case 6:return e.abrupt("return",{type:"Noop"});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];default:(0,d.exhaustivenessCheck)(t)}};function g(e,t,r){return t.fetch("messages.getConversations",{filter:"archive",count:e.totalCount,extended:1,group_id:(0,y.getOwnerGroupId)(r)})}},751713:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(151225),u=r(837021),c=function(e,t){switch(t.type){case"UserHitEdit":var r=t.mid,a=t.text,c=t.attaches,l=t.peerId,d=t.keepForwarded,p=t.keepSnippets,f=e.convos.get(l),h=e.ownerId;if(!f)return[];e.locks.edit.add(l);var v=i.ids(c).join(",");return[function(){var e=(0,n.default)(s().mark((function e(t){var n,o,i,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,o=!1,e.prev=2,e.next=5,n.fetch("messages.edit",{message_id:r,peer_id:l,message:a,attachment:0===v.length?void 0:v,group_id:(0,u.getOwnerGroupId)(h),keep_forward_messages:d?1:0,keep_snippets:p?1:0,lat:null===(i=c.geo)||void 0===i?void 0:i.coordinates.latitude,long:null===(f=c.geo)||void 0===f?void 0:f.coordinates.longitude});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),o=!0;case 10:return e.abrupt("return",{type:"UserHitEdit_RequestCompleted",peerId:l,hasFailed:o});case 11:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()];case"UserHitEdit_RequestCompleted":var y=t.peerId;t.hasFailed;e.locks.edit.delete(y);e.convos.get(y);return[];default:return(0,o.exhaustivenessCheck)(t)}}},362156:(e,t,r)=>{"use strict";r.d(t,{handler:()=>m});var n=r(334738),a=r(28991),s=r(692137),o=r(678927),i=r(887757),u=r.n(i),c=r(210746),l=r(21705),d=r(980662),p=r(509727),f=r(151225),h=r(215857),v=r(837021),y=r(190831),m=function e(t,r,a){switch(r.type){case"UserHitSend":var s=r.peerId,i=t.convos.get(s);return i?(p.clearAfterGap(i),function(e,t){for(var r=e.text,a=e.attaches,s=e.peerId,o=e.timestamp,i=e.expireTTL,u=e.deleteTTL,c=e.entrypoint,l=e.extra,p=e.reply,f=e.forwarded,h=function(e){var t=e.length;if(t<y.MAX_MESSAGE_SIZE)return[e];for(var r=[],n=0,a=0;a<Math.ceil(t/y.MAX_MESSAGE_SIZE);a++){var s=e.substring(n,n+y.MAX_MESSAGE_SIZE).lastIndexOf(" "),o=-1===s?y.MAX_MESSAGE_SIZE:s,i=t-n<=y.MAX_MESSAGE_SIZE?e.substring(n):e.substring(n,n+o);n+=i.length,r.push(i)}return r.map((function(e){return e.trim()}))}(r),v=function(e){var t=Object.values(e).flat(),r=Object.fromEntries(Object.entries(e).map((function(e){var t=(0,n.default)(e,2),r=t[0],a=t[1];return Array.isArray(a)?[a[0].kind,r]:[a.kind,r]})));if(t.length<=y.MAX_MESSAGE_ATTACHES)return[e];return t.reduce((function(e,t,n){var a,s=Math.floor(n/y.MAX_MESSAGE_ATTACHES),o=r[t.kind];return o?(e[s][o]=(null===(a=e[s][o])||void 0===a?void 0:a.concat(t))||[t],e):e}),Array(Math.ceil(t.length/y.MAX_MESSAGE_ATTACHES)).fill("").map(Object))}(a),m=h.length+v.length-1,g=[],b=0;b<m;b++){var k=h[b]||"",C=v[b-h.length+1]||{},_=d.newQueued({peerId:s,text:k,isOut:!0,sentAt:o+b,authorId:t,attaches:C,expireTTL:i,deleteTTL:u,extra:l,entrypoint:c},0===b?p:void 0,b===m-1?f:void 0);g.push(_)}return g}(r,t.ownerId).flatMap((function(e){var r,n,a,s;p.appendQueuedMessage(i,e);var u=t.locks.sendQueue.get(i.peerId);return u?(u.add(e.randomId),[]):(t.locks.sendQueue.set(i.peerId,new Set([e.randomId])),e.attaches.sticker&&(t.recentStickers=[e.attaches.sticker.id].concat((0,o.default)(t.recentStickers.filter((function(t){var r;return t!==(null===(r=e.attaches.sticker)||void 0===r?void 0:r.id)})))).slice(0,h.MAX_RECENT_STICKERS)),[g(e.peerId,e.randomId,e.text,f.ids(e.attaches),e.extra,e.entrypoint,e.attaches.geo,(0,v.getOwnerGroupId)(t.ownerId),null!==(r=null===(n=e.replyMessage)||void 0===n?void 0:n.id)&&void 0!==r?r:null,null!==(a=null===(s=e.forwardedMessages)||void 0===s?void 0:s.map((function(e){return e.id})))&&void 0!==a?a:null)])}))):[];case"UserHitSend_RequestCompleted":var u,m,b,k,C=r.peerId,_=r.randomId,w=r.hasFailed,I=t.convos.get(C),S=t.ownerId;if(!I)return t.locks.sendQueue.delete(C),[];w&&p.updateSendingFail(I,_,w);var M=t.locks.sendQueue.get(I.peerId);if(!M)return[];M.delete(_);var A=(0,o.default)(M)[0];if(!A)return t.locks.sendQueue.delete(C),[];var x=I.queued.get(A);if(!x)return[];var R=(0,c.current)(x);return[g(C,R.randomId,R.text,f.ids(R.attaches),R.extra,R.entrypoint,R.attaches.geo,(0,v.getOwnerGroupId)(S),null!==(u=null===(m=R.replyMessage)||void 0===m?void 0:m.id)&&void 0!==u?u:null,null!==(b=null===(k=R.forwardedMessages)||void 0===k?void 0:k.map((function(e){return e.id})))&&void 0!==b?b:null)];case"UserHitResendFailedMessage":var E,U,P,O,T=r.randomId,F=r.peerId,N=r.entrypoint,q=t.convos.get(F),L=t.ownerId;if(!q)return[];var j=q.queued.get(T);if(!j)return[];p.updateSendingFail(q,T,!1),p.changeQueuedMessageEntrypoint(q,T,N);var D=t.locks.sendQueue.get(q.peerId);if(D)return D.add(j.randomId),[];t.locks.sendQueue.set(q.peerId,new Set([j.randomId]));var B=(0,c.current)(j);return[g(F,B.randomId,B.text,f.ids(B.attaches),B.extra,N,B.attaches.geo,(0,v.getOwnerGroupId)(L),null!==(E=null===(U=B.replyMessage)||void 0===U?void 0:U.id)&&void 0!==E?E:null,null!==(P=null===(O=B.forwardedMessages)||void 0===O?void 0:O.map((function(e){return e.id})))&&void 0!==P?P:null)];case"UserHitResendAllFailedMessages":var G=r.peerId,H=r.entrypoint,V=t.convos.get(G);return V?p.allQueuedMessages(V).filter((function(e){return e.hasFailed})).flatMap((function(r){return e(t,{type:"UserHitResendFailedMessage",peerId:G,randomId:r.randomId,entrypoint:H||r.entrypoint},a)})):[];case"ResendAllFailedMessages":return Array.from(t.convos.values()).flatMap((function(r){return e(t,{type:"UserHitResendAllFailedMessages",peerId:r.peerId},a)}));case"UserHitSendWidget":var W=r.peerId,z=r.text,K=r.timestamp,$=r.entrypoint,Q=r.extra;if(t.convos.get(W))return e(t,{type:"UserHitSend",attaches:{},extra:Q,entrypoint:$,text:z,peerId:W,timestamp:K},a);var J=d.newQueued({peerId:W,text:z,isOut:!0,sentAt:K,authorId:t.ownerId,attaches:{},extra:Q,entrypoint:$});return[g(J.peerId,J.randomId,J.text,f.ids(J.attaches),J.extra,J.entrypoint,J.attaches.geo,(0,v.getOwnerGroupId)(t.ownerId),null,null)];default:return(0,l.exhaustivenessCheck)(r)}};function g(e,t,r,n,o,i,c,l,d,p){return function(){var f=(0,s.default)(u().mark((function s(f){var h,v,y,m;return u().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return h=f.api,v=!1,y={},o.sticker&&(y.sticker_id=o.sticker.id,y.sticker_referrer=o.sticker.referrer),o.botPayload&&(y.payload=o.botPayload),o.silent&&(y.silent=1),o.expiresIn&&(y.expire_ttl=o.expiresIn),c&&(y.lat=c.coordinates.latitude,y.long=c.coordinates.longitude),s.prev=8,s.next=11,h.fetch("messages.send",(0,a.default)((0,a.default)({},y),{},{peer_id:e,random_id:t,message:r,reply_to:null!=d?d:void 0,forward_messages:null!==(m=null==p?void 0:p.join(","))&&void 0!==m?m:void 0,attachment:0===n.length?void 0:n.join(","),entrypoint:i,group_id:l}));case 11:s.next=16;break;case 13:s.prev=13,s.t0=s.catch(8),v=!0;case 16:return s.abrupt("return",{type:"UserHitSend_RequestCompleted",peerId:e,randomId:t,hasFailed:v});case 17:case"end":return s.stop()}}),s,null,[[8,13]])})));return function(e){return f.apply(this,arguments)}}()}},628177:(e,t,r)=>{"use strict";r.d(t,{handler:()=>v});var n=r(28991),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=r(716352),c=r(30966),l=r(251766),d=r(314432),p=r(190831),f=r(837021),h={UserChangedLike:"UserChangedLike",UserChangedLike_RequestCompleted:"UserChangedLike",UserLoadedLikes:"UserLoadedLikes",UserLoadedLikes_RequestCompleted:"UserLoadedLikes"},v=function e(t,r,s){var v,m,g;switch(r.kind){case"comment":var b=r.channelId,k=r.postCmid,C=r.commentCmid,_=r.replyCmid,w=t.channels.get(b),I=w&&u.findPostByCmid(w,k),S="Normal"===(null==I?void 0:I.kind)&&c.findCommentByCmid(I,C);if(!S||"Normal"!==S.kind)break;if(v=S.channelId,_){var M=l.findReplyByCmid(S,_);if(!M||"Normal"!==M.kind)break;g=M,m=M.cmid;break}g=S,m=S.cmid;break;case"post":var A=r.channelId,x=r.postCmid,R=t.channels.get(A),E=R&&u.findPostByCmid(R,x);if(!E||"Normal"!==E.kind)break;v=E.channelId,m=E.cmid,g=E;break;default:(0,i.exhaustivenessCheck)(r)}if(!g||!v||!m)return[];var U=y(h[r.type],r.kind,v,m);switch(r.type){case"UserLoadedLikes":if(t.locks.likeActions.has(U))return[];var P;switch(t.locks.likeActions.add(U),r.kind){case"comment":case"post":P=g.likes.peerIds.size;break;default:(0,i.exhaustivenessCheck)(r)}var O=0===g.likes.peerIds.size?p.LIKE_PEERS_FIRST_LOAD:p.LIKE_PEERS_PER_PAGE;return[function(){var e=(0,a.default)(o().mark((function e(t){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.api,e.prev=1,e.next=4,a.fetch("likes.getList",{type:r.kind,owner_id:v,item_id:m,extended:1,skip_own:1,count:O,offset:P});case 4:return s=e.sent,e.abrupt("return",(0,n.default)((0,n.default)({},r),{},{type:"UserLoadedLikes_RequestCompleted",response:s,hasFailed:!1}));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",(0,n.default)((0,n.default)({},r),{},{type:"UserLoadedLikes_RequestCompleted",hasFailed:!0}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserLoadedLikes_RequestCompleted":var T=r.hasFailed,F=r.response;if(t.locks.likeActions.delete(U),T||!F)return[];var N=F.items.filter((function(e){return"profile"===e.type})),q=F.items.filter((function(e){return"group"===e.type})),L=F.items.map((function(e){return d.resolveId(e.id)}));switch((0,f.insertPeers)(t,{apiUsers:N,apiGroups:q,apiContacts:[]}),r.kind){case"comment":case"post":L.forEach((function(e){var t;return null===(t=g)||void 0===t?void 0:t.likes.peerIds.add(e)}));break;default:(0,i.exhaustivenessCheck)(r)}return[];case"UserChangedLike":var j=r.reactionId,D=g.likes.reactionId;if(D===j)return[];var B=void 0!==D;return t.locks.likeActions.has(U)?[]:(t.locks.likeActions.add(U),void 0===j?g.likes.count-=1:B||(g.likes.count+=1),g.likes.reactionId=j,[function(){var e=(0,a.default)(o().mark((function e(t){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.api,e.prev=1,e.next=4,a.fetch(B&&void 0===j?"likes.delete":"likes.add",{type:r.kind,owner_id:v,item_id:m||0,reaction_id:j});case 4:return s=e.sent,e.abrupt("return",(0,n.default)((0,n.default)({},r),{},{type:"UserChangedLike_RequestCompleted",response:s,hasFailed:!1}));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",(0,n.default)((0,n.default)({},r),{},{type:"UserChangedLike_RequestCompleted",hasFailed:!0,prevReactionId:D}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]);case"UserChangedLike_RequestCompleted":var G=r.hasFailed,H=r.response,V=r.prevReactionId;return t.locks.likeActions.delete(U),G||!H?(e(t,(0,n.default)((0,n.default)({},r),{},{type:"UserChangedLike",reactionId:V}),s),t.locks.likeActions.delete(U),[]):(g.likes.count=H.likes,[]);default:(0,i.exhaustivenessCheck)(r)}},y=function(e,t,r,n){return"".concat(e,"-").concat(t,"-").concat(r,"-").concat(n)}},360082:(e,t,r)=>{"use strict";r.d(t,{handler:()=>f,getCommentsHistoryLockKey:()=>h});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(716352),u=r(30966),c=r(251766),l=r(837021),d=r(190831),p=r(10454),f=function(e,t){switch(t.type){case"UserLoadedCommentsHistory":var r=t.channelId,a=t.postCmid,f=t.startCmid,v=t.commentCmid,y=t.order,m=h(r,a,v);if(e.locks.getPostCommentsHistory.has(m))return[];e.locks.getPostCommentsHistory.add(m);var g=e.channels.get(r);if(!g)return[];var b,k=i.findPostByCmid(g,a);if(!k||"Normal"!==k.kind)return[];if(v&&!u.findCommentByCmid(k,v))return[];switch(y){case"interesting":b="smart";break;case"new":b="desc";break;case"old":b="asc";break;default:(0,o.exhaustivenessCheck)(y)}return[function(){var e=(0,n.default)(s().mark((function e(t){var n,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.next=4,n.fetch("wall.getComments",{owner_id:r,post_id:a,count:d.COMMENTS_PER_PAGE,sort:b,thread_items_count:d.THREAD_COMMENTS_COUNT,need_likes:1,extended:1,start_comment_id:f,comment_id:v||void 0,offset:f?1:0});case 4:return o=e.sent,e.abrupt("return",{type:"UserLoadedCommentsHistory_RequestSucceed",channelId:r,response:o,postCmid:a,order:y,commentCmid:v});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserLoadedCommentsHistory_RequestFailed",channelId:r,postCmid:a,commentCmid:v,hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserLoadedCommentsHistory_RequestSucceed":var C=t.response,_=t.channelId,w=t.postCmid,I=t.commentCmid,S=t.order;e.locks.getPostCommentsHistory.delete(h(_,w,I));var M=e.channels.get(_);if(!M)return[];var A=i.findPostByCmid(M,w);if(!A||"Normal"!==A.kind)return[];var x=C.items.map((function(e){return(0,p.fromApiComment)(e)}));if(S!==A.comments.order&&u.changeCommentsOrder(A,S),I){var R=u.findCommentByCmid(A,I);if(!R)return[];c.insertReplies(R,x),R.replies.count=C.current_level_count||R.replies.count}else u.insertComments(A,x,C.current_level_count||0),A.comments.count=C.count,A.comments.oneLevelCount=C.current_level_count||A.comments.oneLevelCount;return(0,l.insertPeers)(e,{apiUsers:C.profiles||[],apiGroups:C.groups||[],apiContacts:[]}),[];case"UserLoadedCommentsHistory_RequestFailed":var E=t.channelId,U=t.postCmid,P=t.commentCmid;return e.locks.getPostCommentsHistory.delete(h(E,U,P)),[];default:return(0,o.exhaustivenessCheck)(t)}},h=function(e,t,r){return"".concat(e,"-").concat(t,"-").concat(r||"")}},759568:(e,t,r)=>{"use strict";r.d(t,{handler:()=>p});var n=r(692137),a=r(887757),s=r.n(a),o=r(906978),i=r(716352),u=r(527119),c=r(21705),l=r(767084),d=r(837021),p=function(e,t,r){switch(t.type){case"UserOpenedChannel":var a=t.channelId,p=e.locks.channelsCleanup.get(a)||0;return e.locks.channelsCleanup.set(a,p+1),e.channels.get(a)?[]:[function(){var e=(0,n.default)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("channels.getById",{channel_ids:a.toString(),extended:1},{retries:2});case 4:return n=e.sent,e.abrupt("return",{type:"UserOpenedChannel_ChannelRequestCompleted",channelId:a,response:n,hasFailed:!1});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserOpenedChannel_ChannelRequestCompleted",channelId:a,hasFailed:!0,errCode:e.t0 instanceof l.IApi.RequestError?e.t0.code:void 0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserOpenedChannel_ChannelRequestCompleted":var f=t.hasFailed,h=t.channelId,v=t.response,y=t.errCode;if(f&&y===o.API_ERROR_ACCESS)return[function(){var e=(0,n.default)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.router.replace({kind:"ChannelRoute",channelId:h,accessDenied:!0}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];if(!v)return[];(0,d.insertChannels)(e,{apiChannels:v.items||[],apiGroups:v.groups||[]});var m=e.channels.get(h);if(!m){if(c.isDev)throw new Error("Диалог не был найден");return[function(){var e=(0,n.default)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.router.replace({kind:"ChannelsListRoute"}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}return m.isMember&&u.refreshChannels(e.organisers,m),[];case"UserClosedChannel":var g=t.channelId,b=e.locks.channelsCleanup.get(g);if(b&&b>1)return e.locks.channelsCleanup.set(g,b-1),[];var k=e.channels.get(g);return k?(i.cleanup(k),[]):[];default:return(0,c.exhaustivenessCheck)(t)}}},931947:(e,t,r)=>{"use strict";r.d(t,{handler:()=>v});var n=r(334738),a=r(692137),s=r(887757),o=r.n(s),i=r(837021),u=r(341570),c=r(314432),l=r(509727),d=r(527119),p=r(190831),f=r(21705),h=r(378399),v=function e(t,r,s){switch(r.type){case"LoadChatMembers":return[];case"UserOpenedConvo":var v=r.peerId,m=r.cmid,g=t.convos.get(v),b=t.locks.convosCleanup.get(v)||0;t.locks.convosCleanup.set(v,b+1);var k=(0,i.getOwnerGroupId)(t.ownerId);return g?e(t,{type:"UserOpenedConvo_ConvoRequestCompleted",peerId:v,cmid:m,hasFailed:!1},s):[function(){var e=(0,a.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.getConversationsById",{peer_ids:v.toString(),group_id:k,extended:1},{retries:3});case 4:return n=e.sent,e.abrupt("return",{type:"UserOpenedConvo_ConvoRequestCompleted",peerId:v,cmid:m,hasFailed:!1,profiles:n.profiles,groups:n.groups,conversations:n.items,contacts:n.contacts});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserOpenedConvo_ConvoRequestCompleted",peerId:v,hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserOpenedConvo_ConvoRequestCompleted":var C=r.peerId,_=r.conversations,w=r.profiles,I=r.cmid,S=r.groups,M=r.contacts;if(r.hasFailed){if(f.isDev)throw new Error("Не удалось загрузить диалог");return[function(){var e=(0,a.default)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.router.replace({kind:"MainRoute"}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}(0,i.insertConvos)(t,_||[]),(0,i.insertPeers)(t,{apiUsers:w||[],apiGroups:S||[],apiContacts:M||[]});var A=t.convos.get(C);if(!A){if(f.isDev)throw new Error("Диалог не был найден");return[function(){var e=(0,a.default)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.router.replace({kind:"MainRoute"}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}var x=A.isMarkedUnread&&0===A.unreadCount;x&&l.markRead(A),d.refresh(t.organisers,A);var R="ChatConvo"===A.kind&&void 0===A.members&&l.canReadMembers(A)&&!t.locks.getConversationMembers.has(C);R&&t.locks.getConversationMembers.add(C);var E=void 0!==I&&!l.canShowAround(A,I),U=E||(s.vkm_convo_new_history_load?!l.canShowAround(A,A.inReadBy):l.length(A).persisted<p.MESSAGES_PER_PAGE)&&A.hasMore&&!t.locks.getHistory.has(A.peerId);U&&t.locks.getHistory.add(A.peerId);var P=Object.values(s.me_sticker_packs).flat(),O=A.unreadCount>0,T=!t.locks.getStickerPacks;T&&(t.locks.getStickerPacks=!0);var F=(0,i.getOwnerGroupId)(t.ownerId);return[R&&c.isChatPeerId(C)&&function(){var e=(0,a.default)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"LoadChatMembers",peerId:C});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T&&function(){var e=(0,a.default)(o().mark((function e(t){var r,a,i,u,c,l,d,p,f,h,v,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,a=t.storage,e.prev=1,i={retries:10},e.next=5,Promise.all([r.fetch("store.getProducts",{type:"stickers",filters:"active",extended:1},i),y({api:r,storage:a,featureFlags:s})]);case 5:return u=e.sent,c=(0,n.default)(u,2),l=c[0],d=c[1],e.next=11,r.fetchMany([{method:"store.getFavoriteStickers",params:{}},{method:"messages.getRecentStickers",params:{group_id:F}},P.length>0&&{method:"store.getStickers",params:{sticker_ids:P.join()}}],{retries:10});case 11:return p=e.sent,f=(0,n.default)(p,3),h=f[0],v=f[1],m=f[2],e.abrupt("return",{type:"UserOpenedConvo_StickersLoadRequestSucceed",favoriteStickersResponse:h,recentStickersResponse:v,stickerPacksResponse:l,helloStickersResponse:m,stickersKeywordsResponse:d});case 19:return e.prev=19,e.t0=e.catch(1),e.abrupt("return",{type:"UserOpenedConvo_StickersLoadRequestFailed"});case 22:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),x&&function(){var e=(0,a.default)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.markAsRead",{peer_id:C,mark_conversation_as_read:1,group_id:F});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.abrupt("return",{type:"Noop"});case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),U&&function(){var e=(0,a.default)(o().mark((function e(t){var r,n,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.api,e.t0=!0,e.next=e.t0===E?4:e.t0===O?7:10;break;case 4:return n=p.MESSAGES_PER_PAGE,a=-(Math.floor(p.MESSAGES_PER_PAGE/2)-1),e.abrupt("break",12);case 7:return n=Math.floor(1.25*p.MESSAGES_PER_PAGE),a=-p.MESSAGES_PER_PAGE,e.abrupt("break",12);case 10:n=p.MESSAGES_PER_PAGE,a=0;case 12:return e.prev=12,e.next=15,r.fetch("messages.getHistory",{peer_id:C,start_cmid:E?I:-1,count:n,offset:a,extended:1,group_id:F},{retries:5,timeout:2e4});case 15:return s=e.sent,e.abrupt("return",{type:"UserOpenedConvo_HistoryRequestSucceed",peerId:C,hasMore:E||s.items.length>=n+a,response:s});case 19:return e.prev=19,e.t1=e.catch(12),e.abrupt("return",{type:"UserOpenedConvo_HistoryRequestFailed",peerId:C});case 22:case"end":return e.stop()}}),e,null,[[12,19]])})));return function(t){return e.apply(this,arguments)}}()];case"UserClosedConvo":if((b=t.locks.convosCleanup.get(r.peerId))&&b>1)return t.locks.convosCleanup.set(r.peerId,b-1),[];t.locks.convosCleanup.delete(r.peerId);var N=t.convos.get(r.peerId);return N?(l.cleanup(N),[]):[];case"UserOpenedConvo_HistoryRequestSucceed":var q=r.peerId,L=r.response,j=r.hasMore;t.locks.getHistory.delete(q);var D=t.convos.get(q);if(!D)return[];var B=L.items.map((function(e){return(0,u.fromApiMessage)(e).message}));return l.insertMessages(D,B,j),(0,i.insertPeers)(t,{apiUsers:L.profiles||[],apiGroups:L.groups||[],apiContacts:[]}),[];case"UserOpenedConvo_HistoryRequestFailed":return t.locks.getHistory.delete(r.peerId),[];case"UserOpenedConvo_StickersLoadRequestSucceed":var G,H,V,W=r.stickerPacksResponse,z=r.helloStickersResponse,K=r.favoriteStickersResponse,$=r.recentStickersResponse,Q=r.stickersKeywordsResponse,J=new Map;null===(G=W.items)||void 0===G||G.forEach((function(e){var r=(0,h.fromApiStickerPack)(e);if(r){var n=r.stickerPack,a=r.stickers;J.set(n.id,n),a.forEach((function(e){t.stickers.set(e.id,e)}))}})),t.stickerPacks=J,t.stickersKeywords=(0,h.fromApiStickersKeywords)(Q);var X=function(e){var r=(0,h.fromApiSticker)(e);if(r)return t.stickers.set(r.id,r),r.id};return null==z||z.forEach(X),t.favoriteStickers=[],null===(H=K.items)||void 0===H||H.forEach((function(e){var r=X(e);r&&t.favoriteStickers.push(r)})),t.recentStickers=[],null===(V=$.items)||void 0===V||V.forEach((function(e){var r=X(e);r&&t.recentStickers.push(r)})),[function(){var e=(0,a.default)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.sleep)(p.STICKERS_REFRESH_INTERVAL);case 2:return e.abrupt("return",{type:"UserOpenedConvo_StickersRefreshThrottleTimedOut"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()];case"UserOpenedConvo_StickersRefreshThrottleTimedOut":case"UserOpenedConvo_StickersLoadRequestFailed":return t.locks.getStickerPacks=!1,[];default:return(0,f.exhaustivenessCheck)(r)}};function y(e){return m.apply(this,arguments)}function m(){return(m=(0,a.default)(o().mark((function e(t){var r,n,a,s,i,u,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,n=t.storage,a=t.featureFlags,e.next=3,n.getIDB("stickers-keywords");case 3:if(s=e.sent,i=Math.round((new Date).getTime()/1e3),u=86400,!(c=s&&s.expiresAt>i)){e.next=11;break}e.t0=s.response,e.next=14;break;case 11:return e.next=13,r.fetch("store.getStickersKeywords",{need_stickers:0,all_products:a.vkm_send_promoted_stickers?1:0},{retries:3});case 13:e.t0=e.sent;case 14:return l=e.t0,c||n.setIDB("stickers-keywords",{response:l,expiresAt:i+u}),e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},682569:(e,t,r)=>{"use strict";r.d(t,{handler:()=>f});var n=r(28991),a=r(692137),s=r(887757),o=r.n(s),i=r(314432),u=r(716352),c=r(21705),l=r(837021),d=r(509727),p=r(170971),f=function e(t,r,s){switch(r.type){case"LoadChatMembers":return[];case"UserOpenedConvoProfile":var f=r.peerId,h=r.isLinkWithHistory,v=t.convos.get(f),y="edu"===t.viewer.profileType,m=u.isChannelId(f),g=u.resolveId(f),b=m?t.channels.get(g):null,k=t.ownerId;return!v||s.vkm_convo_profile&&m&&!b?[function(){var e=(0,a.default)(o().mark((function e(t){var r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.api,e.prev=1,v){e.next=6;break}return e.next=5,r.fetch("messages.getConversationsById",{peer_ids:f.toString(),extended:1,group_id:(0,l.getOwnerGroupId)(k)},{retries:3});case 5:n=e.sent;case 6:if(!s.vkm_convo_profile||!m||b||y){e.next=10;break}return e.next=9,r.fetch("channels.getById",{channel_ids:g.toString(),extended:1},{retries:2});case 9:a=e.sent;case 10:return e.abrupt("return",{type:"UserOpenedConvoProfile_ConvoRequestCompleted",peerId:f,hasFailed:!1,convoResponse:n,channelResponse:a,isLinkWithHistory:h});case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",{type:"UserOpenedConvoProfile_ConvoRequestCompleted",peerId:f,hasFailed:!0,isLinkWithHistory:h});case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}()]:e(t,{type:"UserOpenedConvoProfile_ConvoRequestCompleted",peerId:f,hasFailed:!1,isLinkWithHistory:h},s);case"UserOpenedConvoProfile_ConvoRequestCompleted":var C=r.peerId,_=r.channelId,w=r.convoResponse,I=r.channelResponse,S=r.hasFailed,M=r.isLinkWithHistory,A=t.ownerId;if(S){if(c.isDev)throw new Error("Не удалось загрузить диалог");return[(0,a.default)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"Noop"});case 1:case"end":return e.stop()}}),e)})))]}w&&((0,l.insertConvos)(t,w.items||[]),(0,l.insertPeers)(t,{apiUsers:w.profiles||[],apiGroups:w.groups||[],apiContacts:w.contacts||[]})),I&&((0,l.insertChannels)(t,{apiChannels:I.items||[],apiGroups:I.groups||[]}),(0,l.insertPeers)(t,{apiUsers:I.profiles||[],apiGroups:I.groups||[],apiContacts:[]}));var x=t.convos.get(C);if(!x){if(c.isDev)throw new Error("Диалог не был найден");return[function(){var e=(0,a.default)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.router.replace({kind:"MainRoute"}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}if(_)if(!t.channels.get(_)){if(c.isDev)throw new Error("Канал не был найден");return[function(){var e=(0,a.default)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.router.replace({kind:"MainRoute"}),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}var R="ChatConvo"===x.kind&&void 0===x.members&&d.canReadMembers(x)&&!t.locks.getConversationMembers.has(C);R&&t.locks.getConversationMembers.add(C);var E="ChatConvo"===x.kind&&x.acl.canSeeInviteLink;return[R&&i.isChatPeerId(C)&&function(){var e=(0,a.default)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"LoadChatMembers",peerId:C});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E&&i.isChatPeerId(C)&&function(){var e=(0,a.default)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.t0=C,e.t1=M,e.next=6,r.fetch("messages.getInviteLink",{peer_id:C,visible_messages_count:M?p.VISIBLE_MESSAGES_COUNT:0,reset:0,group_id:(0,l.getOwnerGroupId)(A)},{retries:1});case 6:return e.t2=e.sent,e.abrupt("return",{type:"UserOpenedConvoProfile_InviteLinksCompleted",peerId:e.t0,isLinkWithHistory:e.t1,response:e.t2});case 10:e.prev=10,e.t3=e.catch(1);case 12:return e.abrupt("return",{type:"Noop"});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()];case"UserOpenedConvoProfile_InviteLinksCompleted":var U=r.peerId,P=r.response.link,O=r.isLinkWithHistory,T=t.convos.get(U);return T&&"ChatConvo"===T.kind&&P?(d.replaceInviteLinks(T,(0,n.default)((0,n.default)({},T.inviteLinks),O?{withHistory:P}:{noHistory:P})),[]):[];default:(0,c.exhaustivenessCheck)(r)}}},481763:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(692137),a=r(887757),s=r.n(a),o=r(980662),i=r(21705),u=r(837021),c=function(e,t){switch(t.type){case"UserPlayedMessage":var r=t.cmid,a=t.peerId,c=e.convos.get(a),l=null==c?void 0:c.persisted.get(r),d=e.ownerId;return"Normal"===(null==l?void 0:l.kind)&&o.canChangeMessagePlayedStatus(l)?[function(){var e=(0,n.default)(s().mark((function e(t){var n,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.next=4,n.fetch("messages.markAsPlayed",{peer_id:a,cmid:r,group_id:(0,u.getOwnerGroupId)(d)},{retries:1});case 4:return o=e.sent,e.abrupt("return",{type:"UserPlayedMessage_RequestCompleted",hasFailed:1!==o,cmid:r,peerId:a});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserPlayedMessage_RequestCompleted",hasFailed:!0,cmid:r,peerId:a});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]:[];case"UserPlayedMessage_RequestCompleted":if(!t.hasFailed){var p=t.cmid,f=t.peerId,h=e.convos.get(f),v=null==h?void 0:h.persisted.get(p);if("Normal"!==(null==v?void 0:v.kind)||!o.canChangeMessagePlayedStatus(v))return[];v.isPlayed=!0}return[];default:(0,i.exhaustivenessCheck)(t)}}},939294:(e,t,r)=>{"use strict";r.d(t,{handler:()=>a});var n=r(21705),a=function(e,t){if("UserProfileInfo_Update"===t.type){var r=t.user,a=t.profileInfo;return a&&(e.viewer.profileInfo=a),r&&e.peers.set(r.id,r),[]}(0,n.exhaustivenessCheck)(t.type)}},376065:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(692137),a=r(887757),s=r.n(a),o=r(360202),i=r(21705),u=r(767084),c=function(e,t,r){switch(t.type){case"UserReorderedFolders":var a=t.order;return e.locks.reorderFolders?[]:(e.locks.reorderFolders=!0,o.reorderFolders(e.organisers.folders,a),[function(){var e=(0,n.default)(s().mark((function e(t){var r,n,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.reorderFolders",{folder_ids:a.join(",")});case 4:return n=e.sent,e.abrupt("return",{type:"UserReorderedFolders_ReorderRequestCompleted",hasFailed:1!==n,order:a});case 8:return e.prev=8,e.t0=e.catch(1),e.t0 instanceof u.IApi.RequestError&&(o=e.t0.code),e.abrupt("return",{type:"UserReorderedFolders_ReorderRequestCompleted",hasFailed:!0,error:o,order:a});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()]);case"UserReorderedFolders_ReorderRequestCompleted":var c=t.hasFailed;if(e.locks.reorderFolders=!1,c){if(t.error);else if(i.isDev)throw new Error("Не удалось изменить порядок папок");return[]}return[];default:(0,i.exhaustivenessCheck)(t)}}},170971:(e,t,r)=>{"use strict";r.d(t,{VISIBLE_MESSAGES_COUNT:()=>l,handler:()=>d});var n=r(28991),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=r(509727),c=r(837021),l=250,d=function(e,t){switch(t.type){case"UserRequestChatInvitationLink":var r=t.peerId,s=t.isLinkWithHistory,d=e.ownerId;return[function(){var e=(0,a.default)(o().mark((function e(t){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.next=4,n.fetch("messages.getInviteLink",{peer_id:r,reset:0,visible_messages_count:s?l:0,group_id:(0,c.getOwnerGroupId)(d)},{retries:1});case 4:return a=e.sent,e.abrupt("return",{type:"UserRequestChatInvitationLink_RequestCompleted",hasFailed:!a.link,link:a.link,isLinkWithHistory:s,peerId:r});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserRequestChatInvitationLink_RequestCompleted",hasFailed:!0,isLinkWithHistory:s,peerId:r});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserRequestChatInvitationLink_RequestCompleted":var p=t.peerId,f=t.link,h=t.isLinkWithHistory,v=t.hasFailed,y=e.convos.get(p);return!v&&y&&"ChatConvo"===y.kind&&f?(u.replaceInviteLinks(y,(0,n.default)((0,n.default)({},y.inviteLinks),h?{withHistory:f}:{noHistory:f})),[]):[];case"UserResetChatInvitationLink":var m=t.peerId,g=e.ownerId;return[function(){var e=(0,a.default)(o().mark((function e(t){var r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.getInviteLink",{peer_id:m,reset:1,visible_messages_count:l,group_id:(0,c.getOwnerGroupId)(g)},{retries:1});case 4:return n=e.sent,e.next=7,r.fetch("messages.getInviteLink",{peer_id:m,reset:0,visible_messages_count:0,group_id:(0,c.getOwnerGroupId)(g)},{retries:1});case 7:return a=e.sent,e.abrupt("return",{type:"UserResetChatInvitationLink_RequestCompleted",hasFailed:!n.link||!a.link,links:{withHistory:n.link,noHistory:a.link},peerId:m});case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",{type:"UserResetChatInvitationLink_RequestCompleted",hasFailed:!0,peerId:m,links:{}});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()];case"UserResetChatInvitationLink_RequestCompleted":var b=t.peerId,k=t.links,C=t.hasFailed,_=e.convos.get(b);return C||"ChatConvo"!==(null==_?void 0:_.kind)?[]:k.noHistory&&k.withHistory?(u.replaceInviteLinks(_,k),[]):[];default:return(0,i.exhaustivenessCheck)(t)}}},543435:(e,t,r)=>{"use strict";r.d(t,{handler:()=>p});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(190831),u=r(716352),c=r(30966),l=r(610557),d=r(837021),p=function(e,t){switch(t.type){case"UserScrolledChannelHistory":var r=t.channelId,a=t.direction,p=t.startCmid,f=t.possibleSkipped,h=e.channels.get(r);if(!h)return[];if(e.locks.getChannelHistory.has(r))return[];e.locks.getChannelHistory.add(r);var v,y=Math.min(i.POSTS_PER_PAGE,f||i.POSTS_PER_PAGE)+2;switch(a){case"backward":v=0;break;case"forward":v=1-y;break;case"around":y=i.POSTS_PER_PAGE,v=-Math.floor(y/2),h.inReadCmid===p&&(v=Math.max(-h.unreadCount,v));break;default:(0,o.exhaustivenessCheck)(a)}return[function(){var e=(0,n.default)(s().mark((function e(t){var n,i,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.next=4,n.fetch("channels.getHistory",{channel_id:r,start_cmid:Math.max(p,1),count:y,offset:v,extended:1},{retries:5});case 4:i=e.sent,e.t0=a,e.next="backward"===e.t0?8:"around"===e.t0||"forward"===e.t0?10:12;break;case 8:return u=y===i.items.length,e.abrupt("break",13);case 10:return u=!0,e.abrupt("break",13);case 12:(0,o.exhaustivenessCheck)(a);case 13:return e.abrupt("return",{type:"UserScrolledChannelHistory_RequestSucceed",channelId:r,response:i,hasMore:u});case 16:return e.prev=16,e.t1=e.catch(1),e.abrupt("return",{type:"UserScrolledChannelHistory_RequestFailed",channelId:r});case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}()];case"UserScrolledChannelHistory_RequestSucceed":var m=t.channelId,g=t.response,b=t.hasMore;e.locks.getChannelHistory.delete(m);var k=e.channels.get(m);if(!k)return[];var C=[];return g.items.reverse().forEach((function(t,r,n){var a=(0,l.fromApiPost)(t),s=a.post;a.reactions.forEach((function(t){e.reactions.set(t.id,t)})),0===r&&s.cmid>1&&b&&C.push({kind:"GapItem",fromCmid:c.resolveCmid(1),toCmid:c.resolveCmid(s.cmid-1)}),C.push({kind:"PostItem",post:s});var o=k.history[k.history.length-1];if(r===n.length-1&&o){var i="GapItem"===o.kind?o.toCmid:o.post.cmid;s.cmid<i&&C.push({kind:"GapItem",fromCmid:c.resolveCmid(s.cmid+1),toCmid:c.resolveCmid(i-("GapItem"===o.kind?0:1))})}})),u.insertPosts(k,C),(0,d.insertPeers)(e,{apiUsers:g.profiles||[],apiGroups:g.groups||[],apiContacts:[]}),[];case"UserScrolledChannelHistory_RequestFailed":var _=t.channelId;return e.locks.getChannelHistory.delete(_),[];default:return(0,o.exhaustivenessCheck)(t)}}},475690:(e,t,r)=>{"use strict";r.d(t,{handler:()=>p});var n=r(678927),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=r(190831),c=r(509727),l=r(341570),d=r(837021),p=function(e,t){switch(t.type){case"UserScrolledConvoHistory":var r=t.peerId,s=t.direction,p=e.ownerId,f=e.convos.get(r);if(!f)return[];if("end"===s)return c.cleanup(f),[];if(e.locks.getHistory.has(r))return[];if("forward"===s&&!c.hasGap(f))return[];if("backward"===s&&!f.hasMore)return[];e.locks.getHistory.add(t.peerId);var h=u.MESSAGES_PER_PAGE;switch(s){case"forward":var v=f.afterGapCmid,y=-h;return[function(){var e=(0,a.default)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.t0=r,e.next=5,n.fetch("messages.getHistory",{peer_id:r,start_cmid:v,count:h,offset:y,extended:1,group_id:(0,d.getOwnerGroupId)(p)},{retries:5});case 5:return e.t1=e.sent,e.abrupt("return",{type:"UserScrolledConvoHistory_RequestSucceed",peerId:e.t0,response:e.t1});case 9:return e.prev=9,e.t2=e.catch(1),e.abrupt("return",{type:"UserScrolledConvoHistory_RequestFailed",peerId:r});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()];case"backward":var m=Math.min.apply(Math,(0,n.default)(f.persisted.keys()));m=Number.isFinite(m)?m:-1;return[function(){var e=(0,a.default)(o().mark((function e(t){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.api,e.prev=1,e.next=4,n.fetch("messages.getHistory",{peer_id:r,start_cmid:m,count:h,offset:0,extended:1,group_id:(0,d.getOwnerGroupId)(p)},{retries:5});case 4:return a=e.sent,e.abrupt("return",{type:"UserScrolledConvoHistory_RequestSucceed",peerId:r,hasMore:a.items.length>=h+0,response:a});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserScrolledConvoHistory_RequestFailed",peerId:r});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];default:return(0,i.exhaustivenessCheck)(s)}case"UserScrolledConvoHistoryToMessage":var g=t.peerId,b=t.cmid,k=e.convos.get(g),C=e.ownerId;if(!k)return[];if(c.isCmidInIterator(k,b))return[];c.clearAfterGap(k),e.locks.getHistory.add(t.peerId);var _=-(Math.floor(u.MESSAGES_PER_PAGE/2)-1),w=u.MESSAGES_PER_PAGE;return[function(){var e=(0,a.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.getHistory",{peer_id:g,start_cmid:b,count:w,offset:_,extended:1,group_id:(0,d.getOwnerGroupId)(C)},{retries:5});case 4:return n=e.sent,e.abrupt("return",{type:"UserScrolledConvoHistory_RequestSucceed",peerId:g,hasMore:!0,response:n});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserScrolledConvoHistory_RequestFailed",peerId:g});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserScrolledConvoHistory_RequestSucceed":var I=t.peerId,S=t.response,M=t.hasMore;e.locks.getHistory.delete(I);var A=e.convos.get(I);if(!A)return[];var x=S.items.map((function(e){return(0,l.fromApiMessage)(e).message}));return c.insertMessages(A,x,M),(0,d.insertPeers)(e,{apiUsers:S.profiles||[],apiGroups:S.groups||[],apiContacts:[]}),[];case"UserScrolledConvoHistory_RequestFailed":return e.locks.getHistory.delete(t.peerId),[];default:return(0,i.exhaustivenessCheck)(t)}}},143110:(e,t,r)=>{"use strict";r.d(t,{handler:()=>i});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=function(e,t){switch(t.type){case"UserSeenHelpHint":return e.helpHints.delete(t.hintId),[function(){var e=(0,n.default)(s().mark((function e(r){var n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.api,e.prev=1,e.next=4,n.fetch("account.hideHelpHint",{hint_id:t.hintId},{retries:1});case 4:return a=e.sent,e.abrupt("return",{type:"UserSeenHelpHint_RequestCompleted",hasFailed:1!==a});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserSeenHelpHint_RequestCompleted",hasFailed:!0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserSeenHelpHint_RequestCompleted":return[];default:(0,o.exhaustivenessCheck)(t)}}},900547:(e,t,r)=>{"use strict";r.d(t,{handler:()=>d});var n=r(692137),a=r(111965),s=r(887757),o=r.n(s),i=r(21705),u=r(509727),c=r(527119),l=r(837021),d=function e(t,r,s){switch(r.type){case"UserSeenMessage":var d=r.cmid,f=r.peerId,h=t.convos.get(f);if(!h)return[];var v=h.persisted.get(d);if(!v)return[];var y=h.inReadBy,m=h.unreadReactions.has(d);v.isOut||u.readInUntil(h,d),u.readReactions(h,d),c.refresh(t.organisers,h);var g=t.readQueues.get(f);return g?(g.inReadBy=h.inReadBy,m&&g.reactions.add(d),[]):(t.readQueues.set(f,{inReadBy:h.inReadBy,reactions:m?new Set([d]):new Set}),[p(f,y)]);case"UserSeenMessage_ThrottleTimedOut":var b=r.peerId,k=r.prevInReadBy;if(!t.convos.get(b))return t.readQueues.delete(b),[];var C=t.readQueues.get(b);if(!C)return[];var _,w=[],I=(0,a.default)(C.reactions);try{for(I.s();!(_=I.n()).done;){var S=_.value;if(w.push(S),C.reactions.delete(S),100===w.length)break}}catch(e){I.e(e)}finally{I.f()}var M=C.inReadBy,A=t.ownerId,x=k<M,R=!1!==s.vkm_reactions&&w.length>0;return x||R?[function(){var e=(0,n.default)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetchMany([x&&{method:"messages.markAsRead",params:{peer_id:b,up_to_cmid:M,mark_conversation_as_read:1,group_id:(0,l.getOwnerGroupId)(A)}},R&&{method:"messages.markReactionsAsRead",params:{peer_id:b,cmids:w.join(","),group_id:(0,l.getOwnerGroupId)(A)}}]);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.abrupt("return",{type:"UserSeenMessage_RequestCompleted",peerId:b,readUntilCmid:M});case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()]:e(t,{type:"UserSeenMessage_RequestCompleted",peerId:b,readUntilCmid:M},s);case"UserSeenMessage_RequestCompleted":var E=r.peerId,U=r.readUntilCmid;if(!t.convos.get(E))return[];var P=t.readQueues.get(E);return P?P.inReadBy<=U&&0===P.reactions.size?(t.readQueues.delete(E),[]):[p(E,U)]:[];default:return(0,i.exhaustivenessCheck)(r)}};function p(e,t){return function(){var r=(0,n.default)(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,i.sleep)(500);case 2:return r.abrupt("return",{type:"UserSeenMessage_ThrottleTimedOut",prevInReadBy:t,peerId:e});case 3:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()}},602292:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(692137),a=r(887757),s=r.n(a),o=r(21705),i=r(527119),u=r(716352),c=function(e,t,r){switch(t.type){case"UserSeenPost":var a=t.cmid,c=t.channelId,d=e.channels.get(c);if(!d)return[];if(a<=d.inReadCmid)return[];u.readUntil(d,a),i.refreshChannels(e.organisers,d);var p=e.channelReadQueues.has(c);return e.channelReadQueues.set(c,d.inReadCmid),p?[]:[l(c)];case"UserSeenPost_ThrottleTimedOut":var f=t.channelId,h=e.channelReadQueues.get(f);return h?[function(){var e=(0,n.default)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("channels.markAsRead",{channel_id:f,last_read_cmid:h});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.abrupt("return",{type:"UserSeenPost_RequestCompleted",channelId:f,readUntilCmid:h});case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()]:[];case"UserSeenPost_RequestCompleted":var v=t.channelId,y=t.readUntilCmid,m=e.channelReadQueues.get(v);return m?y>=m?(e.channelReadQueues.delete(v),[]):[l(v)]:[];default:return(0,o.exhaustivenessCheck)(t)}};function l(e){return function(){var t=(0,n.default)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.sleep)(300);case 2:return t.abrupt("return",{type:"UserSeenPost_ThrottleTimedOut",channelId:e});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},486803:(e,t,r)=>{"use strict";r.d(t,{handler:()=>c});var n=r(678927),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=r(837021),c=function(e,t){switch(t.type){case"UserSetMessageReaction":var r=t.peerId,n=t.cmid,s=t.reactionId,c=e.convos.get(r);if(!c)return[];var d=c.persisted.get(n);if(!d||"Normal"!==d.kind)return[];var p=d.reactionId,f=e.ownerId;return l(d,s,e.ownerId),[function(){var e=(0,a.default)(o().mark((function e(t){var a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.api,e.prev=1,e.next=4,a.fetch("messages.sendReaction",{cmid:n,peer_id:r,reaction_id:s,group_id:(0,u.getOwnerGroupId)(f)});case 4:return i=e.sent,e.abrupt("return",{type:"UserSetMessageReaction_RequestCompleted",hasFailed:1!==i,cmid:n,peerId:r,reactionId:s,prevReactionId:p});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserSetMessageReaction_RequestCompleted",hasFailed:!0,cmid:n,peerId:r,reactionId:s,prevReactionId:p});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserSetMessageReaction_RequestCompleted":var h=t.hasFailed,v=t.peerId,y=t.cmid,m=t.prevReactionId;if(!h)return[];var g=e.convos.get(v);if(!g)return[];var b=g.persisted.get(y);return b&&"Normal"===b.kind?(l(b,m,e.ownerId),[]):[];case"UserUnsetMessageReaction":var k=t.peerId,C=t.cmid,_=e.convos.get(k);if(!_)return[];var w=_.persisted.get(C);if(!w||"Normal"!==w.kind||!w.reactionId)return[];var I=w.reactionId,S=e.ownerId;return l(w,void 0,e.ownerId),[function(){var e=(0,a.default)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,e.prev=1,e.next=4,r.fetch("messages.deleteReaction",{cmid:C,peer_id:k,group_id:(0,u.getOwnerGroupId)(S)});case 4:return n=e.sent,e.abrupt("return",{type:"UserUnsetMessageReaction_RequestCompleted",hasFailed:1!==n,cmid:C,peerId:k,reactionId:I});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{type:"UserUnsetMessageReaction_RequestCompleted",hasFailed:!0,cmid:C,peerId:k,reactionId:I});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()];case"UserUnsetMessageReaction_RequestCompleted":var M=t.hasFailed,A=t.peerId,x=t.cmid,R=t.reactionId;if(!M)return[];var E=e.convos.get(A);if(!E)return[];var U=E.persisted.get(x);return U&&"Normal"===U.kind?(l(U,R,e.ownerId),[]):[];default:(0,i.exhaustivenessCheck)(t)}};function l(e,t,r){var a=e.reactionId;if(e.reactionId=t,a){var s=e.reactions.get(a);if(!s&&i.isDev)throw new Error("Реакция не найдена в списке реакций сообщения");s&&(s.count<=1?e.reactions.delete(a):(s.count-=1,s.peerIds.delete(r)))}if(t){var o=e.reactions.get(t);o?(o.count+=1,o.peerIds=new Set([r].concat((0,n.default)(o.peerIds)))):e.reactions.set(t,{reactionId:t,count:1,peerIds:new Set([r])})}}},275864:(e,t,r)=>{"use strict";r.d(t,{handler:()=>l});var n=r(678927),a=r(692137),s=r(887757),o=r.n(s),i=r(360202),u=r(21705),c=r(837021),l=function(e,t,r){switch(t.type){case"UserUpdatedFolder":var a=t.folderId,s=t.name,o=t.addPeerIds,l=t.removePeerIds;if(e.locks.updateFolder.has(a))return[];if(function(e,t){if(new Set((0,n.default)(e).filter((function(e){return t.has(e)}))).size)return!0;return!1}(o,l))throw new Error("Peer id не может одновременно находиться в списке на добавление и на удаление");e.locks.updateFolder.add(a);var p=e.organisers.folders.find((function(e){return e.id===a}));if(!p)return[];var f=(0,c.getConvosByIds)(e,Array.from(l)),h=(0,c.getConvosByIds)(e,Array.from(o));return s&&i.setName(p,s),(0,c.removeConvosFromFolder)(e,p.id,f),(0,c.addConvosToFolder)(e,p.id,h),[d(a,s,o,l)];case"UserUpdatedFolder_UpdateRequestCompleted":var v=t.hasFailed,y=t.folderId;if(e.locks.updateFolder.delete(y),v&&u.isDev)throw new Error("Не удалось изменить папку");return[];default:(0,u.exhaustivenessCheck)(t)}};function d(e,t,r,s){return function(){var i=(0,a.default)(o().mark((function a(i){var u,c,l,d;return o().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return u=i.api,c=!1,l={folder_id:e},t&&(l.name=t),r.size&&(l.add_included_peer_ids=(0,n.default)(r).join(",")),s.size&&(l.remove_included_peer_ids=(0,n.default)(s).join(",")),a.prev=6,a.next=9,u.fetch("messages.updateFolder",l);case 9:d=a.sent,c=1!==d,a.next=16;break;case 13:a.prev=13,a.t0=a.catch(6),c=!0;case 16:return a.abrupt("return",{type:"UserUpdatedFolder_UpdateRequestCompleted",hasFailed:c,folderId:e,addPeerIds:r,removePeerIds:s,name:t});case 17:case"end":return a.stop()}}),a,null,[[6,13]])})));return function(e){return i.apply(this,arguments)}}()}},151117:(e,t,r)=>{"use strict";r.d(t,{handler:()=>u});var n=r(678927),a=r(692137),s=r(887757),o=r.n(s),i=r(21705),u=function(e,t,r){switch(t.type){case"VideoMessageShapesGetById":var s,u=t.shapeId;return e.locks.getVideoMessageShapesById.has(u)||(null!==(s=e.videoMessageShapes)&&void 0!==s&&s.has(u)||!r.vkm_video_messages_shapes)?[]:(e.locks.getVideoMessageShapesById.add(u),[function(){var e=(0,a.default)(o().mark((function e(t){var r,n,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,n=t.storage,(a=n.get("videomessage-shapes"))&&(a.expiresAt=0),e.prev=3,e.next=6,r.fetch("messages.getVideoMessageShapesByIds",{ids:u.toString()});case 6:return s=e.sent,e.abrupt("return",{type:"VideoMessageShapesGetById__RequestCompleted",shapeId:u,response:s,hasFailed:!Boolean(s)});case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",{type:"VideoMessageShapesGetById__RequestCompleted",shapeId:u,response:null,hasFailed:!0});case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()]);case"VideoMessageShapesGetById__RequestCompleted":var c,l=t.response,d=t.shapeId;if(e.locks.getVideoMessageShapesById.delete(d),!l)return[];var p=l.shapes.reduce((function(e,t){return e.set(t.id,t.raw_path),e}),new Map);return e.videoMessageShapes=new Map([].concat((0,n.default)(null!==(c=e.videoMessageShapes)&&void 0!==c?c:[]),(0,n.default)(p))),[];default:return(0,i.exhaustivenessCheck)(t)}}},227778:(e,t,r)=>{"use strict";r.d(t,{createStore:()=>u});var n=r(111965),a=r(334738),s=r(657442),o=r(21705),i=r(577377);function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.initial,u=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0,d=arguments.length>5?arguments[5]:void 0,p=!1,f=o.isDev&&(0,s.devTools)(),h=[],v=r(t,u,l,d),y=(0,a.default)(v,2),m=y[0],g=y[1];f&&f.init(m);var b=function(e){return h.push(e),function(){h=h.filter((function(t){return t!==e}))}},k=function r(s){if(!p)throw new Error("Стор еще не был активирован. Нужно вызвать store.start().");var o=(0,i.reducer)(m,s,t),u=(0,a.default)(o,2),l=u[0],d=u[1];f&&f.send(s,l);var v=m!==l;if(m=l,c(r,d,e),v){var y,g=(0,n.default)(h);try{for(g.s();!(y=g.n()).done;){(0,y.value)(l)}}catch(e){g.e(e)}finally{g.f()}}};return{start:function(){p||(p=!0,c(k,g,e))},dispatch:k,subscribe:b,featureFlags:t,getState:function(){return m}}}function c(e,t,r){0!==t.length&&setTimeout((function(){var a,s=(0,n.default)(t);try{for(s.s();!(a=s.n()).done;){var o=a.value;"function"==typeof o&&o(r).then(e).catch((function(e){r.logger.error("Необработанная ошибка редьюсера",e)}))}}catch(e){s.e(e)}finally{s.f()}}))}},657442:(e,t,r)=>{"use strict";function n(){return"undefined"!=typeof window&&"__REDUX_DEVTOOLS_EXTENSION__"in window?window.__REDUX_DEVTOOLS_EXTENSION__.connect({serialize:{options:{map:!0,set:!0}}}):null}r.d(t,{devTools:()=>n})},577377:(e,t,r)=>{"use strict";r.d(t,{initial:()=>Ee,reducer:()=>Ue});var n=r(678927),a=r(28991),s=r(334738),o=r(692137),i=r(887757),u=r.n(i),c=r(210746),l=r(837021),d=r(21705),p=r(527119),f=r(252229),h=r(360202),v=r(782597),y=r(509727),m=r(314432),g=r(980662),b=r(689018),k=r(416872),C=r(716352),_=r(30966),w=r(233600),I=r(120052),S=r(604850),M=r(190831),A=r(103589),x=r(362156),R=r(751713),E=r(900547),U=r(475690),P=r(931947),O=r(103820),T=r(104571),F=r(217698),N=r(53646),q=r(154808),L=r(387079),j=r(338779),D=r(903975),B=r(716192),G=r(135738),H=r(481763),V=r(143110),W=r(117215),z=r(182931),K=r(581738),$=r(425592),Q=r(632828),J=r(859451),X=r(682569),Y=r(455995),Z=r(139150),ee=r(275864),te=r(864669),re=r(376065),ne=r(215857),ae=r(543435),se=r(759568),oe=r(877185),ie=r(170971),ue=r(10998),ce=r(970996),le=r(849902),de=r(146796),pe=r(602292),fe=r(653752),he=r(939294),ve=r(360082),ye=r(160136),me=r(461672),ge=r(901334),be=r(641117),ke=r(628177),Ce=r(617014),_e=r(564741),we=r(151117),Ie=r(446116),Se=r(478635),Me=r(486803),Ae=r(426578),xe=r(475614),Re=r(257889),Ee=function(e,t,r,n){var a=m.resolveId(t),s=r?m.resolveId(r):void 0;if(!m.isUserPeerId(a))throw Error("Viewer может быть только пользователем");if(void 0!==s&&!m.isUserPeerId(s)&&!m.isGroupPeerId(s))throw Error("Owner может быть только пользователем или группой");var i=(0,A.fromApiProfileType)(n);return[{convoConn:{status:"loading",pts:0},channelConn:{status:"running",ts:0},viewer:{id:a,profileType:i,settings:{ctrSubmit:!1,soundNotifications:!0,browserNotifications:!1,showRecommendations:!0,countOnlyNotMuted:!1,autoUnarchive:!0,transcriptAutoShow:!0,theme:"system",verticalFoldersView:!1,businessNotify:!1,push:I.VIEWER_DEFAULT_PUSH_SETTINGS,teacherVerification:!1},profileInfo:{id:a},accounts:[]},ownerId:m.resolveId(),organisers:p.empty(),channels:new Map([[C.resolveId(0),{kind:"Channel",id:C.resolveId(0),name:"",activity:"",adminLevel:C.AdminLevel.Member,isVerified:!1,photos:{},inReadCmid:_.resolveCmid(0),unreadCount:0,isArchived:!1,isMuted:!1,notificationsDisabledUntil:0,majorSortId:0,minorSortId:0,membersCount:0,isMember:!1,canSendDonut:!1,pending:{},locks:{loading:!1,cleanUp:0},history:[]}]]),convos:new Map([[m.resolveId(),{kind:"UserConvo",peerId:m.resolveId(),unreadCount:0,majorSortId:0,minorSortId:0,inReadBy:g.resolveCmid(0),outReadBy:g.resolveCmid(0),isNew:!1,folderIds:new Set,isMarkedUnread:!1,isArchived:!1,canWrite:{allowed:!1,reason:"unknown"},push:{mode:"everything",disabledUntil:0},persistedCmid:g.resolveCmid(),persisted:new Map,queuedId:g.resolveRandomId(),queued:new Map,afterGapCmid:g.resolveCmid(),unreadExpireables:new Set,unreadReactions:new Set,hasMore:!1,entrypoint:null}]]),composerDrafts:{},channelComposerDrafts:{},readQueues:new Map,channelReadQueues:new Map,peers:new Map([[m.resolveId(),{kind:"User",id:m.resolveId(),firstName:"...",firstNameGen:"...",firstNameAcc:"...",lastName:"...",lastNameGen:"...",lastNameAcc:"...",sex:"unknown",lastSeen:{isVisible:!1,platform:"other"},isVerified:!1,canCall:!0,followersCount:0,canChangeFriendship:!1,canMessage:!1,friendship:"unfamiliar",isBlacklisted:!1,isBlacklistedByMe:!1,isDeactivated:!1,canInviteToChats:!1}]]),onlines:new Set,typings:new Map,convosSearchIndex:w.create(),locks:{getConversations:{all:!1,unread:!1,archive:!1,messageRequest:!1},getChannels:{all:!1,unread:!1},hideFilter:{all:!1,unread:!1,chats:!1,archive:!1,messageRequest:!1,businessNotify:!1},getHistory:new Set,getConversationMembers:new Set,getConversationInfo:new Set,sendQueue:new Map,edit:new Set,convosCleanup:new Map,channelsCleanup:new Map,updateFriendshipOrMembership:new Set,convoActions:new Set,messageActions:new Set,channelActions:new Set,channelPostActions:new Set,settings:new Set,contactList:!1,newFolder:!1,deleteFolder:new Set,updateFolder:new Set,reorderFolders:!1,getChannelHistory:new Set,changeMessageRequest:new Set,getStickerPacks:!1,getImportantUsers:!1,getPostCommentsHistory:new Set,likeActions:new Set,commentActions:new Set,getVideoMessageShapesById:new Set,loadStickers:new Set},hiddenPinnedMessages:new Map,helpHints:new Set,stickerPacks:new Map,stickers:new Map,favoriteStickers:[],recentStickers:[],stickersKeywords:{},contacts:{items:new Map,contacts:new Map,hasMore:!0},importantMessages:{messages:new Map,hasMore:!0},hiddenBotKeyboards:new Set,reactions:new Map,messageReactions:new Map,importantUsers:null,videoMessageShapes:null},[function(){return Promise.resolve({type:"InitialData",ownerId:s})},function(){var t=(0,o.default)(u().mark((function t(r){var n,s,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.api,s=r.storage,e.vkm_video_messages_shapes){t.next=3;break}return t.abrupt("return",{type:"Noop"});case 3:return s.identify(a),t.next=6,Te({api:n,storage:s});case 6:return o=t.sent,t.abrupt("return",{type:"LoadVideoMessageShapes_RequestCompleted",videoMessageShapes:o});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()]]};function Ue(e,t,r){if("TemporaryHackForResync"===t.type)return Ee(r,e.viewer.id,e.ownerId,"edu"===e.viewer.profileType?2:0);var n,a=(0,c.createDraft)(e);switch(t.type){case"Noop":n=[];break;case"InitialData":case"InitialData_RequestCompleted":case"InitialData_ChannelsReadyForUse":n=Pe(a,t,r);break;case"LoadVideoMessageShapes_RequestCompleted":n=Oe(a,t,r);break;case"EngineBatchReceived":case"EngineBatchReceived_TypingsTimedOut":case"UpdateMessageRequestsCounter":case"UpdateMessageRequestsCounter_RequestCompleted":n=O.handler(a,t,r);break;case"ChannelEngineBatchReceived":n=T.handler(a,t,r);break;case"QueueBatchReceived":n=G.handler(a,t,r);break;case"MoreConvosNeeded":case"MoreConvosNeeded_RequestCompleted":n=j.handler(a,t,r);break;case"MoreChannelsNeeded":case"MoreChannelsNeeded_RequestCompleted":n=D.handler(a,t,r);break;case"CacheUpdateReceived":n=B.handler(a,t,r);break;case"UserScrolledConvoHistory":case"UserScrolledConvoHistoryToMessage":case"UserScrolledConvoHistory_RequestSucceed":case"UserScrolledConvoHistory_RequestFailed":n=U.handler(a,t,r);break;case"UserSeenMessage":case"UserSeenMessage_ThrottleTimedOut":case"UserSeenMessage_RequestCompleted":n=E.handler(a,t,r);break;case"UserHitSend":case"UserHitSend_RequestCompleted":case"UserHitResendAllFailedMessages":case"ResendAllFailedMessages":case"UserHitResendFailedMessage":case"UserHitSendWidget":n=x.handler(a,t,r);break;case"UserHitEdit":case"UserHitEdit_RequestCompleted":n=R.handler(a,t,r);break;case"UserOpenedConvo":case"UserClosedConvo":case"UserOpenedConvo_ConvoRequestCompleted":case"UserOpenedConvo_HistoryRequestSucceed":case"UserOpenedConvo_HistoryRequestFailed":case"UserOpenedConvo_StickersLoadRequestSucceed":case"UserOpenedConvo_StickersLoadRequestFailed":case"UserOpenedConvo_StickersRefreshThrottleTimedOut":n=P.handler(a,t,r);break;case"LoadStickers":case"LoadStickers_RequestCompleted":n=Se.handler(a,t,r);break;case"UserChangedFriendship":case"UserChangedFriendship_RequestCompleted":n=q.handler(a,t,r);break;case"UserChangedGroupMembership":case"UserChangedGroupMembership_RequestCompleted":n=L.handler(a,t,r);break;case"UserChangedSetting":case"UserChangedSetting_RequestCompleted":n=F.handler(a,t,r);break;case"SettingThemeUpdated":case"SettingThemeUpdated_RequestCompleted":n=N.handler(a,t,r);break;case"UserPlayedMessage":case"UserPlayedMessage_RequestCompleted":n=H.handler(a,t,r);break;case"UserSeenHelpHint":case"UserSeenHelpHint_RequestCompleted":n=V.handler(a,t,r);break;case"UserChangedConvo":case"UserChangedConvo_RequestCompleted":case"UserPinMessage":case"UserPinMessage_RequestCompleted":case"UserUnpinMessage":case"UserUnpinMessage_RequestCompleted":case"UserChangedMute":case"UserChangedMute_RequestCompleted":case"UserChangedBusinessNotify":case"UserChangedBusinessNotify_RequestCompleted":n=W.handler(a,t,r);break;case"UserChangedMessage":case"UserChangedMessage_RequestCompleted":case"UserDeleteMessage":case"UserDeleteMessage_RequestCompleted":case"UserDeleteFailedMessage":case"UserDeleteAllFailedMessage":case"UserRestoreMessage":case"UserRestoreMessage_RequestCompleted":n=z.handler(a,t,r);break;case"LoadContactList":case"LoadContactList_RequestCompleted":n=K.handler(a,t,r);break;case"UserHideFilter":case"UserHideFilter_Completed":case"UserUndoHideFilter":case"ActualizeArchiveMentions":case"LoadArchiveConvos_RequestCompleted":case"UserActualizeHideFilter":n=Q.handler(a,t,r);break;case"UserAcceptedChatMessageRequest":case"UserRejectedMessageRequest":case"UserAcceptedChatMessageRequest_RequestCompleted":case"UserRejectedChatMessageRequest_RequestCompleted":n=$.handler(a,t,r);break;case"UserChangedChatTitle":case"UserChangedChatDescription":case"UserChangedChatTitle_RequestCompleted":case"UserChangedChatDescription_RequestCompleted":case"UserRemovedChatPhoto":case"UserSetChatPhoto":case"UserRemovedChatPhoto_RequestCompleted":case"UserChangedChatSettings":case"UserChangedChatSettings_RequestCompleted":n=J.handler(a,t,r);break;case"UserOpenedConvoProfile":case"UserOpenedConvoProfile_ConvoRequestCompleted":case"UserOpenedConvoProfile_InviteLinksCompleted":n=X.handler(a,t,r);break;case"LoadImportantMessages":case"LoadImportantMessages_RequestCompleted":case"UserClosedImportantMessages":n=Y.handler(a,t,r);break;case"UserCreatedFolder":case"UserCreatedFolder_CreateRequestCompleted":n=Z.handler(a,t,r);break;case"UserUpdatedFolder":case"UserUpdatedFolder_UpdateRequestCompleted":n=ee.handler(a,t,r);break;case"UserDeletedFolder":case"UserDeletedFolder_DeleteRequestCompleted":n=te.handler(a,t,r);break;case"UserReorderedFolders":case"UserReorderedFolders_ReorderRequestCompleted":n=re.handler(a,t,r);break;case"StickersAddToFavorite":case"StickersAddToFavorite__RequestCompleted":case"StickersRemoveFromFavorite":case"StickersRemoveFromFavorite__RequestCompleted":case"StickerAddToRecent":n=ne.handler(a,t,r);break;case"UserScrolledChannelHistory":case"UserScrolledChannelHistory_RequestSucceed":case"UserScrolledChannelHistory_RequestFailed":n=ae.handler(a,t,r);break;case"UserOpenedChannel":case"UserClosedChannel":case"UserOpenedChannel_ChannelRequestCompleted":n=se.handler(a,t,r);break;case"UserChangedChatMember":case"UserChangedChatMember_RequestCompleted":n=oe.handler(a,t,r);break;case"UserRequestChatInvitationLink":case"UserRequestChatInvitationLink_RequestCompleted":case"UserResetChatInvitationLink":case"UserResetChatInvitationLink_RequestCompleted":n=ie.handler(a,t,r);break;case"LoadChatMembers":case"LoadChatMembers_RequestComplete":n=ue.handler(a,t,r);break;case"LoadChatInfo":case"LoadChatInfo_RequestComplete":n=ce.handler(a,t,r);break;case"UserChangedChannel":case"UserChangedChannel_RequestCompleted":n=le.handler(a,t,r);break;case"UserChangedChannelPost":case"UserChangedChannelPost_RequestCompleted":n=de.handler(a,t,r);break;case"UserSeenPost":case"UserSeenPost_ThrottleTimedOut":case"UserSeenPost_RequestCompleted":n=pe.handler(a,t,r);break;case"LoadImportantUsers":case"LoadImportantUsers_RequestCompleted":n=fe.handler(a,t,r);break;case"UserLoadedCommentsHistory":case"UserLoadedCommentsHistory_RequestSucceed":case"UserLoadedCommentsHistory_RequestFailed":n=ve.handler(a,t,r);break;case"ChannelsOnboardingDone":case"ChannelsOnboardingDone_RequestSucceeded":case"ChannelsOnboardingDone_RequestFailed":n=ye.handler(a,t,r);break;case"UserChangedComposerDraft":case"UserClearedComposerDraft":case"UpdateComposerDraftOnMessageDelete":n=me.handler(a,t,r);break;case"ResetUpdatesCounter":case"ResetUpdatesCounter_RequestCompleted":n=ge.handler(a,t,r);break;case"UserProfileInfo_Update":n=he.handler(a,t,r);break;case"UserChangedMessageAttachment":case"UserChangedMessageAttachment_RequestCompleted":n=be.handler(a,t,r);break;case"UserDeleteComment":case"UserDeleteComment_RequestCompleted":case"UserRestoreComment":case"UserRestoreComment_RequestCompleted":n=Ce.handler(a,t,r);break;case"UserLoadedLikes":case"UserLoadedLikes_RequestCompleted":case"UserChangedLike":case"UserChangedLike_RequestCompleted":n=ke.handler(a,t,r);break;case"UserChangedBrowserNotifications":case"UserChangedBrowserNotifications_RequestCompleted":n=_e.handler(a,t,r);break;case"UserSetMessageReaction":case"UserSetMessageReaction_RequestCompleted":case"UserUnsetMessageReaction":case"UserUnsetMessageReaction_RequestCompleted":n=Me.handler(a,t,r);break;case"ImportContact":n=Re.handler(a,t,r);break;case"VideoMessageShapesGetById":case"VideoMessageShapesGetById__RequestCompleted":n=we.handler(a,t,r);break;case"UserChangedPostAttachment":case"UserChangedPostAttachment_RequestCompleted":n=Ie.handler(a,t,r);break;case"PollConvoReactions":case"PollConvoReactions_RequestSucceed":n=Ae.handler(a,t,r);break;case"UserChangedChannelComposerDraft":case"UserClearedChannelComposerDraft":n=xe.handler(a,t,r);break;default:(0,d.exhaustivenessCheck)(t)}a.convos.set(m.resolveId(),y.safeGet(e.convos,m.resolveId())),a.peers.set(m.resolveId(),m.safeGet(e.peers,m.resolveId())),a.channels.set(C.resolveId(0),C.safeGet(e.channels,C.resolveId(0)));var i=(0,c.finishDraft)(a);if(e.hiddenPinnedMessages!==i.hiddenPinnedMessages&&n.push(function(){var e=(0,o.default)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.storage.set("hidden-pinned-messages",Array.from(i.hiddenPinnedMessages.entries()).reduce((function(e,t){var r=(0,s.default)(t,2),n=r[0],a=r[1];return e[n]=a,e}),{})),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.hiddenBotKeyboards!==i.hiddenBotKeyboards&&n.push(function(){var e=(0,o.default)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.storage.set("hidden-bot-keyboards",i.hiddenBotKeyboards),e.abrupt("return",{type:"Noop"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.organisers.filters.businessNotify.isHidden&&"Noop"!==t.type&&"UserUndoHideFilter"!==t.type&&"visible"===document.visibilityState){var l=i.organisers.filters.businessNotify.unreadCount;n.push((0,o.default)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==l){e.next=2;break}return e.abrupt("return",{type:"Noop"});case 2:return e.abrupt("return",{type:"UserUndoHideFilter",kind:"businessNotify"});case 3:case"end":return e.stop()}}),e)}))))}return[i,n]}var Pe=function(e,t,r){switch(t.type){case"InitialData":var i=t.ownerId,c=i?(0,l.getOwnerGroupId)(i):0,y=e.viewer.id;return 0===y?[]:[function(){var e=(0,o.default)(u().mark((function e(t){var r,n,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.storage).identify(y),a=null!==(r=n.get("theme"))&&void 0!==r?r:"system",e.abrupt("return",{type:"SettingThemeUpdated",value:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,o.default)(u().mark((function e(t){var r,n,o,i,l,d,p,f,h,v,m,g,C,_,w,S,A,x,R,E,U,P,O,T,F,N,q,L,j;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=t.engine,v=t.api,m=t.storage,g=t.player,C=t.voicePlayer,e.next=3,v.fetch("messages.getLongPollServer",{need_pts:1,lp_version:h.version,group_id:c},{retries:1/0,usePrefetch:!0});case 3:if((_=e.sent).pts){e.next=6;break}throw new Error("Отсутствует pts");case 6:return h.connect((0,a.default)((0,a.default)({},_),{},{pts:_.pts})),e.next=9,v.fetchMany([{method:"messages.getConversations",params:{count:M.CONVOS_PER_PAGE,group_id:c,extended:1}},{method:"messages.getConversationsById",params:{peer_ids:y.toString(),group_id:c,extended:1}},{method:"messages.getFolders",params:{}},{method:"users.get",params:{}},0!==c&&{method:"groups.getById",params:{group_ids:String(c)}},{method:"account.getCounters",params:{filter:"all"}},{method:"account.getInfo",params:{fields:["messages_recommendation_list_hidden","show_only_not_muted_messages","messages_multiline_input","messages_auto_unarchive","messages_transcript_auto_show","business_notify","messages_show_banner_teacher_verification"].join(",")}},{method:"account.getHelpHints",params:{categories:"im"}},{method:"account.getMulti",params:{fields:"profile_type,photo_100"}},{method:"account.getProfileInfo",params:{}}],{retries:1/0,timeout:2e4,usePrefetch:!0});case 9:if(w=e.sent,S=(0,s.default)(w,10),A=S[0],x=S[1],R=S[2],E=S[3],U=S[4],P=S[5],O=S[6],T=S[7],F=S[8],N=S[9],q=null==U||null===(r=U.groups)||void 0===r?void 0:r[0],L=E[0]){e.next=25;break}throw new Error("Не удалось получить текущего пользователя");case 25:return m.identify(y),g.init(y),C.init(y),j={type:"InitialData_RequestCompleted",responseViewer:L,responseMultiAccount:F,responseGroup:q,responseConvos:A,responseProfileInfo:N,responseViewerConvo:x,hasMoreConvos:A.items.length>=M.CONVOS_PER_PAGE,folders:R,unreadCount:{messages:P.messages||0,messagesUnmuted:P.messages_unread_unmuted||0,archive:P.messages_archive_unread||0,archiveMentions:P.messages_archive_mentions_count||0,archiveTotal:P.messages_archive||0,messageRequest:P.message_requests||0,businessNotify:P.business_notify||0,businessNotifyTotal:P.business_notify_all||0,channelsTotal:(null===(n=P.channels)||void 0===n?void 0:n.total_count)||0,folders:P.messages_folders||[]},convoLp:{pts:_.pts},hiddenPinnedMessages:m.get("hidden-pinned-messages"),hiddenBotKeyboards:m.get("hidden-bot-keyboards"),archiveManuallyHidden:!!m.get("archive-manually-hidden"),composerDrafts:b.validateRequiredFields(m.get("drafts")||{}),channelComposerDrafts:k.validateRequiredFields(m.get("channels-drafts")||{}),businessNotifyManuallyHidden:!!m.get("business-notify-manually-hidden"),userSettings:{ctrSubmit:Boolean(O.messages_multiline_input),soundNotifications:null===(o=m.get("settings-sound-notifications-on"))||void 0===o||o,browserNotifications:null!==(i=m.get("settings-browser-notifications-on"))&&void 0!==i&&i,showRecommendations:!Boolean(O.messages_recommendation_list_hidden),countOnlyNotMuted:Boolean(O.show_only_not_muted_messages),autoUnarchive:Boolean(O.messages_auto_unarchive),transcriptAutoShow:Boolean(O.messages_transcript_auto_show),theme:null!==(l=m.get("theme"))&&void 0!==l?l:"system",verticalFoldersView:null!==(d=m.get("folders-view-vertical"))&&void 0!==d&&d,businessNotify:Boolean(O.business_notify_enabled),push:I.VIEWER_DEFAULT_PUSH_SETTINGS,teacherVerification:Boolean("1"===(null===(p=O.settings)||void 0===p||null===(f=p.find((function(e){return"messages_show_banner_teacher_verification"===e.name})))||void 0===f?void 0:f.value))},helpHints:T.items.reduce((function(e,t){return e.add(t.id),e}),new Set)},e.abrupt("return",j);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];case"InitialData_RequestCompleted":var C;e.convoConn={status:"running",pts:t.convoLp.pts},e.hiddenPinnedMessages=new Map(Object.entries(t.hiddenPinnedMessages||{}).map((function(e){var t=(0,s.default)(e,2),r=t[0],n=t[1];return[m.resolveId(parseInt(r)),g.resolveCmid(n)]}))),e.hiddenBotKeyboards=t.hiddenBotKeyboards||new Set,e.composerDrafts=t.composerDrafts,e.channelComposerDrafts=t.channelComposerDrafts;var _=(0,l.insertConvos)(e,t.responseConvos.items);(0,l.insertConvos)(e,t.responseViewerConvo.items),e.organisers.filters.archive.isHidden=!!t.archiveManuallyHidden,e.organisers.filters.businessNotify.isHidden=!!t.businessNotifyManuallyHidden,f.push(e.organisers.filters,"all",_,t.hasMoreConvos),0===t.unreadCount.archiveTotal&&f.push(e.organisers.filters,"archive",[],!1),0===t.unreadCount.messageRequest&&f.push(e.organisers.filters,"messageRequest",[],!1),f.updateCounters(e.organisers.filters,{unread:t.unreadCount.messages,unreadUnmuted:t.unreadCount.messagesUnmuted,headerNotMutedUnread:0,archive:t.unreadCount.archive,archiveMentions:t.unreadCount.archiveMentions,archiveTotal:t.unreadCount.archiveTotal,messageRequests:t.unreadCount.messageRequest,businessNotify:t.unreadCount.businessNotify,businessNotifyTotal:t.unreadCount.businessNotifyTotal}),(0,l.insertFolders)(e,t.folders.items),null===(C=t.unreadCount.folders)||void 0===C||C.forEach((function(t){h.setUnreadCounters(e.organisers.folders,h.resolveId(t.folder_id),t.total_count,t.unmuted_count)})),v.updateCounters(e.organisers.channelFilters,{unread:t.unreadCount.channelsTotal,archiveTotal:0}),(0,l.insertPeers)(e,{apiUsers:(0,n.default)(t.responseConvos.profiles||[]),apiGroups:(0,n.default)(t.responseConvos.groups||[]),apiContacts:(0,n.default)(t.responseConvos.contacts||[])}),e.viewer.profileInfo=(0,A.fromApiViewerProfileInfo)(t.responseProfileInfo);var w=(0,S.fromApiUser)(t.responseViewer).user;e.peers.set(w.id,w),e.viewer.id=w.id,e.viewer.accounts=t.responseMultiAccount.items.map(A.fromApiViewerAccount);var x=t.responseGroup?(0,S.fromApiGroup)(t.responseGroup):void 0;return x&&e.peers.set(x.id,x),e.ownerId=x?x.id:w.id,t.userSettings&&(e.viewer.settings=t.userSettings),e.helpHints=t.helpHints,e.convoConn.status="running",[function(){var e=(0,o.default)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.engine,e.next=3,r.poll();case 3:return e.t0=e.sent,e.t1={kind:"FromEngine",next:e.t0},e.abrupt("return",{type:"EngineBatchReceived",variant:e.t1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,o.default)(u().mark((function e(t){var r,n,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.api,n=t.queue,e.next=3,r.fetch("queue.subscribe",{queue_ids:"onlfriends_".concat(w.id)},{retries:1/0});case 3:return s=e.sent,n.connect((0,a.default)({user_id:w.id},s)),e.next=7,n.poll();case 7:return e.t0=e.sent,e.abrupt("return",{type:"QueueBatchReceived",next:e.t0});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,o.default)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{type:"LoadImportantUsers"});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,o.default)(u().mark((function e(t){var n,a,o,i,c,l,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.api,a=t.channelEngine,o=t.router,a&&r.me_channels){e.next=3;break}return e.abrupt("return",{type:"Noop"});case 3:return e.prev=3,e.next=6,n.fetchSeq([{method:"channels.getLongPollServer",params:{}},{method:"channels.get",params:{count:M.CHANNELS_PER_PAGE,filter:(0,d.getChannelFilterForAPI)(p.tabToChannelFilter(o.currentRoute.tab)),extended:1}}],{retries:1/0});case 6:return i=e.sent,c=(0,s.default)(i,2),l=c[0],f=c[1],a.connect(l),e.abrupt("return",{type:"InitialData_ChannelsReadyForUse",channelLpTS:l.ts,channelsGetResponse:f});case 14:return e.prev=14,e.t0=e.catch(3),e.abrupt("return",{type:"Noop"});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}()];case"InitialData_ChannelsReadyForUse":var R,E,U;e.channelConn={status:"running",ts:t.channelLpTS};var P=(0,l.insertChannels)(e,{apiChannels:t.channelsGetResponse.items||[],apiGroups:t.channelsGetResponse.groups||[]}),O=((null===(R=t.channelsGetResponse.items)||void 0===R?void 0:R.length)||0)>=M.CHANNELS_PER_PAGE;return v.push(e.organisers.channelFilters,"all",P,O),(0,l.insertPeers)(e,{apiUsers:(0,n.default)((null===(E=t.channelsGetResponse)||void 0===E?void 0:E.profiles)||[]),apiGroups:(0,n.default)((null===(U=t.channelsGetResponse)||void 0===U?void 0:U.groups)||[]),apiContacts:[]}),[function(){var e=(0,o.default)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.channelEngine){e.next=3;break}return e.abrupt("return",{type:"Noop"});case 3:return e.next=5,r.poll();case 5:return e.t0=e.sent,e.t1={kind:"FromChannelEngine",next:e.t0},e.abrupt("return",{type:"ChannelEngineBatchReceived",variant:e.t1});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];default:return[]}},Oe=function(e,t){var r,n;return"LoadVideoMessageShapes_RequestCompleted"===t.type?(e.videoMessageShapes=null!==(r=null===(n=t.videoMessageShapes)||void 0===n?void 0:n.shapes.reduce((function(e,t){var r=t.id,n=t.raw_path;return e.set(r,n),e}),new Map))&&void 0!==r?r:new Map,[]):[]};function Te(e){return Fe.apply(this,arguments)}function Fe(){return(Fe=(0,o.default)(u().mark((function e(t){var r,s,o,i,c,l,d,p,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.api,s=t.storage,o=s.get("videomessage-shapes"),i=Math.round((new Date).getTime()/1e3),c=86400,l=o&&o.expiresAt>i,d=null,!l){e.next=10;break}d=o.response,e.next=18;break;case 10:return e.prev=10,e.next=13,r.fetch("messages.getVideoMessageShapes",{client_version:null!==(p=null==o?void 0:o.response.version)&&void 0!==p?p:0},{retries:3});case 13:d=e.sent,e.next=18;break;case 16:e.prev=16,e.t0=e.catch(10);case 18:return f=d?(0,a.default)((0,a.default)({},d),{},{shapes:[].concat((0,n.default)((null==o?void 0:o.response.shapes)||[]),(0,n.default)(d.shapes))}):null,!l&&f&&s.set("videomessage-shapes",{response:f,expiresAt:i+c}),e.abrupt("return",f);case 21:case"end":return e.stop()}}),e,null,[[10,16]])})))).apply(this,arguments)}},207388:(e,t,r)=>{"use strict";r.d(t,{initConfig:()=>a});var n=r(210746);function a(){(0,n.enableMapSet)(),(0,n.setAutoFreeze)(!1);var e=r(164623),t=r(859005);e.shim(),t.shim()}},906978:(e,t,r)=>{"use strict";r.d(t,{API_ERROR_UNKNOWN:()=>n,API_ERROR_AUTH:()=>a,API_ERROR_CAPTCHA:()=>s,API_ERROR_ACCESS:()=>o,API_ERROR_AUTH_VALIDATION:()=>i,API_ERROR_PARAM:()=>u,API_ERROR_LIMITS:()=>c,API_ERROR_MESSAGES_CHAT_USER_NO_ACCESS:()=>l,API_ERROR_MESSAGES_CHAT_NOT_ADMIN:()=>d,API_ERROR_MESSAGES_GROUP_PEER_ACCESS:()=>p,API_ERROR_MESSAGES_CONTACT_NOT_FOUND:()=>f,API_ERROR_MESSAGES_MESSAGE_REQUEST_ALREADY_SENT:()=>h,API_ERROR_MESSAGES_CHAT_DISABLED:()=>v,API_ERROR_MESSAGES_CHAT_UNSUPPORTED:()=>y,API_ERROR_MESSAGES_MEMBER_ACCESS_TO_GROUP_DENIED:()=>m,API_ERROR_MESSAGES_CHAT_MEMBER_NOT_STAFF:()=>g});const n=1,a=5,s=14,o=15,i=17,u=100,c=103,l=917,d=925,p=932,f=936,h=939,v=945,y=946,m=947,g=967},540399:(e,t,r)=>{"use strict";var n=r(929120),a=r(91521),s=r(570317),o=r(299739),i=r(304840),u=r(369058);e.exports=function(e){var t,r=u(this),c=i(s(r,"length"));if(!o(e))throw new TypeError("mapperFunction must be a function");arguments.length>1&&(t=arguments[1]);var l=n(r,0);return a(l,r,c,0,1,e,t),l}},164623:(e,t,r)=>{"use strict";var n=r(404289),a=r(155559),s=r(540399),o=r(989739),i=o(),u=r(736967),c=a(i);n(c,{getPolyfill:o,implementation:s,shim:u}),e.exports=c},989739:(e,t,r)=>{"use strict";var n=r(540399);e.exports=function(){return Array.prototype.flatMap||n}},736967:(e,t,r)=>{"use strict";var n=r(404289),a=r(697272),s=r(989739);e.exports=function(){var e=s();return n(Array.prototype,{flatMap:e},{flatMap:function(){return Array.prototype.flatMap!==e}}),a("flatMap"),e}},487496:(e,t,r)=>{"use strict";var n=r(304840),a=r(260561),s=r(186378),o=r(921924)("String.prototype.slice");e.exports=function(e){var t,r=s(this),i=a(r),u=n(i.length);arguments.length>1&&(t=arguments[1]);var c=void 0===t?"":a(t);""===c&&(c=" ");var l=n(e);if(l<=u)return i;for(var d=l-u;c.length<d;){var p=c.length,f=d-p;c+=p>f?o(c,0,f):c}var h=c.length>d?o(c,0,d):c;return h+i}},859005:(e,t,r)=>{"use strict";var n=r(404289),a=r(186378),s=r(155559),o=r(487496),i=r(433842),u=r(714563),c=s.apply(i()),l=function(e,t){a(e);var r=arguments.length>2?[t,arguments[2]]:[t];return c(e,r)};n(l,{getPolyfill:i,implementation:o,shim:u}),e.exports=l},433842:(e,t,r)=>{"use strict";var n=r(487496);e.exports=function(){return"function"==typeof String.prototype.padStart?String.prototype.padStart:n}},714563:(e,t,r)=>{"use strict";var n=r(433842),a=r(404289);e.exports=function(){var e=n();return a(String.prototype,{padStart:e},{padStart:function(){return String.prototype.padStart!==e}}),e}},172006:()=>{}}]);try{stManager.done("dist/3bad6e117063d3681bf4f60574b483cc.4c15987897cc9ca14009.js")}catch(e){}