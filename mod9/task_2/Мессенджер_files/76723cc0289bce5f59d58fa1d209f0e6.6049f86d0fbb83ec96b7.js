(self.webpackChunkvk=self.webpackChunkvk||[]).push([[33822],{857265:(e,o,t)=>{"use strict";function i(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 9.6c0-4.53 0-6.79 1.4-8.2C2.82 0 5.08 0 9.6 0h.8c4.53 0 6.79 0 8.2 1.4C20 2.82 20 5.08 20 9.6v.8c0 4.53 0 6.79-1.4 8.2S14.92 20 10.4 20h-.8c-4.53 0-6.79 0-8.2-1.4C0 17.18 0 14.92 0 10.4z" fill="#07f"/><path d="M13.2 4C9.05 4 6.8 9.2 0 9.2v1.2c0 4.53 0 6.79 1.4 8.2C2.82 20 5.08 20 9.6 20h.8c4.53 0 6.79 0 8.2-1.4s1.4-3.67 1.4-8.2V7.3C18.95 6.5 16.3 4 13.2 4z" fill="#f45fff"/><g fill="#fff"><path d="M15.5 10.2a.9.9 0 0 1 1.8 0v3.6a.9.9 0 0 1-1.8 0zm-3.2-2.3a.9.9 0 0 1 1.8 0v8.2a.9.9 0 0 1-1.8 0zm-3.2 2.3a.9.9 0 0 1 1.8 0v3.6a.9.9 0 0 1-1.8 0zm-3.2 1.3a.9.9 0 0 1 1.8 0v1a.9.9 0 0 1-1.8 0zm-3.2 0a.9.9 0 0 1 1.8 0v1a.9.9 0 0 1-1.8 0z"/></g></svg>',name:"logo_vk_music_color_20"}}t.d(o,{getIcon20LogoVkMusicColor:()=>i})},378322:(e,o,t)=>{"use strict";function i(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M12.06 1.5c.65 0 1.23 0 1.7.04.51.04 1.04.13 1.56.4a4 4 0 0 1 1.74 1.74c.27.52.36 1.05.4 1.56.04.47.04 1.05.04 1.7v6.12c0 .65 0 1.23-.04 1.7a4.07 4.07 0 0 1-.4 1.56 4 4 0 0 1-1.74 1.74c-.52.27-1.05.36-1.56.4-.47.04-1.05.04-1.7.04H7.94c-.65 0-1.23 0-1.7-.04a4.06 4.06 0 0 1-1.56-.4 4 4 0 0 1-1.74-1.74 4.06 4.06 0 0 1-.4-1.56c-.04-.47-.04-1.05-.04-1.7V6.94c0-.65 0-1.23.04-1.7.04-.51.13-1.04.4-1.56a4 4 0 0 1 1.74-1.74 4.06 4.06 0 0 1 1.56-.4c.47-.04 1.05-.04 1.7-.04zM4.27 4.37C4 4.9 4 5.6 4 7v6c0 1.4 0 2.1.27 2.63.24.48.62.86 1.1 1.1C5.9 17 6.6 17 8 17h4c1.4 0 2.1 0 2.63-.27a2.5 2.5 0 0 0 1.1-1.1C16 15.1 16 14.4 16 13V7c0-1.4 0-2.1-.27-2.63a2.5 2.5 0 0 0-1.1-1.1C14.1 3 13.4 3 12 3H8c-1.4 0-2.1 0-2.63.27a2.5 2.5 0 0 0-1.1 1.1zM6 14c0-.33 0-.49.06-.62a.65.65 0 0 1 .32-.32c.13-.06.3-.06.62-.06s.49 0 .62.06c.14.06.26.18.32.32.06.13.06.3.06.62s0 .49-.06.62a.65.65 0 0 1-.32.32c-.13.06-.3.06-.62.06s-.49 0-.62-.06a.65.65 0 0 1-.32-.32C6 14.49 6 14.32 6 14zm.06-4.62C6 9.51 6 9.68 6 10c0 .33 0 .49.06.62.06.14.18.26.32.32.13.06.3.06.62.06s.49 0 .62-.06a.65.65 0 0 0 .32-.32c.06-.13.06-.3.06-.62 0-.33 0-.49-.06-.62a.65.65 0 0 0-.32-.32C7.49 9 7.32 9 7 9s-.49 0-.62.06a.65.65 0 0 0-.32.32zM12 6c0-.33 0-.49.06-.62a.65.65 0 0 1 .32-.32c.13-.06.3-.06.62-.06s.49 0 .62.06c.14.06.26.18.32.32.06.13.06.3.06.62s0 .49-.06.62a.65.65 0 0 1-.32.32c-.13.06-.3.06-.62.06s-.49 0-.62-.06a.65.65 0 0 1-.32-.32C12 6.49 12 6.32 12 6zm.06 7.38c-.06.13-.06.3-.06.62s0 .49.06.62c.06.14.18.26.32.32.13.06.3.06.62.06s.49 0 .62-.06a.65.65 0 0 0 .32-.32c.06-.13.06-.3.06-.62s0-.49-.06-.62a.65.65 0 0 0-.32-.32c-.13-.06-.3-.06-.62-.06s-.49 0-.62.06a.65.65 0 0 0-.32.32zM12 10c0-.33 0-.49.06-.62a.65.65 0 0 1 .32-.32c.13-.06.3-.06.62-.06s.49 0 .62.06c.14.06.26.18.32.32.06.13.06.3.06.62 0 .33 0 .49-.06.62a.65.65 0 0 1-.32.32c-.13.06-.3.06-.62.06s-.49 0-.62-.06a.65.65 0 0 1-.32-.32c-.06-.13-.06-.3-.06-.62zM6.06 5.38C6 5.51 6 5.68 6 6s0 .49.06.62c.06.14.18.26.32.32.13.06.3.06.62.06s.49 0 .62-.06a.65.65 0 0 0 .32-.32C8 6.49 8 6.32 8 6s0-.49-.06-.62a.65.65 0 0 0-.32-.32C7.49 5 7.32 5 7 5s-.49 0-.62.06a.65.65 0 0 0-.32.32z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"video_outline_20"}}t.d(o,{getIcon20VideoOutline:()=>i})},522876:(e,o,t)=>{"use strict";function i(){return{icon:'<svg fill="none" height="28" viewBox="0 0 28 28" width="28" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M26.7 15.29a1 1 0 0 1 .1 1.32l-6.95 7.1a1 1 0 0 1-1.33.08L14.3 19.5a1 1 0 0 1 1.33-1.48l3.52 3.54 6.15-6.27a1 1 0 0 1 1.41-.01zM10 18a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm12-6a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm0-6a1 1 0 1 1 0 2H4a1 1 0 0 1 0-2z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"list_check_outline_28"}}t.d(o,{getIcon28ListCheckOutline:()=>i})},404645:(e,o,t)=>{"use strict";function i(){return{icon:'<svg fill="none" height="56" viewBox="0 0 56 56" width="56" xmlns="http://www.w3.org/2000/svg"><path d="M37.74 6c3.57 0 4.86.37 6.17 1.07s2.32 1.72 3.02 3.02c.7 1.3 1.07 2.6 1.07 6.17v23.48c0 3.57-.37 4.86-1.07 6.17a7.27 7.27 0 0 1-3.02 3.02c-1.3.7-2.6 1.07-6.17 1.07H18.26c-3.57 0-4.86-.37-6.17-1.07-1.3-.7-2.32-1.72-3.02-3.02S8 43.3 8 39.74V16.26c0-3.57.37-4.86 1.07-6.17.7-1.3 1.72-2.32 3.02-3.02S14.7 6 18.26 6zm.32 3h-19.8c-2.8 0-3.77.19-4.75.71a4.27 4.27 0 0 0-1.8 1.8c-.5.95-.7 1.87-.7 4.43L11 39.74c0 2.8.19 3.77.71 4.75a4.27 4.27 0 0 0 1.8 1.8c.99.52 1.95.71 4.75.71h19.48c2.8 0 3.77-.19 4.75-.71a4.27 4.27 0 0 0 1.8-1.8c.52-.98.71-1.95.71-4.75V16.26c0-2.8-.19-3.77-.71-4.75a4.27 4.27 0 0 0-1.8-1.8c-.95-.5-1.87-.7-4.43-.7zM18.72 38c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13z" fill="currentColor"/></svg>',name:"video_outline_56"}}t.d(o,{getIcon56VideoOutline:()=>i})},305096:(e,o,t)=>{"use strict";function i(e,o){var t,i,r=!1;return function n(){if(r)return t=arguments,void(i=this);e.apply(this,arguments),r=!0,setTimeout((function(){r=!1,t&&(n.apply(i,t),t=i=null)}),o)}}t.d(o,{throttle:()=>i})},499206:(e,o,t)=>{"use strict";function i(e){var o=e.getBoundingClientRect();return o.top>=0&&o.left>=0&&o.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&o.right<=(window.innerWidth||document.documentElement.clientWidth)}t.d(o,{isElementInViewport:()=>i})},684351:(e,o,t)=>{"use strict";t.d(o,{Video:()=>M});t(892222),t(57327),t(682772),t(66992),t(821249),t(747042),t(702707),t(140561),t(241539),t(788674),t(324603),t(339714),t(804723),t(115306),t(864765),t(323123),t(573210),t(454747),t(333948);var i=t(873589),r=t(545161),n=t(343474),a=t(226323),s=t(608021),c=t(733164),d=t(146143),l=t(798262),u=t(290846),_=t(927766),v=t(501389),h=t(342269),g=t(152278),p=t(897449),f=t(315882),S=t(522876),m=t(484239),w=t(404645),I=t(857265),E=t(378322),b=t(305096),y=t(631491),C=t(499206),V=t(108046),L=t(124041),A=t(892100),P=t(997109),O=t(506770),T=t(844142);function B(e,o){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,o){if(!e)return;if("string"==typeof e)return x(e,o);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x(e,o)}(e))||o&&e&&"number"==typeof e.length){t&&(e=t);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e,o){(null==o||o>e.length)&&(o=e.length);for(var t=0,i=new Array(o);t<o;t++)i[t]=e[t];return i}function D(){return t.e(90927).then(t.bind(t,697632))}var M={VIDEO_SEARCH_TYPE:"search_videos",VIDEO_GLOBAL_SEARCH_TYPE:"search_global_videos",ALBUM_SEARCH_TYPE:"search_albums",ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE:"search_promo_albums",SEARCH_FILTERS:["hd","notsafe","live","date","order","len"],AVAILABLE_TABS:["all","uploaded","albums"],VIDEOS_PER_PAGE:60,VIDEOS_PER_ROW:3,PLAYLIST_FIRST_CHUNK_SIZE:9,PLAYLIST_OBJECT_ID_INDEX:6,SEARCH_KEEP_FILTERS_DELAY:3e3,SEARCH_STATS_POSITION_FIELDS:["oid","vid","clicked","viewStarted","viewedParts","viewedSeconds"],USER_SYSTEMS_ALBUM_TYPES:["type_my_uploaded","type_my_added","type_my_lives","type_my_recorded_calls"],DAY_IN_MS:864e5,getLoc:function(){return cur.curLoc?cur.curLoc:cur.is_showcase&&!nav.objLoc.section&&cur.showcaseSection&&("playlist"===cur.section||(0,h.inArray)(cur.showcaseSection,M.USER_SYSTEMS_ALBUM_TYPES))?(nav.objLoc.section=cur.showcaseSection,nav.objLoc):((0,c.isEmpty)(nav.objLoc)||!nav.objLoc[0]||0!=nav.objLoc[0].indexOf("video"))&&cur.section&&(0,h.inArray)(cur.section,["catalog","all","uploaded","albums"])?{0:"catalog"===cur.section?"video":"videos"+cur.oid}:nav.objLoc},init:function(){cur.searchInputEl=(0,i.geByClass1)("video_search_input"),cur.videoRecentlyRemoved={},cur.videoShowWindow={},cur.found={},cur.silentLoaded={},cur.currentSortings={},cur._preloadedPages={},cur.videoSearchFilters={},cur.videoSearchStats=null,cur.videoSearchPos=null,cur.videoSearchTrackCodeForQID="",cur.module="video",cur.albumsPreload=cur.albumsPreload||{},cur.albumsShowingAll={},cur.curLoc=!!cur.query&&nav.fromStr(cur.query),cur._back={hide:[function(){(0,g.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=null}],show:[function(){M._initScroll()}]},(0,c.isObject)(cur.curLoc)&&(cur.curLoc.section=cur.section),cur.getOwnerId=function(){return cur.oid},M.initNavigation(),M.initSearch();var e=M._getCurrentSectionType();if(M.isInAlbum()||M.loadSilent(),M.loadSilent(M.getLoc().section),"catalog"===e&&"playlists"!==M.getLoc().section||M.initOwnerVideoPage(),cur.videoCanSort&&"all_playlists"===cur.showcaseSection){var o=document.getElementById("video_all_playlists_list");o&&D().then((()=>{cur.albumsSorter=new window.GridSorter(o,"video_item__thumb_link",{onReorder:M._onAlbumReorder})}))}cur.curLoc=!1,cur.section=!1,cur.currentModule=function(){return M.isInSearch()?"video_search":cur.is_showcase&&cur.ref?cur.ref:M.isInCatalog()?"videocat":M.isInVideosList()?cur.oid<0?"community_videos":cur.oid==vk.id?"profile_own_videos":"profile_videos":cur.module},M._initScroll(),M._loadNextChunkIfNeed(),M._updateThumbsInView()},_loadNextChunkIfNeed:function(){if(cur.is_showcase){var e=document.getElementById(`ui_${cur.showcaseSection}_load_more`);if(e&&e.clientHeight&&(0,C.isElementInViewport)(e))M.onScroll();else{var o=document.getElementById(`video_${cur.showcaseSection}_list`);if(o)o.getBoundingClientRect().bottom-(0,i.clientHeight)()<300&&M.onScroll()}}},_getMyAddedVideosPath:function(){return cur.my_added_videos_path},_initScroll:function(){cur._ev_onScroll&&(0,g.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=(0,b.throttle)(M.onScroll,100),(0,g.addEvent)(window,"scroll",cur._ev_onScroll),(0,P.pushNavDestroy)((()=>{(0,g.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=null}))},initOwnerVideoPage:function(){if(!cur._videoInited){if(cur._videoInited=!0,cur.videoCanSort){if(!M.isInAlbum()){var e=cur.is_showcase?"video_playlist_list":"video_albums_list";D().then((()=>{cur.albumsSorter=new window.GridSorter(e,"video_item__thumb_link",{onReorder:M._onAlbumReorder})}))}M._createSorters()}if(M.isGroupsRedesignEnabled())Promise.all([t.e(56990),t.e(98066),t.e(89658)]).then(t.bind(t,156816)).then((e=>{var o=e.renderVideoExtraTabsActions,t=e.mapRawVideosOrderItemToVideosOrderItem;o({commentsTooltipText:(0,s.getLang)("video_comments_review"),orderItems:cur.videoSortItems.map(t),canSeeComments:!!cur.canSeeCommentsPage,canSeeOrder:!!cur.canSeeOrder,onCommentsButtonClick:()=>{var e,o;return(null==(e=nav)||null==(o=e.objLoc)?void 0:o[0])&&nav.go(nav.objLoc[0]+"/comments")},onVideosOrderChange:M._sortVideos})}));else{var o=(0,i.ge)("video_sort_dd");o&&(cur.videoSortDD=new InlineDropdown(o,{items:cur.videoSortItems,withArrow:!0,ariaLabel:(0,s.curLang)("video_search_order"),selected:"default",onSelect:M._sortVideos})),M._toggleSorter("albums"!==M.getLoc().section)}}},_toggleSorter:function(e){var o=(0,i.geByClass1)("video_tab_actions_wrap"),t=[(0,i.geByClass1)("_video_sort_dd_wrap",o),(0,i.geByClass1)("divider",o)];(0,i.toggle)(t[0],e),(0,i.toggle)(t[1],e)},updateEmptyPlaceholder:function(e){if(e){var o=!1,t="";"albums"===e?cur.playlistsCount||(o=!0,t=(0,s.getLang)("video_no_albums_placeholder_text")):cur.videosCount[cur.getOwnerId()][e]||(o=!0,t=(0,s.getLang)("video_no_videos_here_yet")),M._toggleEmptyPlaceholder(o,t)}},initNavigation:function(){cur.nav.push((function(e,o,t,r){var a=void 0!==e[0],s=!cur.is_showcase&&"comments"===t.section,c=t.q&&!o.q&&t[0].indexOf("video")>=0,d=o.q&&!t.q&&o[0].indexOf("video")>=0,u="upload"===o.section&&!t.section,_=e.q;if(c||_?M._initSearchStats(t):d&&M._clearSearchStats(),(0,n.revertLastInlineVideo)(),s)return delete cur._back,!0;if(a){var v=cur.getOwnerId();if(v==vk.id&&(cur.is_showcase||!(0,h.inArray)(e[0],["video","videos"+v])))return!0;if(v!=vk.id&&!(0,h.inArray)(e[0],["videos"+v]))return!0}if(u)return!0;if(uiTabs.hideProgress("video_main_tabs"),"all"===e.section&&delete t.section,c&&(cur.videoLocBeforeSearch=o),d&&(cur.videoSearchFilters={},cur.lastProcessedSearchParams=null,M.doSearch(),M.inputVal(cur.searchInputEl,""),cur.videoLocBeforeSearch&&r.fromSearch)){var g=(0,h.clone)(cur.videoLocBeforeSearch);return delete cur.videoLocBeforeSearch,nav.go(g),!1}var p=t.section||"all";if(t.q||(0,f.removeSearchPositionTracker)(f.serviceVideo),t.q)M.isInAlbum()||delete t.section,c&&"lives"===cur.section_id&&(t.live=1),M._prepareSearchFilters(t),r.fromSearch||M.inputVal(cur.searchInputEl,t.q),r.fromSearch||r.globalQuery||(r.globalQuery=t.q),M.doSearch(t.q);else{var S;if(cur.is_showcase)return"left_nav"===(null==(S=r.params)?void 0:S._ref)||(nav.setLoc(t),!(!cur.is_showcase||!t.z||o.z===t.z)||(o.section!==t.section||o[0]!==t[0]));if(-1==M.AVAILABLE_TABS.indexOf(p))return~p.indexOf("album")&&(0,l.statlogsValueEvent)("video_play_album",0,"open_album"),!0;if(M.isInAlbum(o.section))return nav.setLoc(t),!0;(0,h.each)(M.AVAILABLE_TABS,(function(e,o){(0,i.hide)("video_subtab_pane_"+o)})),(0,i.show)("video_subtab_pane_"+p),M.updateEmptyPlaceholder(p);var m=(0,i.domFC)((0,i.ge)("video_tab_"+p));m&&uiTabs.switchTab(m,{noAnim:r.hist}),"albums"!==p?(M.loadSilent(p),cur.videoSortDD&&cur.videoSortDD.select(cur.currentSortings[p]||"default",!0),M._toggleSorter(!0)):M._toggleSorter(!1),M._createSorters(p)}return!!t.show_original||(nav.setLoc(t),!1)})),(0,P.pushNavDestroy)((()=>{cur.nav.pop()}))},initSearch:function(){cur.searchInputEl=(0,i.ge)("video_search_input"),cur.lastProcessedSearchParams=null,cur._videoRenderedSearchResults={},cur.searchInputEl&&!cur.is_showcase&&((0,i.data)(cur.searchInputEl,"opts").onChange=M.onSearchInputChange,(0,i.data)(cur.searchInputEl,"opts").onBlur=M.onSearchInputBlur,cur.searchInputEl.focus())},onSearchInputChange:function(e,o){e=(0,h.trim)(e),o=(0,c.isString)(o)?(0,h.trim)(o):"";var t={};e||((0,h.each)(M.SEARCH_FILTERS,(function(e,o){t[o]=!1})),cur.videoPrevSearchFilters=(0,h.clone)(cur.videoSearchFilters),setTimeout((function(){delete cur.videoPrevSearchFilters}),M.SEARCH_KEEP_FILTERS_DELAY)),e&&cur.videoPrevSearchFilters&&(t=cur.videoPrevSearchFilters,delete cur.videoPrevSearchFilters),nav.change((0,h.extend)({q:e||!1},t),!1,{fromSearch:!0,globalQuery:o})},onSearchInputBlur:function(){(0,h.trim)((0,i.val)(cur.searchInputEl))&&(cur.vSearchInputBlurred=!0)},_sortVideos:function(e){var o,t,r;window.tooltips&&tooltips.hideAll();var n=M._getCurrentSectionType(),a=cur.getOwnerId();"album"===n&&(n=M.getLoc().section);var c=cur.silentLoaded[a][n];if(!c)return M.isGroupsRedesignEnabled()?window.dispatchEvent(new CustomEvent(V.VideoOrderEvents.START_LOADING)):((0,i.show)("video_sort_progress"),(0,i.hide)("video_sort_dd")),void M._addPendingAction(n,(function(){M._sortVideos(e)}));M.isGroupsRedesignEnabled()?window.dispatchEvent(new CustomEvent(V.VideoOrderEvents.END_LOADING)):((0,i.hide)("video_sort_progress"),(0,i.show)("video_sort_dd"));var d=0;c=c.filter((function(e){var o=e[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+e[VideoConstants.VIDEO_ITEM_INDEX_ID];return!cur.videoRecentlyRemoved[o]||(d++,!1)}));var l=cur.videosCount[cur.getOwnerId()];if(d&&l)if(M.isInAlbum()){var u="album_"+M._getSectionAlbumId();l[u]&&(l[u]-=d,(0,i.val)((0,i.geByClass1)("_video_subtitle_counter",(0,i.ge)("video_layout_contents")),(0,s.langNumeric)(l[u],(0,s.curLang)("video_playlist_size"))))}else l.all-=d,M.updateTabCounter(l.all);(null==(o=cur.pageVideosList)||null==(t=o[a])||null==(r=t[n])?void 0:r.count)===cur.silentLoaded[a][n].length&&(cur.pageVideosList[a][n].list=c,cur.pageVideosList[a][n].count=c.length),cur.silentLoaded[a][n]=c,clearTimeout(cur._sortTO),cur._sortTO=setTimeout((function(){c.length&&(c.sort((function(o,t){switch(e){case"default":return o[cur.indexIndex]-t[cur.indexIndex];case"new":return t[VideoConstants.VIDEO_ITEM_INDEX_DATE]-o[VideoConstants.VIDEO_ITEM_INDEX_DATE];case"old":return o[VideoConstants.VIDEO_ITEM_INDEX_DATE]-t[VideoConstants.VIDEO_ITEM_INDEX_DATE];case"popularity":return t[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]-o[VideoConstants.VIDEO_ITEM_INDEX_VIEWS];case"short":return o[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]-t[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION];case"long":return t[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]-o[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]}})),(0,i.ge)("video_"+n+"_list").innerHTML="",cur.videoShowWindow&&cur.videoShowWindow[a]&&(cur.videoShowWindow[a][n]=!1),M.showMore(n),M._reinitSorters("default"!==e),cur.currentSortings=cur.currentSortings||{},cur.currentSortings[n]=e)}),10)},_reindex:function(e){for(var o=0,t=e.length;o<t;o++)e[o].length>=cur.indexIndex?e[o][cur.indexIndex]=o:e[o].push(o)},_onAlbumReorder:function(e,o,t){var i=e.getAttribute("data-id"),r=t&&!t.getAttribute("nodrag")?t.getAttribute("data-id"):null,n=o&&!o.getAttribute("nodrag")?o.getAttribute("data-id"):null,a=!1,s=cur.albumsSorter._contEl;if(cur.is_showcase&&s){if(!(a=e.classList.contains("VideoCard--first")||e.classList.contains("VideoCard--second"))){var c=[...s.querySelectorAll(".js-video_playlist_item")];c.length&&(a=c[0].getAttribute("data-id")===i||c[1].getAttribute("data-id")===i)}var d=s.querySelector(`.VideoPlaylistInfo[data-id='${i}']`);d&&e.insertAdjacentElement("afterend",d)}a&&[...s.querySelectorAll(".js-video_playlist_item:not(.VideoCard--isSystem)")].forEach(((e,o)=>{e.classList.toggle("VideoCard--first",0===o),e.classList.toggle("VideoCard--second",1===o)})),ajax.post("al_video.php?act=reorder_albums",{oid:cur.getOwnerId(),aid:i,before:n,after:r,hash:cur.videoAlbumsSortHash,need_update:a?1:0},{onDone:function(e){M._updatePlaylistPanel(e)}})},_onReorder:function(e,o,t){var r=cur.getOwnerId(),n=(0,i.domData)(e,"id"),a=t?(0,i.domData)(t,"id"):null,s=o?(0,i.domData)(o,"id"):null,c=M._getCurrentSectionType();"album"===c&&(c=M.getLoc().section.split("_")[1]);var d=M._getCurrentSectionType(),l=cur.silentLoaded[r][d];if(l){var u=-1,_=-1;if((0,h.each)(l,(function(e,o){var t=o[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+o[VideoConstants.VIDEO_ITEM_INDEX_ID];if(t==n&&(u=e),t==a&&(_=e),_>=0&&u>=0)return!1})),u>=0){var v=l.splice(u,1)[0];_<0?l.unshift(v):(_>u&&_--,l.splice(_+1,0,v)),M._reindex(l)}}var g=!1;if(cur.is_showcase){if(!(g=e.classList.contains("VideoCard--first"))){var p=document.querySelector(`._video_playlist_${c}_list .VideoCard`);p&&(g=p.getAttribute("data-id")===n)}g&&[...document.querySelectorAll(`._video_playlist_${c}_list .VideoCard`)].forEach(((e,o)=>{e.classList.toggle("VideoCard--first",0===o)}))}ajax.post("al_video.php?act=reorder_videos",{album_id:c,target_id:r,vid:n,before:s,after:a,hash:cur.videoSortHash,ref:window.cur.ref,update_cover:g?1:0},{onDone:function(e,o){if(e){var t=document.querySelector(".VideoInfoPanel--playlistPage .VideoInfoPanel__coverImage");t&&(t.src=e)}M._updatePlaylistPanel(o)}})},_updatePlaylistPanel:function(e){if(e){var o=document.getElementById("own_playlist_panel");o&&(o.innerHTML="",o.insertAdjacentHTML("beforeend",e))}},_prepareSearchFilters:function(e){return cur.videoSearchFilters={},(0,h.each)(M.SEARCH_FILTERS,(function(o,t){var i=e[t];(0,c.isString)(i)&&(i=(0,c.htsc)(i)),cur.videoSearchFilters[t]=i})),cur.videoSearchFilters},onFilterRemoved:function(e){M._setFilterSelector(e),clearTimeout(cur._frto),cur._frto=setTimeout(M._onFiltersChanged,10)},_setFilterSelector:function(e,o){var t,r=cur["videoFilter_"+e];return!!r&&("Selector"===r.__className?(void 0===o&&(o=r.options.defaultItems[0][0]),r.selectItem(o,!1),(t=(0,h.clone)(r.selectedItems()[0])).push(t[0]==r.options.defaultItems[0][0])):(0,i.hasClass)(r,"checkbox")&&((0,i.toggleClass)(r,"on",!!o),t=[!!o,(0,i.data)(r,"title"),!o]),t)},_onFiltersChanged:function(){var e=(0,p.isChecked)("video_fltr_hd"),o=(0,p.isChecked)("video_fltr_notsafe"),t=(0,p.isChecked)("video_fltr_live"),i=cur.videoFilter_len.selectedItems()[0][0],r=cur.videoFilter_date.selectedItems()[0][0],n=cur.videoFilter_order.selectedItems()[0][0];nav.change({hd:!!e&&"1",len:i>0&&i,date:r>0&&r,order:n>=0&&n,notsafe:!!o&&"1",live:!!t&&"1"},!1,{filtersChanged:!0})},initFilters:function(){if((0,i.geByClass1)("video_search_input")){cur.videoFilter_len=new Dropdown((0,i.ge)("video_fltr_len"),cur.lenFilters,{big:1,zeroPlaceholder:!0,onChange:M._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_date=new Dropdown((0,i.ge)("video_fltr_date"),cur.dateFilters,{big:1,zeroPlaceholder:!0,onChange:M._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_order=new Dropdown((0,i.ge)("video_fltr_order"),cur.orderFilters,{big:1,zeroPlaceholder:!0,onChange:M._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_hd=(0,i.ge)("video_fltr_hd"),(0,g.removeEvent)(cur.videoFilter_hd,"click"),(0,g.addEvent)(cur.videoFilter_hd,"click",M._onFiltersChanged),(0,i.data)(cur.videoFilter_hd,"title",(0,s.curLang)("video_hd_checkbox")),vk.id&&(cur.videoFilter_notsafe=(0,i.ge)("video_fltr_notsafe"),(0,g.removeEvent)(cur.videoFilter_notsafe,"click"),(0,g.addEvent)(cur.videoFilter_notsafe,"click",M._onFiltersChanged),(0,i.data)(cur.videoFilter_notsafe,"title",(0,s.curLang)("video_filter_no_safe"))),cur.videoFilter_live=(0,i.ge)("video_fltr_live"),(0,g.removeEvent)(cur.videoFilter_live,"click"),(0,g.addEvent)(cur.videoFilter_live,"click",M._onFiltersChanged),(0,i.data)(cur.videoFilter_live,"title",(0,s.curLang)("video_filter_live"));var e=M.getLoc().q;e&&(M._prepareSearchFilters(M.getLoc()),cur.searchText=e,M.inputVal(cur.searchInputEl,cur.searchText),M.doSearch(e))}},_isGeneralSection:function(e){for(var o=0;o<M.AVAILABLE_TABS.length;o++)if(e==M.AVAILABLE_TABS[o])return!0;return!1},showMoreShowcase:function(e,o,t){if(void 0===t&&(t=()=>{}),(0,i.isVisible)(o)&&!(0,p.isButtonLocked)(o)){(0,p.lockButton)(o);var r={silent_loading:1,next_from:cur.listNextFrom},n=window.nav.strLoc;ajax.post(n,r,{onDone:function(r){var a=JSON.parse(r),s=a.videos,d=a.playlists,l=a.nextFrom,u=a.communities,_=a.shopping,v=a.shoppingVideos;if(l&&(cur.listNextFrom=l),"type_my_communities"!==e)if((0,c.isEmpty)(_)||void 0===_){if(n===window.nav.strLoc){var h=document.getElementById(`video_${e}_list`),g=document.createDocumentFragment(),f=[];if(!(0,c.isEmpty)(s)){for(var S,m=B(s);!(S=m()).done;){var w=S.value;if("type_my_history"===e||"type_subscribes"===e){var I=void 0;if(I="type_my_history"===e?w[VideoConstants.VIDEO_ITEM_INDEX_VIEWED_DAY]:Math.floor(1e3*w[VideoConstants.VIDEO_ITEM_INDEX_DATE]/M.DAY_IN_MS)*M.DAY_IN_MS)if(!document.querySelector(`.VideoGrid__separator[data-date='${I}']`)&&-1===f.indexOf(I)){f.push(I);var E=(0,y.buildDateSeparatorEl)(I);g.appendChild(E)}}var b=M.buildVideoEl(w,!0);g.appendChild(b)}if(cur.catPlaylistId&&(cur.catVideosList[cur.catPlaylistId].list.push(...s),window.VideoPlaylist&&window.mvcur)){var C=window.VideoPlaylist.getCurList();C&&(window.VideoPlaylist.addVideosToBlockList(s,!C.reversed,C.reversed),l&&s&&s.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}}if(!(0,c.isEmpty)(d))for(var V,L=B(d);!(V=L()).done;){var A=V.value,P=M.buildPlaylistEl(A,!0);g.appendChild(P)}h.appendChild(g),(0,p.unlockButton)(o),l||(0,i.hide)(o),"function"==typeof t&&t()}}else M.showMoreShopping(v,l,o,t);else M.showMoreCommunities(u,l,o)},onFail:()=>{(0,p.unlockButton)(o)},timeout:3e4})}},showMoreOwnerPlaylists:function(){if(cur.playlistsNextOffset&&!cur.loadingAlbums){cur.loadingAlbums=!0;var e=document.getElementById("video_all_playlists_list"),o=document.getElementById("ui_all_playlists_load_more");(0,p.lockButton)(o),ajax.post("/video?act=more_owner_playlists",{owner_id:cur.oid,offset:cur.playlistsNextOffset},{onDone:(t,r,n,a)=>{null==e||e.insertAdjacentHTML("beforeend",t),window.VideoShowcase.initPlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),cur.playlistsNextOffset=a,cur.loadingAlbums=!1,(0,p.unlockButton)(o),a||(0,i.hide)(o)},onFail:()=>{cur.loadingAlbums=!1,(0,p.unlockButton)(o)}})}},showMoreSubscriptionsPlaylists:function(){if(cur.playlistsNextOffset&&!cur.loadingAlbums){cur.loadingAlbums=!0;var e=document.getElementById("video_all_playlist_subscriptions_list"),o=document.getElementById("ui_all_playlist_subscriptions_load_more");(0,p.lockButton)(o),ajax.post("/video?act=more_subscriptions_playlists",{owner_id:cur.oid,offset:cur.playlistsNextOffset},{onDone:(t,r)=>{null==e||e.insertAdjacentHTML("beforeend",t),window.VideoShowcase.initPlaylistSlider(),cur.playlistsNextOffset=r,cur.loadingAlbums=!1,(0,p.unlockButton)(o),r||(0,i.hide)(o)},onFail:()=>{cur.loadingAlbums=!1,(0,p.unlockButton)(o)}})}},showMoreCommunities:function(e,o,t){var r=document.getElementById("video_type_my_communities_list"),n=document.createDocumentFragment();if(!(0,c.isEmpty)(e))for(var a,s=B(e);!(a=s()).done;){var d=a.value;(0,h.each)((0,y.buildCommunityEl)(d),(function(e,o){n.appendChild(o)}))}r.appendChild(n),window.VideoShowcase.updatePlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),(0,p.unlockButton)(t),o||(0,i.hide)(t)},showMoreShopping:function(e,o,t,r){for(var n,a=document.querySelectorAll("#video_subtab_pane_type_trends"),s=a[a.length-1].firstElementChild,c=document.createDocumentFragment(),d=B(e);!(n=d()).done;){var l=n.value,u=M.buildVideoEl(l,!0);c.appendChild(u)}if(cur.catPlaylistId&&(cur.catVideosList[cur.catPlaylistId].list.push(...e),window.VideoPlaylist&&window.mvcur)){var _=window.VideoPlaylist.getCurList();_&&(window.VideoPlaylist.addVideosToBlockList(e,!_.reversed,_.reversed),o&&e&&e.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}s.appendChild(c),window.VideoShowcase.updatePlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),(0,p.unlockButton)(t),o||(0,i.hide)(t),"function"==typeof r&&r()},loadSilent:function(e){e=e||"all";var o=cur.getOwnerId(),t=M.isInAlbum(e),i=!!cur.isSnippetVideoSelection;if((t||this._isGeneralSection(e))&&"albums"!=e){cur.silentLoaded=cur.silentLoaded||{},cur.silentLoaded[o]=cur.silentLoaded[o]||{},cur.silentLoadingProgress=cur.silentLoadingProgress||{},cur.silentLoadingProgress[o]=cur.silentLoadingProgress[o]||{};var r=cur.silentLoadingProgress[o][e];!0!==r&&cur.pageVideosList&&cur.pageVideosList[o]&&(!1!==r?void 0===r&&(cur.silentLoadingProgress[o][e]=!0,function(e){function r(t,i){cur.silentLoadingProgress&&cur.silentLoadingProgress[o]&&(cur.silentLoadingProgress[o][e]=!1,t&&(t.length&&(cur.indexIndex=t[0].length),M._reindex(t),cur.silentLoaded[o][e]=t),i&&(cur.albumsPreload[o]=!1,cur.silentLoaded[o].albums=i),M.indexItems((function(){cur.silentLoadingProgress&&(M._callPendingAction(e),i&&M._callPendingAction("albums"),cur.is_showcase?M.onScroll():M.showMore(e))})))}var n=cur.pageVideosList[o][e],a=!!n&&cur.videosCount[o][e]<=n.list.length,s=!!t||cur.albumsPreload&&cur.playlistsCount<=cur.albumsPreload[o].length;if(s&&(cur.silentLoaded[o].albums=cur.albumsPreload[o]),a&&s)r(cur.pageVideosList[o][e].list,cur.albumsPreload[o]);else if(cur.noVideos)r([],[]);else{var c=function(){var t=!cur.videosCount||!cur.videosCount[o],n=!cur.playlistsCount;if(t&&n)return{v:r([],[])};var a=cur.VIDEO_SILENT_VIDEOS_CHUNK_SIZE,c=0;if(cur.videosCount[o]&&cur.videosCount[o][e]){var d=Math.min(cur.videosCount[o][e],cur.VIDEO_SILENT_VIDEOS_MAX_SIZE);c=Math.ceil(d/a)}var l,u=Math.ceil((cur.playlistsCount||0)/a),_=Math.max(c,u),v=new Array(c),g=[],p=new window.callHub((()=>{r([].concat.apply([],v),g)}),_);if(0==_)return{v:r([],[])};for(var f=0;f<_;f++)!function(t){if(cur.serverPaging&&!cur.isCurrentVideoLayer){if(cur.pageVideosList[o])r(cur.pageVideosList[o].all||[],[])}else{var n={oid:o,section:e,rowlen:M.VIDEOS_PER_ROW,offset:t*a,snippet_video:i?1:0,need_albums:(0,h.intval)(!s&&"all"==e&&(0,h.intval)(0==t))};l=()=>{ajax.post("/al_video.php?act=load_videos_silent",n,{onDone:function(o,i,r){r&&(cur.listNextFrom=r),o&&o[e]&&o[e].list?v[t]=o[e].list:v[t]=[],0==t&&(g=i),p.done()}})},cur.direct_link?(0,V.idlizeCall)(l):l()}}(f)}();if("object"==typeof c)c.v}}(e)):M._callPendingAction(e))}},indexItems:function(e){if(cur.getOwnerId){var o=0,i=cur.getOwnerId();cur.videoIndexes=cur.videoIndexes||{},cur.videoIndexes[i]=cur.videoIndexes[i]||{},(0,h.each)(cur.silentLoaded[i],(function(e){cur.videoIndexes[i][e]||o++}));var r=new callHub(e,o);t.e(36315).then(t.bind(t,535427)).then((()=>{(0,h.each)(cur.silentLoaded[i],(function(e,o){cur.videoIndexes[i][e]||(cur.videoIndexes[i][e]=new vkIndexer(o,(function(o){return"albums"===e?o[0]:o[VideoConstants.VIDEO_ITEM_INDEX_TITLE]}),(function(){r.done()})))}))}))}},_updateSearchPageTitle:function(e){(0,v.curBox)()||(e?(cur.prevVideoPageTitle||(cur.prevVideoPageTitle=document.title),(0,i.setDocumentTitle)((0,s.getLang)("video_title_search").replace("{q}",e))):cur.prevVideoPageTitle&&(0,i.setDocumentTitle)(cur.prevVideoPageTitle))},inputVal:function(e,o){if((0,i.val)(e)!=o){(0,i.val)(e,o);var t=(0,i.gpeByClass)("_wrap",e);(0,i.toggleClass)(t,"ui_search_field_empty",!o)}},doSearch:function(e){if(cur.searchInputEl){var o=(0,h.trim)(e),t=o+M._buildFiltersSearchStr();if(cur.lastProcessedSearchParams!==t){cur.videoLocalSearchQuery=o,cur.videoGlobalSearchQuery=o;var r=cur.searchQueryId&&cur.videoSearchTrackCodeForQID?cur.searchQueryId:(0,f.generateQID)();cur.searchQueryId=r,(0,h.each)(M.SEARCH_FILTERS,(function(e,o){var t=M._setFilterSelector(o,cur.videoSearchFilters[o]);t&&uiSearch.toggleFilter(cur.searchInputEl,o,t[1],!t[2])})),cur.noEmptyLocalResults=M.isInCatalog();var n=[M.VIDEO_SEARCH_TYPE,M.ALBUM_SEARCH_TYPE,M.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE,M.VIDEO_GLOBAL_SEARCH_TYPE];M.isInSearch()&&cur.noEmptyLocalResults&&n.pop(),(0,h.each)(n,(function(e,o){(0,i.hide)("video_subtab_pane_"+o)})),o||M._toggleSearchContent(!1),(0,v.curBox)()?(0,i.ge)("box_layer_wrap").scrollTop=0:(0,_.scrollToTop)(cur.is_showcase?500:1e3);var a=M.isInAlbum()?M.getLoc().section:"all";M._clearPendingAction(a),M._updateSearchPageTitle(o),o?(M._addPendingAction(a,(function(){var e=M._searchLocally(o);(0,f.saveSearchAttemptStats)(f.serviceVideo,0,e,o,r,0,"0","",f.blockNameOwn),cur.lastProcessedSearchParams=t,e<15&&M._searchGlobally(o)})),M.loadSilent(a),(0,O.partConfigEnabled)("search_video_catalog_web2")||M._searchGlobally(o)):cur.lastProcessedSearchParams=t}}},getCurrentGlobalSearchKey(){if(!window.cur.searchInputEl)return"";var e=(0,h.trim)((0,i.val)(window.cur.searchInputEl));return e?e+M._buildFiltersSearchStr():""},isGlobalSearchMode:()=>!!M.getCurrentGlobalSearchKey(),shouldShowSectionInPlaylistWithSearch:()=>!M.shouldShowSearchInPlaylistWithSearch()&&!M.shouldShowOtherInPlaylistWithSearch(),shouldShowOtherInPlaylistWithSearch:()=>"other"===window.cur.videosInSearchPlaylistAB,shouldShowSearchInPlaylistWithSearch:()=>"search"===window.cur.videosInSearchPlaylistAB,_searchGlobally:function(e,o){if(e){o=(0,h.intval)(o)||0;var t=cur.searchQueryId,i=o>0;cur.globalSearchResults=cur.globalSearchResults||{};var r=e+M._buildFiltersSearchStr(),n=cur.globalSearchResults[r];if(!i&&n)return(0,f.saveSearchAttemptStats)(f.serviceVideo,0,n.count,e,t,n.eventBits,"1",n.modelName,f.blockNameSearch,"",n.isAnonym),cur.globalSearchInProgress=!1,M._showGlobalSearchResults(e),void M._toggleSearchProgress(!1);if(cur.globalSearchInProgress!==e){cur.globalSearchInProgress=e;var a=!!cur.isSnippetVideoSelection,s={q:e,offset:o,from:cur.oid,query_id:t};a&&(s.snippet_video=1),cur.videoSearchTrackCodeForQID&&(s.track_code_for_qid=cur.videoSearchTrackCodeForQID,cur.videoSearchTrackCodeForQID=""),i||M._toggleSearchProgress(!0);var c=Date.now(),d={onDone:function(o,n,a,s,d,l,u,_,h,g,p){if(!i){M._toggleSearchProgress(!1),cur.lastEventBits=u,cur.lastModelName=_;var S=Date.now()-c;(0,f.saveSearchAttemptStats)(f.serviceVideo,0,o,e,p||t,u,S,_,f.blockNameSearch,"",g),cur.searchQueryId=p}cur.globalSearchInProgress=!1,(0,v.curBox)()&&(d=!1),cur.globalSearchResults=cur.globalSearchResults||{},cur.globalSearchResults[r]=cur.globalSearchResults[r]||{count:0,countHash:n,list:[],realOffset:0,promoPlaylists:d,modelName:_,eventBits:u,playlistTotalCount:h,isAnonym:g};var m=cur.globalSearchResults[r];m.done=m.done||!a.list||0==a.list.length;var w=m.list.length;if(!m.done){for(var I=a.list[0],E=0,b=m.list.length-1;b>=0;b--){var y=m.list.length-b;if(y>20)break;var C=m.list[b];if(I[0]==C[0]&&I[1]==C[1]){E=y;break}}m.count=parseInt(o);var V=a.list.slice(E);if(Array.prototype.push.apply(m.list,V),window.VideoPlaylist&&window.mvcur){var L=window.VideoPlaylist.getCurList();(null==L?void 0:L.id)===M.VIDEO_GLOBAL_SEARCH_TYPE&&(window.VideoPlaylist.addVideosToBlockList(V,!L.reversed,L.reversed),!s&&V&&V.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}var A=m.list.length%M.VIDEOS_PER_ROW;o>M.VIDEOS_PER_PAGE&&A&&m.list.length<m.count&&(m.list.splice(-A,M.VIDEOS_PER_ROW),l-=A),m.realOffset=l}(s||!m.done&&m.list.length==w)&&(m.done=!0),M._showGlobalSearchResults(e,i)}};cur.is_showcase?(clearTimeout(cur.searhRequestTimeout),cur.searhRequestTimeout=setTimeout((()=>{(0,O.partConfigEnabled)("search_video_catalog_web2")||ajax.post("/al_video.php?act=search_video",(0,h.extend)(s,cur.videoSearchFilters),d)}),300)):(0,O.partConfigEnabled)("search_video_catalog_web2")||ajax.post("/al_video.php?act=search_video",(0,h.extend)(s,cur.videoSearchFilters),d)}}},toggleSearchProgress:function(e){M._toggleSearchProgress(e)},_toggleSearchProgress:function(e){cur.is_showcase||(cur.searchProgressRef=cur.searchProgressRef||0,cur.searchProgressRef=Math.max(0,cur.searchProgressRef+(e?1:-1)),e=cur.searchProgressRef>0);var o=(0,i.geByClass1)("ui_search_fltr_control",(0,i.geByClass1)("video_search_input")),t=(0,i.geByClass1)("ui_search_fltr_progress",o);(0,i.toggle)(t,e),(0,i.hasClass)(o,"shown")||(0,i.toggleClass)((0,i.gpeByClass)("_wrap",cur.searchInputEl),"ui_search_loading",e)},_buildFiltersSearchStr:function(){var e=[];return(0,h.each)(cur.videoSearchFilters||{},(function(o,t){t&&e.push(o+":"+t)})),"$"+e.join("#")},_toggleEmptySearchPlaceholder:function(e,o,t){var r=(0,i.ge)("video_empty_placeholder_search"),n=cur.getOwnerId()<0?(0,s.getLang)("video_not_found_group"):(0,s.getLang)("video_not_found_user");if(cur.getOwnerId()==vk.id&&(n=(0,s.getLang)("video_not_found_yours")),M.isInAlbum()&&(n=(0,s.getLang)("video_not_found_in_album")),M.isInCatalog()&&(n=(0,s.getLang)("video_not_found_globally")),o){var a=n.replace("{searchText}",'<b class="VideoEmptyStub__token">'+(0,h.clean)(o.replace(/\$/g,"$$$$"))+"</b>");r.classList.contains("VideoEmptyStub")?r.querySelector(".VideoEmptyStub__text").innerHTML=a:r.innerHTML=a}if((0,i.toggle)(r,e),t){var c=!0,d=(0,i.ge)("video_layout_search");(0,h.each)((0,i.domChildren)(d),(function(){if((0,i.isVisible)(this))return c=!1,!1})),c&&(0,i.toggle)(r,!0)}},_toggleEmptyPlaceholder:function(e,o){var t=(0,i.ge)("video_empty_placeholder_main");e&&t&&(t.classList.contains("VideoEmptyStub")?t.querySelector(".VideoEmptyStub__text").innerHTML=o:t.innerHTML=o),(0,i.toggle)(t,e)},_showSearchResult:function(e){var o=cur.found[e],t=cur.getOwnerId();if((0,i.toggle)("video_subtab_pane_"+e,!!o.count&&!!o.list),o.count){var r="";switch(e){case M.ALBUM_SEARCH_TYPE:r=M.isInAlbum()?(0,s.curLang)("video_found_albums_in_album"):cur.getOwnerId()<0?(0,s.curLang)("video_found_albums_community"):cur.getOwnerId()==vk.id?(0,s.curLang)("video_found_albums_yours"):(0,s.curLang)("video_found_albums_of");break;case M.VIDEO_SEARCH_TYPE:r=M.isInAlbum()?(0,s.curLang)("video_found_videos_in_album"):cur.getOwnerId()<0?(0,s.curLang)("video_found_videos_community"):cur.getOwnerId()==vk.id?(0,s.curLang)("video_found_videos_yours"):(0,s.curLang)("video_found_videos_of");break;case M.VIDEO_GLOBAL_SEARCH_TYPE:r=cur.is_showcase?(0,s.getLang)("video_found_videos"):(0,s.curLang)("video_found_videos_global");break;case M.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE:r=cur.is_showcase?(0,s.getLang)("video_search_playlists"):(0,s.getLang)("video_search_promo_playlists")}r=(r=(0,s.langNumeric)(o.count,r,!0)).replace("{user}",(0,s.curLang)("video_owner_name_gen"));var n=(0,i.ge)("video_subtab_pane_"+e),a=(0,i.geByClass1)("js-video-subtitle",n);if((0,i.val)(a,r),cur.is_showcase&&o.count){var c=(0,i.geByClass1)("js-video-subtitle-counter",n);(0,i.val)(c,(0,s.langNumeric)(o.count,"%s",!0))}var d=e==M.VIDEO_GLOBAL_SEARCH_TYPE?cur.videoGlobalSearchQuery:cur.videoLocalSearchQuery;d+=M._buildFiltersSearchStr(),cur._videoRenderedSearchResults=cur._videoRenderedSearchResults||{};var l=cur._videoRenderedSearchResults;l[e]!=d&&(l[e]=d,(0,i.ge)("video_"+e+"_list").innerHTML="",cur.videoShowWindow&&cur.videoShowWindow[t]&&delete cur.videoShowWindow[t][e],M.showMore(e))}},_showGlobalSearchResults:function(e,o){var t=e+M._buildFiltersSearchStr(),i=cur.getOwnerId(),r=M.isInAlbum()?M.getLoc().section:"all",n=cur.is_showcase||!!cur.silentLoaded[i][r];if((e==cur.videoGlobalSearchQuery||e==cur.videoLocalSearchQuery)&&n&&cur.globalSearchResults[t]&&cur.globalSearchResults[t].count>=0){var a=cur.globalSearchResults[t];cur.found[M.VIDEO_GLOBAL_SEARCH_TYPE]={list:a.list,count:a.count,done:a.done,realOffset:a.realOffset},cur.found[M.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE]={list:a.promoPlaylists,count:a.playlistTotalCount||a.promoPlaylists.length,done:!a.promoPlaylists.length},cur.noEmptyLocalResults&&(M._toggleSearchContent(!0),0==a.count?M._toggleEmptySearchPlaceholder(!0,e):M._toggleEmptySearchPlaceholder(!1)),o||(M._showSearchResult(M.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE),M._showSearchResult(M.VIDEO_GLOBAL_SEARCH_TYPE)),M._callPendingAction(M.VIDEO_GLOBAL_SEARCH_TYPE)}},_toggleSearchContent:function(e){(0,i.toggle)("video_layout_contents",!e),(0,i.toggle)("video_layout_search",!!e),cur.is_showcase&&(0,i.toggle)("video_block_header",!e)},setVisibilityShowcaseContent:function(e){(0,i.toggle)("video_main_block",e)},_searchLocally:function(e){if(cur.found={},!e||!cur.videoIndexes)return!1;var o=cur.getOwnerId(),t=[],i=[];!M.isInAlbum()&&cur.videoIndexes[o].albums&&(i=cur.videoIndexes[o].albums.search(e),cur.found[M.ALBUM_SEARCH_TYPE]={list:i,count:i.length},M._showSearchResult(M.ALBUM_SEARCH_TYPE));var r=M.isInAlbum()?M.getLoc().section:"all";if(cur.videoIndexes[o][r]){var n=cur.videoIndexes[o][r].search(e);(0,h.each)(n,(function(e,o){(!cur.videoSearchFilters.hd||o[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_HD)&&(!cur.videoSearchFilters.live||o[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_LIVE)&&(Date.now()/1e3-o[VideoConstants.VIDEO_ITEM_INDEX_DATE]>cur.videoSearchFilters.date||t.push(o))})),cur.found[M.VIDEO_SEARCH_TYPE]={list:t,count:t.length},M._showSearchResult(M.VIDEO_SEARCH_TYPE)}return i.length+t.length?(M._toggleSearchContent(!0),M._toggleEmptySearchPlaceholder(!1)):cur.noEmptyLocalResults?M._toggleEmptySearchPlaceholder(!1,void 0,!0):(M._toggleSearchContent(!0),M._toggleEmptySearchPlaceholder(!0,e)),t?t.length:0},onItemEnter:function(e){(0,i.setTitle)(e,e)},showMoreAlbums:function(e){var o=!1,t=cur.getOwnerId();cur.albumsPreload&&cur.albumsPreload[t]&&!cur.silentLoaded[t].albums&&(cur.silentLoaded[t].albums=cur.albumsPreload[t],o=!0),cur.albumsShowingAll[t]=!0,M.showMore("albums",e),o&&(cur.silentLoaded[t].albums=!1)},prepareVideoItemAttrs:function(e){var o="",t="",i={};i[VideoConstants.VIDEO_ITEM_FLAG_EXTERNAL]="video_ext",i[VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE]="video_active_live",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_EDIT]="video_can_edit",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DOWNLOAD]="video_can_download",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_ADD]="video_can_add",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE]="video_can_delete",i[VideoConstants.VIDEO_ITEM_FLAG_NO_AUTOPLAY]="video_nap",i[VideoConstants.VIDEO_ITEM_FLAG_ADDED]="VideoCard--videoAdded",i[VideoConstants.VIDEO_ITEM_FLAG_SKIP_THUMB_LOAD]="video_skip_thumb_load",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE_FROM_HISTORY]="VideoCard--history",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE]="VideoCard--private",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_MEMBERS]="VideoCard--privateMembers",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_BY_LINK]="VideoCard--privateByLink",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_NOT_PUBLISHED]="VideoCard--privateNotPublished",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_MOVE]="video_can_edit_albums",i[VideoConstants.VIDEO_ITEM_FLAG_HORIZONTAL]="VideoCard--horizontal";var r=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS];(0,h.each)(i,(function(e,t){r&e&&(o+=t+" ")})),e[VideoConstants.VIDEO_ITEM_INDEX_PLATFORM]||e[VideoConstants.VIDEO_ITEM_INDEX_DURATION]||r&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE||(o+=" video_no_duration"),cur.is_showcase&&r&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE&&(o+=" video_no_duration"),e[VideoConstants.VIDEO_ITEM_INDEX_DATE]||(o+=" no_date");var n=e[VideoConstants.VIDEO_ITEM_INDEX_MUSIC_VIDEO_META];n&&n.explicit&&(o+=" video_explicit");var a=!(r&VideoConstants.VIDEO_ITEM_FLAG_CAN_EDIT||r&VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE),s=e[VideoConstants.VIDEO_ITEM_INDEX_BLOCKED],c=!(r&VideoConstants.VIDEO_ITEM_FLAG_CAN_ADD);return a&&(c||s)&&(o+=" video_no_actions"),s&&(o+=" video_blocked"),cur.videoCanAddAlbums&&!s&&(o+=" video_can_edit_albums"),cur.isSnippetVideoSelection&&(o+=" no_video_select_btn"),r&VideoConstants.VIDEO_ITEM_FLAG_NEED_SIGN_IN&&(t+=' rel="nofollow"'),[o,t]},buildVideoEl:function(e,o,t){return void 0===o&&(o=!1),void 0===t&&(t=!1),(0,y.buildVideoEl)(e,o)},buildPlaylistEl:function(e,o){return void 0===o&&(o=!1),(0,y.buildPlaylistEl)(e,o)},addShowMoreButton:function(e,o){if(e&&o&&0!==o.length){var t=(0,i.ce)("div",{className:(M.showMoreClassNames||"").replace("%type%",o),innerHTML:(0,s.curLang)("video_show_more")});return e.parentNode.append(t),t.onClick=M.showMore(o,t),t}},onMoreLoaded:function(e,o,t,r,n){M._loading=!1;var a,s=cur.getOwnerId(),c=cur.videoShowWindow[s][o],d=(0,i.ge)("video_"+o+"_list"),l=(0,i.gpeByClass)("ge_video_pane",d),u=d.classList.contains("VideoGrid");if(d){e=(0,i.geByClass1)("ui_load_more_btn",l);var _=o.indexOf("albums")>=0,v=_?0:3,g=M._getCurrentSectionType();g="album"==g?M.getLoc().section:"all";var p,f=!1;if(o.indexOf("search")>=0&&cur.videoIndexes&&cur.searchText)f=new RegExp("("+cur.searchText.replace(/\|/g,"").replace(null==(p=cur.videoIndexes[s][g])?void 0:p.delimiter,"|").replace(/^\||\|$/g,"").replace(/([\+\*\)\(])/g,"\\$1")+")","gi");for(var S=0,m=t.length;S<m;S++){var w=(0,h.extend)({},t[S]);f&&!u&&(w[v]=w[v].replace(f,"<em>$1</em>")),a=_?M.buildPlaylistEl(w,u):M.buildVideoEl(w,u),o==M.VIDEO_GLOBAL_SEARCH_TYPE&&a.setAttribute("data-search-pos",S+c.offset),d.appendChild(a)}!e&&!n&&!c.done&&r>c.offset&&(e=M.addShowMoreButton(d,g)),c.offset=r,c.done=!t.length||n,(0,i.toggle)(e,!c.done),cur.is_showcase&&l.classList.toggle("VideoPane--noMore",c.done),o==M.VIDEO_GLOBAL_SEARCH_TYPE&&(cur.videoSearchStats||M._initSearchStats(M.getLoc()),cur.videoSearchStats.lastActionTime=Date.now(),M._updateLastSeenElement(d))}},showMore:function(e,o){e=e||M._getCurrentSectionType();var t=(0,v.curBox)()?(0,v.curBox)().bodyNode:void 0,r=(0,i.geByClass1)("_video_"+e+"_list",t);if(r){var n=M.isInAlbum(e),a=cur.getOwnerId();if(!n&&-1==M.AVAILABLE_TABS.indexOf(e)||cur.silentLoaded[a][e]){var c;(0,p.unlockButton)(o),cur.videoShowWindow=cur.videoShowWindow||{},cur.videoShowWindow[a]=cur.videoShowWindow[a]||{},cur.videoShowWindow[a][e]||(cur.videoShowWindow[a][e]={done:!1,offset:r.children.length});var d=cur.videoShowWindow[a][e];if(!d.done)if(e.indexOf("search")>=0&&cur.found[e]){var l,u,_;if(e===M.VIDEO_GLOBAL_SEARCH_TYPE){if(c=cur.found[e].list.length,l=cur.found[e].realOffset||c,u=cur.found[e].list.slice(d.offset,c),!(_=cur.found[e].done)&&0===u.length)return M._addPendingAction(e,(function(){M.showMore(e,o)})),(0,p.lockButton)(o),void(cur.globalSearchInProgress||M._searchGlobally(cur.videoGlobalSearchQuery,l))}else if(e===M.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE){var h=0===d.offset,g=(0,i.ge)("video_"+e+"_list"),f=g.classList.contains("VideoGrid");if(!h)return(0,p.lockButton)(o),void M.showMorePlaylist(cur.videoGlobalSearchQuery,d.offset,((t,i,r)=>{f&&g.classList.remove("VideoGrid--oneRow"),(0,p.unlockButton)(o),M.onMoreLoaded(o,e,i,r,t)}));c=cur.found[e].list.length,u=cur.found[e].list,_=c>=cur.found[e].count,f&&g.classList.add("VideoGrid--oneRow")}else if(cur.is_showcase&&e===M.ALBUM_SEARCH_TYPE){if(0===d.offset){c=M._getNumberOfVideoGridColumns()||M.PLAYLIST_FIRST_CHUNK_SIZE,u=cur.found[e].list.slice(0,c);var S=cur.found[e].list.length-c;if(S>0){_=!1;var m=(0,i.geByClass1)("ui_load_more_btn",(0,i.gpeByClass)("ge_video_pane",r));if(m){var w=(0,s.curLang)("video_show_more_playlists").map((e=>e.replace("%s",'<span class="VideoShowMoreButton__counter">%s</span>')));m.innerHTML=(0,s.langNumeric)(S,w)}}else _=!0}else(0,i.ge)("video_"+e+"_list").classList.remove("VideoGrid--oneRow"),u=cur.found[e].list.slice(d.offset,cur.found[e].list.length),_=!0}else c=d.offset+M.VIDEOS_PER_PAGE,u=cur.found[e].list.slice(d.offset,c),_=c>=cur.found[e].list.length;M.onMoreLoaded(o,e,u,c,_)}else if((n||-1!=M.AVAILABLE_TABS.indexOf(e))&&cur.silentLoaded[a][e]){var I=cur.silentLoaded[a][e];if(!c&&!I.length)return cur.is_showcase?void(0,i.hide)(o):void M._toggleEmptyPlaceholder(!0,(0,s.getLang)("video_no_videos_here_yet"));c=Math.min(I.length,d.offset+M.VIDEOS_PER_PAGE);var E,b=I.slice(d.offset,c);if("albums"===e&&cur.albumsPreload[a])E=cur.albumsNoMore,cur.albumsPreload[a]=!1;else{E=c>=I.length;var y=Math.ceil(c,M.VIDEOS_PER_PAGE);if(window.cur.unauthScrollMoreBox){var C=window.cur.unauthScrollMoreBox,V=C.ownerId;y>C.screens&&M.getCurOwnerId()===V&&(window.cur.unauthScrollMoreBox.needShow=!0,E=!0)}}"albums"===e&&(cur.albumsShowingAll[a]=!E),M.onMoreLoaded(o,e,b,c,E)}M._updateThumbsInView()}else(0,p.isButtonLocked)(o)||(M._addPendingAction(e,(function(){M.showMore(e,o)})),(0,p.lockButton)(o))}},showMorePlaylist:function(e,o,t){ajax.post("/al_video.php?act=search_video_playlist",{q:e,offset:o,query_id:cur.searchQueryId},{onDone:function(e,o,i){t(e,o,i)}})},isInAlbum:function(e){return 0===(e=e||M.getLoc().section||"").indexOf("album_")||0===e.indexOf("playlist_")},isInSearch:function(){return!!M.getLoc().q},_getSectionAlbumId:function(){var e=M.getLoc().section||"all";switch(e){case"all":return-2;case"uploaded":return-1;default:return e.split("_")[1]}},isInCatalog:function(e){return e=e||M.getLoc(),cur.is_showcase?!cur.isOwnerVideos&&!(0,h.inArray)(e.section,M.USER_SYSTEMS_ALBUM_TYPES):"video"===e[0]&&!e.section},_getCurrentSectionType:function(){return cur.videoForcedSection?cur.videoForcedSection:M.isInAlbum(M.getLoc().section)?"album":M.isInCatalog()?"catalog":M.getLoc().section||"all"},_getNumberOfVideoGridColumns:function(){var e,o,t=document.querySelector(".VideoLayout__contentsWrapper"),i=document.querySelector(".VideoLayout__contents .VideoGrid");if(i){e=i.offsetWidth||t.offsetWidth;var r=getComputedStyle(i);o=parseInt(r.getPropertyValue("column-gap"),10)}else e=t.offsetWidth,o=12;return Math.floor((e+o)/(300+o))},onScroll:function(){if("upload"!==M.getLoc().section){var e;cur.getOwnerId&&cur.albumsShowingAll[cur.getOwnerId()]?e="albums":(e=M._getCurrentSectionType(),M.getLoc().q||"search"===e?e=(0,i.isVisible)((0,i.gpeByClass)("ge_video_pane","ui_search_global_videos_load_more"))?M.VIDEO_GLOBAL_SEARCH_TYPE:M.VIDEO_SEARCH_TYPE:"album"===e?e=M.getLoc().section:cur.showcaseSection&&(e=cur.showcaseSection));var o=(0,v.curBox)()?(0,v.curBox)().bodyNode:void 0,t=(0,i.geByClass1)("_video_"+e+"_list",o);if(t&&"all_playlists"!==e&&"all_playlist_subscriptions"!==e){var r=(0,i.gpeByClass)("ge_video_pane",t),n=(0,i.geByClass1)("ui_load_more_btn",r);if(n){var a=(0,i.clientHeight)(),s=(0,_.scrollGetY)(),c=(0,i.getXY)(n);s+a>(cur.serverPaging?c[1]-a:c[1]-a/2)&&(cur.serverPaging&&cur.showcaseSection===e?M.showMoreShowcase(e,n,(()=>{M._updateThumbsInView(),M._loadNextChunkIfNeed()})):M.showMore(e,n))}e===M.VIDEO_GLOBAL_SEARCH_TYPE&&M._updateLastSeenElement(t)}else if("all_playlists"===cur.showcaseSection&&cur.playlistsNextOffset&&!cur.loadingAlbums){var d=(0,i.clientHeight)(),l=document.body.clientHeight;(0,_.scrollGetY)()+d>l-d/2&&M.showMoreOwnerPlaylists()}else if("all_playlist_subscriptions"===cur.showcaseSection&&cur.playlistsNextOffset&&!cur.loadingAlbums){var u=(0,i.clientHeight)(),h=document.body.clientHeight;(0,_.scrollGetY)()+u>h-u/2&&M.showMoreSubscriptionsPlaylists()}M._updateChooseFixedBottom(),M._updateThumbsInView()}},_createSorters:function(e){if(cur.videoCanSort){cur.videoSorter&&cur.videoSorter.destroy(),"album"===(e=e||M._getCurrentSectionType())&&(e=M.getLoc().section);var o=cur.is_showcase?"VideoCard--dragOver":"video_on_drag_over";D().then((()=>{cur.videoSorter=new window.GridSorter((0,i.ge)("video_"+e+"_list"),"video_item__thumb_link",{onReorder:M._onReorder,onDragOverElClass:"js-video_playlist_item",onDragLeave:function(e,t){(0,i.removeClass)(e,o),(0,i.removeClass)(t,"video_on_drag_over")},onDragEnter:function(e,t){(0,i.addClass)(e,o),(0,i.addClass)(t,"video_on_drag_over")},onDragDrop:function(e,o){var t=(0,i.attr)(o,"data-id").split("_"),r=(0,i.attr)(e,"data-id");return ajax.post("/al_video.php?act=a_add_to_playlist",{oid:t[0],vid:t[1],gid:cur.getOwnerId()<0?-cur.getOwnerId():0,add:1,playlist_id:r,own:1,hash:cur.videoAddToPlaylistOwnHash},{onDone:function(o,t){if(t&&t[r]){var n=M.buildPlaylistEl(t[r],cur.is_showcase);(0,i.domPN)(e).replaceChild(n,e),M._reinitSorters(),cur.albumsSorter.update()}}}),!0}})}))}},_reinitSorters:function(e){cur.videoCanSort&&(clearTimeout(cur._rsto),cur._rsto=setTimeout((function(){cur.videoSorter?e?cur.videoSorter.disable():cur.videoSorter.enable():M._createSorters()})))},_saveHistoryAction:function(e,o){if(M.isInSearch()&&cur.videoGlobalSearchQuery){var t=cur.videoGlobalSearchQuery+M._buildFiltersSearchStr(),i=cur.globalSearchResults[t];i&&!cur.videoSearchFilters.notsafe&&uiSearch.saveHistorySearch(this.searchInputEl,cur.videoGlobalSearchQuery,e,o,i.count,i.countHash)}},onVideoAdd:function(e,o,t,r,n){var a,c=(0,i.gpeByClass)("_video_item",o),d=(0,h.intval)((0,i.toggleClass)(c,"VideoCard--videoAdded"));return a=d?{playlist_id:-2}:{playlists:0},M._saveHistoryAction(t,r),ajax.post("/al_video.php?act=a_add_to_playlist",(0,h.extend)({oid:t,vid:r,add:(0,h.intval)(d),hash:n},a),{onFail:function(){d&&(window.tooltips&&tooltips.destroyAll(),(0,i.removeClass)(c,"VideoCard--videoAdded"))},onDone:function(e,o,n){var a,c=cur.currentSortings&&(!cur.currentSortings.all||"default"===cur.currentSortings.all),l=!!cur._preloadedPages&&(0,i.geByClass1)("_video_list_my_all",cur._preloadedPages.all),u=!1;(0,O.partConfigEnabled)("video_card_add_video_button_redesign")&&(a=d?(0,s.getLang)("video_added_to_playlist"):(0,s.getLang)("video_deleted_from_playlist"),(0,v.showSnackbar)({text:`<span class="VideoNotification__title">${a}</span>`,before:{content:(0,S.getIcon28ListCheckOutline)().icon},action:{label:`«${(0,s.getLang)("video_catalog_showcase_section_my_video_added_title")}»`,onClick:()=>window.location.href=M._getMyAddedVideosPath()}}));if(l){var _=(0,i.geByClass1)("ge_video_item_"+t+"_"+r,l);_&&(0,i.re)(_),u=!!_,d&&c&&l.insertBefore(M.buildVideoEl(n,cur.is_showcase),l.firstChild)}if(cur.silentLoaded&&cur.silentLoaded[vk.id]&&cur.silentLoaded[vk.id].all){var h=cur.silentLoaded[vk.id].all;if(d)c&&(h.unshift(n),M._reindex(h));else for(var g=0,p=h.length;g<p;g++)if(h[g][0]==t&&h[g][1]==r){h.splice(g,1);break}if(cur.videosCount[vk.id]){var f=d?1:-1;1===f&&u&&(f=0);var m=cur.videosCount[vk.id].all=Math.max(0,(cur.videosCount[vk.id].all||0)+f);M.updateTabCounter(m)}}}}),window.tooltips&&tooltips.destroyAll(),(0,g.cancelEvent)(e)},updateTabCounter:function(e){var o=(0,i.ge)("video_tab_all");o&&((0,i.geByClass1)("ui_tab_count",o).innerHTML=e)},onVideoMove:function(e,o,t,i,r){return(0,d.showBox)("/al_video.php?act=video_playlists_box",{target_id:cur.getOwnerId(),oid:t,vid:i,hash:r},{stat:[window.jsc("web/indexer.js")]}),(0,g.cancelEvent)(e)},_showProgressPanel:function(e){var o=(0,i.se)('<div class="video_delete_progress _video_delete_progress VideoCard__deleteProgress"><div class="round_spinner"></div></div>');return e.appendChild(o),o},onVideoDelete:function(e,o,t,r,n,a){void 0===a&&(a=!1);var s=(0,i.gpeByClass)("_video_item",o),c=M._getCurrentSectionType(),d=M._showProgressPanel(s),l="album"===c?M._getSectionAlbumId():-2;return(0,i.addClass)(s,s.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),cur.videoRecentlyRemoved||(cur.videoRecentlyRemoved={}),cur.videoRecentlyRemoved[t+"_"+r]=!0,ajax.post("/al_video.php?act=a_delete_video",{oid:t,vid:r,from:cur.oid,pl_id:l,section:cur.section_id,hash:n,is_showcase:cur.is_showcase,is_short:+a},{onDone:function(e){(0,i.re)(d),s.appendChild((0,i.se)(e));var o=(0,i.data)(s,"restoreTO");clearTimeout(o),o=setTimeout((function(){(0,i.re)((0,i.geByClass1)("_video_restore_act",s))}),6e4),(0,i.data)(s,"restoreTO",o)}}),(0,g.cancelEvent)(e)},restoreVideo:function(e,o,t,r){var n=(0,i.gpeByClass)("_video_item",e),a=(0,i.gpeByClass)("_video_restore",e),s=M._showProgressPanel(n),c="album"===M._getCurrentSectionType()?M._getSectionAlbumId():-2;if((0,i.re)(a),"my_bookmarks"===cur.section_id){var d=o.split("_");return(0,i.removeClass)(n,n.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,i.re)(s),void window.bookmark(d[0],d[1],"video",r,!1)}if("my_liked"!==cur.section_id)ajax.post("/al_video.php?act=a_restore_video",{from:t,video_id:o,pl_id:c,hash:r,section:cur.section_id},{onDone:function(){(0,i.removeClass)(n,n.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,i.re)(s)}}),delete cur.videoRecentlyRemoved[o];else{(0,i.removeClass)(n,n.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,i.re)(s);var l=()=>Likes.toggle(e,!1,"video"+o,r);window.Likes?l():(0,A.getLikesModule)().then(l)}},onVideoUMA:function(e,o,t,i){return(0,d.showBox)("al_video.php?act=get_uma_restrictions",{oid:t,vid:i},{params:{width:750}}),(0,g.cancelEvent)(e)},onVideoEdit:function(e,o,t,r,n){return void 0===n&&(n=!1),cur.videoEditItem=(0,i.gpeByClass)("_video_item",o),window.Videoview&&Videoview.hidePlayer(),(0,d.showBox)("al_video.php?act=edit_box",{vid:r,oid:t,is_short_video:+n},{containerClass:"video_edit",stat:[window.jsc("web/privacy.js"),"privacy.css","video_edit.css","videoview.js","video_upload.js",window.jsc("web/upload.js")]}).setOptions({onHide:function(){window.Videoview&&Videoview.showPlayer()}}),(0,g.cancelEvent)(e)},switchChooserToOwner:function(e){var o=(0,v.curBox)(),t=!!cur.isSnippetVideoSelection,i={to_id:e,switched:1};t&&(i.snippet_video=1),(0,d.showBox)("al_video.php?act=a_choose_video_box",i,{showProgress:o.showCloseProgress.bind(o),hideProgress:o.hideCloseProgress.bind(o),cache:1,onDone:function(){(0,v.curBox)().hide(),(0,d.showBox)("al_video.php?act=a_choose_video_box",i,{cache:1})}})},chooseBoxBack:function(){cur.videoChoosePrevSection=cur.videoChoosePrevSection||"all",0==cur.videoChoosePrevSection.indexOf("album_")&&(cur.videoChoosePrevSection="albums"),nav.go("/videos?section="+cur.videoChoosePrevSection)},initChooseBox:function(e,o,t,r,n,c,d){if(arguments.length>0)this.initChooseBoxOptions={isNoteEdit:e,isReview:o,toMail:t,curOwnerId:r,defaultTitle:n,blockPersonal:c,isSnippetVideo:d};else{if(!this.initChooseBoxOptions)return;e=this.initChooseBoxOptions.isNoteEdit,o=this.initChooseBoxOptions.isReview,t=this.initChooseBoxOptions.toMail,r=this.initChooseBoxOptions.curOwnerId,n=this.initChooseBoxOptions.defaultTitle,c=this.initChooseBoxOptions.blockPersonal,d=this.initChooseBoxOptions.isSnippetVideo}cur.found={},cur.currentSortings={},cur._preloadedPages={},cur.videoSearchFilters={},cur.chosenVideos=[],cur.albumsShowingAll={},cur.isNoteEdit=e,cur.videoShowWindow={},cur.isSnippetVideoSelection=d;var l=(0,v.curBox)(),u=cur.getOwnerId;function _(){l.setOptions({width:631,bodyStyle:"padding: 0",hideButtons:!0}),(0,i.ge)("box_layer_wrap").scrollTop=0}function p(){(0,h.each)(M.AVAILABLE_TABS,(function(e,o){(0,i.hide)("video_subtab_pane_"+o)})),(0,i.hide)((0,i.geByClass1)("video_subtab_pane_album"))}function f(){l.setOptions({title:'<div class="back" onclick="Video.chooseBoxBack();"><span class="back__icon">'+(0,m.getIcon24BrowserBack)().icon+"</span>"+(0,s.getLang)("video_choose_box_back_to_videos")+"</div>",bodyStyle:"padding: 0",noRefreshCoords:1})}function S(){var e=n;if(!c&&!o&&cur.videoSwitchOwnerId){var t=r==vk.id?(0,s.getLang)("video_choose_wall_to_group_videos"):(0,s.getLang)("video_choose_wall_to_my_videos");e+='<span class="divider">|</span><a class="toggle" onclick="Video.switchChooserToOwner('+(r==vk.id?cur.videoSwitchOwnerId:vk.id)+')">'+t+"</a>"}l.getOptions().defaultTitle&&(e=l.getOptions().defaultTitle),l.setOptions({title:e,grey:o})}function w(){(0,v.curBox)()&&(0,h.each)((0,i.geByClass)("video_item",(0,v.curBox)().bodyNode),(function(){var e=(0,i.geByClass1)("media_check_btn_wrap",this),o=this.getAttribute("data-id");(0,i.toggleClass)(e,"checked",-1!=cur.chosenVideos.indexOf(o))}))}cur.getOwnerId=function(){return r},l.setOptions({onHideAttempt:function(){return cur.getOwnerId=u,!0}}),cur.nav.push((function(e,o,t,n){if(!n.filtersChanged&&1===Object.keys(t).length&&t[0]&&0!=t[0].indexOf("video")&&!n.fromSearch)return!0;if(e[0]&&!e.section&&t[0]!=="videos"+r)return!0;(0,i.hide)("global_prg");var s=(0,i.geByClass1)("video_default_tabs",l.bodyNode),c=(0,i.geByClass1)("video_subtab_pane_album",l.bodyNode),d=e.section||"all";M._prepareSearchFilters(t);var u=e.section?"":t.q||(0,i.val)(cur.searchInputEl);if(u?(d="search",n.fromSearch||n.globalQuery||(n.globalQuery=u),M.doSearch(u),f(),M._updateChooseFixedBottom()):(M.inputVal(cur.searchInputEl,""),M.doSearch("")),cur.videoForcedSection=d,-1!==M.AVAILABLE_TABS.indexOf(d))p(),(0,i.show)("video_subtab_pane_"+d),(0,i.show)(s),(0,i.hide)("albumPane"),S(),_(),cur.videoChoosePrevSection=d,"albums"!==d&&M.loadSilent(d),M.updateEmptyPlaceholder(d);else if(d&&0==d.indexOf("album_")){var v=d.split("_")[1];(0,a.showGlobalPrg)((0,i.ge)("video_playlist_item_"+v),{cls:"progress_inv_img",w:46,h:16,shift:[0,-22],zIndex:1e3}),M._addPendingAction(d,(function(){f(),p(),(0,i.hide)("global_prg"),(0,i.hide)(s),c.id="video_subtab_pane_"+d;var e=(0,i.geByClass1)("video_items_list",c);e.id="video_"+d+"_list",(0,i.addClass)(e,"_video_"+d+"_list"),e.innerHTML="",(0,i.show)(c);var o=cur.getOwnerId();cur.videoShowWindow=cur.videoShowWindow||{},cur.videoShowWindow[o]=cur.videoShowWindow[o]||{},cur.videoShowWindow[o][d]=!1,M.showMore(d,(0,i.geByClass1)("ui_load_more_btn",(0,i.ge)("video_subtab_pane_album"))),_(),w(),M._updateChooseFixedBottom()})),cur.videoChoosePrevSection=d,M.loadSilent(d)}return w(),!1})),cur.chooseVideoToMail=t,cur.isCurrentVideoLayer=!0,M.loadSilent(),_(),(0,g.addEvent)((0,i.ge)("box_layer_wrap"),"scroll",M.onScroll);var I=boxLayerWrap.scrollTop;(0,i.elfocus)((0,i.geByClass1)("_scroll_node",l.bodyNode)),boxLayerWrap.scrollTop=I,M.initSearch(),S(),o||(cur.chooseVideoMedia=function(e,o,t){var r,n=e;if((0,i.hasClass)(n,"media_check_btn_wrap")?cur.cancelClick=!0:n=(0,i.geByClass1)("media_check_btn_wrap",n),(r=cur.chosenVideos.indexOf(o))>=0)cur.chosenVideos.splice(r,1);else{if(cur.chosenVideos.length>=(cur.maxFiles||10))return;cur.chosenVideos.push(o)}if((0,i.toggleClass)(n,"checked"),1===cur.chosenVideos.length&&!t)return M.doAttachSelectedVideos(e),!1;var a=(0,i.ge)("video_choosebox_bottom");if(cur.chosenVideos.length>0){(0,i.show)(a);var c=cur.chooseVideoAdd?(0,s.curLang)("video_add_videos"):(0,s.curLang)("global_attach_videos"),d=null==a?void 0:a.querySelector(".video_choosebox_attach_btn");d&&L.FlatButton.setLabel(d,(0,s.langNumeric)(cur.chosenVideos.length,c)),M._updateChooseFixedBottom()}else(0,i.hide)(a);return(0,i.toggleClass)((0,i.ge)("video_choose_box"),"with_bottom_fixed",(0,i.isVisible)(a)),!1}),window.uiScrollBox&&window.uiScrollBox.init((0,v.curBox)(),{onHide:function(){(0,i.hide)("global_prg"),cur.nav.pop(),(0,g.removeEvent)((0,i.ge)("box_layer_wrap"),"scroll",M.onScroll),cur.isCurrentVideoLayer=!1,cur.chooseVideoMedia=null},onShow:function(){M.initChooseBox()}})},doAttachSelectedVideos:function(e){L.FlatButton.isFlatButton(e)?L.FlatButton.lock(e):(0,a.showGlobalPrg)((0,i.geByClass1)("video_item_thumb_wrap",e)||e,{cls:"progress_inv_img",w:46,h:16,zIndex:1e3});var o=function(){L.FlatButton.isFlatButton(e)&&L.FlatButton.unlock(e),(0,i.hide)("global_prg")};if(cur.chooseVideoAdd)return cur.chooseVideoAdd(cur.chosenVideos,"",o);M.attachVideos(cur.chosenVideos,o)},attachVideos:function(e,o){ajax.post("al_video.php?act=a_videos_attach_info",{from:cur.getFrom?cur.getFrom():"",videos:e.join(",")},{onDone:function(e){if(o&&o(),cur.isSnippetVideoSelection&&cur.chooseSnippetVideo)return(0,h.each)(e,(function(e,o){return cur.chooseSnippetVideo(e,o),!1})),void((0,v.curBox)()&&(0,v.curBox)().hide());var t=0;(0,h.each)(e,(function(e,o){cur.isNoteEdit&&window.editorChooseVideo?window.editorChooseVideo(o.thumb,o.name,o.duration,"/video"+e,e):cur.chooseMedia("video",e,o,t,cur.chosenVideos.length>1),t++})),(0,v.curBox)()&&cur.chosenVideos.length>1&&(0,v.curBox)().hide()}})},_updateChooseFixedBottom:function(){var e=(0,v.curBox)(),o=(0,i.ge)("video_choosebox_bottom");if(e&&o){var t=(0,i.gpeByClass)("box_layout",e.bodyNode);(0,i.getSize)(t)[1]+((0,i.getXY)(t)[1]-(0,_.scrollGetY)())-(0,i.clientHeight)()>0?(0,i.addClass)(o,"fixed"):(0,i.removeClass)(o,"fixed")}},_addPendingAction:function(e,o){var t=cur.getOwnerId?cur.getOwnerId():cur.oid;if(cur.videoPendingAction=cur.videoPendingAction||{},cur.videoPendingAction[t]=cur.videoPendingAction[t]||{},e){var i=cur.videoPendingAction[t][e];cur.videoPendingAction[t][e]=function(){o(),i&&i()}}},_callPendingAction:function(e){M._addPendingAction();var o=M.getCurOwnerId();cur.videoPendingAction[o][e]&&cur.videoPendingAction[o][e](),cur.videoPendingAction[o][e]=!1},_clearPendingAction:function(e){M._addPendingAction();var o=M.getCurOwnerId();cur.videoPendingAction[o][e]=!1},toggleTooltip:function(e,o,t){var i=[9,18,9];"view-toggle"===t&&(i=[-5,-1,3]),(0,u.showTooltip)(e,{black:1,text:o,shift:i,needLeft:!0,forcetodown:!0})},toggleAddTooltip:function(e,o,t){if(!(0,O.partConfigEnabled)("video_card_add_video_button_redesign")){var r=(0,i.gpeByClass)("_video_item",e);M.toggleTooltip(e,(0,i.hasClass)(r,"VideoCard--videoAdded")?t:o)}},show:function(e,o,t,r){if(cur.videoEditItem=(0,i.gpeByClass)("_video_item",r),cur.articleEditorLayer)return(0,g.cancelEvent)(e);if(t.playAlbum&&(0,l.statlogsValueEvent)("video_play_album",0,"play_album"),cur.isCurrentChooseVideoBox){var a=window.event,c=o.split("_");return ajax.post("al_video.php?act=a_video_photo_sizes",{oid:c[0],vid:c[1],type:cur.isCurrentChooseVideoBox},{onDone:function(){switch(window.event=a||window.event,cur.isCurrentChooseVideoBox){case"video_add":cur.chooseVideoAdd(o,arguments[0]);break;case"wiki_editor":window.editorChooseVideo(arguments[0],arguments[1],arguments[2],"video"+o,o);break;case"video_choose":cur.chooseMedia("video",o,arguments[0])}}}),(0,g.cancelEvent)(e),!1}if(r&&(0,i.hasClass)(r,"video_row_deleted"))return!1;if(!vk.id&&r&&(0,i.hasClass)(r,"video_row_not_public"))return(0,v.showDoneBox)((0,s.getLang)("video_please_sign_in")),!1;var d,u,_=(0,h.extend)({root:1,autoplay:1},t||{}),p=(t?t.listId:"")||this.getDefaultListId();if(!_.module){var f=cur.currentModule?cur.currentModule():cur.module;"video_search"===f&&(0,i.isAncestor)(r,"video_search_videos_list")&&(f="video_search_local"),_.module=f}M.isInVideosList()&&!_.playlistId&&("all"===(d=cur.is_showcase?cur.showcaseSection:M.getLoc().section||"all")?_.playlistId=cur.oid+"_-2":"uploaded"===d?_.playlistId=cur.oid+"_-1":(u=d.match(/^(album|playlist)_(-?\d+)$/))&&(_.playlistId=cur.oid+"_"+u[1]));if(!M.isInCatalog()||_.playlistId||!cur.catPlaylistId||cur.isCatalog||this.isGlobalSearchMode()&&!this.shouldShowSectionInPlaylistWithSearch()||(_.playlistId=cur.catPlaylistId),_.playlistId&&(_.addParams=(0,h.extend)(_.addParams||{},{playlist_id:_.playlistId,show_next:(0,h.intval)(window.VideoPlaylist&&!!VideoPlaylist.getList(_.playlistId)),force_no_repeat:1,show_all_videos:(0,h.intval)(cur.isCatalog&&(!window.VideoPlaylist||!VideoPlaylist.getList(_.playlistId)))})),_.playFrom&&(_.addParams=(0,h.extend)(_.addParams||{},{t:_.playFrom})),cur.videoSearchStats){var S=(0,i.domClosest)("video_item",r);if(S&&S.hasAttribute("data-search-pos")){cur.videoSearchPos=parseInt(S.getAttribute("data-search-pos")),cur.videoSearchPos>cur.videoSearchStats.lastSeenIndex&&(cur.videoSearchStats.lastSeenElement=S,cur.videoSearchStats.lastSeenIndex=cur.videoSearchPos),cur.videoSearchStats.positions[cur.videoSearchPos]=(0,h.extend)({clicked:0},cur.videoSearchStats.positions[cur.videoSearchPos]),cur.videoSearchStats.positions[cur.videoSearchPos].clicked++;var m=++cur.videoSearchStats.clickNum,w=Date.now()-cur.videoSearchStats.lastActionTime;_.addParams=(0,h.extend)(_.addParams||{},{click_num:m,click_time:w})}}if(!(0,O.partConfigEnabled)("search_video_catalog_web2")){var I=o.split("_");M._saveHistoryAction(I[0],I[1])}return(0,n.showVideo)(o,p,_,e)},getDefaultListId:function(){return window.cur.oid<0?"club"+-window.cur.oid:window.cur.pvVideoTagsShown&&window.cur.pvShown?"tag"+window.cur.pvVideoTagsShown:""},isInVideosList:function(){if(cur.is_showcase)return(0,h.inArray)(cur.showcaseSection,["all","uploaded","all_playlists"])||/^playlist_-?\d+$/.test(cur.showcaseSection);var e=M.getLoc();return/^videos-?\d+|video-?\d+_\d+$/.test(e[0])&&!e.q&&((0,h.inArray)(M._getCurrentSectionType(),M.AVAILABLE_TABS)||M.isInAlbum())},deleteAlbum:function(e,o){return e=e.split("_")[1],(0,d.showBox)("al_video.php?act=delete_album",{aid:e,oid:cur.oid,is_showcase:cur.is_showcase}),(0,g.cancelEvent)(o)},editAlbum:function(e,o){return e=e.split("_")[1],(0,d.showBox)("al_video.php?act=edit_album",{oid:cur.oid,aid:e,is_showcase:cur.is_showcase},{stat:[window.jsc("web/upload.js")],containerClass:"VideoPlaylistPopup"}),(0,g.cancelEvent)(o)},initEditAlbumBox:function(e,o,t,r,n,a,d){var l=(0,v.curBox)(),u=(0,c.isObject)(n),_=!!Object.keys(d).length;if(_&&(VideoUpload.initThumbUpload(d,l.bodyNode),(0,c.isObject)(a)&&a.uploaded_id)){var g=(0,i.geByClass1)("js-video_tc_upload_image",l.bodyNode);(0,i.setStyle)(g,{backgroundImage:"url("+a.uploaded_url+")"}),(0,i.show)(g);var f=(0,i.geByClass1)("js-video_tc_uploader",l.bodyNode);f&&(0,i.domData)(f,"thumb-id",a.uploaded_id)}u&&(cur.privacy=(0,h.extend)(cur.privacy||{},n)),l.setOptions({bodyStyle:"padding: 20px; padding-bottom: 25px;",width:422}),l.removeButtons(),l.addButton((0,s.getLang)("global_save"),(function(n){var a=(0,i.ge)("video_album_edit_title"),s=a.value.trim();if(!s)return(0,p.notaBene)(a);var c=u?Privacy.getValue("video_playlist"+o):"",d="";if(_){var v=(0,i.geByClass1)("js-video_tc_uploader",l.bodyNode);d=(0,i.domData)(v,"thumb-id")||"0_0"}ajax.post("al_video.php?act=do_edit_album",{id:o,oid:e,hash:t,title:s,privacy:c,thumb_id:d},{showProgress:()=>(0,p.lockButton)(n),hideProgress:()=>(0,p.unlockButton)(n),onDone:function(t){o?cur.isAdmin?AdminShowcasePlaylists.search():nav.reload():cur.is_showcase?nav.go(r+"/"+e+"_"+t):nav.change({section:"album_"+t},!1,{noback:!0}),l.hide()}})}),"yes",!1,"popup_save_button"),l.addButton((0,s.getLang)("global_cancel"),l.hide,"no"),(0,i.elfocus)("video_album_edit_title")},editCategories:function(e,o){var t=e.split("_")[1];return(0,d.showBox)("al_video.php?act=update_categories",{owner_id:cur.oid,playlist_id:t},{onDone:function(e,o){cur.categoriesUpdateOptions={hash:o.hash,owner_id:o.owner_id,playlist_id:o.playlist_id};var t=new Dropdown((0,i.ge)("video_playlist_categories"),o.all_categories,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:o.category_ids});e.setOptions({bodyStyle:"padding: 20px; padding-bottom: 25px;",width:422}),e.removeButtons(),e.addButton("Сохранить",(function(r){var n={hash:cur.categoriesUpdateOptions.hash,owner_id:cur.categoriesUpdateOptions.owner_id,playlist_id:cur.categoriesUpdateOptions.playlist_id,category_ids:t.selectedItems().map((function(e){return e[0]})),info_updated_at:o.info_updated_at,info_age_rating:(0,i.ge)("video_movie_age_rating").value};ajax.post("al_video.php?act=do_update_categories",n,{showProgress:()=>(0,p.lockButton)(r),hideProgress:()=>(0,p.unlockButton)(r),onDone:function(){e.hide()}})})),e.addButton("Отмена",e.hide,"no")}}),(0,g.cancelEvent)(o)},initCreateAlbumWarningBox:function(){var e=(0,v.curBox)();e.removeButtons(),e.addButton((0,s.getLang)("video_cancel_but"),e.hide,"neutral")},createAlbum:function(e,o){return void 0===o&&(o=cur.oid),(0,h.intval)(o)?cur.is_showcase&&!vk.id?((0,d.showBox)("al_login.php?act=box",{from:nav.strLoc},{},e),!1):void(0,d.showBox)("al_video.php?act=edit_album",{oid:o,is_showcase:cur.is_showcase},{stat:[window.jsc("web/upload.js")],containerClass:"VideoPlaylistPopup",onDone:function(e){e.setOptions({width:500}),e.titleWrap.classList.toggle("OwnerChooseWrapper",cur.is_showcase),e.titleWrap.classList.toggle("OwnerChooseWrapper--colorGrey",!0)},onFail:function(e){if(e)return(0,v.curBox)().hide(),(0,d.showFastBox)((0,s.getLang)("global_error"),e),!0}}):((0,r.showQuickLoginBox)(),!1)},isVideoPlayerOpen:function(e,o){var t=e;return o&&(t+="_"+o),window.mvcur&&!0===mvcur.mvShown&&mvcur.videoRaw===t},startPollVideoReady:function(e,o){var t=e+"_"+o;setTimeout((function(){ajax.post("al_video.php?act=check_upload_status",{video:t,oid:e,vid:o},{onDone:function(i){M.isVideoPlayerOpen(e,o)&&(i?(mvcur.minimized?Videoview.hide(!1,!0):Videoview.backLocation(),(0,n.showVideo)(t,"",{})):M.startPollVideoReady(e,o))}})}),1e4)},tcSlide:function(e,o,t,r){var n=(0,i.gpeByClass)("video_tc_slider",o),a=(0,i.geByClass1)("video_tc_slider_cont",n),s=(0,i.getW)(a),c=getComputedStyle(a.children[0]),d=getComputedStyle(a.children.length>0?a.children[1]:a.children[0]),l=parseInt(c.getPropertyValue("margin-left"))+parseInt(c.getPropertyValue("margin-right")),u=parseInt(d.getPropertyValue("margin-left"))+parseInt(d.getPropertyValue("margin-right")),_=(0,i.getW)(a.children[0])+l,v=(0,i.getW)(a.children.length>0?a.children[1]:a.children[0])+u,h=_>0?Math.max(Math.floor(s/_),Math.floor((s-u)/v)):Math.floor((s-u)/v),p=Math.max(0,a.children.length-h),f=(0,i.data)(a,"currOffset")||0;f+=t,f=Math.min(a.children.length,Math.max(0,f),p),(0,i.data)(a,"currOffset",f),r&&(0,i.addClass)(a,"no_transition");var S=_*+(a.children.length>0)+v*(a.children.length-1)-s-u,m=_*+(f>0)+Math.max(0,v*(f-1));m=Math.max(0,Math.min(m,S)),(0,i.setStyle)(a,{left:-m}),r&&setTimeout((function(){(0,i.removeClass)(a,"no_transition")}));var w=0===f,I=f===p||m===S,E=(0,i.geByClass1)("video_tc_btn_left",n),b=(0,i.geByClass1)("video_tc_btn_right",n);function y(e,o){e?(0,g.addEvent)(o,"mouseleave",(function(){(0,i.setStyle)(o,"pointer-events","none"),(0,g.removeEvent)(o,"mouseleave")})):((0,i.setStyle)(o,"pointer-events","all"),(0,g.removeEvent)(o,"mouseleave"))}return(0,i.toggleClass)(E,"video_tc_btn_none",w),(0,i.toggleClass)(b,"video_tc_btn_none",I),y(w,E),y(I,b),e&&(0,g.cancelEvent)(e),!1},_initSearchStats:function(e){cur.videoSearchPos=null,cur.videoSearchStats={loc:e,totalViews:0,lastSeenElement:null,lastSeenIndex:-1,totalViewedTime:0,clickNum:0,lastActionTime:Date.now(),positions:[]}},_clearSearchStats:function(){delete cur.videoSearchPos,delete cur.videoSearchStats},_updateLastSeenElement:function(e){if(cur.videoSearchStats&&(null!==cur.videoSearchStats.lastSeenElement&&e.contains(cur.videoSearchStats.lastSeenElement)||(cur.videoSearchStats.lastSeenElement=(0,i.domFC)(e),cur.videoSearchStats.lastSeenElement))){cur.videoSearchStats.lastSeenIndex=0;var o=(0,i.clientHeight)(),t=(0,i.domNS)(cur.videoSearchStats.lastSeenElement);if(t){for(var r=t.getBoundingClientRect();r.top+t.clientHeight/2<o&&(cur.videoSearchStats.lastSeenElement=t,t=(0,i.domNS)(cur.videoSearchStats.lastSeenElement));)r=t.getBoundingClientRect();cur.videoSearchStats.lastSeenIndex=parseInt(cur.videoSearchStats.lastSeenElement.getAttribute("data-search-pos"))||0}}},_updateThumbsInView:function(){(0,y.updateThumbsInView)()},getCurOwnerId:function(){return cur.getOwnerId?cur.getOwnerId():cur.oid},onImageError:function(e,o){if(void 0===o&&(o=!1),!e.getAttribute("data-thumb")){var t=e.parentNode;t.removeChild(e);var i=(0,w.getIcon56VideoOutline)().icon;o&&(e.getAttribute("data-music-meta")?(t.classList.add("VideoCard__musicStub"),i=(0,I.getIcon20LogoVkMusicColor)().icon):i=(0,E.getIcon20VideoOutline)().icon),t.insertAdjacentHTML("beforeend",`<div class="VideoCard__thumbIcon">${i}</div>`)}},checkClickEvent:e=>"click"===e.type&&(e.ctrlKey||e.metaKey),isGroupsRedesignEnabled:()=>{var e=cur.getOwnerId?cur.getOwnerId():cur.oid;return(0,O.partConfigEnabled)("video_groups_redesign")&&T.Ranges.isGroupId(e)}}}}]);try{stManager.done("dist/76723cc0289bce5f59d58fa1d209f0e6.6049f86d0fbb83ec96b7.js")}catch(e){}